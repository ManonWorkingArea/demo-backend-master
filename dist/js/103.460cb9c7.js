"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[103],{42043:function(e,o,s){s.d(o,{A:function(){return U}});var t=s(20641),r=s(90033),c=s(53751);const u={class:"survey-layout p-2 mb-3"},a={class:"flex flex-col"},l={class:"mb-4"},i={class:""},n={key:0,class:"flex border-b border-gray-400 p-1 bg-gray-100"},d={class:"w-2/5 text-md font-semibold"},h={class:"w-3/5 space-y-0"},p={key:0,class:"w-full flex justify-start"},v={class:"flex items-center px-2 text-sm"},y=["onUpdate:modelValue","value"],m=["onUpdate:modelValue"],k={class:"text-md font-semibold p-1 border-b border-gray-400 bg-gray-100"},b={class:"space-y-0"},L={class:"w-full md:w-2/5 flex flex-col justify-start"},C={class:"mb-1 px-2 text-sm"},g={class:"w-full md:w-3/5 mt-2 md:mt-0"},f=["value","onUpdate:modelValue","onChange"],x=["onUpdate:modelValue"],D={class:"mt-2"},G={class:"font-semibold"},E={class:"mt-2 space-x-2 mb-5"},V={key:0,class:"mt-2 p-4 bg-red-200 border border-red-400 rounded"};function S(e,o,s,S,R,T){return(0,t.uX)(),(0,t.CE)("div",u,[(0,t.Lk)("div",a,[(0,t.Lk)("div",l,[(0,t.Lk)("div",null,[o[2]||(o[2]=(0,t.Lk)("span",{class:"font-semibold"},"Name:",-1)),(0,t.eW)(" "+(0,r.v_)(s.surveyData.name),1)]),(0,t.Lk)("div",null,[o[3]||(o[3]=(0,t.Lk)("span",{class:"font-semibold"},"Description:",-1)),(0,t.eW)(" "+(0,r.v_)(s.surveyData.description),1)])]),(0,t.Lk)("div",i,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.surveyData.choiceGroups,((e,o)=>((0,t.uX)(),(0,t.CE)("div",{key:o,class:(0,r.C4)([{"error-class":e.error},"choice-group border border-b-0 border-gray-400 mb-2 rounded-sm"])},["custom"===e.groupType?((0,t.uX)(),(0,t.CE)("div",n,[(0,t.Lk)("h3",d,(0,r.v_)(o+1)+". "+(0,r.v_)(e.groupName),1),(0,t.Lk)("div",h,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.choices,((o,s)=>((0,t.uX)(),(0,t.CE)("div",{key:s,class:"flex items-center"},["radio"===o.type?((0,t.uX)(),(0,t.CE)("div",p,[(0,t.Lk)("label",v,[(0,t.bo)((0,t.Lk)("input",{type:"radio","onUpdate:modelValue":o=>e.selectedChoice=o,value:o.choiceText,class:"mr-2 text-sm"},null,8,y),[[c.XL,e.selectedChoice]]),(0,t.eW)(" "+(0,r.v_)(o.choiceText),1)])])):"textarea"===o.type?(0,t.bo)(((0,t.uX)(),(0,t.CE)("textarea",{key:1,"onUpdate:modelValue":e=>o.choiceValue=e,class:"w-full p-1 h-32 rounded-sm"},null,8,m)),[[c.Jo,o.choiceValue]]):(0,t.Q3)("",!0)])))),128))])])):(0,t.Q3)("",!0),"score"===e.groupType?((0,t.uX)(),(0,t.CE)(t.FK,{key:1},[(0,t.Lk)("h3",k,(0,r.v_)(o+1)+". "+(0,r.v_)(e.groupName),1),(0,t.Lk)("div",b,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.choices,((u,a)=>((0,t.uX)(),(0,t.CE)("div",{key:a,class:(0,r.C4)([{"error-class":e.error},"flex items-center border-b border-gray-400 p-1 flex-col md:flex-row"])},[(0,t.Lk)("div",L,[(0,t.Lk)("p",C,(0,r.v_)(o+1)+"."+(0,r.v_)(a+1)+". "+(0,r.v_)(u.choiceText),1)]),(0,t.Lk)("div",g,["radio"===u.type?((0,t.uX)(),(0,t.CE)("div",{key:0,class:(0,r.C4)(["grid","gap-0","md:grid-cols-"+s.surveyData.score,"md:grid-rows-1","grid-cols-1","md:grid-cols-"+s.surveyData.score])},[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(s.surveyData.score,((e,o)=>((0,t.uX)(),(0,t.CE)("label",{key:e,class:"flex items-center px-2 text-sm"},[(0,t.bo)((0,t.Lk)("input",{type:"radio",value:e,"onUpdate:modelValue":e=>u.choiceValue=e,onChange:e=>T.updateCustomScore(u),class:"mr-2 text-sm"},null,40,f),[[c.XL,u.choiceValue]]),(0,t.eW)(" "+(0,r.v_)(s.scoreItemLabels[o]),1)])))),128))],2)):"textarea"===u.type?(0,t.bo)(((0,t.uX)(),(0,t.CE)("textarea",{key:1,"onUpdate:modelValue":e=>u.choiceValue=e,class:"w-full p-1 h-32 rounded-sm"},null,8,x)),[[c.Jo,u.choiceValue]]):(0,t.Q3)("",!0)])],2)))),128))])],64)):(0,t.Q3)("",!0)],2)))),128))])]),(0,t.Lk)("div",D,[(0,t.Lk)("p",G,"Summary Score: "+(0,r.v_)(T.summaryScore),1)]),(0,t.Lk)("div",E,[(0,t.Lk)("button",{onClick:o[0]||(o[0]=(...e)=>T.saveResult&&T.saveResult(...e)),class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},"ส่งข้อมูล"),(0,t.Lk)("button",{onClick:o[1]||(o[1]=(...e)=>T.clearSurvey&&T.clearSurvey(...e)),class:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"},"เคลียร์ข้อมูล")]),R.hasErrors?((0,t.uX)(),(0,t.CE)("div",V,[o[4]||(o[4]=(0,t.Lk)("h3",{class:"font-semibold text-red-700"},"เกิดข้อผิดพลาด (s):",-1)),(0,t.Lk)("ul",null,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(R.errors,((e,o)=>((0,t.uX)(),(0,t.CE)("li",{key:o,class:"text-red-700"},(0,r.v_)(e),1)))),128))])])):(0,t.Q3)("",!0)])}s(44114),s(98992),s(72577),s(3949),s(81454),s(37550);var R=s(63084),T={props:{surveyData:Object,scoreItemLabels:Array,surveyResults:Array},data(){return{errors:[],hasErrors:!1,preview:[]}},computed:{summaryScore(){let e=0;return this.surveyData.choiceGroups.forEach((o=>{"custom"!==o.groupType&&o.choices.forEach((o=>{if("radio"===o.type){const s=Number(o.choiceValue)||0;if(5===s&&o.hasCustomScore){const s=Number(o.customScore)||0;e+=s}else e+=s}}))})),e}},methods:{updateCustomScore(e){R.A.log("choice",e)},sanitizeString(e){const o=/[,!@#$%^&*();/|<>"']+/g;return e.replace(o,"")},saveResult(){if(this.errors=[],this.hasErrors=!1,this.surveyData.choiceGroups.forEach((e=>{if(e.choices.forEach((()=>{e.error=!1})),"custom"===e.groupType){let o=e.choices.some((e=>e.isRequested&&"radio"===e.type));o&&!e.selectedChoice&&(this.errors.push(`ตัวเลือกในกลุ่ม "${e.groupName}" ยังไม่ได้เลือกคำตอบ.`),e.error=!0),e.choices.forEach((o=>{o.isRequested&&"textarea"===o.type&&!o.choiceValue&&(this.errors.push(`ข้อความ "${e.groupName}" ยังไม่ได้กรอกข้อมูล.`),e.error=!0)}))}else e.choices.forEach((o=>{o.isRequested&&"radio"===o.type&&null===o.choiceValue?(this.errors.push(`ตัวเลือก "${o.choiceText}" ยังไม่ได้เลือกคำตอบ.`),e.error=!0):o.isRequested&&"textarea"===o.type&&!o.choiceValue&&(this.errors.push(`ข้อความ "${o.choiceText}" ยังไม่ได้กรอกข้อมูล.`),e.error=!0)}))})),this.errors.length>0)this.hasErrors=!0;else{const e={name:this.surveyData.name,score:this.surveyData.score,scoreSummary:this.summaryScore,choiceGroups:this.surveyData.choiceGroups.map((e=>"custom"===e.groupType?{groupName:e.groupName,groupType:e.groupType,choices:e.choices.map((e=>({choiceText:e.choiceText,type:e.type}))),selectedChoice:e.choices.some((e=>"textarea"===e.type))?this.sanitizeString(e.choices.find((e=>"textarea"===e.type&&e.choiceValue))?.choiceValue||""):e.selectedChoice}:{groupName:e.groupName,groupType:e.groupType,choices:e.choices.map((e=>({choiceText:e.choiceText,type:e.type,choiceValue:"textarea"===e.type?this.sanitizeString(e.choiceValue||""):e.choiceValue})))}))};this.preview=e,this.$emit("save-result",e)}},clearSurvey(){this.surveyData.choiceGroups.forEach((e=>{"custom"===e.groupType?e.selectedChoice=null:e.choices.forEach((e=>{"radio"===e.type?e.choiceValue=null:"textarea"===e.type&&(e.choiceValue="")}))}))}}},X=s(64621);const w=(0,X.A)(T,[["render",S],["__scopeId","data-v-e54faf52"]]);var U=w},30103:function(e,o,s){s.r(o),s.d(o,{default:function(){return X}});var t=s(20641);function r(e,o,s,r,c,u){const a=(0,t.g2)("Edit");return this.login?((0,t.uX)(),(0,t.Wv)(a,{key:0})):(0,t.Q3)("",!0)}var c=s(52968),u=s(75220),a=s(53751),l=s(90033);const i={for:"scoreItemLabel"},n=["onUpdate:modelValue"],d=["onUpdate:modelValue"],h=["onClick","disabled"],p=["onClick","disabled"],v=["onClick"],y=["onClick"],m=["onClick"],k=["onUpdate:modelValue"],b=["onClick","disabled"],L=["onClick","disabled"],C=["onClick"],g=["onUpdate:modelValue"];function f(e,o,s,r,c,u){const f=(0,t.g2)("SurveyResult");return(0,t.uX)(),(0,t.CE)("div",null,[o[10]||(o[10]=(0,t.Lk)("h2",null,"Survey Configuration",-1)),(0,t.Lk)("table",null,[(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[o[4]||(o[4]=(0,t.Lk)("td",null,[(0,t.Lk)("label",{for:"surveyName"},"Survey Name:")],-1)),(0,t.Lk)("td",null,[(0,t.bo)((0,t.Lk)("input",{type:"text",id:"surveyName","onUpdate:modelValue":o[0]||(o[0]=e=>c.surveyData.surveyName=e)},null,512),[[a.Jo,c.surveyData.surveyName]])])]),(0,t.Lk)("tr",null,[o[5]||(o[5]=(0,t.Lk)("td",null,[(0,t.Lk)("label",{for:"scoreLevels"},"Score Levels:")],-1)),(0,t.Lk)("td",null,[(0,t.bo)((0,t.Lk)("input",{type:"number",id:"scoreLevels","onUpdate:modelValue":o[1]||(o[1]=e=>c.surveyData.scoreConfig=e),min:"1"},null,512),[[a.Jo,c.surveyData.scoreConfig]])])])])]),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(c.scoreItemLabels,((e,o)=>((0,t.uX)(),(0,t.CE)("div",{key:o},[(0,t.Lk)("label",i,"Score Item "+(0,l.v_)(o+1)+" Label:",1),(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":e=>c.scoreItemLabels[o]=e},null,8,n),[[a.Jo,c.scoreItemLabels[o]]])])))),128)),o[11]||(o[11]=(0,t.Lk)("h3",null,"Choice Groups:",-1)),(0,t.Lk)("button",{onClick:o[2]||(o[2]=(...e)=>u.addChoiceGroup&&u.addChoiceGroup(...e))},"Add Group"),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(c.surveyData.choiceGroups,((e,s)=>((0,t.uX)(),(0,t.CE)("div",{key:s,class:"choice-group"},[(0,t.Lk)("table",null,[(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[o[6]||(o[6]=(0,t.Lk)("td",null,[(0,t.Lk)("label",{for:"groupName"},"Group Name:")],-1)),(0,t.Lk)("td",null,[(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":o=>e.groupName=o},null,8,d),[[a.Jo,e.groupName]])]),(0,t.Lk)("td",null,[(0,t.Lk)("button",{onClick:e=>u.moveGroupUp(s),disabled:0===s},"Up",8,h),(0,t.Lk)("button",{onClick:e=>u.moveGroupDown(s),disabled:s===c.surveyData.choiceGroups.length-1},"Down",8,p),(0,t.Lk)("button",{onClick:e=>u.removeChoiceGroup(s)},"Remove",8,v)])])])]),o[9]||(o[9]=(0,t.Lk)("h4",null,"Choices:",-1)),(0,t.Lk)("button",{onClick:e=>u.addChoice(s)},"Add Choice",8,y),(0,t.Lk)("button",{onClick:e=>u.addTextareaChoice(s)},"Add Text Area",8,m),((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.choices,((r,c)=>((0,t.uX)(),(0,t.CE)("div",{key:c},[(0,t.Lk)("table",null,[(0,t.Lk)("tbody",null,[(0,t.Lk)("tr",null,[o[8]||(o[8]=(0,t.Lk)("td",null,[(0,t.Lk)("label",{for:"choiceText"},"Choice Text:")],-1)),(0,t.Lk)("td",null,[(0,t.bo)((0,t.Lk)("input",{type:"text","onUpdate:modelValue":e=>r.choiceText=e},null,8,k),[[a.Jo,r.choiceText]])]),(0,t.Lk)("td",null,[(0,t.Lk)("button",{onClick:e=>u.moveChoiceUp(s,c),disabled:0===c},"Up",8,b),(0,t.Lk)("button",{onClick:e=>u.moveChoiceDown(s,c),disabled:c===e.choices.length-1},"Down",8,L),(0,t.Lk)("button",{onClick:e=>u.removeChoice(s,c)},"Remove",8,C)]),(0,t.Lk)("td",null,[o[7]||(o[7]=(0,t.Lk)("label",{for:"isRequested"},"*:",-1)),(0,t.bo)((0,t.Lk)("input",{type:"checkbox","onUpdate:modelValue":e=>r.isRequested=e},null,8,g),[[a.lH,r.isRequested]])])])])])])))),128))])))),128)),(0,t.Lk)("button",{onClick:o[3]||(o[3]=(...e)=>u.saveSurveyConfig&&u.saveSurveyConfig(...e))},"Save Survey"),(0,t.bF)(f,{surveyData:c.surveyData,scoreItemLabels:c.scoreItemLabels,surveyResults:c.surveyResults,onSaveResult:u.saveSurveyResult},null,8,["surveyData","scoreItemLabels","surveyResults","onSaveResult"]),(0,t.Lk)("pre",null,(0,l.v_)(c.surveyResults),1)])}s(44114);var x=s(42043),D={data(){return{surveyData:{surveyName:"",scoreConfig:0,choiceGroups:[]},surveyResults:[],scoreItemLabels:[]}},watch:{"surveyData.scoreConfig":function(e){this.scoreItemLabels=Array.from({length:e},(()=>""))}},components:{SurveyResult:x.A},methods:{addChoiceGroup(){this.surveyData.choiceGroups.push({groupName:"",choices:[]})},addChoice(e){this.surveyData.choiceGroups[e].choices.push({choiceText:"",type:"radio",choiceValue:null,isRequested:!1})},addTextareaChoice(e){this.surveyData.choiceGroups[e].choices.push({choiceText:"",type:"textarea",choiceValue:null,isRequested:!1})},removeChoiceGroup(e){this.surveyData.choiceGroups.splice(e,1)},removeChoice(e,o){this.surveyData.choiceGroups[e].choices.splice(o,1)},moveGroupUp(e){if(e>0){const o=this.surveyData.choiceGroups[e];this.surveyData.choiceGroups.splice(e,1),this.surveyData.choiceGroups.splice(e-1,0,o)}},moveGroupDown(e){if(e<this.surveyData.choiceGroups.length-1){const o=this.surveyData.choiceGroups[e];this.surveyData.choiceGroups.splice(e,1),this.surveyData.choiceGroups.splice(e+1,0,o)}},moveChoiceUp(e,o){if(o>0){const s=this.surveyData.choiceGroups[e].choices[o];this.surveyData.choiceGroups[e].choices.splice(o,1),this.surveyData.choiceGroups[e].choices.splice(o-1,0,s)}},moveChoiceDown(e,o){if(o<this.surveyData.choiceGroups[e].choices.length-1){const s=this.surveyData.choiceGroups[e].choices[o];this.surveyData.choiceGroups[e].choices.splice(o,1),this.surveyData.choiceGroups[e].choices.splice(o+1,0,s)}},saveSurveyConfig(){console.log(this.surveyData)},saveSurveyResult(e){this.surveyResults=e,console.log("Survey Result Saved:",e)}}},G=s(64621);const E=(0,G.A)(D,[["render",f],["__scopeId","data-v-7872f518"]]);var V=E,S=s(40475),R={name:"Lesson Survey",components:{Edit:V},data(){return{login:S.A.get("session","login")}},methods:{},setup(){const e=(0,u.lq)(),o=e.meta.title;(0,c.K7)(o)}};const T=(0,G.A)(R,[["render",r]]);var X=T}}]);
//# sourceMappingURL=103.460cb9c7.js.map