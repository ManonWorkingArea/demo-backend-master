"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[1533],{36876:function(e,t,i){i.r(t),i.d(t,{default:function(){return me}});var o=i(20641);function s(e,t,i,s,n,l){const a=(0,o.g2)("Institution",!0);return this.login?((0,o.uX)(),(0,o.Wv)(a,{key:0})):(0,o.Q3)("",!0)}var n=i(52968),l=i(75220),a=(i(44114),i(90033)),r=i(53751);const c={class:"bg-white rounded-lg shadow-sm border border-gray-200"},d={class:"px-4 py-3 border-b border-gray-200"},u={class:"flex items-center justify-between"},g={class:"flex items-center space-x-3"},p={class:"w-8 h-8 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center"},m={class:"text-xs text-gray-500"},f={class:"bg-gray-50 border-b border-gray-200 px-4 py-2"},b={class:"p-4"},h={key:0,class:"text-center py-8"},y={class:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3"},k={key:1,class:"space-y-3"},x={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3"},v={class:"h-32 bg-gray-100 relative overflow-hidden"},w={class:"p-4 relative"},L={class:"absolute -top-8 left-4"},F={class:"w-16 h-16 bg-white rounded-lg border-2 border-white shadow-lg overflow-hidden"},I=["src"],C={class:"pt-10"},T={class:"flex items-start justify-between mb-2"},O={class:"flex-1"},_={class:"text-base font-semibold text-gray-900 mb-1"},j={class:"text-xs text-gray-500 mb-1"},R={class:"text-sm text-gray-600 line-clamp-2"},B=["title"],M={class:"flex items-center justify-end pt-3 border-t border-gray-100 space-x-1"},D=["onClick"],W=["onClick"],E={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},X={class:"flex min-h-full items-center justify-center p-4"},P={class:"relative bg-white rounded-xl shadow-xl max-w-lg w-full"},A={class:"h-32 bg-gray-100 relative overflow-hidden rounded-t-xl"},J={class:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity duration-300"},S={class:"absolute top-20 left-6"},U={class:"w-16 h-16 bg-white rounded-lg border-2 border-white shadow-lg overflow-hidden relative group"},$=["src"],Q={class:"absolute inset-0 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-black bg-opacity-50"},N={class:"p-5 pt-12"},V={class:"flex items-center justify-between mb-4"},z={class:"flex items-center space-x-2"},K={class:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center"},q={class:"space-y-3"},G={class:"flex items-center space-x-2"},H={class:"flex justify-end space-x-2 mt-5"},Y={key:0,class:"fixed inset-0 z-50 overflow-y-auto"},Z={class:"flex min-h-full items-center justify-center p-4"},ee={class:"relative bg-white rounded-xl shadow-xl max-w-md w-full p-5"},te={class:"flex items-center justify-between mb-4"},ie={class:"flex items-center space-x-2"},oe={class:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center"},se={class:"flex justify-end space-x-2"};function ne(e,t,i,s,n,l){const ne=(0,o.g2)("FileBrowser"),le=(0,o.g2)("font-awesome-icon");return(0,o.uX)(),(0,o.CE)(o.FK,null,[n.FileBannerOpen?((0,o.uX)(),(0,o.Wv)(ne,{key:0,isWindowsOpen:!0,callbackFunction:"banner",allowFileType:["jpg","gif","png","jpeg"],onFileBrowserTrigger:l.changeFileTrigger,onFileBrowserCallback:l.selectFileTrigger},null,8,["onFileBrowserTrigger","onFileBrowserCallback"])):(0,o.Q3)("",!0),n.FileLogoOpen?((0,o.uX)(),(0,o.Wv)(ne,{key:1,isWindowsOpen:!0,callbackFunction:"logo",allowFileType:["jpg","gif","png","jpeg"],onFileBrowserTrigger:l.changeFileTriggerLogo,onFileBrowserCallback:l.selectFileTriggerLogo},null,8,["onFileBrowserTrigger","onFileBrowserCallback"])):(0,o.Q3)("",!0),(0,o.Lk)("div",c,[(0,o.Lk)("div",d,[(0,o.Lk)("div",u,[(0,o.Lk)("div",g,[(0,o.Lk)("div",p,[(0,o.bF)(le,{icon:["fas","university"],class:"text-white text-sm"})]),(0,o.Lk)("div",null,[t[19]||(t[19]=(0,o.Lk)("h2",{class:"text-base font-semibold text-gray-900"},"สถาบัน",-1)),(0,o.Lk)("p",m,(0,a.v_)(l.getMainInstitutions.length)+" สถาบัน",1)])]),(0,o.Lk)("button",{onClick:t[0]||(t[0]=e=>l.addInstitution("main")),type:"button",class:"inline-flex items-center rounded-lg bg-purple-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-200"},[(0,o.bF)(le,{icon:["fas","plus"],class:"mr-1.5"}),t[20]||(t[20]=(0,o.eW)(" เพิ่มสถาบัน "))])])]),(0,o.Lk)("div",f,[(0,o.Lk)("button",{onClick:t[1]||(t[1]=t=>e.$router.push("/lesson/home")),type:"button",class:"inline-flex items-center text-sm text-gray-600 hover:text-gray-900 transition-colors duration-200"},[(0,o.bF)(le,{icon:["fas","chevron-left"],class:"mr-1.5 text-xs"}),t[21]||(t[21]=(0,o.eW)(" ย้อนกลับ "))])]),(0,o.Lk)("div",b,[0===l.getMainInstitutions.length?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.Lk)("div",y,[(0,o.bF)(le,{icon:["fas","university"],class:"text-gray-400 text-lg"})]),t[23]||(t[23]=(0,o.Lk)("h3",{class:"text-base font-medium text-gray-900 mb-2"},"ยังไม่มีสถาบัน",-1)),t[24]||(t[24]=(0,o.Lk)("p",{class:"text-sm text-gray-500 mb-4"},"เริ่มต้นสร้างสถาบันสำหรับจัดการหลักสูตร",-1)),(0,o.Lk)("button",{onClick:t[2]||(t[2]=e=>l.addInstitution("main")),type:"button",class:"inline-flex items-center rounded-lg bg-purple-600 px-3 py-2 text-sm font-medium text-white shadow-sm hover:bg-purple-700 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:ring-offset-2 transition-all duration-200"},[(0,o.bF)(le,{icon:["fas","plus"],class:"mr-1.5"}),t[22]||(t[22]=(0,o.eW)(" สร้างสถาบันแรก "))])])):((0,o.uX)(),(0,o.CE)("div",k,[(0,o.Lk)("div",x,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.flattenedInstitutions,(e=>((0,o.uX)(),(0,o.CE)(o.FK,null,["main"===e.type?((0,o.uX)(),(0,o.CE)("div",{key:e._id,class:"bg-white border border-gray-200 rounded-lg hover:shadow-md transition-all duration-200 group overflow-hidden"},[(0,o.Lk)("div",v,[(0,o.Lk)("div",{class:"w-full h-full bg-cover bg-center",style:(0,a.Tr)({backgroundImage:e.banner?`url(${e.banner})`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"})},null,4),t[25]||(t[25]=(0,o.Lk)("div",{class:"absolute inset-0 bg-black bg-opacity-20"},null,-1))]),(0,o.Lk)("div",w,[(0,o.Lk)("div",L,[(0,o.Lk)("div",F,[(0,o.Lk)("img",{src:e.logo||"https://dummyimage.com/400x400/dbdbdb/6e6e6e.jpg&text=++LOGO++",alt:"Logo",class:"w-full h-full object-cover"},null,8,I)])]),(0,o.Lk)("div",C,[(0,o.Lk)("div",T,[(0,o.Lk)("div",O,[(0,o.Lk)("h3",_,(0,a.v_)(l.getMainInstitutionIndex(e))+". "+(0,a.v_)(e.name),1),(0,o.Lk)("p",j,(0,a.v_)(e.code),1),(0,o.Lk)("p",R,(0,a.v_)(e.description),1)]),e.color?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"w-4 h-4 rounded-full border border-gray-200 flex-shrink-0 ml-2",style:(0,a.Tr)({backgroundColor:e.color}),title:`สีสถาบัน: ${e.color}`},null,12,B)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",M,[(0,o.Lk)("button",{onClick:t=>l.openRenameDialog(e),class:"inline-flex items-center px-2 py-1 text-xs text-gray-600 hover:text-purple-600 hover:bg-purple-50 rounded transition-all duration-200"},[(0,o.bF)(le,{icon:["fas","edit"],class:"mr-1 text-xs"}),t[26]||(t[26]=(0,o.eW)(" แก้ไข "))],8,D),(0,o.Lk)("button",{onClick:t=>l.removeMainCategoryConfirmation(e),class:"inline-flex items-center px-2 py-1 text-xs text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-all duration-200"},[(0,o.bF)(le,{icon:["fas","trash"],class:"mr-1 text-xs"}),t[27]||(t[27]=(0,o.eW)(" ลบ "))],8,W)])])])])):(0,o.Q3)("",!0)],64)))),256))])]))])]),(0,o.bF)(r.eB,{"enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active","enter-from-class":"modal-enter-from","leave-to-class":"modal-leave-to"},{default:(0,o.k6)((()=>[n.showRenameDialog?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.Lk)("div",X,[(0,o.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-25 transition-opacity",onClick:t[3]||(t[3]=(...e)=>l.closeRenameDialog&&l.closeRenameDialog(...e))}),(0,o.Lk)("div",P,[(0,o.Lk)("div",A,[(0,o.Lk)("div",{class:"w-full h-full bg-cover bg-center",style:(0,a.Tr)({backgroundImage:n.selectedInstitution?.banner?`url(${n.selectedInstitution.banner})`:"linear-gradient(135deg, #667eea 0%, #764ba2 100%)"})},null,4),t[29]||(t[29]=(0,o.Lk)("div",{class:"absolute inset-0 bg-black bg-opacity-20"},null,-1)),(0,o.Lk)("div",J,[(0,o.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>l.OpenFileBrowser&&l.OpenFileBrowser(...e)),class:"bg-black bg-opacity-75 text-white text-xs px-3 py-2 rounded-lg hover:bg-opacity-90 transition-all duration-200"},[(0,o.bF)(le,{icon:["fas","image"],class:"mr-1.5"}),t[28]||(t[28]=(0,o.eW)(" เปลี่ยนรูปปก "))])])]),(0,o.Lk)("div",S,[(0,o.Lk)("div",U,[(0,o.Lk)("img",{src:n.selectedInstitution?.logo||"https://dummyimage.com/400x400/dbdbdb/6e6e6e.jpg&text=++LOGO++",alt:"Logo",class:"w-full h-full object-cover"},null,8,$),(0,o.Lk)("div",Q,[(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>l.OpenFileBrowserLogo&&l.OpenFileBrowserLogo(...e)),class:"text-white text-xs"},[(0,o.bF)(le,{icon:["fas","image"]})])])])]),(0,o.Lk)("div",N,[(0,o.Lk)("div",V,[(0,o.Lk)("div",z,[(0,o.Lk)("div",K,[(0,o.bF)(le,{icon:["fas","edit"],class:"text-purple-600 text-sm"})]),t[30]||(t[30]=(0,o.Lk)("div",null,[(0,o.Lk)("h3",{class:"text-base font-semibold text-gray-900"},"แก้ไขข้อมูลสถาบัน"),(0,o.Lk)("p",{class:"text-xs text-gray-500"},"จัดการข้อมูลและการตั้งค่า")],-1))]),(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>l.closeRenameDialog&&l.closeRenameDialog(...e)),class:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded transition-all duration-200"},[(0,o.bF)(le,{icon:["fas","times"],class:"text-sm"})])]),(0,o.Lk)("div",q,[(0,o.Lk)("div",null,[t[31]||(t[31]=(0,o.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ชื่อสถาบัน",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[7]||(t[7]=e=>n.selectedInstitution.name=e),type:"text",class:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 text-sm",placeholder:"ระบุชื่อสถาบัน"},null,512),[[r.Jo,n.selectedInstitution.name]])]),(0,o.Lk)("div",null,[t[32]||(t[32]=(0,o.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"รหัสสถาบัน",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>n.selectedInstitution.code=e),type:"text",class:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 text-sm",placeholder:"ระบุรหัสสถาบัน"},null,512),[[r.Jo,n.selectedInstitution.code]])]),(0,o.Lk)("div",null,[t[33]||(t[33]=(0,o.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"รายละเอียด",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[9]||(t[9]=e=>n.selectedInstitution.description=e),rows:"2",class:"w-full px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 resize-none text-sm",placeholder:"ระบุรายละเอียดสถาบัน"},null,512),[[r.Jo,n.selectedInstitution.description]])]),(0,o.Lk)("div",null,[t[34]||(t[34]=(0,o.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"สีประจำสถาบัน",-1)),(0,o.Lk)("div",G,[(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[10]||(t[10]=e=>n.selectedInstitution.color=e),type:"color",class:"w-12 h-8 border border-gray-200 rounded cursor-pointer"},null,512),[[r.Jo,n.selectedInstitution.color]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[11]||(t[11]=e=>n.selectedInstitution.color=e),type:"text",class:"flex-1 px-3 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition-all duration-200 text-sm",placeholder:"#000000"},null,512),[[r.Jo,n.selectedInstitution.color]])])]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>n.selectedInstitution.logo=e),type:"hidden"},null,512),[[r.Jo,n.selectedInstitution.logo]]),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[13]||(t[13]=e=>n.selectedInstitution.banner=e),type:"hidden"},null,512),[[r.Jo,n.selectedInstitution.banner]])]),(0,o.Lk)("div",H,[(0,o.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>l.closeRenameDialog&&l.closeRenameDialog(...e)),class:"px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all duration-200"}," ยกเลิก "),(0,o.Lk)("button",{onClick:t[15]||(t[15]=e=>l.renameInstitution(n.selectedInstitution)),class:"px-3 py-2 text-xs font-medium text-white bg-purple-600 hover:bg-purple-700 rounded-lg transition-all duration-200"},[(0,o.bF)(le,{icon:["fas","save"],class:"mr-1"}),t[35]||(t[35]=(0,o.eW)(" บันทึก "))])])])])])])):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(r.eB,{"enter-active-class":"modal-enter-active","leave-active-class":"modal-leave-active","enter-from-class":"modal-enter-from","leave-to-class":"modal-leave-to"},{default:(0,o.k6)((()=>[n.showConfirmationPopup?((0,o.uX)(),(0,o.CE)("div",Y,[(0,o.Lk)("div",Z,[(0,o.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-25 transition-opacity",onClick:t[16]||(t[16]=(...e)=>l.cancelRemoveMainCategory&&l.cancelRemoveMainCategory(...e))}),(0,o.Lk)("div",ee,[(0,o.Lk)("div",te,[(0,o.Lk)("div",ie,[(0,o.Lk)("div",oe,[(0,o.bF)(le,{icon:["fas","exclamation-triangle"],class:"text-red-600 text-sm"})]),t[36]||(t[36]=(0,o.Lk)("div",null,[(0,o.Lk)("h3",{class:"text-base font-semibold text-gray-900"},"ยืนยันการลบ"),(0,o.Lk)("p",{class:"text-xs text-gray-500"},"สถาบัน")],-1))])]),t[37]||(t[37]=(0,o.Lk)("div",{class:"mb-4"},[(0,o.Lk)("p",{class:"text-sm text-gray-600"},"คุณแน่ใจหรือไม่ที่จะลบสถาบันนี้? การดำเนินการนี้ไม่สามารถยกเลิกได้")],-1)),(0,o.Lk)("div",se,[(0,o.Lk)("button",{onClick:t[17]||(t[17]=(...e)=>l.cancelRemoveMainCategory&&l.cancelRemoveMainCategory(...e)),class:"px-3 py-2 text-xs font-medium text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all duration-200"}," ยกเลิก "),(0,o.Lk)("button",{onClick:t[18]||(t[18]=(...e)=>l.removeMainInstitution&&l.removeMainInstitution(...e)),class:"px-3 py-2 text-xs font-medium text-white bg-red-600 hover:bg-red-700 rounded-lg transition-all duration-200"}," ลบ ")])])])])):(0,o.Q3)("",!0)])),_:1})],64)}i(98992),i(54520),i(81454),i(8872);var le=i(40475),ae=i(40687),re={name:"InstitutionList",data(){return{session:le.A.get("session"),configs:le.A.get("configs"),institutions:[],uniqueIdCounter:5,showRenameDialog:!1,selectedInstitution:null,showMoveDialog:!1,selectedInstitutionParent:null,FileBannerOpen:!1,FileLogoOpen:!1,showConfirmationPopup:!1,categoryToRemove:null}},components:{FileBrowser:ae.A},computed:{flattenedInstitutions(){return this.flattenInstitutions(this.institutions)},getMainInstitutions(){return this.institutions.filter((e=>"main"===e.type))}},async mounted(){try{await this.getInstitutionData()}catch(e){console.log(Error)}},methods:{OpenFileBrowser(){this.FileBannerOpen=!0},changeFileTrigger(e){this.FileBannerOpen=e},selectFileTrigger(e){console.log("selectFileTrigger"),void 0!=e&&(console.log("selectFileReturnFunction",e.file),this.updateBanner(e.file))},async updateBanner(e){try{const t=this.selectedInstitution,i={...t,banner:e};delete i._id;const o=await fetch(`https://gateway.cloudrestfulapi.com/api/institution/${t._id}`,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:i,options:{}})});o.ok&&(this.selectedInstitution.banner=e,this.$swal({toast:!0,position:"bottom-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"แก้ไขรูปหน้าปก",text:"แก้ไขรูปหน้าปก สำเร็จแล้ว"}))}catch(t){console.log(t)}},OpenFileBrowserLogo(){this.FileLogoOpen=!0},changeFileTriggerLogo(e){this.FileLogoOpen=e},selectFileTriggerLogo(e){console.log("selectFileTrigger"),void 0!=e&&(console.log("selectFileReturnFunction",e.file),this.updateLogo(e.file))},async updateLogo(e){try{const t=this.selectedInstitution,i={...t,logo:e};delete i._id;const o=await fetch(`https://gateway.cloudrestfulapi.com/api/institution/${t._id}`,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:i,options:{}})});o.ok&&(this.selectedInstitution.logo=e,this.$swal({toast:!0,position:"bottom-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"แก้ไขรูปหน้าปก",text:"แก้ไขรูปหน้าปก สำเร็จแล้ว"}))}catch(t){console.log(t)}},async getInstitutionData(){const e=await fetch("https://gateway.cloudrestfulapi.com/api/institution/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({method:"find",args:[{$and:[{unit:this.session.current._id}]}],paging:{page:1,limit:200}})});if(e.ok){const t=await e.json();console.log("finalRes",t),this.institutions=t.data.map((e=>({...e,color:e.color||"#000000"})))}},async addInstitution(e,t){try{const i={unit:this.session.current._id,name:"New Institution",code:"institution-code",description:"Description for New Institution",type:"main",order:0};"sub"===e&&(i.type="sub",i.parent=t._id);const o=await fetch("https://gateway.cloudrestfulapi.com/api/institution/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:i,options:{}})});if(o.ok){await this.getInstitutionData();const e=await o.json();console.log("finalRes",e)}}catch(i){console.error(i)}},async updateInstitution(e){const t=await fetch("https://gateway.cloudrestfulapi.com/api/institution/"+e._id,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{name:e.name,code:e.code,description:e.description,order:e.order,color:e.color},options:{}})});if(t.ok){await this.getInstitutionData();const e=await t.json();console.log("finalRes",e)}},async deleteInstitution(e){const t=await fetch("https://gateway.cloudrestfulapi.com/api/institution/"+e._id,{method:"DELETE",headers:{"Content-Type":"application/json","client-token-key":this.configs.key}});if(t.ok){await this.getInstitutionData();const e=await t.json();console.log("finalRes",e)}},getMainInstitutionIndex(e){const t=this.flattenedInstitutions.filter((e=>"main"===e.type));return t.findIndex((t=>t._id===e._id))+1},flattenInstitutions(e){return e.reduce(((e,t)=>(e.push(t),e)),[])},moveMainInstitutionUp(e){const t=this.institutions.findIndex((t=>t._id===e._id&&"main"===t.type));if(t>0){const e=this.institutions.splice(t,1)[0];this.institutions.splice(t-1,0,e)}},moveMainInstitutionDown(e){const t=this.institutions.findIndex((t=>t._id===e._id&&"main"===t.type));if(t<this.institutions.length-1){const e=this.institutions.splice(t,1)[0];this.institutions.splice(t+1,0,e)}},async removeMainCategoryConfirmation(e){this.categoryToRemove=e,this.showConfirmationPopup=!0},async removeMainInstitution(){try{const e=this.categoryToRemove,t=this.institutions.findIndex((t=>t._id===e._id&&"main"===t.type));-1!==t&&(this.institutions.splice(t,1),await this.deleteInstitution(e)),this.categoryToRemove=null,this.showConfirmationPopup=!1}catch(e){console.error(e)}},cancelRemoveMainCategory(){this.categoryToRemove=null,this.showConfirmationPopup=!1},openRenameDialog(e){this.selectedInstitution=e,this.showRenameDialog=!0},closeRenameDialog(){this.showRenameDialog=!1,this.selectedInstitution=null},async renameInstitution(e){try{const t=e.name.trim(),i=e.code.trim(),o=e.description.trim(),s=e.color.trim();""!==t&&(e.name=t),""!==i&&(e.code=i),""!==o&&(e.description=o),""!==s&&(e.color=s),await this.updateInstitution(e),this.closeRenameDialog()}catch(t){console.error(t)}},openMoveDialog(e){this.selectedInstitution=e,this.selectedInstitutionParent=e.parent,this.showMoveDialog=!0},closeMoveDialog(){this.showMoveDialog=!1,this.selectedInstitution=null,this.selectedInstitutionParent=null},updateSelectedInstitutionParent(){this.selectedInstitution.parent=this.selectedInstitutionParent,this.closeMoveDialog()}}},ce=i(64621);const de=(0,ce.A)(re,[["render",ne],["__scopeId","data-v-cfc27a68"]]);var ue=de,ge={name:"Lesson Edit",components:{Institution:ue},data(){return{login:le.A.get("session","login")}},methods:{},setup(){const e=(0,l.lq)(),t=e.meta.title;(0,n.K7)(t)}};const pe=(0,ce.A)(ge,[["render",s]]);var me=pe},40687:function(e,t,i){i.d(t,{A:function(){return b}});var o=i(20641),s=i(50953),n=i(90033),l=i(94232),a=i(10797),r=i(55372);const c={key:0,class:"fixed inset-0 overflow-y-auto"},d={class:"flex min-h-full items-center justify-center p-4 text-center"},u={class:"font-medium"},g={class:"bg-black w-8 h-8 right-2 top-2 leading-8 hover:bg-gray-500"},p={props:["isWindowsOpen","allowFileType","callbackFunction"],data(){return console.log("FileBrowser props:",this.isWindowsOpen,this.allowFileType,this.callbackFunction),{SessionList:[],loading_sources:!0,activeBlock:!1,schoolId:"",isOpen:this.isWindowsOpen,isAllow:this.allowFileType,isCallback:this.callbackFunction,mode:"popup"}},components:{FileManager:r.A},watch:{isWindowsOpen(e){console.log("isWindowsOpen changed to:",e),this.isOpen=e}},methods:{selectFileTrigger(e){this.selectFileTrigger=e,this.closeModal(),this.selectFile(e)},closeModal(){this.isOpen=!1,this.$emit("fileBrowserTrigger",!1)},selectFile(e){this.$emit("fileBrowserCallback",e)}},async mounted(){console.log("FileBrowser mounted with isOpen:",this.isOpen,"isWindowsOpen:",this.isWindowsOpen)},setup(){}};var m=Object.assign(p,{__name:"FileBrowser",setup(e){return(t,i)=>{const p=(0,o.g2)("font-awesome-icon");return(0,o.uX)(),(0,o.Wv)((0,s.R1)(l.O),{appear:"",show:t.isOpen,as:"template"},{default:(0,o.k6)((()=>[(0,o.bF)((0,s.R1)(a.lG),{as:"div",onClose:t.closeModal,class:"relative z-10"},{default:(0,o.k6)((()=>[(0,o.bF)((0,s.R1)(l._),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:(0,o.k6)((()=>i[1]||(i[1]=[(0,o.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)]))),_:1}),t.loading_sources?((0,o.uX)(),(0,o.CE)("div",c,[(0,o.Lk)("div",d,[(0,o.bF)((0,s.R1)(l._),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:(0,o.k6)((()=>[(0,o.bF)((0,s.R1)(a.Lj),{class:(0,n.C4)(["w-[60rem] z-40 transform overflow-hidden bg-white p-3 text-left align-middle shadow-xl transition-all blocking relative",[t.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},{default:(0,o.k6)((()=>[(0,o.bF)((0,s.R1)(a.L3),{as:"h3",class:"text-lg pb-2 font-bold leading-6 text-gray-900 border-b"},{default:(0,o.k6)((()=>[i[3]||(i[3]=(0,o.eW)("เลือกไฟล์ (Select File) ")),(0,o.Lk)("p",u,[i[2]||(i[2]=(0,o.eW)("อนุญาติเฉพาะไฟล์ ")),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.allowFileType,(e=>((0,o.uX)(),(0,o.CE)("span",{key:e.code,class:"text-xs font-medium bg-indigo-600 pl-2 pr-2 pt-1 mr-1 rounded text-white"},(0,n.v_)(e),1)))),128))]),(0,o.Lk)("button",{onClick:i[0]||(i[0]=(...e)=>t.closeModal&&t.closeModal(...e)),type:"button",class:"z-50 absolute top-2 right-2"},[(0,o.Lk)("div",g,[(0,o.bF)(p,{icon:["fas","times"],class:"text-white mt-[7px] font-sm"})])])])),_:1}),(0,o.Lk)("div",null,[(0,o.bF)(r.A,{onSelectFileTrigger:t.selectFileTrigger,Mode:t.mode,AllowFile:t.isAllow,CallbackFunc:t.isCallback},null,8,["onSelectFileTrigger","Mode","AllowFile","CallbackFunc"])])])),_:1},8,["class"])])),_:1})])])):(0,o.Q3)("",!0)])),_:1},8,["onClose"])])),_:1},8,["show"])}}});const f=m;var b=f}}]);
//# sourceMappingURL=1533.461f74e7.js.map