"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[1553],{60463:function(e,t,s){s.r(t),s.d(t,{default:function(){return D}});var o=s(20641);function i(e,t,s,i,n,a){return(0,o.uX)(),(0,o.Wv)((0,o.$y)(a.componentName))}var n=s(52968),a=s(75220),l=s(40475),r=s(90033),c=s(53751);const u={class:"bg-gray-50"},d={class:"flex min-h-full flex-col justify-center py-12 sm:px-6 lg:px-8"},m={class:"sm:mx-auto sm:w-full sm:max-w-lg"},g=["src"],f={class:"mt-2 text-center text-sm text-gray-600"},h={class:"bg-white px-4 py-8 shadow sm:rounded-lg sm:px-10"},b={class:"relative mt-2"},p={key:0,class:"col-span-2"},k={class:"items-center px-3 py-1 rounded-md bg-red-100 text-sm text-black pb-5 mb-5"},v={class:"w-full"},x=["disabled"];function y(e,t,s,i,n,a){const l=(0,o.g2)("router-link"),y=(0,o.g2)("font-awesome-icon");return(0,o.uX)(),(0,o.CE)("div",u,[(0,o.Lk)("div",d,[(0,o.Lk)("div",m,[this.showModal?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("img",{key:0,class:"mx-auto h-16 w-auto",src:this.config.siteLogo,alt:"Your Company"},null,8,g)),t[4]||(t[4]=(0,o.Lk)("h2",{class:"mt-6 text-center text-2xl font-bold tracking-tight text-gray-900"},"ลืมรหัสผ่าน",-1)),(0,o.Lk)("p",f,[t[3]||(t[3]=(0,o.eW)(" หรือ ")),(0,o.bF)(l,{to:"/user/register",class:"font-medium text-indigo-600 hover:text-indigo-500"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)(" ลงทะเบียนสมาชิกใหม่ ")]))),_:1})])]),(0,o.Lk)("div",{class:(0,r.C4)(["mt-8 sm:mx-auto sm:w-full sm:max-w-md relative",[e.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},[(0,o.Lk)("div",h,[(0,o.Lk)("form",{class:"space-y-6",onSubmit:t[1]||(t[1]=(0,c.D$)(((...e)=>a.resetPassword&&a.resetPassword(...e)),["prevent"]))},[(0,o.Lk)("div",null,[(0,o.Lk)("div",b,[t[5]||(t[5]=(0,o.Lk)("span",{class:"input-label"},[(0,o.eW)("อีเมล์ที่ลงทะเบียน "),(0,o.Lk)("small",{class:"text-red-400"},"(*จำเป็นต้องกรอก)")],-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>n.email=e),type:"text",placeholder:"อีเมล์ที่ลงทะเบียน",class:"w-full p-4 border border-gray-200 text-sm"},null,512),[[c.Jo,n.email]])])]),t[8]||(t[8]=(0,o.Lk)("div",null,[(0,o.Lk)("strong",null,"*หมายเหตุ*"),(0,o.Lk)("br"),(0,o.eW)(' กรอกเลขที่บัตรประชาชนที่ลงทะเบียนไว้ในระบบ หลังจากคลิ๊ก "ตั้งค่ารหัสผ่าน" เรียบร้อยแล้ว ระบบจะทำการสร้างรหัสผ่านเป็นเบอร์โทรที่ลงทะเบียนไว้ในระบบ หากจำเบอร์โทรไม่ได้ กรุณาแจ้งทีมงานที่ @doacer ')],-1)),(0,o.Lk)("div",null,[n.errorStage?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.Lk)("div",k,[t[6]||(t[6]=(0,o.Lk)("div",{class:"font-semibold pt-3 pb-3"},"เกิดข้อผิดพลาด",-1)),(0,o.Lk)("div",v,(0,r.v_)(n.errorMessage),1)])])):(0,o.Q3)("",!0),(0,o.Lk)("button",{type:"submit",disabled:e.buttonDisabled,class:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-4 text-md font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[(0,o.bF)(y,{icon:["fas","refresh"],class:"mr-2"}),(0,o.eW)(" "+(0,r.v_)(n.buttonText),1)],8,x),(0,o.bF)(l,{to:"/user/login",class:"flex w-full justify-center rounded-md bg-gray-300 text-md font-semibold text-gray-700 shadow-sm hover:bg-gray-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600 mt-4 py-2"},{default:(0,o.k6)((()=>t[7]||(t[7]=[(0,o.eW)(" ย้อนกลับ ")]))),_:1})])],32)])],2)])])}s(44114);var w=s(25747),L={name:"Login",components:{},props:{showModal:{type:Boolean,default:!1}},data(){return{config:l.A.get("configs"),email:"",errorStage:!1,errorMessage:"",buttonText:"ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่"}},methods:{async resetPassword(){try{if(!this.email)return this.errorStage=!0,this.errorMessage="โปรดกรอกอีเมล์",void(this.activeBlock=!1);this.activeBlock=!0,this.errorStage=!1,this.buttonText="กำลังดำเนินการ...";const e=await fetch("https://gateway.cloudrestfulapi.com/api/user/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.config.key},body:JSON.stringify({method:"find",args:[{$and:[{email:this.email}]}]})}),t=await e.json();console.log(t);const s=t.length>0?t[0]:null;if(!t||0===t.length)return this.errorStage=!0,this.errorMessage="ไม่พบอีเมล์นี้ในระบบ กรุณาตรวจสอบหรือติดต่อทีมงาน",this.activeBlock=!1,this.buttonText="ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่",void(this.buttonDisabled=!1);{const e={email:s.email,name:s.firstname+""+s.lastname};await(0,w.Z)(e,"reset-password"),this.$swal({icon:"success",title:"การรีเซ็ตรหัสผ่านใหม่เรียบร้อยแล้ว",text:"ระบบได้ทำการรีเซ็ตและจัดส่งรหัสผ่านใหม่ให้ทางอีเมล์แล้ว กรุณาตรวจสอบอีเมล์และเข้าสู่ระบบด้วยวรหัสผ่านใหม่ เมื่อเข้าสู่ระบบครั้งแรก กรุณาเปลี่ยนรหัสผ่านใหม่อีกครั้งเพื่อความปลอดภัย",showCancelButton:!1,confirmButtonText:"ตกลง"}).then((()=>{this.$router.push("/user/login")}))}this.activeBlock=!1}catch(e){console.log(e),this.buttonText="ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่",this.buttonDisabled=!1}}}},C=s(64621);const S=(0,C.A)(L,[["render",y],["__scopeId","data-v-786aebbe"]]);var B=S,T=s(31359),_=s(86539),A={name:"userLoginLoader",components:{},data(){return{session:l.A.get("session"),configs:l.A.get("configs")}},setup(){const e=(0,a.lq)(),t=e.meta.title;(0,n.K7)(t)},computed:{componentName(){return this.configs&&this.configs.layout&&this.configs.layout.userLogin?"DOA"===this.configs.layout.userLogin?T["default"]:"SACRED"===this.configs.layout.userLogin?_["default"]:B:B}}};const W=(0,C.A)(A,[["render",i]]);var D=W}}]);
//# sourceMappingURL=1553.55791369.js.map