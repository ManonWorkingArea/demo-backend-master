"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[2415],{22415:function(e,t,s){s.d(t,{A:function(){return St}});var o=s(20641),a=s(90033);const l={key:0,class:"text-center"},r={key:1,class:"fixed inset-0 flex items-center justify-center z-50"},i={class:"bg-white rounded shadow-lg w-full md:w-3/5 relative"},n={class:"bg-blue-500 text-white px-4 py-2 rounded-t flex justify-between"},c={class:"text-lg font-semibold"},d={class:"p-4 overflow-y-auto max-h-[95vh]"},u={class:"bg-gray-100"},m={key:0,class:"mx-auto max-w-2xl px-4 pt-3 pb-3 sm:px-18 sm:pt-3 sm:pb-3 lg:grid lg:max-w-7xl lg:grid-cols-2 lg:gap-x-4"},p={class:"lg:flex lg:items-center lg:justify-between"},f={class:"min-w-0 flex-1"},y={class:"flex","aria-label":"Breadcrumb"},h={role:"list",class:"flex items-center space-x-4"},g={key:0},x={class:"flex items-center"},b={key:1},v={class:"flex items-center"},k={class:"flex items-center"},w={class:"ml-4 text-sm font-bold text-gray-600 hover:text-gray-700"},L={key:1,class:"mx-auto max-w-2xl px-4 pt-3 pb-3 sm:px-18 sm:pt-3 sm:pb-3 lg:grid lg:max-w-7xl lg:grid-cols-2 lg:gap-x-4"},C={class:"lg:flex lg:items-center lg:justify-between"},D={class:"bg-white border-t border-gray-200"},T={key:0,class:"mx-auto max-w-2xl px-4 pb-12 pt-8 sm:px-6 sm:pb-12 sm:pt-6 lg:grid lg:max-w-7xl lg:grid-cols-2 lg:gap-x-8 lg:px-8"},E={class:"mt-5 lg:col-span-2"},I={class:"text-3xl font-bold tracking-tight text-gray-900 sm:text-4xl"},_={class:"mt-5"},F={"aria-labelledby":"information-heading",class:"mt-4 mb-4"},S={class:"flex items-center"},X=["innerHTML"],A={class:"mt-4 space-y-6"},O=["innerHTML"],P=["innerHTML"],M={class:"mt-6 flex items-center"},V={"aria-labelledby":"options-heading"},j={class:""},U={class:"mt-1 grid grid-cols-3 gap-1 sm:grid-cols-3"},N={class:"relative block rounded-lg border border-gray-300 p-2 focus:outline-none"},W={class:"flex items-center mb-1"},$={class:"text-xl text-gray-500 mr-2"},Q={class:"text-sm text-gray-500"},R={class:"flex items-center mb-1"},H={class:"text-xl text-gray-500 mr-2"},K={class:"flex items-center mb-1"},q={class:"text-xl text-gray-500 mr-2"},B={class:"mt-4"},J={href:"#",class:"group inline-flex text-sm text-gray-500 hover:text-gray-700"},z={key:0},G={class:"mt-5"},Y={type:"button",class:"flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50"},Z={class:"flex items-center"},ee={class:"text-left font-semibold"},te={class:"text-sm text-gray-100 font-normal"},se={class:"font-semibold"},oe={key:0,readonly:!0,style:{opacity:"0.3"},type:"button",class:"flex w-full mt-5 items-center justify-center rounded-md border border-transparent bg-yellow-400 px-4 py-3 text-base font-medium text-black hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50"},ae={class:"text-left font-semibold"},le={class:"text-sm text-gray-500 font-normal"},re={class:"text-left font-semibold"},ie={class:"text-sm text-gray-500 font-normal"},ne=["disabled"],ce={class:"flex items-center"},de={class:"text-left font-semibold"},ue={class:"text-sm text-gray-500 font-normal"},me=["readonly"],pe={class:"text-left font-semibold"},fe={class:"text-sm text-gray-500 font-normal"},ye=["disabled"],he={class:"flex items-center"},ge={class:"text-left font-semibold"},xe={class:"text-sm text-gray-500 font-normal"},be={key:3,class:""},ve={key:0},ke={type:"button",class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-600 px-8 py-3 text-base font-medium text-white hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50"},we={key:1},Le={class:"mt-6 text-center"},Ce={href:"javascript:void(0);",class:"group inline-flex text-base font-medium"},De={class:"mt-10"},Te={class:"lg:col-start-2 lg:row-span-2 lg:mt-0 lg:self-center"},Ee={class:"mt-16"},Ie=["src"],_e={class:"mx-auto max-w-7xl sm:px-3 lg:px-4 pb-10"},Fe=["innerHTML"],Se=["innerHTML"],Xe={class:"bg-gray-100 py-6"},Ae={key:0,class:"mx-auto max-w-7xl sm:px-3 lg:px-4"},Oe={class:"overflow-hidden bg-white shadow sm:rounded-md"},Pe={key:1,class:"mx-auto max-w-7xl sm:px-3 lg:px-4"},Me={class:"mx-auto max-w-2xl px-2 py-3 sm:px-3 sm:py-3 lg:max-w-7xl lg:px-4"},Ve={"aria-labelledby":"details-heading"},je={class:"flex flex-col items-center text-center"};function Ue(e,t,s,Ue,Ne,We){const $e=(0,o.g2)("Loader"),Qe=(0,o.g2)("templete"),Re=(0,o.g2)("SurveyResult"),He=(0,o.g2)("router-link"),Ke=(0,o.g2)("font-awesome-icon"),qe=(0,o.g2)("CertOwnerSelector"),Be=(0,o.g2)("LoginPopup"),Je=(0,o.g2)("Playlist"),ze=(0,o.g2)("Form");return(0,o.uX)(),(0,o.CE)(o.FK,null,[this.lesson&&"onsite"!==this.lesson.type?((0,o.uX)(),(0,o.Wv)(Qe,{key:0},{default:(0,o.k6)((()=>[Ne.playerDataStatus?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",l,[(0,o.bF)($e)]))])),_:1})):(0,o.Q3)("",!0),Ne.isModalOpen?((0,o.uX)(),(0,o.CE)("div",r,[t[7]||(t[7]=(0,o.Lk)("div",{class:"bg-black opacity-50 fixed inset-0"},null,-1)),(0,o.Lk)("div",i,[(0,o.Lk)("div",n,[(0,o.Lk)("h2",c,(0,a.v_)(Ne.surveyData.name),1),(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>We.closeModal&&We.closeModal(...e)),class:"text-white hover:text-red-500 transition"},t[6]||(t[6]=[(0,o.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(0,o.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),(0,o.Lk)("div",d,[(0,o.bF)(Re,{surveyData:Ne.surveyData,scoreItemLabels:Ne.scoreItemLabels,surveyResults:Ne.surveyResults,onSaveResult:We.saveSurveyResult},null,8,["surveyData","scoreItemLabels","surveyResults","onSaveResult"])])])])):(0,o.Q3)("",!0),(0,o.Lk)("div",u,["desktop"===this.deviceType?((0,o.uX)(),(0,o.CE)("div",m,[(0,o.Lk)("div",p,[(0,o.Lk)("div",f,[(0,o.Lk)("nav",y,[(0,o.Lk)("ol",h,[(0,o.Lk)("li",null,[(0,o.Lk)("div",null,[(0,o.bF)(He,{to:"/",class:"text-gray-400 hover:text-gray-500"},{default:(0,o.k6)((()=>t[8]||(t[8]=[(0,o.Lk)("svg",{class:"h-5 w-5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[(0,o.Lk)("path",{"fill-rule":"evenodd",d:"M9.293 2.293a1 1 0 011.414 0l7 7A1 1 0 0117 11h-1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-3a1 1 0 00-1-1H9a1 1 0 00-1 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-6H3a1 1 0 01-.707-1.707l7-7z","clip-rule":"evenodd"})],-1),(0,o.Lk)("span",{class:"sr-only"},"Home",-1)]))),_:1})])]),this.lesson.standalone?((0,o.uX)(),(0,o.CE)("li",g,[(0,o.Lk)("div",x,[t[10]||(t[10]=(0,o.Lk)("svg",{class:"h-5 w-5 flex-shrink-0 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true"},[(0,o.Lk)("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})],-1)),(0,o.bF)(He,{to:"/user/profile",class:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700"},{default:(0,o.k6)((()=>t[9]||(t[9]=[(0,o.eW)("หน้าหลัก")]))),_:1})])])):((0,o.uX)(),(0,o.CE)("li",b,[(0,o.Lk)("div",v,[t[12]||(t[12]=(0,o.Lk)("svg",{class:"h-5 w-5 flex-shrink-0 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true"},[(0,o.Lk)("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})],-1)),(0,o.bF)(He,{to:"bypass"===Ne.session.mode?"/user/employee":"/lesson/home",class:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700"},{default:(0,o.k6)((()=>t[11]||(t[11]=[(0,o.eW)("หลักสูตร")]))),_:1},8,["to"])])])),(0,o.Lk)("li",null,[(0,o.Lk)("div",k,[t[13]||(t[13]=(0,o.Lk)("svg",{class:"h-5 w-5 flex-shrink-0 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true"},[(0,o.Lk)("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})],-1)),(0,o.Lk)("span",w,(0,a.v_)(this.lesson.name),1)])])])])])])])):(0,o.Q3)("",!0),"mobile"===this.deviceType?((0,o.uX)(),(0,o.CE)("div",L,[(0,o.Lk)("div",C,[this.lesson.standalone?((0,o.uX)(),(0,o.Wv)(He,{key:0,to:"/user/profile",class:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700"},{default:(0,o.k6)((()=>[(0,o.bF)(Ke,{icon:["fas","chevron-left"]}),t[14]||(t[14]=(0,o.eW)(" ย้อนกลับ"))])),_:1})):((0,o.uX)(),(0,o.Wv)(He,{key:1,to:"/lesson/home",class:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700"},{default:(0,o.k6)((()=>[(0,o.bF)(Ke,{icon:["fas","chevron-left"]}),t[15]||(t[15]=(0,o.eW)(" ย้อนกลับ"))])),_:1}))])])):(0,o.Q3)("",!0),(0,o.Lk)("div",D,[Ne.playerDataStatus?((0,o.uX)(),(0,o.CE)("div",T,[(0,o.Lk)("div",E,[(0,o.Lk)("h1",I,(0,a.v_)(this.lesson.name),1)]),(0,o.Lk)("div",_,[(0,o.Lk)("section",F,[t[17]||(t[17]=(0,o.Lk)("h2",{id:"information-heading",class:"sr-only"},"Product information",-1)),(0,o.Lk)("div",S,[(0,o.Lk)("p",{class:"text-lg text-gray-900 sm:text-xl",innerHTML:We.formatPrice(this.lesson.regular_price,this.lesson.sale_price)},null,8,X)]),(0,o.Lk)("div",A,[this.lesson.short_description?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"text-base text-gray-500",innerHTML:this.lesson.short_description},null,8,O)):((0,o.uX)(),(0,o.CE)("div",{key:1,class:"text-base text-gray-500",innerHTML:this.lesson.description},null,8,P))]),(0,o.Lk)("div",M,[(0,o.bF)(Ke,{class:"h-5 w-5 flex-shrink-0 text-green-500",icon:["fas","check"]}),t[16]||(t[16]=(0,o.Lk)("p",{class:"ml-2 text-sm text-gray-500"},"This course includes:",-1))])]),(0,o.Lk)("section",V,[(0,o.Lk)("div",j,[(0,o.Lk)("div",U,[(0,o.Lk)("div",N,[(0,o.Lk)("div",W,[(0,o.Lk)("span",$,[(0,o.bF)(Ke,{icon:["fas","book"]})]),t[18]||(t[18]=(0,o.Lk)("p",{class:"text-sm font-semibold text-gray-900"},"เนื้อหาอัดแน่น",-1))]),(0,o.Lk)("p",Q,(0,a.v_)(this.players.length)+" บท / "+(0,a.v_)(this.lesson.hours)+" ชม. เต็ม",1),t[19]||(t[19]=(0,o.Lk)("div",{class:"pointer-events-none absolute -inset-px rounded-lg border-2","aria-hidden":"true"},null,-1))]),(0,o.Lk)("div",{class:(0,a.C4)([{"opacity-30":!We.checkExam("post")},"relative block rounded-lg border border-gray-300 p-2 focus:outline-none"])},[(0,o.Lk)("div",R,[(0,o.Lk)("span",H,[(0,o.bF)(Ke,{icon:["fas","check-square"]})]),t[20]||(t[20]=(0,o.Lk)("p",{class:"text-sm font-semibold text-gray-900"},"ประเมินผลการเรียน",-1))]),t[21]||(t[21]=(0,o.Lk)("p",{class:"text-sm text-gray-500"},"วัดผลการเรียน",-1)),t[22]||(t[22]=(0,o.Lk)("div",{class:"pointer-events-none absolute -inset-px rounded-lg border-2","aria-hidden":"true"},null,-1))],2),(0,o.Lk)("div",{class:(0,a.C4)([{"opacity-30":"no"===this.lesson.certification},"relative block rounded-lg border border-gray-300 p-2 focus:outline-none"])},[(0,o.Lk)("div",K,[(0,o.Lk)("span",q,[(0,o.bF)(Ke,{icon:["fas","certificate"]})]),t[23]||(t[23]=(0,o.Lk)("p",{class:"text-sm font-semibold text-gray-900"},"ใบประกาศ",-1))]),t[24]||(t[24]=(0,o.Lk)("p",{class:"text-sm text-gray-500"},"รับใบประกาศเมื่อสอบผ่านเกณฑ์",-1)),t[25]||(t[25]=(0,o.Lk)("div",{class:"pointer-events-none absolute -inset-px rounded-lg border-2","aria-hidden":"true"},null,-1))],2)])]),(0,o.Lk)("div",B,[(0,o.Lk)("a",J,[t[26]||(t[26]=(0,o.Lk)("span",null,"วิธีการลงทะเบียน ?",-1)),(0,o.bF)(Ke,{class:"ml-2 h-4 w-4 flex-shrink-0 text-gray-400 group-hover:text-gray-500",icon:["fas","question-circle"]})])]),"onsite"!=this.lesson.type?((0,o.uX)(),(0,o.CE)("div",z,[(0,o.Lk)("div",G,[this.login?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[We.loggedInComputed.enrollAccess(this.dataItem)&&e.groupedPlayers?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("button",Y,[(0,o.Lk)("span",Z,[(0,o.bF)(Ke,{icon:["fas","graduation-cap"],class:"mr-5 w-6 h-6"})]),(0,o.Lk)("span",ee,[t[28]||(t[28]=(0,o.eW)("ลงทะเบียนแล้ว")),t[29]||(t[29]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("p",te,[t[27]||(t[27]=(0,o.eW)("ความคืบหน้า ")),(0,o.Lk)("span",se,(0,a.v_)(e.groupedPlayers.analytics.percent)+" % ",1),(0,o.eW)("("+(0,a.v_)(e.groupedPlayers.analytics.message)+")",1)])])]),this.lesson.scoreDate&&We.checkDueDate(this.lesson.scoreDate)?((0,o.uX)(),(0,o.CE)("button",oe,[(0,o.bF)(Ke,{icon:["fas","certificate"],class:"mr-5 w-6 h-6"}),(0,o.Lk)("span",ae,[t[30]||(t[30]=(0,o.eW)("ใบรับรอง (e-Certification)")),t[31]||(t[31]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("p",le,"ประกาศผลสอบ "+(0,a.v_)(We.formatThaidate(this.lesson.scoreDate)),1)])])):((0,o.uX)(),(0,o.CE)("div",{key:1,class:(0,a.C4)({"cert-panel":Ne.lesson&&Ne.lesson.cert_owner_corperate,"mt-3":!(Ne.lesson&&Ne.lesson.cert_owner_corperate)})},[Ne.enrollData?.analytics?.retest&&Ne.enrollData?.analytics?.retest?.score>=Ne.enrollData?.analytics?.retest?.measure?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[1]||(t[1]=e=>We.assignCertification()),type:"button",class:"flex w-full items-center justify-center rounded-md border border-transparent bg-yellow-400 px-4 py-3 text-base font-medium text-black hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50"},[(0,o.bF)(Ke,{icon:["fas","certificate"],class:"mr-5 w-6 h-6"}),(0,o.Lk)("span",re,[t[32]||(t[32]=(0,o.eW)("ใบรับรอง (e-Certification)")),t[33]||(t[33]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("p",ie,(0,a.v_)(this.certification?"เปิด":"สร้าง")+" ใบรับรองของคุณ",1)])])):Ne.enrollData?.analytics?.retest?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[e.groupedPlayers.analytics.certification.status?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:0,type:"button",class:(0,a.C4)([{"opacity-50":!0,"cursor-not-allowed":!0},"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-200 px-4 py-2 text-base font-medium text-black hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50"]),disabled:e.groupedPlayers.analytics.percent<100},[(0,o.Lk)("span",ce,[(0,o.bF)(Ke,{icon:["fas","certificate"],class:"mr-5 w-6 h-6"})]),(0,o.Lk)("span",de,[t[34]||(t[34]=(0,o.eW)("ใบรับรอง (e-Certification)")),t[35]||(t[35]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("p",ue,(0,a.v_)(e.groupedPlayers.analytics.certification.message),1)])],8,ne))],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[e.groupedPlayers.analytics.certification.status?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[2]||(t[2]=e=>We.assignCertification()),readonly:e.groupedPlayers.analytics.percent<100,style:(0,a.Tr)({opacity:e.groupedPlayers.analytics.percent<100?"0.3":"1"}),type:"button",class:(0,a.C4)({"flex w-full items-center justify-center border border-transparent bg-yellow-400 px-4 py-3 text-base font-medium text-black hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50":!0,"rounded-md":!(this.certification&&Ne.lesson.cert_owner_corperate),"rounded-t-md":this.certification&&Ne.lesson.cert_owner_corperate})},[(0,o.bF)(Ke,{icon:["fas","certificate"],class:"mr-5 w-6 h-6"}),(0,o.Lk)("span",pe,[t[36]||(t[36]=(0,o.eW)(" ใบรับรอง (e-Certification) ")),t[37]||(t[37]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("p",fe,(0,a.v_)(this.certification?"เปิด":"สร้าง")+" ใบรับรองของคุณ",1)])],14,me)):(0,o.Q3)("",!0),e.groupedPlayers.analytics.certification.status?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,type:"button",class:(0,a.C4)([{"opacity-50":!0,"cursor-not-allowed":!0},"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-200 px-4 py-2 text-base font-medium text-black hover:bg-yellow-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50"]),disabled:e.groupedPlayers.analytics.percent<100},[(0,o.Lk)("span",he,[(0,o.bF)(Ke,{icon:["fas","certificate"],class:"mr-5 w-6 h-6"})]),(0,o.Lk)("span",ge,[t[38]||(t[38]=(0,o.eW)("ใบรับรอง (e-Certification)")),t[39]||(t[39]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("p",xe,(0,a.v_)(e.groupedPlayers.analytics.certification.message),1)])],8,ye))],64)),Ne.lesson&&Ne.lesson.cert_owner_corperate?((0,o.uX)(),(0,o.CE)("div",be,[Ne.certification?((0,o.uX)(),(0,o.Wv)(qe,{key:0,certOwnerType:Ne.certOwnerType,"onUpdate:certOwnerType":t[3]||(t[3]=e=>Ne.certOwnerType=e),certification:Ne.certification,onEdit:e.handleEdit},null,8,["certOwnerType","certification","onEdit"])):(0,o.Q3)("",!0)])):(0,o.Q3)("",!0)],2))],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[this.lesson.visibility?((0,o.uX)(),(0,o.CE)("span",we,[this.lesson.sale_price>0&&!this.lesson.standalone?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:t[4]||(t[4]=e=>We.orderCourse()),type:"button",class:"flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50"},[(0,o.bF)(Ke,{class:"ml-2 mr-2 h-4 w-4 flex-shrink-0 text-white group-hover:text-gray-500",icon:["fas","shopping-cart"]}),t[41]||(t[41]=(0,o.eW)(" สั่งซื้อ "))])):(0,o.Q3)("",!0),this.lesson.standalone?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("button",{key:1,onClick:t[5]||(t[5]=e=>We.enrollCourse(this.lesson._id)),type:"button",class:"flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2 focus:ring-offset-gray-50"},[(0,o.bF)(Ke,{class:"ml-2 mr-2 h-4 w-4 flex-shrink-0 text-white group-hover:text-gray-500",icon:["fas","play"]}),(0,o.eW)(" "+(0,a.v_)("bypass"===Ne.session.mode?"เริ่มเรียนหลักสูตรนี้":"ลงทะเบียนหลักสูตรนี้"),1)]))])):((0,o.uX)(),(0,o.CE)("span",ve,[(0,o.Lk)("button",ke,[(0,o.bF)(Ke,{class:"ml-2 mr-2 h-4 w-4 flex-shrink-0 text-white group-hover:text-gray-500",icon:["fas","lock"]}),t[40]||(t[40]=(0,o.eW)(" หลักสูตรนี้เปิดลงทะเบียนแบบ Private เท่านั้น "))])]))],64))],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[this.lesson.standalone?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.Wv)(Be,{key:0,onLoginSuccess:We.handleLoginSuccess},null,8,["onLoginSuccess"]))],64))]),(0,o.Lk)("div",Le,[(0,o.Lk)("a",Ce,[(0,o.bF)(Ke,{class:"mr-2 h-6 w-6 flex-shrink-0 text-gray-400 group-hover:text-gray-500",icon:["fas","laptop"]}),t[42]||(t[42]=(0,o.Lk)("span",{class:"text-gray-500 hover:text-gray-700"},"เรียนออนไลน์ ได้ทุกที่ ทุกเวลาตลอด 24 ชั่วโมง",-1))])])])):(0,o.Q3)("",!0)])]),(0,o.Lk)("div",De,[(0,o.Lk)("div",Te,[(0,o.Lk)("figure",Ee,[(0,o.Lk)("img",{class:"aspect-video rounded-xl bg-gray-50 object-cover",src:Ne.lesson.cover||Ne.defaultCoverUrl,alt:""},null,8,Ie)])])])])):(0,o.Q3)("",!0),(0,o.Lk)("div",_e,[(0,o.Lk)("div",null,[t[43]||(t[43]=(0,o.Lk)("h3",{class:"text-lg font-bold text-blue-600"},"คำอธิบายรายวิชา",-1)),this.lesson.description?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"text-md text-gray-500",innerHTML:this.lesson.description},null,8,Fe)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",null,[t[44]||(t[44]=(0,o.Lk)("h3",{class:"text-lg font-bold text-blue-600"},"วัตถุประสงค์",-1)),this.lesson.objective?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"text-md text-gray-500",innerHTML:this.lesson.objective},null,8,Se)):(0,o.Q3)("",!0)])])]),(0,o.Lk)("div",Xe,["onsite"!=this.lesson.type?((0,o.uX)(),(0,o.CE)("div",Ae,[t[45]||(t[45]=(0,o.Fv)('<div class="mx-auto max-w-2xl px-2 py-3 sm:px-3 sm:py-3 lg:max-w-7xl lg:px-4" data-v-56d4dffb><section aria-labelledby="details-heading" data-v-56d4dffb><div class="flex flex-col items-center text-center" data-v-56d4dffb><h2 id="details-heading" class="text-2xl font-bold tracking-tight text-gray-900 sm:text-2xl" data-v-56d4dffb>รายละเอียดเนื้อหา</h2><p class="mt-3 max-w-3xl text-lg text-gray-600" data-v-56d4dffb>รายละเอียดเนื้อหาของหลักสูตรนี้ คุณต้องทำการเข้าเรียนตามลำดับแต่ละบทเรียน</p></div></section></div>',1)),(0,o.Lk)("div",Oe,[(0,o.bF)(Je,{dataItem:this.dataItem,courseData:this.lesson,playerItem:null,playOption:this.playOption,onDataFetched:We.handleDataFromChild,debug:!1},null,8,["dataItem","courseData","playOption","onDataFetched"])])])):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[this.login?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[Ne.userSubmit?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.eW)((0,a.v_)(Ne.onsite)+" ",1),t[46]||(t[46]=(0,o.Fv)('<div class="mx-auto max-w-7xl sm:px-3 lg:px-4" data-v-56d4dffb><div class="mx-auto max-w-2xl px-2 py-3 sm:px-3 sm:py-3 lg:max-w-7xl lg:px-4" data-v-56d4dffb><section aria-labelledby="details-heading" data-v-56d4dffb><div class="flex flex-col items-center text-center" data-v-56d4dffb><h2 id="details-heading" class="text-2xl font-bold tracking-tight text-gray-900 sm:text-2xl" data-v-56d4dffb>แบบฟอร์มการลงทะเบียน</h2><p class="mt-3 max-w-3xl text-lg text-gray-600" data-v-56d4dffb>คุณได้ทำการลงทะเบียนหลักสูตรนี้เรียบร้อยแล้ว ทีมงานจะทำการตรวจสอบข้อมูลและจะแจ้งการดำเนินการในขั้นตอนต่อไป</p></div></section></div></div>',1))],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[t[47]||(t[47]=(0,o.Fv)('<div class="mx-auto max-w-7xl sm:px-3 lg:px-4" data-v-56d4dffb><div class="mx-auto max-w-2xl px-2 py-3 sm:px-3 sm:py-3 lg:max-w-7xl lg:px-4" data-v-56d4dffb><section aria-labelledby="details-heading" data-v-56d4dffb><div class="flex flex-col items-center text-center" data-v-56d4dffb><h2 id="details-heading" class="text-2xl font-bold tracking-tight text-gray-900 sm:text-2xl" data-v-56d4dffb>แบบฟอร์มการลงทะเบียน</h2><p class="mt-3 max-w-3xl text-lg text-gray-600" data-v-56d4dffb>แบบฟอร์มสำหรับลงทะเบียนหลักสูตรนี้</p></div></section></div></div>',1)),Ne.loadedForm?((0,o.uX)(),(0,o.Wv)(ze,{key:0,dataItem:this.onsiteForm,masterItem:this.lesson._id,mode:"id"},null,8,["dataItem","masterItem"])):(0,o.Q3)("",!0)],64))],64)):((0,o.uX)(),(0,o.CE)("div",Pe,[(0,o.Lk)("div",Me,[(0,o.Lk)("section",Ve,[(0,o.Lk)("div",je,[t[48]||(t[48]=(0,o.Lk)("h2",{id:"details-heading",class:"text-2xl font-bold tracking-tight text-gray-900 sm:text-2xl"},"แบบฟอร์มการลงทะเบียน",-1)),t[49]||(t[49]=(0,o.Lk)("p",{class:"mt-3 max-w-3xl text-lg text-gray-600"},"หากคุณต้องการลงทะเบียนหลักสูตรนี้ ต้องเข้าสู่ระบบหรือสมัครสมาชิกใหม่ก่อนลงทะเบียน",-1)),(0,o.bF)(Be,{onLoginSuccess:We.handleLoginSuccess},null,8,["onLoginSuccess"])])])])]))],64))])])],64)}s(44114),s(98992),s(54520),s(72577),s(37550);var Ne=s(40475),We=s(9964),$e=s(6138),Qe=s(57313),Re=s(21810),He=s(43263),Ke=s(75435),qe=s(42043),Be=s(53751);const Je={class:"flex flex-col w-full space-y-2"},ze={class:"flex flex-col md:flex-row items-start md:items-center justify-between bg-gray-100 border border-gray-300 border-t rounded-b-md rounded-t-none p-3 w-full"},Ge={class:"flex flex-col space-y-4 md:space-y-0 md:flex-row md:space-x-6 w-full md:w-auto"},Ye={class:"flex items-center space-x-2 w-full md:w-auto"},Ze={class:"inline-flex items-center w-full md:w-auto"},et={class:"flex items-center space-x-2 w-full md:w-auto"},tt={class:"inline-flex items-center w-full md:w-auto"};function st(e,t,s,a,l,r){const i=(0,o.g2)("font-awesome-icon"),n=(0,o.g2)("CustomModal");return(0,o.uX)(),(0,o.CE)("div",null,[(0,o.Lk)("div",Je,[(0,o.Lk)("div",ze,[t[8]||(t[8]=(0,o.Lk)("div",{class:"text-gray-700 font-bold w-full md:w-auto mb-4 md:mb-0 text-sm"}," ออกใบรับรองในนาม ",-1)),(0,o.Lk)("div",Ge,[(0,o.Lk)("div",Ye,[(0,o.Lk)("label",Ze,[(0,o.bo)((0,o.Lk)("input",{type:"radio",name:"cert_owner",value:"personal","onUpdate:modelValue":t[0]||(t[0]=e=>l.localCertOwnerType=e),onChange:t[1]||(t[1]=(...e)=>r.updateCertOwnerType&&r.updateCertOwnerType(...e))},null,544),[[Be.XL,l.localCertOwnerType]]),t[5]||(t[5]=(0,o.Lk)("span",{class:"ml-2 text-gray-600 text-sm"},"บุคคลธรรมดา",-1))])]),(0,o.Lk)("div",et,[(0,o.Lk)("label",tt,[(0,o.bo)((0,o.Lk)("input",{type:"radio",name:"cert_owner",value:"corporate","onUpdate:modelValue":t[2]||(t[2]=e=>l.localCertOwnerType=e),onChange:t[3]||(t[3]=(...e)=>r.updateCertOwnerType&&r.updateCertOwnerType(...e))},null,544),[[Be.XL,l.localCertOwnerType]]),t[6]||(t[6]=(0,o.Lk)("span",{class:"ml-2 text-gray-600 text-sm"},"นิติบุคคล",-1))]),(0,o.Lk)("button",{class:"text-gray-500 hover:text-gray-700 flex-shrink-0 text-[13px]",onClick:t[4]||(t[4]=e=>r.openModal("corporate"))},[(0,o.bF)(i,{icon:"pencil-alt",class:"text-[10px]"}),t[7]||(t[7]=(0,o.eW)(" แก้ไขข้อมูลนิติบุคคล "))])])])]),t[9]||(t[9]=(0,o.Lk)("p",{class:"text-gray-500 text-sm w-full"}," ** หลักสูตรนี้สามารถแก้ไขข้อมูลของผู้รับใบรับรองได้ระหว่าง ชื่อผู้อบรมหรือชื่อนิติบุคคล ",-1))]),(0,o.bF)(n,{showModal:l.isModalVisible,type:l.modalType,data:s.certification.owner_data,onClose:r.closeModal,onSave:r.handleSave},null,8,["showModal","type","data","onClose","onSave"])])}const ot={key:0,class:"fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50"},at={class:"bg-white rounded-md shadow-lg p-6 w-full max-w-lg"},lt={class:"flex justify-between items-center border-b pb-4"},rt={class:"text-lg font-bold"},it={class:"mt-4"},nt={key:0,class:"text-red-500 text-sm mb-4"},ct={key:1,class:"flex flex-wrap md:flex-nowrap"},dt={class:"w-full md:w-1/5 pr-4 mb-4"},ut={class:"w-full md:w-2/5 pr-4 mb-4"},mt={class:"w-full md:w-2/5 mb-4"},pt={key:2},ft={class:"flex justify-end mt-4"},yt=["disabled"];function ht(e,t,s,l,r,i){const n=(0,o.g2)("font-awesome-icon");return s.showModal?((0,o.uX)(),(0,o.CE)("div",ot,[(0,o.Lk)("div",at,[(0,o.Lk)("div",lt,[(0,o.Lk)("h3",rt,(0,a.v_)(i.modalTitle),1),(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.closeModal&&i.closeModal(...e)),class:"text-gray-500 hover:text-gray-700"},[(0,o.bF)(n,{icon:"times"})])]),(0,o.Lk)("div",it,["corporate"===s.type?((0,o.uX)(),(0,o.CE)("p",nt," แก้ไขข้อมูลบริษัทได้ครั้งเดียวเท่านั้น กรุณาตรวจสอบให้ถูกต้องก่อนบันทึกข้อมูล ")):(0,o.Q3)("",!0),"personal"===s.type?((0,o.uX)(),(0,o.CE)("div",ct,[(0,o.Lk)("div",dt,[t[8]||(t[8]=(0,o.Lk)("label",{class:"block mb-2"},"คำนำหน้า",-1)),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>r.formData.prefix=e),class:"p-2 border rounded w-full"},t[7]||(t[7]=[(0,o.Lk)("option",{value:"mr"},"นาย",-1),(0,o.Lk)("option",{value:"mrs"},"นาง",-1),(0,o.Lk)("option",{value:"ms"},"นางสาว",-1)]),512),[[Be.u1,r.formData.prefix]])]),(0,o.Lk)("div",ut,[t[9]||(t[9]=(0,o.Lk)("label",{class:"block mb-2"},"ชื่อ",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>r.formData.firstName=e),class:"p-2 border rounded w-full"},null,512),[[Be.Jo,r.formData.firstName]])]),(0,o.Lk)("div",mt,[t[10]||(t[10]=(0,o.Lk)("label",{class:"block mb-2"},"นามสกุล",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[3]||(t[3]=e=>r.formData.lastName=e),class:"p-2 border rounded w-full"},null,512),[[Be.Jo,r.formData.lastName]])])])):"corporate"===s.type?((0,o.uX)(),(0,o.CE)("div",pt,[t[11]||(t[11]=(0,o.Lk)("label",{class:"block mb-2"},"ชื่อบริษัท",-1)),(0,o.bo)((0,o.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>r.formData.corpName=e),class:"mb-4 p-2 border rounded w-full"},null,512),[[Be.Jo,r.formData.corpName]]),t[12]||(t[12]=(0,o.Lk)("label",{class:"block mb-2"},"ที่อยู่",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[5]||(t[5]=e=>r.formData.address=e),class:"p-2 border rounded w-full",rows:"4"},null,512),[[Be.Jo,r.formData.address]])])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",ft,[(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>i.save&&i.save(...e)),class:"bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600",disabled:!r.isInitialEmpty&&""!==r.formData.corpName,style:(0,a.Tr)({opacity:r.isInitialEmpty||""===r.formData.corpName?1:.5})}," บันทึก ",12,yt)])])])):(0,o.Q3)("",!0)}var gt={props:{showModal:{type:Boolean,default:!1},data:{type:Object,default:()=>({})},type:{type:String,required:!0}},data(){return{formData:{prefix:"",firstName:"",lastName:"",corpName:"",address:""},isInitialEmpty:!0}},computed:{modalTitle(){return"personal"===this.type?"แก้ไขบุคคลธรรมดา":"แก้ไขข้อมูลนิติบุคคล"}},watch:{data:{immediate:!0,handler(e){this.formData={...this.formData,...e},this.isInitialEmpty=!e.corpName}}},methods:{closeModal(){this.$emit("close")},save(){const e={...this.formData,type:this.type};this.$emit("save",e),this.closeModal()}}},xt=s(64621);const bt=(0,xt.A)(gt,[["render",ht],["__scopeId","data-v-bb2c66ba"]]);var vt=bt,kt=s(40471);const wt=new kt.A(!1);var Lt={components:{CustomModal:vt},props:{certOwnerType:{type:String,required:!0},certification:{type:Object,required:!0}},data(){return{configs:Ne.A.get("configs"),session:Ne.A.get("session"),localCertOwnerType:this.certOwnerType,isModalVisible:!1,modalType:"",enrollData:null}},watch:{certOwnerType(e){this.localCertOwnerType=e}},methods:{async updateCertOwnerType(){this.$emit("update:certOwnerType",this.localCertOwnerType);try{const e=await wt.PUT(`certification/${this.certification._id}`,{data:{owner_type:this.localCertOwnerType}},this.configs.key);console.log("Certification updated:",e)}catch(e){console.error("Error updating certification:",e)}},async handleSave(e){console.log("Saved data:",e);try{const t=await wt.PUT(`certification/${this.certification._id}`,{data:{owner_data:e}},this.configs.key);console.log("Owner information updated:",t),location.reload()}catch(t){console.error("Error updating owner information:",t)}},openModal(e){this.modalType=e,this.isModalVisible=!0},closeModal(){this.isModalVisible=!1}}};const Ct=(0,xt.A)(Lt,[["render",st],["__scopeId","data-v-e993d442"]]);var Dt=Ct,Tt=s(63084);const Et=new kt.A(!1),It=[{name:"pending",label:"รอเรียน",styleClass:"bg-gray-300 text-gray-600",icon:"hourglass-start"},{name:"processing",label:"กำลังเรียน",styleClass:"bg-yellow-300 text-yellow-800",icon:"spinner"},{name:"complete",label:"เรียนจบแล้ว",styleClass:"bg-green-300 text-green-800",icon:"check"}];var _t={name:"Lesson Detail",components:{LoginPopup:$e.A,Playlist:He.A,Loader:Ke.A,SurveyResult:qe.A,CertOwnerSelector:Dt,Form:Re.A},data(){return{defaultCoverUrl:"https://vue-project.sgp1.digitaloceanspaces.com/default-coverjpg.jpg",uniqueVisitors:null,pageViewsPerDay:null,pageViewsPerWeek:null,pageViewsPerMonth:null,login:Ne.A.get("session","login"),configs:Ne.A.get("configs"),session:Ne.A.get("session"),dataItem:this.$route.params.id,enroll:Ne.A.get("session","enroll"),deviceType:Qe.A.deviceDetect(),playOption:"step",certification:null,exam:[],lesson:[],players:[],surveyData:[],surveyResults:[],scoreItemLabels:[],enrollData:[],userSubmit:[],isModalOpen:!1,playerDataStatus:null,onsite:!1,onsiteForm:null,loadedForm:!1,certOwnerType:"personal"}},watch:{"lesson.type"(e){this.onsite="onsite"===e}},methods:{checkDueDate(e){const t=420,s=new Date(e),o=new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes()+t),a=new Date,l=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes()+t);return l<o},async handleDataFromChild(e){Tt.A.slack("*handleDataFromChild*",e.analytics),this.groupedPlayers=e,this.playerDataStatus=!0,this.loggedInComputed.enrollAccess(this.dataItem)&&await this.getEnrollData()},async getEnrollData(){try{const e=await Et.POST("enroll/query",{method:"find",args:[{$and:[{courseID:this.dataItem,userID:this.session.userID}]}]},this.configs.key,!0);if(200!==e.status)throw new Error("Failed to fetch enroll data from API");const t=e.data[0];this.enrollData=t}catch(e){console.error(e)}},stripHtmlTags(e){const t=document.createElement("div");return t.innerHTML=e,t.textContent||t.innerText||""},handleLoginSuccess(){Tt.A.log("Login Success")},getStatus(e){const t=It.find((t=>t.name===e));return t?`<p class="inline-flex rounded-full px-2 text-xs font-semibold leading-5 capitalize ${t.styleClass}">\n        <i class="fa fa-${t.icon} mr-1 mt-1"></i>${t.label}\n        </p>`:""},checkExam(e){return this.exam.some((t=>t.type===e))},formatSeconds(e){return We.A.secondsToTime(e)},formatThaidate(e){return We.A.toThaiDatetime(e)},formatPrice(e,t){return We.A.formatPrice(e,t)},getFilteredExams(e){return this.exam&&this.exam.length?this.exam.filter((t=>t.type===e)):[]},async getData(){try{this.loading_sources=!1;const e=await Et.GET(`course/${this.dataItem}`,this.configs.key,!0);if(200===e.status){this.lesson=e.data,this.playOption=this.lesson.display,"undefined"===typeof this.lesson.visibility&&(this.lesson.visibility=!0),this.playerDataStatus=!this.lesson||"onsite"===this.lesson.type,this.onsite="onsite"===(this.lesson?.type??""),console.log("lesson 4",this.lesson.type),console.log("getCertification");const t=await this.getCertification();if(console.log("getCertification 3"),Array.isArray(t)&&t.length>0?this.certification=t[t.length-1]:this.certification=t,console.log("getCertification 4"),console.log("onsite",this.lesson.type),"onsite"===this.lesson.type)if(console.log("onsite X"),this.lesson.formID)console.log("getSubmitForm"),this.userSubmit=await this.getSubmitForm(),this.onsiteForm=this.lesson.formID,this.loadedForm=!0;else{console.log("onsite Y");const e=await this.getForm();console.log("getSubmitForm"),this.userSubmit=await this.getSubmitForm(),console.log("userSubmit",this.userSubmit),this.onsiteForm=e,this.loadedForm=!0}else console.log("not onsite 2");this.certOwnerType=this.certification.owner_type||"personal",this.$setPageTitle("หลักสูตร "+this.lesson.name)}}catch(e){Tt.A.log(e)}},async getCertification(){try{const e={method:"find",args:[{$and:[{userID:this.session.userID},{courseID:this.lesson._id}]}]},t=await Et.POST("certification/query",e,this.configs.key);if(200!==t.status)throw console.log("getCertification 2"),new Error("Failed to fetch player data from API");return t.data[0]}catch(e){throw console.error("An error occurred while fetching player data:",e),e}},async getForm(){try{const e={method:"find",args:[{$and:[{owner:this.configs.siteID,type:"form",action:"course",default:!0}]}]},t=await Et.POST("post/query",e,this.configs.key);if(200!==t.status)throw new Error("Failed to fetch player data from API");return t.data[0]._id}catch(e){throw console.error("An error occurred while fetching player data:",e),e}},async getSubmitForm(e){try{const t={method:"find",args:[{$and:[{courseID:this.dataItem,userID:this.session.userID,formID:e}]}]};console.log("courseID",this.dataItem),console.log("userID",this.session.userID),console.log("formID",e);const s=await Et.POST("form/query",t,this.configs.key);if(200!==s.status)throw new Error("Failed to fetch player data from API");return s.data[0]}catch(t){throw console.error("An error occurred while fetching player data:",t),t}},async enrollCourse(e){let t=null;if(this.login)try{this.activeBlock=!0;const s=await fetch("https://gateway.cloudrestfulapi.com/api/order/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{userID:this.session.userID,courseID:e,unit:this.configs.siteID},options:{}})}),o=await s.json();if(Tt.A.log("orderRes",o),200===s.status){const s=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{userID:this.session.userID,courseID:e,orderID:o._id,unit:this.configs.siteID},options:{}})});if(t=await s.json(),Tt.A.log("finalRes",t),200===s.status){this.activeBlock=!1;const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({method:"find",hidden:["userID"],args:[{$and:[{userID:this.session.userID}]}]})}),s=await t.json();if(200===t.status){const t={enroll:s};Ne.A.update("session",t),Tt.A.log("session",t);const o=this.groupedPlayers.allItems,a=o.find((e=>"folder"!==e.type));let l="";if(!1===a.canPlay){Tt.A.log("ยังไม่ได้สอบก่อนเรียน"),Tt.A.log(this.getFilteredExams("pre"));const t=this.getFilteredExams("pre");l="/lesson/assessment/"+e+"/"+t[0]._id}else Tt.A.log("ไม่มีแบบทดสอบก่อนเรียน"),l="/lesson/play/"+e+"/"+a._id;this.$swal({icon:"success",title:"ลงทะเบียนหลักสูตรเรียบร้อยแล้ว",text:"ระบบกำลังดึงข้อมูลหลักสูตรของคุณ กรุณารอสักครู่",showCancelButton:!1,confirmButtonText:"OK"}).then((()=>{this.$router.push(l)}))}}}}catch(s){Tt.A.log(s)}},orderCourse(){this.$router.push("/lesson/subscribe/"+this.dataItem)},async saveSurveyResult(e){this.surveyResults=e,Tt.A.log("Survey Result Saved:",e);try{const t=await Et.POST("survey_submission",{data:{userId:this.session.userID,courseId:this.dataItem,surveyId:this.lesson.surveyId,survey:e}},this.configs.key);if(200!==t.status)throw new Error("Failed to fetch enroll data from API");const s=t.data;this.closeModal(),this.assignCertification(),Tt.A.log("submissionReturn",s)}catch(t){console.error("Error while fetching enroll data:",t)}},closeModal(){this.isModalOpen=!1,document.body.style.overflow="auto"},async assignCertification(){if(this.login)try{const e=await Et.POST("survey_submission/query",{method:"find",args:[{$and:[{courseId:this.dataItem,userId:this.session.userID}]}]},this.configs.key);if(200!==e.status)throw new Error("Failed to fetch enroll data from API");const t=e.data;if("yes"===this.lesson.survey&&Array.isArray(t)&&0===t.length){let e=null;if(void 0===this.lesson.surveyId||null===this.lesson.surveyId){const t=await Et.POST("survey/query",{method:"find",args:[{$and:[{unit:this.session.current._id,default:!0}]}]},this.configs.key);if(200!==t.status)throw new Error("Failed to fetch enroll data from API");const s=t.data;this.lesson.surveyId=e,e=s[0]._id}else e=this.lesson.surveyId;const t=await Et.GET(`survey/${e}`,this.configs.key);if(200!==t.status)throw new Error("Failed to fetch course data from API");this.surveyData=t.data,this.scoreItemLabels=this.surveyData.label.slice(),this.isModalOpen=!0,document.body.style.overflow="hidden",Tt.A.log(this.surveyData)}else if(this.certification)window.location.href="/lesson/certification/"+this.certification._id,Tt.A.log("Open Certification",this.certification);else{this.activeBlock=!0;const e=await fetch("https://gateway.cloudrestfulapi.com/api/certification/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{userID:this.session.userID,courseID:this.dataItem,course:this.lesson,user:this.session.user,unit:this.configs.siteID,asset:this.configs.siteName},options:{}})}),t=await e.json();200===e.status&&(this.activeBlock=!1,this.certification=t,this.lesson.cert_owner_corperate||(window.location.href="/lesson/certification/"+this.certification._id,Tt.A.log("Assign Certification Complete")))}}catch(e){Tt.A.log(e)}}},async mounted(){try{await this.getData()}catch(e){Tt.A.log(Error)}},setup(){},computed:{loggedInComputed(){const e=Ne.A.get("session","login"),t=Ne.A.get("session","enroll");return e?{enrollAccess(e){if(!t||0===t.length)return!1;const s=t.find((t=>t.courseID===e));return!!s}}:{enrollAccess(){return!1}}}}};const Ft=(0,xt.A)(_t,[["render",Ue],["__scopeId","data-v-56d4dffb"]]);var St=Ft},42043:function(e,t,s){s.d(t,{A:function(){return A}});var o=s(20641),a=s(90033),l=s(53751);const r={class:"survey-layout p-2 mb-3"},i={class:"flex flex-col"},n={class:"mb-4"},c={class:""},d={key:0,class:"flex border-b border-gray-400 p-1 bg-gray-100"},u={class:"w-2/5 text-md font-semibold"},m={class:"w-3/5 space-y-0"},p={key:0,class:"w-full flex justify-start"},f={class:"flex items-center px-2 text-sm"},y=["onUpdate:modelValue","value"],h=["onUpdate:modelValue"],g={class:"text-md font-semibold p-1 border-b border-gray-400 bg-gray-100"},x={class:"space-y-0"},b={class:"w-full md:w-2/5 flex flex-col justify-start"},v={class:"mb-1 px-2 text-sm"},k={class:"w-full md:w-3/5 mt-2 md:mt-0"},w=["value","onUpdate:modelValue","onChange"],L=["onUpdate:modelValue"],C={class:"mt-2"},D={class:"font-semibold"},T={class:"mt-2 space-x-2 mb-5"},E={key:0,class:"mt-2 p-4 bg-red-200 border border-red-400 rounded"};function I(e,t,s,I,_,F){return(0,o.uX)(),(0,o.CE)("div",r,[(0,o.Lk)("div",i,[(0,o.Lk)("div",n,[(0,o.Lk)("div",null,[t[2]||(t[2]=(0,o.Lk)("span",{class:"font-semibold"},"Name:",-1)),(0,o.eW)(" "+(0,a.v_)(s.surveyData.name),1)]),(0,o.Lk)("div",null,[t[3]||(t[3]=(0,o.Lk)("span",{class:"font-semibold"},"Description:",-1)),(0,o.eW)(" "+(0,a.v_)(s.surveyData.description),1)])]),(0,o.Lk)("div",c,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.surveyData.choiceGroups,((e,t)=>((0,o.uX)(),(0,o.CE)("div",{key:t,class:(0,a.C4)([{"error-class":e.error},"choice-group border border-b-0 border-gray-400 mb-2 rounded-sm"])},["custom"===e.groupType?((0,o.uX)(),(0,o.CE)("div",d,[(0,o.Lk)("h3",u,(0,a.v_)(t+1)+". "+(0,a.v_)(e.groupName),1),(0,o.Lk)("div",m,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.choices,((t,s)=>((0,o.uX)(),(0,o.CE)("div",{key:s,class:"flex items-center"},["radio"===t.type?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.Lk)("label",f,[(0,o.bo)((0,o.Lk)("input",{type:"radio","onUpdate:modelValue":t=>e.selectedChoice=t,value:t.choiceText,class:"mr-2 text-sm"},null,8,y),[[l.XL,e.selectedChoice]]),(0,o.eW)(" "+(0,a.v_)(t.choiceText),1)])])):"textarea"===t.type?(0,o.bo)(((0,o.uX)(),(0,o.CE)("textarea",{key:1,"onUpdate:modelValue":e=>t.choiceValue=e,class:"w-full p-1 h-32 rounded-sm"},null,8,h)),[[l.Jo,t.choiceValue]]):(0,o.Q3)("",!0)])))),128))])])):(0,o.Q3)("",!0),"score"===e.groupType?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[(0,o.Lk)("h3",g,(0,a.v_)(t+1)+". "+(0,a.v_)(e.groupName),1),(0,o.Lk)("div",x,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(e.choices,((r,i)=>((0,o.uX)(),(0,o.CE)("div",{key:i,class:(0,a.C4)([{"error-class":e.error},"flex items-center border-b border-gray-400 p-1 flex-col md:flex-row"])},[(0,o.Lk)("div",b,[(0,o.Lk)("p",v,(0,a.v_)(t+1)+"."+(0,a.v_)(i+1)+". "+(0,a.v_)(r.choiceText),1)]),(0,o.Lk)("div",k,["radio"===r.type?((0,o.uX)(),(0,o.CE)("div",{key:0,class:(0,a.C4)(["grid","gap-0","md:grid-cols-"+s.surveyData.score,"md:grid-rows-1","grid-cols-1","md:grid-cols-"+s.surveyData.score])},[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.surveyData.score,((e,t)=>((0,o.uX)(),(0,o.CE)("label",{key:e,class:"flex items-center px-2 text-sm"},[(0,o.bo)((0,o.Lk)("input",{type:"radio",value:e,"onUpdate:modelValue":e=>r.choiceValue=e,onChange:e=>F.updateCustomScore(r),class:"mr-2 text-sm"},null,40,w),[[l.XL,r.choiceValue]]),(0,o.eW)(" "+(0,a.v_)(s.scoreItemLabels[t]),1)])))),128))],2)):"textarea"===r.type?(0,o.bo)(((0,o.uX)(),(0,o.CE)("textarea",{key:1,"onUpdate:modelValue":e=>r.choiceValue=e,class:"w-full p-1 h-32 rounded-sm"},null,8,L)),[[l.Jo,r.choiceValue]]):(0,o.Q3)("",!0)])],2)))),128))])],64)):(0,o.Q3)("",!0)],2)))),128))])]),(0,o.Lk)("div",C,[(0,o.Lk)("p",D,"Summary Score: "+(0,a.v_)(F.summaryScore),1)]),(0,o.Lk)("div",T,[(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>F.saveResult&&F.saveResult(...e)),class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"},"ส่งข้อมูล"),(0,o.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>F.clearSurvey&&F.clearSurvey(...e)),class:"px-4 py-2 bg-red-500 text-white rounded hover:bg-red-600"},"เคลียร์ข้อมูล")]),_.hasErrors?((0,o.uX)(),(0,o.CE)("div",E,[t[4]||(t[4]=(0,o.Lk)("h3",{class:"font-semibold text-red-700"},"เกิดข้อผิดพลาด (s):",-1)),(0,o.Lk)("ul",null,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(_.errors,((e,t)=>((0,o.uX)(),(0,o.CE)("li",{key:t,class:"text-red-700"},(0,a.v_)(e),1)))),128))])])):(0,o.Q3)("",!0)])}s(44114),s(98992),s(72577),s(3949),s(81454),s(37550);var _=s(63084),F={props:{surveyData:Object,scoreItemLabels:Array,surveyResults:Array},data(){return{errors:[],hasErrors:!1,preview:[]}},computed:{summaryScore(){let e=0;return this.surveyData.choiceGroups.forEach((t=>{"custom"!==t.groupType&&t.choices.forEach((t=>{if("radio"===t.type){const s=Number(t.choiceValue)||0;if(5===s&&t.hasCustomScore){const s=Number(t.customScore)||0;e+=s}else e+=s}}))})),e}},methods:{updateCustomScore(e){_.A.log("choice",e)},sanitizeString(e){const t=/[,!@#$%^&*();/|<>"']+/g;return e.replace(t,"")},saveResult(){if(this.errors=[],this.hasErrors=!1,this.surveyData.choiceGroups.forEach((e=>{if(e.choices.forEach((()=>{e.error=!1})),"custom"===e.groupType){let t=e.choices.some((e=>e.isRequested&&"radio"===e.type));t&&!e.selectedChoice&&(this.errors.push(`ตัวเลือกในกลุ่ม "${e.groupName}" ยังไม่ได้เลือกคำตอบ.`),e.error=!0),e.choices.forEach((t=>{t.isRequested&&"textarea"===t.type&&!t.choiceValue&&(this.errors.push(`ข้อความ "${e.groupName}" ยังไม่ได้กรอกข้อมูล.`),e.error=!0)}))}else e.choices.forEach((t=>{t.isRequested&&"radio"===t.type&&null===t.choiceValue?(this.errors.push(`ตัวเลือก "${t.choiceText}" ยังไม่ได้เลือกคำตอบ.`),e.error=!0):t.isRequested&&"textarea"===t.type&&!t.choiceValue&&(this.errors.push(`ข้อความ "${t.choiceText}" ยังไม่ได้กรอกข้อมูล.`),e.error=!0)}))})),this.errors.length>0)this.hasErrors=!0;else{const e={name:this.surveyData.name,score:this.surveyData.score,scoreSummary:this.summaryScore,choiceGroups:this.surveyData.choiceGroups.map((e=>"custom"===e.groupType?{groupName:e.groupName,groupType:e.groupType,choices:e.choices.map((e=>({choiceText:e.choiceText,type:e.type}))),selectedChoice:e.choices.some((e=>"textarea"===e.type))?this.sanitizeString(e.choices.find((e=>"textarea"===e.type&&e.choiceValue))?.choiceValue||""):e.selectedChoice}:{groupName:e.groupName,groupType:e.groupType,choices:e.choices.map((e=>({choiceText:e.choiceText,type:e.type,choiceValue:"textarea"===e.type?this.sanitizeString(e.choiceValue||""):e.choiceValue})))}))};this.preview=e,this.$emit("save-result",e)}},clearSurvey(){this.surveyData.choiceGroups.forEach((e=>{"custom"===e.groupType?e.selectedChoice=null:e.choices.forEach((e=>{"radio"===e.type?e.choiceValue=null:"textarea"===e.type&&(e.choiceValue="")}))}))}}},S=s(64621);const X=(0,S.A)(F,[["render",I],["__scopeId","data-v-e54faf52"]]);var A=X}}]);
//# sourceMappingURL=2415.5e9de24b.js.map