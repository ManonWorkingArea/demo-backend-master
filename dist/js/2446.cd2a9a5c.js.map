{"version":3,"file":"js/2446.cd2a9a5c.js","mappings":"+PACEA,EAAAA,EAAAA,IAOM,aANJC,EAAAA,EAAAA,IAKEC,EAAA,CAJCC,KAAM,MACNC,KAAM,OACNC,YAAaC,EAAAD,YACbE,YAAWC,EAAAC,W,2EASlB,GACEC,IAAAA,GACE,MAAMC,EAAcC,EAAAA,EAAeC,IAAI,UAAW,SAC5CC,EAAUF,EAAAA,EAAeC,IAAI,WAC7BE,EAAcC,KAAKC,OAAOC,OAEhC,MAAO,CACLC,QAASP,EAAAA,EAAeC,IAAI,WAC5BO,QAASJ,KAAKK,KACdV,cACAG,UACAQ,iBAAiB,EACjBC,YAAY,EACZlB,YAAa,CACXD,KAAM,OACNoB,MAAOV,EAAQW,QAAQC,IACvBC,OAAQ,QACRC,OAAQb,EAAYc,IAAM,KAC1BC,OAAQf,EAAYc,IAAM,MAGhC,EACAE,WAAY,CACVC,YAAWA,EAAAA,GAEbC,OAAAA,GAEMjB,KAAKC,OAAOC,OAAOW,IACrBb,KAAKkB,wBAET,EACAC,QAAS,CACP,4BAAMD,GACJ,IAEE,MAAME,QAAiBpB,KAAKqB,KAAKxB,IAAI,aAAaG,KAAKC,OAAOC,OAAOW,MAC/DS,EAAaF,EAAS1B,KAG5BM,KAAKX,YAAc,IACdW,KAAKX,YACRkC,YAAaD,EAAWC,aAAe,GACvCC,OAAQF,EAAWE,QAAU,GAEjC,CAAE,MAAOC,GACPC,QAAQD,MAAM,4CAA6CA,EAC7D,CACF,EACAE,QAAAA,CAASjC,GACPM,KAAKO,YAAa,EAClBP,KAAKX,YAAc,IAAKW,KAAKX,eAAgBK,EAC/C,EACAD,SAAAA,GACEO,KAAKO,YAAa,EAClBP,KAAKX,YAAc,CACjBD,KAAM,OACNoB,MAAOR,KAAKF,QAAQW,QAAQC,IAC5BC,OAAQ,QACRC,OAAQZ,KAAKC,OAAOC,OAAOW,IAAM,KACjCC,OAAQd,KAAKC,OAAOC,OAAOW,IAAM,MAEnCb,KAAK4B,QAAQC,KAAK,YACpB,I,WCxEJ,MAAMC,GAA2B,OAAgB,EAAQ,CAAC,CAAC,SAASC,KAEpE,O","sources":["webpack://node-backend/./src/extensions/modules/blog/cms/component/AddBlog.vue","webpack://node-backend/./src/extensions/modules/blog/cms/component/AddBlog.vue?b798"],"sourcesContent":["<template>\n  <div>\n    <ContentForm\n      :mode=\"'add'\"\n      :type=\"'post'\"\n      :initialData=\"initialData\"\n      @closeEdit=\"closeEdit\"\n    />\n  </div>\n</template>\n\n<script>\nimport storageManager from '@/plugins/storage';\nimport ContentForm from '@/extensions/modules/blog/cms/component/_plugin/ContentForm.vue';\n\nexport default {\n  data() {\n    const accessToken = storageManager.get('session', 'token');\n    const session = storageManager.get('session');\n    const routeParams = this.$route.params;\n    \n    return {\n      configs: storageManager.get('configs'),\n      hostkey: this.$Key,\n      accessToken,\n      session,\n      loading_sources: true,\n      isEditMode: true,\n      initialData: {\n        type: 'blog', // กำหนดประเภทเป็นบล็อก\n        owner: session.current._id, // เจ้าของบล็อก\n        status: 'draft', // สถานะเริ่มต้นเป็นฉบับร่าง\n        parent: routeParams.id || null, // เพิ่ม parent post id จาก route\n        pageID: routeParams.id || null, // เพิ่ม pageID สำหรับความสัมพันธ์\n      },\n    };\n  },\n  components: {\n    ContentForm,\n  },\n  created() {\n    // ถ้ามี parent id จาก route ให้ดึงข้อมูล parent\n    if (this.$route.params.id) {\n      this.fetchParentPageDetails();\n    }\n  },\n  methods: {\n    async fetchParentPageDetails() {\n      try {\n        // เรียกใช้ API เพื่อดึงรายละเอียดของ parent page\n        const response = await this.$api.get(`/api/page/${this.$route.params.id}`);\n        const parentPage = response.data;\n        \n        // อัปเดต initialData ด้วยข้อมูลเพิ่มเติมจาก parent page\n        this.initialData = {\n          ...this.initialData,\n          destination: parentPage.destination || '',\n          course: parentPage.course || '',\n        };\n      } catch (error) {\n        console.error('เกิดข้อผิดพลาดในการดึงข้อมูล parent page:', error);\n      }\n    },\n    openEdit(data) {\n      this.isEditMode = true;\n      this.initialData = { ...this.initialData, ...data };\n    },\n    closeEdit() {\n      this.isEditMode = false;\n      this.initialData = {\n        type: 'blog',\n        owner: this.session.current._id,\n        status: 'draft',\n        parent: this.$route.params.id || null,\n        pageID: this.$route.params.id || null,\n      };\n      this.$router.push('/cms/blog'); // กลับไปหน้ารายการบล็อก\n    },\n  }\n}\n</script> ","import { render } from \"./AddBlog.vue?vue&type=template&id=22d344e4\"\nimport script from \"./AddBlog.vue?vue&type=script&lang=js\"\nexport * from \"./AddBlog.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createElementBlock","_createVNode","_component_ContentForm","mode","type","initialData","$data","onCloseEdit","$options","closeEdit","data","accessToken","storageManager","get","session","routeParams","this","$route","params","configs","hostkey","$Key","loading_sources","isEditMode","owner","current","_id","status","parent","id","pageID","components","ContentForm","created","fetchParentPageDetails","methods","response","$api","parentPage","destination","course","error","console","openEdit","$router","push","__exports__","render"],"sourceRoot":""}