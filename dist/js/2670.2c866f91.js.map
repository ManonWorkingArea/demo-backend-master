{"version":3,"file":"js/2670.2c866f91.js","mappings":"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","sources":["webpack://node-backend/./src/extensions/modules/elearning/lesson/view/course/Command.vue","webpack://node-backend/./src/extensions/modules/elearning/lesson/component/course/Command.vue","webpack://node-backend/./src/extensions/modules/elearning/lesson/component/course/Command.vue?551b","webpack://node-backend/./src/extensions/modules/elearning/lesson/view/course/Command.vue?b2a6","webpack://node-backend/./src/plugins/duedate.js"],"sourcesContent":["<template>\n    <component :is=\"componentName\" />\n    </template>\n    \n    <script>\n    import { useTitle } from 'vue-page-title';\n    import { useRoute } from 'vue-router';\n    import storageManager from '@/plugins/storage';\n    import Backend from '../../component/course/Command.vue';\n    import Frontend from '../../component/course/Command.vue';\n    \n    export default {\n    name: 'Lesson Detail',\n    components: {\n        Backend,\n        Frontend,\n    },\n    data() {\n        return {\n            session: storageManager.get('session')\n        };\n    },\n    setup() {\n        const route = useRoute();\n        const routeName = route.meta.title;\n        useTitle(routeName);\n    },\n    computed: {\n        componentName() {\n            if (this.session.interface === 'backend') {\n                return 'Backend';\n            } else if (this.session.interface === 'frontend') {\n                return 'Frontend';\n            } else {\n                console.error('Invalid interface:', this.session.interface);\n                return null;\n            }\n        }\n    }\n    };\n    </script>\n        ","<template>\n  <div>\n\n    <div>\n      <div>\n        <label for=\"start\">Start Date:</label>\n        <input type=\"datetime-local\" id=\"start\" v-model=\"start\" />\n      </div>\n      <div>\n        <label for=\"end\">End Date:</label>\n        <input type=\"datetime-local\" id=\"end\" v-model=\"end\" />\n      </div>\n      \n      <p>Status: {{ status.status }}</p>\n      <p>Message: {{ status.message }}</p>\n      <hr>\n      <button @click=\"updateStatus\">Calculate</button>\n    </div>\n\n    <!-- <button @click=\"batchChangeData\">Change Data</button>\n    <button @click=\"findDuplicates\">Find Duplicates</button> -->\n    <table>\n      <thead>\n        <tr>\n          <th>#</th>\n          <th>ID</th>\n          <th>score</th>\n          <th>User</th>\n          <th>Course</th>\n          <th>Date</th>\n          <th>#</th>\n          <!-- Add more table headers as needed -->\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"(formData, index) in duplicates\" :key=\"index\">\n            <td>{{ index+1}}</td>\n            <td>{{ formData._id }}</td>\n            <td>{{ formData.score }}</td>\n            <td>{{ formData.userID }}</td>\n            <td>{{ formData.courseID }}</td>\n            <td><pre>{{ formData.createdAt }}</pre></td>\n            <td><button @click=\"fetchEnrollData(formData.userID,formData.score,formData._id)\">Get</button></td>\n          <!-- Render other data fields as needed -->\n        </tr>\n      </tbody>\n    </table>\n  </div>\n</template>\n  \n  <script>\n  import storageManager from '@/plugins/storage';\n  import requestClient from '@/plugins/requestClient';\n  import { checkDateStatus } from '@/plugins/duedate.js';\n  const Request = new requestClient(false);\n  export default {\n    data() {\n      return {\n        configs: storageManager.get('configs'),\n        session: storageManager.get('session'),\n        message: 'Component with getForm function',\n        loadStatus: false,\n        form: [],\n        userIDsMap:{},\n        duplicates:[],\n        start: \"2024-06-20T02:00:00.000\",\n        end: \"\",\n        status: { status: '', message: '' }\n      };\n    },\n    methods: {\n      updateStatus() {\n        this.status = checkDateStatus(this.start, this.end);\n      },\n      async getForm() {\n        try {\n          const requestData = {\n            method: 'find',\n            args: [{ $and: [{courseID:'65d33ba369c3155dfd669617'}] }],\n            paging: { page: 1, limit: 2000 }\n          };\n  \n          const { data,status } = await Request.POST('form/query', requestData, this.configs.key);\n  \n          if (status !== 200) {\n            throw new Error(`Failed to fetch player data from API`);\n          }\n          this.form = data.data;\n          this.loadStatus = true\n        } catch (error) {\n          console.error('An error occurred while fetching player data:', error);\n          throw error;\n        }\n      },\n      async findDuplicates() {\n        try {\n          // Reset duplicates array before finding duplicates\n          this.duplicates = [];\n\n          // Iterate through the form data\n          for (const formData of this.form) {\n            const userID = formData.userID;\n\n            if (!this.userIDsMap[userID]) {\n              // Initialize an array for the userID if not already present in the map\n              this.userIDsMap[userID] = [formData];\n            } else {\n              // If the userID already exists in the map, check if the document is a duplicate\n              const existingDocs = this.userIDsMap[userID];\n              const isDuplicate = existingDocs.some(doc => doc._id !== formData._id);\n\n              if (isDuplicate) {\n                // If the document is a duplicate, find its original document and push it first\n                const originalDocIndex = existingDocs.findIndex(doc => doc._id === formData._id);\n                if (originalDocIndex !== -1) {\n                  this.duplicates.push(existingDocs[originalDocIndex]);\n                }\n                // Then push the duplicate document\n                this.duplicates.push(formData);\n              } else {\n                // If it's not a duplicate, push the document to the array\n                existingDocs.push(formData);\n              }\n            }\n          }\n        } catch (error) {\n          console.error('An error occurred while finding duplicates:', error);\n          throw error;\n        }\n      },\n\n      async batchChangeData() {\n        try {\n          for (const formData of this.form) {\n            const success = await this.changeData(formData._id);\n            console.log(\"Form data updated successfully:\", success);\n          }\n          this.getForm();\n          console.log(\"Batch update completed.\");\n          // Optionally, perform any actions after the batch update is completed\n        } catch (error) {\n          console.error('An error occurred during batch update:', error);\n          // Optionally, handle the error\n        }\n      },\n      async changeData(id) {\n        try {\n          const requestBody = {\n            data: {\n              courseID: '65d33ba369c3155dfd669617'\n            }\n          };\n\n          const { data, status } = await Request.PUT(`form/${id}`, requestBody, this.configs.key);\n          console.log(status, data);\n          \n          // Optionally, handle the response if needed\n\n          return true; // Return true upon successful update\n        } catch (error) {\n          console.error('An error occurred while changing data:', error);\n          throw error;\n        }\n      },\n      async deleteData(id) {\n        try {\n          const { data } = await Request.DELETE(`form/${id}`, null, this.configs.key);\n          console.log(data);\n          await this.getForm();\n          this.findDuplicates();\n        } catch (error) {\n          console.log(error)\n        }\n      },\n      async updateScore(sessionID ) {\n        const requestBody = {\n          data: {\n            courseID: \"662ed59188ed41e8351d2da4\"\n          }\n        };\n\n        try {\n          const response = await this.$Request.PUT(`score/${sessionID}`, requestBody, this.configs.key);\n          const { data, status } = response;\n\n          if (status === 200) {\n            console.log(`Successfully updated courseID for session ID: ${sessionID}`);\n            console.log('Updated Data:', data);\n          } else {\n            console.error(`Failed to update courseID for session ID: ${sessionID}. Status: ${status}`);\n          }\n        } catch (error) {\n          console.error(`Error updating courseID for session ID: ${sessionID}`, error);\n        }\n      },\n      async fetchEnrollData(userID,score,scoreID) {\n        const andConditions = [\n          { userID: userID },\n          { courseID: \"662ed59188ed41e8351d2da4\" }\n        ];\n\n        const pipeline = [\n          { $match: { $and: andConditions } }\n        ];\n\n        try {\n          const resAPI = await Request.POST('enroll/aggregate', { pipeline }, this.configs.key);\n          const data = resAPI.data;\n\n          const filteredData = data.map(item => {\n            if (!item.analytics.post || item.analytics.post.score === null) {\n\n              // call update\n              this.updateAnalyticsPost(item._id ,item.analytics,score);\n              this.updateScore(scoreID);\n              return { ...item, status: \"nodata\" };\n            } else {\n              this.updateScore(scoreID);\n              return { ...item, status: \"hasdata\" };\n            }\n          });\n          console.log(\"Filtered Data:\", filteredData);\n        } catch (error) {\n          console.error('Failed to fetch data:', error);\n        }\n      },\n      async updateAnalyticsPost(itemID, analytics, score) {\n        // Determine message and result based on the score\n        const newPost = {\n          has: true,\n          measure: \"33\",\n          message: score < 33 ? \"ไม่ผ่านการรับรอง\" : \"ผ่านการรับรอง\",\n          req: true,\n          result: score >= 33,\n          score: score,\n          verified: \"xxx\"\n        };\n\n        // Update the analytics.post field while preserving other analytics data\n        const updatedAnalytics = {\n          ...analytics,  // Spread the existing analytics data\n          post: newPost  // Replace the post field with the newPost structure\n        };\n\n        try {\n\n          console.log(updatedAnalytics); \n          \n          // Send a PUT request to update the item\n          await Request.PUT(`enroll/${itemID}`, {\n            data: {\n              analytics: updatedAnalytics\n            }\n          }, this.configs.key);\n\n          console.log(`Updated item with ID: ${itemID}`);\n\n          \n        } catch (error) {\n          console.error(`Failed to update item with ID: ${itemID}`, error);\n        }\n      },\n      async fetchData() {\n        const andConditions = [\n          { examID: '65eb076bef03bebf9ead6f1c' },\n          { courseID: '65d33ba369c3155dfd669617' }\n        ];\n\n        const pipeline = [\n          { $match: { $and: andConditions } }\n        ];\n\n        try {\n          const resAPI = await Request.POST('score/aggregate', { pipeline }, this.configs.key);\n          const data = resAPI.data;\n\n          // Filter the results by createdAt in JavaScript\n          const filteredData = data.filter(item => {\n            const createdAt = new Date(item.createdAt);\n            return createdAt >= new Date(\"2024-06-21T00:00:00.000Z\") && createdAt < new Date(\"2024-06-22T00:00:00.000Z\");\n          });\n\n          this.duplicates = filteredData;\n        } catch (error) {\n          console.error('Failed to fetch data:', error);\n        }\n      }\n    },\n    mounted() {\n      //this.getForm();\n      this.updateStatus();\n      this.fetchData();\n    }\n  };\n  </script>\n  \n  <style>\n  /* Your component's styles go here */\n  </style>\n  ","import { render } from \"./Command.vue?vue&type=template&id=15bb072a\"\nimport script from \"./Command.vue?vue&type=script&lang=js\"\nexport * from \"./Command.vue?vue&type=script&lang=js\"\n\nimport \"./Command.vue?vue&type=style&index=0&id=15bb072a&lang=css\"\n\nimport exportComponent from \"../../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Command.vue?vue&type=template&id=dd2035c4\"\nimport script from \"./Command.vue?vue&type=script&lang=js\"\nexport * from \"./Command.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","// duedate.js\n\nexport function toBangkokTime(date) {\n    const options = { timeZone: 'Asia/Bangkok', hour12: false };\n    return new Date(date.toLocaleString('en-US', options));\n  }\n  \n  export function getDifference(start, end) {\n    const diffMs = Math.abs(end - start);\n    const diffDays = Math.floor(diffMs / (1000 * 60 * 60 * 24));\n    const diffHours = Math.floor((diffMs % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));\n    return { days: diffDays, hours: diffHours };\n  }\n  \n  export function checkDateStatus(startDate, endDate = null) {\n    const start = toBangkokTime(new Date(startDate));\n    const now = toBangkokTime(new Date());\n    let status = '';\n    let message = '';\n  \n    if (endDate) {\n      const end = toBangkokTime(new Date(endDate));\n  \n      if (now >= start && now <= end) {\n        const diffFromStart = getDifference(start, now);\n        const diffToEnd = getDifference(now, end);\n        status = 'in';\n        message = `เริ่มมาแล้ว ${diffFromStart.days} วัน ${diffFromStart.hours} ชั่วโมง จะจบในอีก ${diffToEnd.days} วัน ${diffToEnd.hours} ชั่วโมง`;\n      } else if (now < start) {\n        const diff = getDifference(now, start);\n        status = 'not';\n        message = `จะถึงในอีก ${diff.days} วัน ${diff.hours} ชั่วโมง`;\n      } else if (now > end) {\n        const diff = getDifference(end, now);\n        status = 'over';\n        message = `เกินกำหนดมา ${diff.days} วัน ${diff.hours} ชั่วโมง`;\n      }\n    } else {\n      if (now < start) {\n        const diff = getDifference(now, start);\n        status = 'not';\n        message = `จะถึงในอีก ${diff.days} วัน ${diff.hours} ชั่วโมง`;\n      } else if (now >= start) {\n        const diff = getDifference(start, now);\n        status = 'over';\n        message = `เกินกำหนดมา ${diff.days} วัน ${diff.hours} ชั่วโมง`;\n      }\n    }\n  \n    return { status, message };\n  }\n  "],"names":["_createBlock","_resolveDynamicComponent","$options","componentName","_createElementBlock","_createElementVNode","for","type","id","_cache","$event","$data","start","end","_toDisplayString","status","message","onClick","args","updateStatus","_Fragment","_renderList","duplicates","formData","index","key","_id","score","userID","courseID","createdAt","fetchEnrollData","_hoisted_1","Request","requestClient","data","configs","storageManager","get","session","loadStatus","form","userIDsMap","methods","this","checkDateStatus","getForm","requestData","method","$and","paging","page","limit","POST","Error","error","console","findDuplicates","existingDocs","isDuplicate","some","doc","originalDocIndex","findIndex","push","batchChangeData","success","changeData","log","requestBody","PUT","deleteData","DELETE","updateScore","sessionID","response","$Request","scoreID","andConditions","pipeline","$match","resAPI","filteredData","map","item","analytics","post","updateAnalyticsPost","itemID","newPost","has","measure","req","result","verified","updatedAnalytics","fetchData","examID","filter","Date","mounted","__exports__","name","components","Backend","Frontend","setup","route","useRoute","routeName","meta","title","useTitle","computed","interface","render","toBangkokTime","date","options","timeZone","hour12","toLocaleString","getDifference","diffMs","Math","abs","diffDays","floor","diffHours","days","hours","startDate","endDate","now","diffFromStart","diffToEnd","diff"],"sourceRoot":""}