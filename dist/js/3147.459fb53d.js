"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[3147],{63147:function(e,t,n){n.r(t),n.d(t,{default:function(){return O}});var a=n(20641);function s(e,t,n,s,i,o){const l=(0,a.g2)("Authen"),r=(0,a.g2)("Dashboard");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(l),this.login?((0,a.uX)(),(0,a.Wv)(r,{key:0})):(0,a.Q3)("",!0)],64)}var i=n(52968),o=n(75220),l=n(90033),r=n(53751);const d={class:"flex-1 pb-8 bg-gray-100 pt-2 pb-5 border-t"},u={class:"mt-8"},m={class:"mx-auto max-w-7xl px-6 sm:px-6 lg:px-6"},g={class:"mt-8 flex flex-col"},p={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},c={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},h={class:"overflow-hidden ring-1 ring-black ring-opacity-5 md:rounded-lg"},b={class:"divide-y divide-gray-200 overflow-hidden rounded-lg bg-gray-200 sm:grid sm:grid-cols-2 sm:gap-px sm:divide-y-0"},f={class:"rounded-tl-lg rounded-tr-lg sm:rounded-tr-none relative group bg-white p-6"},v={class:"mt-4"},k={class:"column menu"},I=["onDragstart"],w={key:0,class:"popup"},D={class:"popup-content"},A={class:"sm:rounded-tr-lg relative group bg-white p-6"},y={class:"mt-4"},x={key:0},L=["onDragstart","onDragend","onDrop"],T={class:"flex w-full"},M={class:"w-4/5"},C={class:"item-title font-medium text-black"},H={key:0,class:"item-old-title"},E={class:"w-1/5 flex justify-end items-center"},S=["onClick"],X=["onClick"],F=["onDrop"],P={key:0,class:"bg-gray-100 py-3 px-3 text-center text-xs text-gray-400"},j=["onDragstart"],U={class:"flex w-full"},N={class:"w-4/5"},$={class:"w-1/5 flex justify-end items-center"},_=["onClick"],Y=["onClick"];function q(e,t,n,s,i,o){const q=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",d,[(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",g,[(0,a.Lk)("div",p,[(0,a.Lk)("div",c,[(0,a.Lk)("div",h,[(0,a.Lk)("div",b,[(0,a.Lk)("div",f,[(0,a.Lk)("div",v,[(0,a.eW)((0,l.v_)(this.droppedItems)+" ",1),(0,a.Lk)("div",k,[t[17]||(t[17]=(0,a.Lk)("div",{class:"title"},"Plugin",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.menuItems,(e=>((0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["w-full py-2 px-2 border border-gray-200",{auth:e.auth}]),key:e.id,draggable:!0,onDragstart:t=>o.dragStartHandler(e)},[(0,a.Lk)("p",null,(0,l.v_)(e.title),1)],42,I)))),128)),(0,a.Lk)("button",{class:"mt-5 mb-5 mr-2 inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2",onClick:t[0]||(t[0]=(...e)=>o.showAddMenuItemPopup&&o.showAddMenuItemPopup(...e))},[(0,a.bF)(q,{icon:["fas","plus"],class:"mr-1 h-4 w-4 text-gray-600"}),t[12]||(t[12]=(0,a.eW)(" Add Menu Item "))]),i.showAddMenuItem?((0,a.uX)(),(0,a.CE)("div",w,[(0,a.Lk)("div",D,[t[13]||(t[13]=(0,a.Lk)("h2",null,"Add Menu Item",-1)),t[14]||(t[14]=(0,a.Lk)("label",null,"Title",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>i.newMenuItemTitle=e)},null,512),[[r.Jo,i.newMenuItemTitle]]),t[15]||(t[15]=(0,a.Lk)("label",null,"Target",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>i.newMenuItemTarget=e)},null,512),[[r.Jo,i.newMenuItemTarget]]),t[16]||(t[16]=(0,a.Lk)("label",null,"Requires Auth",-1)),(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>i.newMenuItemAuth=e)},null,512),[[r.lH,i.newMenuItemAuth]]),(0,a.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>o.addMenuItemHandler&&o.addMenuItemHandler(...e))},"Add"),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...t)=>e.hideAddMenuItemPopup&&e.hideAddMenuItemPopup(...t))},"Cancel")])])):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",A,[(0,a.Lk)("div",y,[(0,a.Lk)("div",{class:"column main p-3",onDragover:t[10]||(t[10]=(0,r.D$)((()=>{}),["prevent"])),onDrop:t[11]||(t[11]=(...e)=>o.dropHandler&&o.dropHandler(...e))},[t[19]||(t[19]=(0,a.Lk)("div",{class:"title"},"Main Menu",-1)),i.droppedItems&&0!==i.droppedItems.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",x,"Drop items here")),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.droppedItems,((e,n)=>((0,a.uX)(),(0,a.CE)("div",{key:e.id,draggable:!0,class:(0,l.C4)([{dragging:i.itemDragging===n},"w-full py-2 px-2 border border-gray-200 p-2 mb-2"]),onDragstart:t=>o.dragStartHandler(e,n),onDragend:e=>o.dragEndHandler(n),onDragover:t[8]||(t[8]=(0,r.D$)((()=>{}),["prevent"])),onDrop:e=>o.dropItemHandler(n)},[(0,a.Lk)("div",T,[(0,a.Lk)("div",M,[(0,a.Lk)("div",C,(0,l.v_)(e.title),1),e.oldTitle?((0,a.uX)(),(0,a.CE)("div",H,(0,l.v_)(e.oldTitle),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",E,[(0,a.Lk)("button",{class:"mr-1",onClick:e=>o.renameHandler(n)},[(0,a.bF)(q,{icon:["fas","pencil"],class:"mx-auto h-3 w-3 text-gray-600"})],8,S),(0,a.Lk)("button",{class:"ml-1",onClick:e=>o.deleteHandler(n)},[(0,a.bF)(q,{icon:["fas","trash"],class:"mx-auto h-3 w-3 text-gray-600"})],8,X)])]),(0,a.Lk)("div",{class:"submenu bg-gray-100 mt-2 p-2",onDragover:t[7]||(t[7]=(0,r.D$)((()=>{}),["prevent"])),onDrop:e=>o.dropSubmenuHandler(n,e)},[0===e.submenu.length?((0,a.uX)(),(0,a.CE)("div",P,"Drag items here to create a submenu")):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.submenu,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{class:(0,l.C4)(["submenu-item py-1 px-1 bg-white border border-gray-200 text-[15px]",{dragging:i.submenuDragging===s}]),key:e.id,draggable:!0,onDragstart:t=>o.submenuDragStartHandler(e,s),onDragend:t[6]||(t[6]=(...e)=>o.submenuDragEndHandler&&o.submenuDragEndHandler(...e))},[(0,a.Lk)("div",U,[(0,a.Lk)("div",N,(0,l.v_)(e.title),1),(0,a.Lk)("div",$,[(0,a.Lk)("button",{class:"rename-submenu-btn mr-1",onClick:e=>o.renameSubmenuHandler(n,s)},[(0,a.bF)(q,{icon:["fas","pencil"],class:"mx-auto h-3 w-3 text-gray-600"})],8,_),(0,a.Lk)("button",{class:"delete-submenu-btn ml-1",onClick:e=>o.deleteSubmenuHandler(n,s)},[(0,a.bF)(q,{icon:["fas","trash"],class:"mx-auto h-3 w-3 text-gray-600"})],8,Y)])])],42,j)))),128))],40,F)],42,L)))),128)),(0,a.Lk)("button",{class:"mt-5 mb-5 mr-2 inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2",onClick:t[9]||(t[9]=(...e)=>o.viewAllHandler&&o.viewAllHandler(...e))},[(0,a.bF)(q,{icon:["fas","save"],class:"mr-1 h-4 w-4 text-gray-600"}),t[18]||(t[18]=(0,a.eW)(" Save "))])],32)])])])])])])])])])])}n(44114),n(98992),n(54520),n(72577),n(81454);var K={data(){return{menuItems:[{id:1,title:"Menu Item 1",target:"#url1",auth:!0},{id:2,title:"Menu Item 2",target:"#url2",auth:!1},{id:3,title:"Menu Item 3",target:"#url3",auth:!0}],menuData:[],droppedItems:[],itemDragging:null,submenuDragging:null,newMenuItemTitle:"",newMenuItemTarget:"",newMenuItemAuth:!1,showAddMenuItem:!1,dataItem:this.$route.params.id}},mounted(){this.fetchData()},methods:{async fetchData(){try{let e=this.$route.params.id;const t=await fetch("https://multisource-api-edsdv.ondigitalocean.app/api/DU1eYMDG7j8yb199YDPg2/hostname/"+e,{method:"GET",headers:{"Content-Type":"application/json"}}),n=await t.json();n.menu?this.droppedItems=n.menu:this.droppedItems=[]}catch(e){console.error(e)}},async updateData(){try{this.activeBlock=!0;const e=await fetch("https://multisource-api-edsdv.ondigitalocean.app/api/DU1eYMDG7j8yb199YDPg2/hostname/"+this.dataItem,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({data:{menu:this.menuData}})}),t=await e.json();console.log(t)}catch(e){console.error(e)}},showAddMenuItemPopup(){this.showAddMenuItem=!0},dragStartHandler(e,t){event.dataTransfer.setData("text/plain",e.id),event.dataTransfer.effectAllowed="move",this.itemDragging=t},dropHandler(e){const t=e.dataTransfer.getData("text/plain"),n=this.menuItems.find((e=>e.id===Number(t)));if(n){const e={...n,oldTitle:n.title,id:Date.now(),submenu:[]};this.menuItems=this.menuItems.filter((e=>e.id!==n.id)),this.droppedItems.push(e)}},dragEndHandler(){this.itemDragging=null,this.submenuDragging=null},dropItemHandler(e){null!==this.itemDragging&&this.itemDragging!==e&&this.droppedItems.splice(e,0,this.droppedItems.splice(this.itemDragging,1)[0])},deleteHandler(e){const t=this.droppedItems.splice(e,1)[0];t.oldTitle&&(t.title=t.oldTitle,delete t.oldTitle),this.menuItems.push(t)},renameHandler(e){const t=this.droppedItems[e].title,n=prompt("Enter new name:",t);n&&(this.droppedItems[e].oldTitle=t,this.droppedItems[e].title=n)},renameSubmenuHandler(e,t){const n=this.droppedItems[e].submenu[t].title,a=prompt("Enter new name:",n);a&&(this.droppedItems[e].submenu[t].oldTitle=n,this.droppedItems[e].submenu[t].title=a)},viewAllHandler(){this.menuData=this.droppedItems.map((e=>({title:e.title,target:e.target,auth:e.auth,submenu:e.submenu.map((e=>({title:e.title,target:e.target})))}))),this.updateData(),console.log(this.droppedItems.map((e=>({title:e.title,target:e.target,auth:e.auth,submenu:e.submenu.map((e=>({title:e.title,target:e.target})))}))))},addMenuItemHandler(){if(this.newMenuItemTitle){const e={id:Date.now(),title:this.newMenuItemTitle,target:this.newMenuItemTarget,auth:this.newMenuItemAuth};this.menuItems.push(e),this.newMenuItemTitle="",this.newMenuItemTarget="",this.newMenuItemAuth=!1,this.showAddMenuItem=!1}},dropSubmenuHandler(e,t){const n=t.dataTransfer.getData("text/plain"),a=this.menuItems.find((e=>e.id===Number(n)));if(a){const t={...a,oldTitle:a.title,id:Date.now()};this.menuItems=this.menuItems.filter((e=>e.id!==a.id)),this.droppedItems[e].submenu.push(t)}},submenuDragStartHandler(e,t){event.dataTransfer.setData("text/plain",e.id),event.dataTransfer.effectAllowed="move",this.submenuDragging=t},submenuDragEndHandler(){this.submenuDragging=null},deleteSubmenuHandler(e,t){const n=this.droppedItems[e].submenu.splice(t,1)[0];n.oldTitle&&(n.title=n.oldTitle,delete n.oldTitle),this.menuItems.push(n)}}},Q=n(64621);const W=(0,Q.A)(K,[["render",q]]);var G=W,J=n(74284),R=n(40475),V={name:"Home",components:{Dashboard:G,Authen:J.A},data(){return{login:R.A.get("session","login")}},methods:{},mounted(){},setup(){const e=(0,o.lq)(),t=e.meta.title;(0,i.K7)(t),console.log("Dashboard")}};const B=(0,Q.A)(V,[["render",s]]);var O=B},74284:function(e,t,n){n.d(t,{A:function(){return m}});var a=n(20641);function s(e,t,n,s,i,o){return(0,a.uX)(),(0,a.CE)("div")}var i=n(75220),o=n(63084),l=n(40475),r={name:"Authen",data(){return{configs:l.A.get("configs"),session:l.A.get("session")}},created(){o.A.option(this.$route)},computed:{},components:{},mounted(){this.checkAuth()},updated(){},methods:{async checkAuth(){const e=(0,i.lq)(),t=e.meta.auth,n=e.name,a=l.A.get("session");let s=a.token,r=a.login,d=a.current;o.A.log("hasLogin",r),o.A.log("Page -> Auth:",t),o.A.log("User -> Token:",s),o.A.log("User -> Login:",r),"frontend"===this.session.interface?o.A.log("Front-End"):"backend"===this.session.interface&&(o.A.log("Back-End"),r?("Login"==n||void 0==d?(o.A.log("Not Login Again"),this.$router.replace({path:"/"})):(o.A.log("Has School Active"),t?(o.A.log("This page is : Authen Request"),""===s||null===s||void 0==s?o.A.log("Your Cannot Access"):o.A.log("Your Can Access")):o.A.log("This page is : No Authen Request")),o.A.log("Login")):(o.A.log("Not Login"),"Login"!=n?(window.location.href="/member/login",o.A.log("Not Login Page",n)):o.A.log("Login Page",n)))}},setup(){}},d=n(64621);const u=(0,d.A)(r,[["render",s]]);var m=u}}]);
//# sourceMappingURL=3147.459fb53d.js.map