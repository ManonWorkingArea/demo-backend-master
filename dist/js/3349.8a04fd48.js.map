{"version":3,"file":"js/3349.8a04fd48.js","mappings":"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","sources":["webpack://node-backend/./src/extensions/modules/elearning/student/view/Login.vue","webpack://node-backend/./src/extensions/modules/elearning/student/component/frontend/Login.vue","webpack://node-backend/./src/extensions/modules/elearning/student/component/frontend/Login.vue?239d","webpack://node-backend/./src/extensions/modules/elearning/student/view/Login.vue?a734"],"sourcesContent":["<template>\n    <component :is=\"componentName\" />\n    </template>\n    \n    <script>\n    import { useTitle } from 'vue-page-title';\n    import { useRoute } from 'vue-router';\n    import storageManager from '@/plugins/storage';\n    import Frontend from '../component/frontend/Login.vue';\n    \n    export default {\n    name: 'Lesson Detail',\n    components: {\n        Frontend,\n    },\n    data() {\n        return {\n            session: storageManager.get('session')\n        };\n    },\n    setup() {\n        const route = useRoute();\n        const routeName = route.meta.title;\n        useTitle(routeName);\n    },\n    computed: {\n        componentName() {\n            return 'Frontend';\n        }\n    }\n    };\n    </script>\n        ","<script>\nimport storageManager from '@/plugins/storage';\nimport CryptoJS from 'crypto-js';\nexport default {\n\tname: 'Login',\n\tcomponents: {\n\t},\n  props: {\n    showModal: {\n      type: Boolean,\n      default: false\n    }\n  },\n\tdata() {\n\t\treturn {\n      config: storageManager.get('configs'),\n      email: '',\n      password: '',\n      errorStage: false,\n      errorMessage: '',\n\t\t}\n\t},\n\tmethods: {\n    async login() {\n        try {\n          \n            this.activeBlock   = true;\n            const resAPILogin   = await fetch(\"https://gateway.cloudrestfulapi.com/api/user/query\", {\n                method: 'POST',\n                headers: {'Content-Type': 'application/json','client-token-key':this.configs.key},\n                body: JSON.stringify({\n                  method: 'find',\n                  args: [\n                    {\n                      $and: [\n                        { username: this.email }\n                      ]\n                    }\n                  ]\n                })\n            });\n            \n            const getLogin  = await resAPILogin.json();\n            const loginData = getLogin.length > 0 ? getLogin[0] : null;\n\n            console.log(\"loginData\",loginData)\n\n            if (loginData.length === 0) {\n              this.errorStage   = true\n              this.errorMessage = \"ไม่พบข้อมูลบัญชีผู้ใช้นี้\";\n              this.activeBlock  = false;\n              return;\n            } else {\n              const salt        = loginData.salt;\n              const inputHash   = CryptoJS.SHA256(this.password + salt).toString();\n              const storedHash  = loginData.password;\n\n              console.log(inputHash,storedHash)\n\n              if (inputHash === storedHash) {\n\n                if(loginData.role!=\"user\") {\n                  this.errorStage   = true\n                  this.errorMessage = \"ไม่มีสิทธิ์เข้าใช้งานเว็บไซต์นี้\";\n                } else {\n                  // Get Student Enroll\n                  const resAPI = await fetch(\"https://gateway.cloudrestfulapi.com/api/enroll/query\", {\n                    method: 'POST',\n                    headers: {'Content-Type': 'application/json','client-token-key':this.configs.key},\n                    body: JSON.stringify({\n                      method: 'find',\n                      hidden:  ['userID'],\n                      args: [\n                        {\n                          $and: [\n                            { userID: loginData._id }\n                          ]\n                        }\n                      ]\n                    })\n                  });\n                  const getEnroll  = await resAPI.json();\n                  if(resAPI.status===200) {\n                    let unitList = [];\n                    let currentAccess = \"\";\n\n                    const session = {\n                      active: true,\n                      token: loginData._id,\n                      refresh: \"\",\n                      login: true,\n                      userID: loginData._id,\n                      user: loginData,\n                      loader: false,\n                      role: loginData.role,\n                      nav: \"normal-nav\",\n                      layout: \"frontend-layout\",\n                      current: currentAccess,\n                      list: unitList,\n                      enroll: getEnroll,\n                    };\n                    storageManager.update('session',session)\n                    console.log(\"session\",session);\n\n                    if (this.showModal) {\n                      window.location.reload();\n                    }\n                    else\n                    {\n                      this.$swal({\n                        toast: true,\n                        position: 'bottom-end',\n                        showConfirmButton: false,\n                        timer: 500,\n                        icon: 'success',\n                        title: 'แจ้งเตือน',\n                        text: 'เข้าสู่ระบบเรียบร้อยแล้ว',\n                      }).then(() => \n                      {\n                        if(loginData.req_reset)\n                        {\n                          window.location.href = \"/student/reset\"\n                        }\n                        else {\n                          window.location.href = \"/student/profile\"\n                        }\n                      });\n                    }\n                    \n                  }\n                }\n              } else {\n                this.errorStage   = true\n                this.errorMessage = \"ชื่อผู้ใช้งานหรือรหัสผ่านไม่ถูกต้อง\";\n              }\n            }\n            this.activeBlock  = false;\n        } catch (error) {\n          console.log(error)\n        }\n    }\n\t},\n};\n</script>\n\n<template>\n  <div class=\"bg-gray-50\">\n    \n    <div class=\"flex min-h-full flex-col justify-center py-12 sm:px-6 lg:px-8\">\n      <div class=\"sm:mx-auto sm:w-full sm:max-w-lg\">\n        <img class=\"mx-auto h-24 w-auto\" :src=\"this.config.siteLogo\" alt=\"Your Company\" v-if=\"!this.showModal\">\n        <h2 class=\"mt-6 text-center text-3xl font-bold tracking-tight text-gray-900\">เข้าสู่บัญชี FTI Academy</h2>\n        <p class=\"mt-2 text-center text-sm text-gray-600\">\n          หรือ\n          <router-link :to=\"'/student/register'\" class=\"font-medium text-indigo-600 hover:text-indigo-500\">\n          ลงทะเบียนผู้อบรมใหม่\n          </router-link>\n        </p>\n      </div>\n  \n      <div class=\"mt-8 sm:mx-auto sm:w-full sm:max-w-md\">\n        <div class=\"bg-white px-4 py-8 shadow sm:rounded-lg sm:px-10\">\n          <form class=\"space-y-6\" @submit.prevent=\"login\">\n            <div>\n              <label for=\"email\" class=\"block text-md font-semibold leading-6 text-gray-900\">อีเมล์</label>\n              <div class=\"mt-2\">\n                <input v-model=\"email\" id=\"email\" name=\"email\" type=\"email\" autocomplete=\"email\" required=\"\" class=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\">\n              </div>\n            </div>\n  \n            <div>\n              <label for=\"password\" class=\"block text-md font-semibold leading-6 text-gray-900\">รหัสผ่าน</label>\n              <div class=\"mt-2\">\n                <input v-model=\"password\" id=\"password\" name=\"password\" type=\"password\" autocomplete=\"current-password\" required=\"\" class=\"block w-full rounded-md border-0 py-1.5 text-gray-900 shadow-sm ring-1 ring-inset ring-gray-300 placeholder:text-gray-400 focus:ring-2 focus:ring-inset focus:ring-indigo-600 sm:text-sm sm:leading-6\">\n              </div>\n            </div>\n  \n            <div class=\"flex items-center justify-between\">\n              <div class=\"flex items-center\">\n                <input id=\"remember-me\" name=\"remember-me\" type=\"checkbox\" class=\"h-4 w-4 rounded border-gray-300 text-indigo-600 focus:ring-indigo-600\">\n                <label for=\"remember-me\" class=\"ml-2 block text-sm text-gray-900\">จำฉันไว้</label>\n              </div>\n  \n              <div class=\"text-sm\">\n                <router-link :to=\"'/student/forgot'\" class=\"font-medium text-indigo-600 hover:text-indigo-500\">\n                ลืมรหัสผ่าน\n                </router-link>\n              </div>\n            </div>\n  \n            <div>\n              <div v-if=\"this.errorStage\" class=\"col-span-2\">\n                  <div class=\" items-center px-3 py-1 rounded-md bg-red-100 text-sm text-black pb-5 mb-5\">\n                    <div class=\"font-semibold pt-3 pb-3\">เกิดข้อผิดพลาด</div>\n                    <div  class=\"w-full\">{{this.errorMessage}}</div>\n                  </div>\n              </div>\n              <button type=\"submit\" class=\"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-4 text-md font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600\">เข้าสู่ระบบ</button>\n            </div>\n          </form>\n  \n        </div>\n      </div>\n    </div>\n  \n    </div>\n</template>","import { render } from \"./Login.vue?vue&type=template&id=30e3e9fe\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { render } from \"./Login.vue?vue&type=template&id=9834b532\"\nimport script from \"./Login.vue?vue&type=script&lang=js\"\nexport * from \"./Login.vue?vue&type=script&lang=js\"\n\nimport exportComponent from \"../../../../../../node_modules/@vue/cli-service/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__"],"names":["_createBlock","_resolveDynamicComponent","$options","componentName","class","key","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","showModal","_createCommentVNode","src","config","siteLogo","alt","_hoisted_4","_hoisted_5","_createTextVNode","_createVNode","_component_router_link","to","default","_withCtx","_cache","_","_hoisted_6","_hoisted_7","onSubmit","_withModifiers","args","login","for","_hoisted_8","$event","$data","email","id","name","type","autocomplete","required","_hoisted_9","password","_hoisted_10","_hoisted_11","errorStage","_hoisted_12","_hoisted_13","_hoisted_14","_toDisplayString","errorMessage","components","props","Boolean","data","storageManager","get","methods","this","activeBlock","resAPILogin","fetch","method","headers","configs","body","JSON","stringify","$and","username","getLogin","json","loginData","length","console","log","salt","inputHash","CryptoJS","toString","storedHash","role","resAPI","hidden","userID","_id","getEnroll","status","unitList","currentAccess","session","active","token","refresh","user","loader","nav","layout","current","list","enroll","update","window","location","reload","$swal","toast","position","showConfirmButton","timer","icon","title","text","then","req_reset","href","error","__exports__","Frontend","setup","route","useRoute","routeName","meta","useTitle","computed","render"],"sourceRoot":""}