"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[3588],{13588:function(e,t,s){s.r(t),s.d(t,{default:function(){return wt}});var a=s(20641);function o(e,t,s,o,n,i){const l=(0,a.g2)("Authen"),r=(0,a.g2)("Dashboard");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(l),this.login?((0,a.uX)(),(0,a.Wv)(r,{key:0})):(0,a.Q3)("",!0)],64)}var n=s(52968),i=s(75220),l=s(90033),r=s(53751);const c={class:"bg-gray-50 flex overflow-hidden message-container"},d={class:"hidden lg:flex lg:w-64 lg:flex-col"},u={class:"flex flex-col flex-grow bg-white border-r border-gray-200 h-full"},g={class:"flex items-center justify-between px-4 py-4 border-b border-gray-200 flex-shrink-0"},m={class:"px-4 py-4 border-b border-gray-200"},p={class:"space-y-2"},h={class:"flex items-center justify-between p-2 bg-blue-50 rounded-lg stats-card"},b={class:"text-sm font-semibold text-blue-600"},f={class:"flex items-center justify-between p-2 bg-green-50 rounded-lg stats-card"},x={class:"text-sm font-semibold text-green-600"},y={class:"flex items-center justify-between p-2 bg-yellow-50 rounded-lg stats-card"},v={class:"text-sm font-semibold text-yellow-600"},k={class:"flex items-center justify-between p-2 bg-red-50 rounded-lg stats-card"},L={class:"text-sm font-semibold text-red-600"},w={class:"px-4 py-4 border-b border-gray-200"},C={class:"space-y-1"},S=["onClick"],P={class:"flex-1 text-left"},E={class:"px-4 py-4 border-b border-gray-200"},A={class:"space-y-2"},I={class:"mt-auto px-4 py-4 flex-shrink-0"},_={class:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg"},j={class:"flex-1 min-w-0"},F={class:"text-sm font-medium text-gray-900 truncate"},D={class:"flex-1 flex flex-col min-w-0 h-full"},T={class:"lg:hidden bg-white border-b border-gray-200 px-4 py-3"},$={class:"flex items-center justify-between"},X={class:"bg-white border-b border-gray-200 px-4 py-3"},M={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3"},Q={class:"flex-1 max-w-md"},B={class:"relative"},U={class:"lg:hidden bg-white border-b border-gray-200"},V={class:"px-4 py-2"},q=["value"],W={class:"flex-1 p-4 overflow-hidden"},N={class:"mb-4 flex items-center justify-between"},R={class:"flex items-center gap-2"},K={class:"text-lg font-semibold text-gray-900"},O={class:"px-2 py-1 bg-gray-100 text-gray-600 text-sm rounded-full"},z={class:"flex items-center gap-2"},H=["value"],Y={class:"h-full overflow-y-auto"},J={class:"bg-white rounded-lg shadow overflow-hidden"},Z={key:0,class:"text-center p-8"},G={key:1,class:"overflow-hidden"},ee={class:"min-w-full divide-y divide-gray-300"},te={class:"bg-gray-50"},se={class:"py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6"},ae={key:2},oe=["onClick"],ne=["src"],ie={key:0,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-80 z-50"},le={class:"max-w-full"},re=["src"],ce={class:"hidden md:table-cell px-3 py-4 text-sm text-gray-500"},de={class:"hidden md:table-cell px-3 py-4 text-sm text-gray-500"},ue=["onUpdate:modelValue","onChange"],ge=["selected"],me=["selected"],pe=["selected"],he=["selected"],be={class:"relative py-4 pl-3 pr-4 text-right text-md font-medium sm:pr-6"},fe={class:"flex justify-end gap-2"},xe=["onClick"],ye={key:0,class:"text-center py-12"},ve={class:"mt-4 flex justify-center"},ke={class:"flex flex-col h-full"},Le={class:"flex items-center justify-between px-4 py-4 border-b border-gray-200"},we={class:"px-4 py-4 border-b border-gray-200"},Ce={class:"space-y-2"},Se={class:"flex items-center justify-between p-2 bg-blue-50 rounded-lg"},Pe={class:"text-sm font-semibold text-blue-600"},Ee={class:"flex items-center justify-between p-2 bg-green-50 rounded-lg"},Ae={class:"text-sm font-semibold text-green-600"},Ie={class:"flex items-center justify-between p-2 bg-yellow-50 rounded-lg"},_e={class:"text-sm font-semibold text-yellow-600"},je={class:"px-4 py-4 border-b border-gray-200"},Fe={class:"space-y-1"},De=["onClick"],Te={class:"flex-1 text-left"},$e={key:2,class:"loading-overlay"},Xe={class:"loading-text"},Me={class:"processing-count"};function Qe(e,t,s,o,n,i){const Qe=(0,a.g2)("Pagination"),Be=(0,a.g2)("Loader"),Ue=(0,a.g2)("ShortText"),Ve=(0,a.g2)("SendEmail"),qe=(0,a.g2)("font-awesome-icon"),We=(0,a.g2)("custom-confirmation");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",d,[(0,a.Lk)("div",u,[(0,a.Lk)("div",g,[t[15]||(t[15]=(0,a.Lk)("h1",{class:"text-lg font-semibold text-gray-900"},"ศูนย์กลางข้อความ",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.exportToCSV&&i.exportToCSV(...e)),class:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg transition-colors duration-200",title:"Export CSV"},t[14]||(t[14]=[(0,a.Lk)("i",{class:"fas fa-download text-sm"},null,-1)]))]),(0,a.Lk)("div",m,[t[20]||(t[20]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"สถิติรวม",-1)),(0,a.Lk)("div",p,[(0,a.Lk)("div",h,[t[16]||(t[16]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"ข้อความทั้งหมด")],-1)),(0,a.Lk)("span",b,(0,l.v_)(n.totalItems),1)]),(0,a.Lk)("div",f,[t[17]||(t[17]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"Submit")],-1)),(0,a.Lk)("span",x,(0,l.v_)(i.getStatusCount("submit")),1)]),(0,a.Lk)("div",y,[t[18]||(t[18]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"Pending")],-1)),(0,a.Lk)("span",v,(0,l.v_)(i.getStatusCount("pending")),1)]),(0,a.Lk)("div",k,[t[19]||(t[19]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-red-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"Confirm")],-1)),(0,a.Lk)("span",L,(0,l.v_)(i.getStatusCount("confirm")),1)])])]),(0,a.Lk)("div",w,[t[21]||(t[21]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"เมนู",-1)),(0,a.Lk)("nav",C,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.sidebarMenuItems,(e=>((0,a.uX)(),(0,a.CE)("button",{key:e.value,onClick:t=>i.toggleStatus(e.value),class:(0,l.C4)(["w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors duration-200 sidebar-menu-item",{"bg-blue-100 text-blue-700 font-medium active":n.statusFilter===e.value,"text-gray-600 hover:bg-gray-100 hover:text-gray-900":n.statusFilter!==e.value}])},[(0,a.Lk)("i",{class:(0,l.C4)([e.icon,"text-sm w-4"])},null,2),(0,a.Lk)("span",P,(0,l.v_)(e.label),1),i.getStatusCount(e.value)>0?((0,a.uX)(),(0,a.CE)("span",{key:0,class:(0,l.C4)(["px-2 py-1 text-xs rounded-full status-badge",{"bg-blue-200 text-blue-800":n.statusFilter===e.value,"bg-gray-200 text-gray-600":n.statusFilter!==e.value}])},(0,l.v_)(i.getStatusCount(e.value)),3)):(0,a.Q3)("",!0)],10,S)))),128))])]),(0,a.Lk)("div",E,[t[24]||(t[24]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"การดำเนินการ",-1)),(0,a.Lk)("div",A,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.exportToCSV&&i.exportToCSV(...e)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},t[22]||(t[22]=[(0,a.Lk)("i",{class:"fas fa-download text-sm w-4"},null,-1),(0,a.Lk)("span",null,"Export CSV",-1)])),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>i.getData&&i.getData(...e)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},t[23]||(t[23]=[(0,a.Lk)("i",{class:"fas fa-sync-alt text-sm w-4"},null,-1),(0,a.Lk)("span",null,"รีเฟรช",-1)]))])]),(0,a.Lk)("div",I,[(0,a.Lk)("div",_,[t[26]||(t[26]=(0,a.Lk)("div",{class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-user text-white text-sm"})],-1)),(0,a.Lk)("div",j,[(0,a.Lk)("p",F,(0,l.v_)(n.session?.current?.name||"ผู้ใช้"),1),t[25]||(t[25]=(0,a.Lk)("p",{class:"text-xs text-gray-500"},"ผู้ดูแลระบบ",-1))])])])])]),(0,a.Lk)("div",D,[(0,a.Lk)("div",T,[(0,a.Lk)("div",$,[t[28]||(t[28]=(0,a.Lk)("h1",{class:"text-lg font-semibold text-gray-900"},"ศูนย์กลางข้อความ",-1)),(0,a.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>i.toggleMobileSidebar&&i.toggleMobileSidebar(...e)),class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},t[27]||(t[27]=[(0,a.Lk)("i",{class:"fas fa-bars"},null,-1)]))])]),(0,a.Lk)("div",X,[(0,a.Lk)("div",M,[(0,a.Lk)("div",Q,[(0,a.Lk)("div",B,[t[29]||(t[29]=(0,a.Lk)("i",{class:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"},null,-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[4]||(t[4]=e=>n.searchQuery=e),placeholder:"ค้นหาข้อความ...",class:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"},null,512),[[r.Jo,n.searchQuery]])])]),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>i.exportToCSV&&i.exportToCSV(...e)),class:"lg:hidden bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200 text-sm flex items-center gap-2"},t[30]||(t[30]=[(0,a.Lk)("i",{class:"fas fa-download text-xs"},null,-1),(0,a.eW)(" Export CSV ")]))])]),(0,a.Lk)("div",U,[(0,a.Lk)("div",V,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>n.statusFilter=e),onChange:t[7]||(t[7]=e=>i.toggleStatus(n.statusFilter)),class:"w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.sidebarMenuItems,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e.value,value:e.value},(0,l.v_)(e.label)+" ("+(0,l.v_)(i.getStatusCount(e.value))+") ",9,q)))),128))],544),[[r.u1,n.statusFilter]])])]),(0,a.Lk)("div",W,[(0,a.Lk)("div",N,[(0,a.Lk)("div",R,[(0,a.Lk)("h2",K,(0,l.v_)(i.getStatusLabel(n.statusFilter)),1),(0,a.Lk)("span",O,(0,l.v_)(n.totalItems)+" รายการ ",1)]),(0,a.Lk)("div",z,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[8]||(t[8]=e=>n.limitItem=e),onChange:t[9]||(t[9]=(...e)=>i.handleLimitChange&&i.handleLimitChange(...e)),class:"block w-20 py-1 px-2 text-xs font-medium bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.limitOptions,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e},(0,l.v_)(e),9,H)))),128))],544),[[r.u1,n.limitItem]]),(0,a.bF)(Qe,{"current-page":n.currentPage,"total-items":n.totalItems,"total-pages":n.totalPages,"limit-items":n.limitItem,"data-loading":n.loading,"display-mode":"nav",onPageChanged:i.handlePageChanged,class:"text-sm"},null,8,["current-page","total-items","total-pages","limit-items","data-loading","onPageChanged"])])]),(0,a.Lk)("div",Y,[(0,a.Lk)("div",J,[n.loading_sources?((0,a.uX)(),(0,a.CE)("div",G,[(0,a.Lk)("table",ee,[(0,a.Lk)("thead",te,[(0,a.Lk)("tr",null,[t[31]||(t[31]=(0,a.Lk)("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"},"#",-1)),n.activeBlock?(0,a.Q3)("",!0):((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(n.newDataArray,((e,t)=>((0,a.uX)(),(0,a.CE)("th",{scope:"col",key:t,class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},(0,l.v_)(e),1)))),128)),t[32]||(t[32]=(0,a.Lk)("th",{scope:"col",class:"hidden md:table-cell px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"วันที่ส่งข้อมูล",-1)),t[33]||(t[33]=(0,a.Lk)("th",{scope:"col",class:"hidden md:table-cell px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"สถานะ",-1)),t[34]||(t[34]=(0,a.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-center text-sm font-semibold text-gray-900"},"เครื่องมือ",-1))])]),(0,a.Lk)("tbody",{class:(0,l.C4)(["divide-y divide-gray-200 bg-white relative",[n.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.listItems,((e,s)=>((0,a.uX)(),(0,a.CE)("tr",{key:e._id,class:"hover:bg-gray-50 transition-colors"},[(0,a.Lk)("td",se,(0,l.v_)((n.currentPage-1)*n.limitItem+s+1),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.formData,((e,s)=>((0,a.uX)(),(0,a.CE)("td",{key:s,class:"hidden md:table-cell px-3 py-4 text-sm text-gray-500"},["input"===e.type||"text"===e.type||"email"===e.type||"name"===e.type||"mobile"===e.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,l.v_)(e.value),1)],64)):"textarea"===e.type?((0,a.uX)(),(0,a.Wv)(Ue,{key:1,value:e.value},null,8,["value"])):"checkbox"===e.type?((0,a.uX)(),(0,a.CE)("ul",ae,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.value,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e},(0,l.v_)(e),1)))),128))])):"radiobox"===e.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:3},[(0,a.eW)((0,l.v_)(e.value),1)],64)):"upload"===e.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:4},[(0,a.Lk)("div",{class:"relative cursor-pointer",onClick:t=>i.showLightbox(e.value[0])},[(0,a.Lk)("img",{class:"w-10 h-10 object-cover rounded-md",src:e.value[0],alt:"Uploaded Image"},null,8,ne),t[35]||(t[35]=(0,a.Lk)("div",{class:"absolute inset-0 bg-black bg-opacity-50 opacity-0 transition-opacity duration-300"},null,-1))],8,oe),n.lightboxVisible?((0,a.uX)(),(0,a.CE)("div",ie,[(0,a.Lk)("div",le,[(0,a.Lk)("img",{src:n.selectedImage,alt:"Lightbox Image",class:"mx-auto max-h-full max-w-full"},null,8,re),(0,a.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>i.closeLightbox&&i.closeLightbox(...e)),class:"absolute top-0 right-0 m-4 text-white text-2xl"},"×")])])):(0,a.Q3)("",!0)],64)):(0,a.Q3)("",!0)])))),128)),(0,a.Lk)("td",ce,(0,l.v_)(i.formatThaidate(e.createdAt)),1),(0,a.Lk)("td",de,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.status=t,onChange:t=>i.updateData(e,t.target.value),class:"border border-gray-300 rounded-md px-2 py-1 text-xs"},[(0,a.Lk)("option",{value:"submit",selected:"submit"===e.status},"Submit",8,ge),(0,a.Lk)("option",{value:"pending",selected:"pending"===e.status},"Pending",8,me),(0,a.Lk)("option",{value:"confirm",selected:"confirm"===e.status},"Confirm",8,pe),(0,a.Lk)("option",{value:"cancel",selected:"cancel"===e.status},"Cancel",8,he)],40,ue),[[r.u1,e.status]])]),(0,a.Lk)("td",be,[(0,a.Lk)("div",fe,[(0,a.bF)(Ve,{emailData:i.processEmailData(e.formData),onEmailSent:i.handleEmailSent,class:"inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"},null,8,["emailData","onEmailSent"]),(0,a.Lk)("button",{onClick:t=>i.removeItem(e._id),type:"button",class:"hidden md:inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"},[(0,a.bF)(qe,{icon:["fas","trash-can"],class:"text-red-500 text-sm"})],8,xe)])])])))),128))],2)]),0===n.listItems.length?((0,a.uX)(),(0,a.CE)("div",ye,t[36]||(t[36]=[(0,a.Lk)("i",{class:"fas fa-envelope text-gray-300 text-4xl mb-4"},null,-1),(0,a.Lk)("p",{class:"text-gray-500"},"ไม่พบข้อความที่ตรงกับการค้นหา",-1)]))):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",Z,[(0,a.bF)(Be)]))]),(0,a.Lk)("div",ve,[(0,a.bF)(Qe,{"current-page":n.currentPage,"total-items":n.totalItems,"total-pages":n.totalPages,"limit-items":n.limitItem,"data-loading":n.loading,"display-mode":"summary",onPageChanged:i.handlePageChanged},null,8,["current-page","total-items","total-pages","limit-items","data-loading","onPageChanged"])])])])]),n.showMobileSidebar?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-50",onClick:t[13]||(t[13]=(...e)=>i.toggleMobileSidebar&&i.toggleMobileSidebar(...e))},[(0,a.Lk)("div",{class:"w-64 h-full bg-white transform transition-transform duration-300",onClick:t[12]||(t[12]=(0,r.D$)((()=>{}),["stop"]))},[(0,a.Lk)("div",ke,[(0,a.Lk)("div",Le,[t[38]||(t[38]=(0,a.Lk)("h1",{class:"text-lg font-semibold text-gray-900"},"ศูนย์กลางข้อความ",-1)),(0,a.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>i.toggleMobileSidebar&&i.toggleMobileSidebar(...e)),class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},t[37]||(t[37]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,a.Lk)("div",we,[t[42]||(t[42]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"สถิติรวม",-1)),(0,a.Lk)("div",Ce,[(0,a.Lk)("div",Se,[t[39]||(t[39]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"ข้อความทั้งหมด")],-1)),(0,a.Lk)("span",Pe,(0,l.v_)(n.totalItems),1)]),(0,a.Lk)("div",Ee,[t[40]||(t[40]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"Submit")],-1)),(0,a.Lk)("span",Ae,(0,l.v_)(i.getStatusCount("submit")),1)]),(0,a.Lk)("div",Ie,[t[41]||(t[41]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"Pending")],-1)),(0,a.Lk)("span",_e,(0,l.v_)(i.getStatusCount("pending")),1)])])]),(0,a.Lk)("div",je,[t[43]||(t[43]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"เมนู",-1)),(0,a.Lk)("nav",Fe,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.sidebarMenuItems,(e=>((0,a.uX)(),(0,a.CE)("button",{key:e.value,onClick:t=>i.toggleStatusAndCloseMobile(e.value),class:(0,l.C4)(["w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors duration-200",{"bg-blue-100 text-blue-700 font-medium":n.statusFilter===e.value,"text-gray-600 hover:bg-gray-100 hover:text-gray-900":n.statusFilter!==e.value}])},[(0,a.Lk)("i",{class:(0,l.C4)([e.icon,"text-sm w-4"])},null,2),(0,a.Lk)("span",Te,(0,l.v_)(e.label),1),i.getStatusCount(e.value)>0?((0,a.uX)(),(0,a.CE)("span",{key:0,class:(0,l.C4)(["px-2 py-1 text-xs rounded-full",{"bg-blue-200 text-blue-800":n.statusFilter===e.value,"bg-gray-200 text-gray-600":n.statusFilter!==e.value}])},(0,l.v_)(i.getStatusCount(e.value)),3)):(0,a.Q3)("",!0)],10,De)))),128))])])])])])):(0,a.Q3)("",!0),n.showConfirmation?((0,a.uX)(),(0,a.Wv)(We,{key:1,message:n.confirmationMessage,header:n.confirmationHeader,onConfirm:i.handleConfirmation,onCancel:i.handleConfirmCancel},null,8,["message","header","onConfirm","onCancel"])):(0,a.Q3)("",!0),n.isShowingOverlay?((0,a.uX)(),(0,a.CE)("div",$e,[(0,a.Lk)("div",Xe,(0,l.v_)(n.loadingMessage),1),(0,a.Lk)("div",Me,(0,l.v_)(n.processingCount),1)])):(0,a.Q3)("",!0)])}s(44114),s(98992),s(54520),s(72577),s(3949),s(81454),s(14603),s(47566),s(98721);var Be=s(40475),Ue=s(75435),Ve=s(38558),qe=s(9964),We=s(77528),Ne=s(22808);const Re=["disabled"],Ke={key:0,class:"fixed inset-0 flex items-center justify-center z-50"},Oe={class:"bg-white w-[500px] shadow-md relative"},ze={class:"bg-gray-700 border-b border-gray-200 p-2"},He={class:"text-base text-white text-left"},Ye={class:"absolute top-0 right-0 m-3"},Je={class:"border-b border-gray-200 p-4"},Ze={class:"text-gray-400 text-left"},Ge={class:"block pb-1"},et={class:"text-gray-600"},tt={class:"font-bold mr-1"},st={class:"p-4"},at={class:"mt-2 mb-4 relative"},ot={class:"relative"},nt={class:"bg-gray-100 border-t border-gray-200 p-4"},it={class:"flex justify-start"},lt=["disabled"];function rt(e,t,s,o,n,i){const c=(0,a.g2)("font-awesome-icon"),d=(0,a.g2)("MiniMCE");return(0,a.uX)(),(0,a.CE)("div",null,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.openComposeEmailPopup&&i.openComposeEmailPopup(...e)),disabled:null!==n.toast},[(0,a.bF)(c,{icon:["fas","envelope"],class:"text-black text-md"}),(0,a.eW)(" email "+(0,l.v_)(n.toast),1)],8,Re),n.showComposePopup?((0,a.uX)(),(0,a.CE)("div",Ke,[t[10]||(t[10]=(0,a.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-50"},null,-1)),(0,a.Lk)("div",Oe,[(0,a.Lk)("div",ze,[(0,a.Lk)("h3",He,[(0,a.bF)(c,{icon:["fas","envelope"],class:"text-white text-md"}),t[6]||(t[6]=(0,a.eW)(" ส่งข้อความใหม่"))]),(0,a.Lk)("div",Ye,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.closeComposeEmailPopup&&i.closeComposeEmailPopup(...e)),class:"text-gray-500 hover:text-gray-700 focus:outline-none"},[(0,a.bF)(c,{icon:["fas","times"],class:"text-white text-md"})])])]),(0,a.Lk)("div",Je,[(0,a.Lk)("p",Ze,[(0,a.Lk)("span",Ge,[(0,a.bF)(c,{icon:["fas","user"],class:"text-gray-500 text-md"}),t[7]||(t[7]=(0,a.eW)()),(0,a.Lk)("span",et,[(0,a.Lk)("span",tt,(0,l.v_)(this.name),1),(0,a.eW)("<"+(0,l.v_)(this.email)+">",1)])])])]),(0,a.Lk)("div",st,[(0,a.Lk)("div",at,[t[8]||(t[8]=(0,a.Lk)("label",{for:"subject",class:"absolute top-0 left-0 bg-white text-sm text-left compose-label"},"หัวข้อ",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>n.subject=e),id:"subject",placeholder:"Subject",class:"w-full py-2 px-3 border border-gray-300 focus:outline-none"},null,512),[[r.Jo,n.subject]])]),(0,a.Lk)("div",ot,[(0,a.bF)(d,{modelValue:n.body,"onUpdate:modelValue":t[3]||(t[3]=e=>n.body=e),options:{menubar:!1,toolbar:"undo redo | bold italic | alignleft aligncenter alignright | forecolor | removeformat"}},null,8,["modelValue"])])]),(0,a.Lk)("div",nt,[(0,a.Lk)("div",it,[(0,a.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>i.sendEmail&&i.sendEmail(...e)),disabled:n.sending,class:"bg-blue-500 hover:bg-blue-700 text-white py-2 px-4 rounded-sm text-base focus:outline-none"},[(0,a.bF)(c,{icon:["fas","envelope"],class:"text-white text-md"}),t[9]||(t[9]=(0,a.eW)(" ส่งข้อความ "))],8,lt),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>i.closeComposeEmailPopup&&i.closeComposeEmailPopup(...e)),class:"bg-gray-300 hover:bg-gray-400 text-gray-700 py-2 px-4 rounded-sm text-base focus:outline-none ml-2"}," ยกเลิก ")])])])])):(0,a.Q3)("",!0)])}var ct=s(25747),dt=s(77823),ut=s(35100),gt=(s(4934),s(12983),{props:{emailData:{type:Object,required:!0}},components:{MiniMCE:ut.A},data(){return{toast:null,showComposePopup:!1,subject:"",body:"",email:"",name:"",sending:!1}},methods:{openComposeEmailPopup(){this.showComposePopup=!0,this.subject=this.emailData.subject,this.body=this.emailData.body,this.email=this.emailData.email,this.name=this.emailData.name},closeComposeEmailPopup(){this.showComposePopup=!1,this.subject="",this.body="",this.email="",this.name=""},async sendEmail(){this.showComposePopup=!1,this.sending=!0,this.toast=(0,dt.A)({type:"pending",message:"Sending email..."});try{const e=await(0,ct.Z)({subject:this.subject,body:this.body,email:this.email,name:this.name});this.toast.hide("Email sent successfully.","success",300),this.toast=null,this.$emit("email-sent",!0,e)}catch(e){this.showToast("Failed to send email.","error"),this.$emit("email-sent",!1,e)}finally{this.sending=!1}}}}),mt=s(64621);const pt=(0,mt.A)(gt,[["render",rt],["__scopeId","data-v-100ec01c"]]);var ht=pt;function bt(e,t){for(const s in e){const a=e[s];if(a.type===t)return a.value}return null}var ft={data(){const e=Be.A.get("session");return{dataItem:this.$route.params.id,dataStatus:this.$route.params.status,school:e.current.id,login:e.login,postData:[],listItems:[],categoryData:[],newDataArray:[],loading_sources:!1,endpoint:"",master:e.master,accessToken:Be.A.get("session","token"),configs:Be.A.get("configs"),session:Be.A.get("session"),limitItem:100,limitOptions:[10,50,100,200,500,1e3,2e3],currentPage:1,totalPages:0,totalItems:0,loading:!1,showingOverlay:!1,searchQuery:"",statusFilter:"all",isCreatingUser:!1,isShowingOverlay:!1,loadingMessage:"",processingCount:"",debounceTimer:null,activeBlock:!1,selectedStatus:"",lightboxVisible:!1,selectedImage:"",confirmationMessage:"",confirmationHeader:"",showConfirmation:!1,deletionData:null,showMobileSidebar:!1,sidebarMenuItems:[{value:"all",label:"ทั้งหมด",icon:"fas fa-list"},{value:"submit",label:"Submit",icon:"fas fa-check"},{value:"pending",label:"Pending",icon:"fas fa-clock"},{value:"confirm",label:"Confirm",icon:"fas fa-thumbs-up"},{value:"cancel",label:"Cancel",icon:"fas fa-times"}]}},components:{Loader:Ue.A,Pagination:Ve.A,CustomConfirmation:We.A,SendEmail:ht,ShortText:Ne.A},methods:{processEmailData(e){const t=e["Subject"].value,s=e["Message"].value,a=bt(e,"email"),o=bt(e,"name");return{subject:t,body:s,email:a,name:o}},handleEmailSent(e,t){e?console.log("Email sent:",t.message):console.error("Failed to send email:",t.message)},removeItem(e){this.confirmationMessage="คุณต้องการลบเนื้อหา (Form) นี้ ?",this.confirmationHeader="ยืนยันการทำรายการ",this.deletionData={itemIndex:e},this.showConfirmation=!0},confirmRemoveItem(){const{itemIndex:e}=this.deletionData;console.log("Delete",e),this.deleteData(e),this.handleConfirmCancel()},handleConfirmation(){this.deletionData&&this.confirmRemoveItem()},handleConfirmCancel(){this.deletionData=null,this.confirmationMessage="",this.confirmationHeader="",this.showConfirmation=!1},async deleteData(e){if(this.$Storage.get("session","login"))try{this.loading_sources=!1,console.log("id",e);const{data:t,status:s}=await this.$Request.DELETE(`message/${e}`,null,this.configs.key),a=200===s;console.log("Data:",t),console.log("Success:",a),a&&await this.getData(),this.loading_sources=!0}catch(t){console.log(t),this.loading_sources=!0}},showLightbox(e){this.lightboxVisible=!0,this.selectedImage=e},closeLightbox(){this.lightboxVisible=!1,this.selectedImage=""},async updateData(e,t){try{this.activeBlock=!0;const{data:s,status:a}=await this.$Request.PUT(`message/${e._id}`,{data:{status:t},options:{}},this.configs.key),o=200===a;console.log("Data:",s),console.log("Success:",o),o&&this.$swal({toast:!0,position:"bottom-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"อัพเดตสถานะเรียบร้อยแล้ว",text:"อัพเดตสถานะของข้อมูลนี้ สำเร็จแล้ว"}),this.activeBlock=!1}catch(s){console.log(s),this.activeBlock=!1}},exportToCSV(){const e=this.listItems.map(((e,t)=>{const s={"#":(this.currentPage-1)*this.limitItem+t+1,...e.formData,"วันที่ส่งข้อมูล":this.formatThaidate(e.createdAt),"สถานะ":e.status};return Object.keys(s).forEach((e=>{Array.isArray(s[e])&&(s[e]=s[e].map((e=>e.value)).join(", "))})),s}));let t="";const s=Object.keys(e[0]);t+=s.join(",")+"\n",e.forEach((e=>{const a=s.map((t=>t in e?Array.isArray(e[t])?e[t].map((e=>e.value)).join(", "):"object"===typeof e[t]?e[t].value:e[t]:""));t+=a.join(",")+"\n"}));const a=new Blob([t]),o=document.createElement("a");o.setAttribute("href",URL.createObjectURL(a)),o.setAttribute("download",this.postData.title+"_exportdata_"+this.postData._id+".csv"),document.body.appendChild(o),o.click(),document.body.removeChild(o)},navigateToItem(e){const t=`/application/apply/${this.postData._id}/${e.slug}`;this.$router.push(t)},formatThaidate(e){return qe.A.toThaiDatetime(e,"short")},handleLimitChange(){const e=Be.A.get("session");e.limitItem=this.limitItem,Be.A.set("session",e),this.currentPage=1,e.currentPage=this.currentPage,Be.A.set("session",e);const t=new URLSearchParams(window.location.search);t.set("page",e.currentPage);const s=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",s),console.log("getdata","handleLimitChange"),this.getData()},handlePageChanged(e){if(e!==this.currentPage){window.scrollTo(0,0),this.currentPage=e;const t=Be.A.get("session");t.currentPage=this.currentPage,Be.A.set("session",t),console.log("getdata","handlePageChanged"),this.getData()}},clearSearchQuery(){this.searchQuery="";const e=Be.A.get("session");e.searchQuery="",Be.A.set("session",e),console.log("getdata","clearSearchQuery"),this.getData()},async callAPI(e){try{const t=`https://faas-sgp1-18bc02ac.doserverless.co/api/v1/web/fn-3bf765c8-bb4f-4bac-ba41-9698000f7334/default/getstudentdata?id=${e}`,s=await fetch(t),a=await s.json();console.log(a)}catch(t){console.log(t)}},async getData(){try{if(this.login){this.loading=!0,this.activeBlock=!0,this.loading_sources=!1;const e=[{parent:this.session.current._id}];"all"!==this.statusFilter&&e.push({status:this.statusFilter});const t=[{$match:{$and:e}},{$facet:{post:[{$skip:(this.currentPage-1)*this.limitItem},{$limit:this.limitItem}],totalCount:[{$count:"count"}]}}],{data:s,status:a}=await this.$Request.POST("message/aggregate",{pipeline:t},this.configs.key),o=200===a;if(o){const e=s[0]?.totalCount?.[0]?.count||0,t={data:s[0].post,total:e,paging:{page:this.currentPage,limit:this.limitItem,totalPages:Math.ceil(e/this.limitItem)}};this.listItems=t.data,this.totalItems=t.total,this.totalPages=t.paging.totalPages,this.newDataArray=Object.keys(t.data[0].formData),console.log("data",this.listItems)}this.loading=!1,this.activeBlock=!1,this.loading_sources=!0}}catch(e){console.log(e),this.loading=!1,this.activeBlock=!1,this.loading_sources=!0}},toggleStatus(e){console.log("Toggle Status",e),this.statusFilter=e,this.getData()},toggleMobileSidebar(){this.showMobileSidebar=!this.showMobileSidebar},getStatusCount(e){return"all"===e?this.totalItems:this.listItems.filter((t=>t.status===e)).length},getStatusLabel(e){const t={submit:"Submit",pending:"Pending",confirm:"Confirm",cancel:"Cancel",all:"ข้อความทั้งหมด"};return t[e]||"สถานะไม่ทราบ"},toggleStatusAndCloseMobile(e){this.toggleStatus(e),this.toggleMobileSidebar()}},async mounted(){try{const e=new URLSearchParams(window.location.search),t=e.get("page");if(t&&/^\d+$/.test(t))this.currentPage=parseInt(t);else{const e=Be.A.get("session");if(e&&e.currentPage){this.currentPage=e.currentPage;const t=new URLSearchParams(window.location.search);t.set("page",e.currentPage);const s=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",s)}}const s=Be.A.get("session");s&&s.searchQuery&&(this.searchQuery=s.searchQuery);const a=s.limitItem;a&&(this.limitItem=a),await this.getData()}catch(e){console.log(Error)}},setup(){},watch:{searchQuery(){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{this.getData();const e=Be.A.get("session");e.searchQuery=this.searchQuery,Be.A.set("session",e),this.currentPage=1;const t=new URLSearchParams(window.location.search);t.set("page",e.currentPage);const s=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",s)}),500)},$route(e,t){e.params.status!==t.params.status&&(this.dataStatus=e.params.status,this.getData(e.params.status).then((()=>{console.log("Data fetched successfully.")})).catch((e=>{console.error(e)})))}},computed:{filteredListItems(){return"All"===this.selectedStatus?this.listItems:this.listItems.filter((e=>e.status===this.selectedStatus))},activeStatus(){const e=this.$route.params.status;return this.postData.status.find((t=>t.slug===e))}}};const xt=(0,mt.A)(ft,[["render",Qe],["__scopeId","data-v-8418c408"]]);var yt=xt,vt=s(74284),kt={name:"Home",components:{Dashboard:yt,Authen:vt.A},data(){return{login:Be.A.get("session","login")}},methods:{},mounted(){},setup(){const e=(0,i.lq)(),t=e.meta.title;(0,n.K7)(t),console.log("Dashboard")}};const Lt=(0,mt.A)(kt,[["render",o]]);var wt=Lt},77528:function(e,t,s){s.d(t,{A:function(){return f}});var a=s(20641),o=s(53751),n=s(90033);const i={class:"w-[420px] bg-white shadow-xl border border-gray-200 rounded-lg overflow-hidden confirmation-modal",tabindex:"0"},l={class:"bg-white border-b border-gray-200 px-4 py-3"},r={class:"flex items-center space-x-2"},c={class:"text-base font-semibold text-gray-900"},d={class:"px-4 py-4"},u=["innerHTML"],g={class:"bg-gray-50 border-t border-gray-200 px-4 py-3 flex items-center justify-end space-x-2"};function m(e,t,s,m,p,h){const b=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",{class:"z-20 fixed inset-0 flex items-center justify-center",onKeydown:[t[2]||(t[2]=(0,o.jR)(((...e)=>h.confirmDeletion&&h.confirmDeletion(...e)),["enter"])),t[3]||(t[3]=(0,o.jR)(((...e)=>h.cancelDeletion&&h.cancelDeletion(...e)),["esc"]))],ref:"popupContainer",tabindex:"0"},[t[6]||(t[6]=(0,a.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-50"},null,-1)),(0,a.Lk)("div",i,[(0,a.Lk)("div",l,[(0,a.Lk)("div",r,[(0,a.Lk)("div",{class:(0,n.C4)(["w-6 h-6 rounded-md flex items-center justify-center",h.iconBadgeClass])},[(0,a.bF)(b,{icon:h.iconType,class:"h-3 w-3 text-white"},null,8,["icon"])],2),(0,a.Lk)("div",null,[(0,a.Lk)("h2",c,(0,n.v_)(s.header),1),t[4]||(t[4]=(0,a.Lk)("p",{class:"text-xs text-gray-500"},"โปรดยืนยันการดำเนินการ",-1))])])]),(0,a.Lk)("div",d,[(0,a.Lk)("div",{class:"text-sm text-gray-700 leading-relaxed",innerHTML:s.message},null,8,u)]),(0,a.Lk)("div",g,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>h.cancelDeletion&&h.cancelDeletion(...e)),class:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors"}," ยกเลิก "),(0,a.Lk)("button",{class:(0,n.C4)([h.confirmButtonClass,"px-3 py-1.5 text-sm font-medium text-white border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors"]),onClick:t[1]||(t[1]=(...e)=>h.confirmDeletion&&h.confirmDeletion(...e))},[(0,a.bF)(b,{icon:["fas","check"],class:"h-3.5 w-3.5 mr-1.5"}),t[5]||(t[5]=(0,a.eW)(" ตกลง "))],2)])])],544)}var p={props:{header:{type:String,required:!0},message:{type:String,required:!0},type:{type:String,default:"default"}},mounted(){this.$refs.popupContainer.focus()},computed:{iconType(){return"warning"===this.type?["fas","exclamation-triangle"]:"success"===this.type?["fas","check-circle"]:"information"===this.type?["fas","info-circle"]:["fas","question-circle"]},iconBadgeClass(){return"warning"===this.type?"bg-red-500":"success"===this.type?"bg-green-500":"information"===this.type?"bg-blue-500":"bg-gray-500"},confirmButtonClass(){return"warning"===this.type?"bg-red-600 hover:bg-red-700 focus:ring-red-500":"success"===this.type?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"information"===this.type?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"bg-gray-600 hover:bg-gray-700 focus:ring-gray-500"}},methods:{confirmDeletion(){this.$emit("confirm")},cancelDeletion(){this.$emit("cancel")}}},h=s(64621);const b=(0,h.A)(p,[["render",m],["__scopeId","data-v-9ba66394"]]);var f=b},38558:function(e,t,s){s.d(t,{A:function(){return I}});var a=s(20641),o=s(90033);const n={class:"flex flex-col justify-center items-center h-full"},i={key:0,class:"flex flex-wrap justify-center"},l=["disabled"],r={key:0,class:"font-medium"},c=["disabled"],d=["onClick","disabled"],u={key:1,class:"font-medium"},g=["disabled"],m=["disabled"],p={key:1,class:"text-sm text-gray-400 text-center"},h={class:"font-medium"},b={class:"text-gray-600"},f={class:"font-medium"},x={class:"text-gray-600"},y={class:"font-medium"},v={class:"text-gray-600"},k={class:"font-medium"},L={class:"text-gray-600"};function w(e,t,s,w,C,S){const P=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",n,["nav"===s.displayMode||"full"===s.displayMode?((0,a.uX)(),(0,a.CE)("ul",i,[(0,a.Lk)("li",{class:(0,o.C4)({"opacity-50 cursor-not-allowed":1===C.activePage})},[(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>S.handleButtonClick(C.activePage-1)),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},[(0,a.bF)(P,{icon:["fas","chevron-left"],class:"text-gray-700 pl-1 pr-1 text-md"})],8,l)],2),C.activePage>2?((0,a.uX)(),(0,a.CE)("li",r,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>S.handleButtonClick(1)),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 ml-1 mr-1 text-sm text-gray-700 rounded-md hover:bg-indigo-100"}," หน้าแรก ",8,c)])):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(S.pages,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:(0,o.C4)([{"bg-indigo-100 ml-1 mr-1 rounded-md border-indigo-500 text-indigo-600 font-semibold":C.activePage===e},"font-medium"])},[(0,a.Lk)("button",{onClick:t=>S.handleButtonClick(e),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 ml-1 mr-1 text-sm text-gray-700 rounded-md hover:bg-indigo-100"},(0,o.v_)(e.toString().padStart(2,"0")),9,d)],2)))),128)),C.activePage<s.totalPages-1?((0,a.uX)(),(0,a.CE)("li",u,[(0,a.Lk)("button",{onClick:t[2]||(t[2]=e=>S.handleButtonClick(s.totalPages)),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 ml-1 mr-1 text-sm text-gray-700 rounded-md hover:bg-indigo-100"}," หน้าสุดท้าย ",8,g)])):(0,a.Q3)("",!0),(0,a.Lk)("li",{class:(0,o.C4)({"opacity-50 cursor-not-allowed":C.activePage===s.totalPages})},[(0,a.Lk)("button",{onClick:t[3]||(t[3]=e=>S.handleButtonClick(C.activePage+1)),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},[(0,a.bF)(P,{icon:["fas","chevron-right"],class:"text-gray-700 pl-1 pr-1 text-md"})],8,m)],2)])):(0,a.Q3)("",!0),"summary"===s.displayMode||"full"===s.displayMode?((0,a.uX)(),(0,a.CE)("div",p,[(0,a.eW)((0,o.v_)(S.translate("paging-display"))+" ",1),(0,a.Lk)("span",h,[(0,a.Lk)("span",b,(0,o.v_)(S.startItem),1)]),(0,a.eW)(" "+(0,o.v_)(S.translate("paging-to"))+" ",1),(0,a.Lk)("span",f,[(0,a.Lk)("span",x,(0,o.v_)(S.endItem),1)]),t[4]||(t[4]=(0,a.eW)(" / ")),(0,a.Lk)("span",y,[(0,a.Lk)("span",v,(0,o.v_)(S.formatNumber(s.totalPages)),1)]),(0,a.eW)(" "+(0,o.v_)(S.translate("paging-page"))+" | "+(0,o.v_)(S.translate("paging-from"))+" ",1),(0,a.Lk)("span",k,[(0,a.Lk)("span",L,(0,o.v_)(S.formatNumber(s.totalItems)),1)]),(0,a.eW)(" "+(0,o.v_)(S.translate("paging-item")),1)])):(0,a.Q3)("",!0)])}s(44114),s(14603),s(47566),s(98721);var C=s(9964),S=s(93426),P={props:{currentPage:{type:Number,required:!0},dataLoading:{type:Boolean,required:!0},displayMode:{type:String,required:!0,default:"full"},totalPages:{type:Number,required:!0},totalItems:{type:Number,required:!0},limitItems:{type:Number,required:!0}},data(){return{activePage:this.currentPage,buttonClicked:!1}},computed:{pages(){if(window.innerWidth>=600){const e=Math.max(this.activePage-2,1),t=Math.min(this.activePage+2,this.totalPages);let s=[];for(let a=e;a<=t;a++)s.push(a);return s}{let e=Math.max(this.activePage-1,1),t=Math.min(e+2,this.totalPages);t-e<2&&(e=Math.max(t-2,1));let s=[];for(let a=e;a<=t;a++)s.push(a);return s}},startItem(){return(this.activePage-1)*this.limitItems+1},endItem(){return Math.min(this.activePage*this.limitItems,this.totalItems)}},methods:{translate:S.Tl,formatNumber(e){return C.A.formatNumber(e,"short")},goToPage(e){if(e<1||e>this.totalPages)return;const t=new URLSearchParams(window.location.search),s=t.get("searchQuery");let a="";e>1&&s?a=`?page=${e}&searchQuery=${s}`:e>1?a=`?page=${e}`:s&&(a=`?searchQuery=${s}`);const o=`${window.location.pathname}${a||""}`;window.history.pushState({path:o},"",o),this.activePage=e,this.$emit("page-changed",e)},handleButtonClick(e){this.buttonClicked||(this.buttonClicked=!0,this.goToPage(e),setTimeout((()=>{this.buttonClicked=!1}),1e3))}},watch:{currentPage(e){this.activePage=e},activePage(e){this.$emit("page-changed",e)},$route(){}},created(){const e=new URLSearchParams(window.location.search),t=e.get("page");if(t){const e=parseInt(t);isNaN(e)||this.goToPage(e)}}},E=s(64621);const A=(0,E.A)(P,[["render",w]]);var I=A},22808:function(e,t,s){s.d(t,{A:function(){return m}});var a=s(20641),o=s(90033);const n={key:0,class:""},i={key:1},l={key:3,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-75 z-10"},r={class:"relative bg-white rounded-sm p-4 max-w-xl"};function c(e,t,s,c,d,u){return(0,a.uX)(),(0,a.CE)("div",null,[d.showShortText?((0,a.uX)(),(0,a.CE)("div",n,(0,o.v_)(u.getShortText(s.value)),1)):((0,a.uX)(),(0,a.CE)("div",i,(0,o.v_)(s.value),1)),d.showShortText&&s.value.length>s.maxLength?((0,a.uX)(),(0,a.CE)("button",{key:2,onClick:t[0]||(t[0]=e=>d.showFullText=!0),class:"mt-2 text-center text-blue-500 hover:underline"}," Show More ")):(0,a.Q3)("",!0),d.showFullText?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",r,[(0,a.Lk)("span",{class:"absolute top-2 right-2 text-lg text-gray-600 cursor-pointer",onClick:t[1]||(t[1]=(...e)=>u.closeFullText&&u.closeFullText(...e))},"×"),(0,a.Lk)("div",null,(0,o.v_)(s.value),1)])])):(0,a.Q3)("",!0)])}var d={props:{value:{type:String,required:!0},maxLength:{type:Number,default:100}},data(){return{showShortText:!0,showFullText:!1}},methods:{getShortText(e){return e&&e.length>this.maxLength?e.substring(0,this.maxLength)+"...":e},closeFullText(){this.showFullText=!1}}},u=s(64621);const g=(0,u.A)(d,[["render",c]]);var m=g},74284:function(e,t,s){s.d(t,{A:function(){return u}});var a=s(20641);function o(e,t,s,o,n,i){return(0,a.uX)(),(0,a.CE)("div")}var n=s(75220),i=s(63084),l=s(40475),r={name:"Authen",data(){return{configs:l.A.get("configs"),session:l.A.get("session")}},created(){i.A.option(this.$route)},computed:{},components:{},mounted(){this.checkAuth()},updated(){},methods:{async checkAuth(){const e=(0,n.lq)(),t=e.meta.auth,s=e.name,a=l.A.get("session");let o=a.token,r=a.login,c=a.current;i.A.log("hasLogin",r),i.A.log("Page -> Auth:",t),i.A.log("User -> Token:",o),i.A.log("User -> Login:",r),"frontend"===this.session.interface?i.A.log("Front-End"):"backend"===this.session.interface&&(i.A.log("Back-End"),r?("Login"==s||void 0==c?(i.A.log("Not Login Again"),this.$router.replace({path:"/"})):(i.A.log("Has School Active"),t?(i.A.log("This page is : Authen Request"),""===o||null===o||void 0==o?i.A.log("Your Cannot Access"):i.A.log("Your Can Access")):i.A.log("This page is : No Authen Request")),i.A.log("Login")):(i.A.log("Not Login"),"Login"!=s?(window.location.href="/member/login",i.A.log("Not Login Page",s)):i.A.log("Login Page",s)))}},setup(){}},c=s(64621);const d=(0,c.A)(r,[["render",o]]);var u=d},25747:function(e,t,s){s.d(t,{Z:function(){return g}});var a=s(40475);const o=`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>Email Template</title>\n  <style>\n    /* Add your custom CSS styles here */\n    /* For example: */\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n      text-align: center;\n    }\n    body {\n      font-family: Arial, sans-serif;\n      line-height: 1.5;\n      background-color: #f2f2f2;\n      color: #ffffff;\n    }\n    .container {\n      max-width: 600px;\n      margin: 0px auto;\n      padding: 20px;\n      background-color: #ffffff;\n      border-radius: 5px;\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    }\n    .header {\n      text-align: center;\n      margin-bottom: 20px;\n    }\n    .header img {\n      max-width: 150px;\n      height: auto;\n    }\n    .content {\n      padding: 20px;\n      border-top: 1px solid #e6e6e6;\n      border-bottom: 1px solid #e6e6e6;\n    }\n    .heading {\n      font-size: 18px;\n      margin-bottom: 20px;\n      color: #000000;\n      text-align: center;\n    }\n    .text {\n      margin-bottom: 20px;\n      color: #000000;\n      text-align: left;\n      font-size: 16px;\n    }\n    .container p {\n      margin-bottom: 20px;\n      color: #000000;\n      text-align: left;\n      font-size: 16px;\n    }\n    .text p {\n      margin-bottom: 20px;\n      color: #000000;\n      text-align: left;\n      font-size: 16px;\n    }\n    .footer {\n      text-align: center;\n      margin-top: 20px;\n      color: #888888;\n      font-size: 14px;\n    }\n    .footer a {\n      color: #888888;\n      text-decoration: none;\n      transition: color 0.3s ease;\n    }\n    .footer a:hover {\n      color: #ffffff;\n    }\n  </style>\n</head>\n<body>\n  <div class="container" style="margin-top:20px;">\n    <div class="header">\n      <img src="https://vue-project.sgp1.digitaloceanspaces.com/Logo/color-logopng.png" alt="Logo">\n    </div>\n    <div class="content">\n      <h2 class="heading">{{ subject }}</h2>\n      <p class="text">{{ content }}</p>\n    </div>\n    <div class="footer">\n      &copy; ${(new Date).getFullYear()} {{ provider }}. All rights reserved.</a>\n    </div>\n  </div>\n</body>\n</html>\n`;var n=s(21396),i=s.n(n),l=s(40471);const r=new l.A(!1),c="https://gateway.cloudrestfulapi.com/email/send",d=a.A.get("session"),u=a.A.get("configs");async function g(e,t=""){let s;"frontend"===d.interface?({email_provider:s}=u):({email_provider:s}=d.current);const{name:a,email:n,subject:i,body:l}=e;try{let d,g;"welcome"===t?({emailBody:d,emailSubject:g}=b(e)):"reset-password"===t?({emailBody:d,emailSubject:g}=await x(e)):"change-password"===t?({emailBody:d,emailSubject:g}=await f(e)):"new-template"===t?({emailBody:d,emailSubject:g}=h(e)):(d=l,g=i),d=o.replace("{{ content }}",d).replace("{{ subject }}",g).replace("{{ provider }}",s);const y=await m(a,n,g,d),v=await r.POST(c,{subject:g,text:d,html:d,fromEmail:"noreply@fti.academy",fromName:"Academy Customer Support",toEmail:n,toName:a},u.key);if(200===v.status){const e=v.data;return console.log(e.message),await p(y._id,"confirm"),e}{console.log("Failed to send email");const e="Failed to send email";return await p(y._id,"fail",e),e}}catch(g){return console.error("Error sending email:",g),g.message}}async function m(e,t,s,a){try{const o={data:{name:e,email:t,subject:s,body:a,status:"submit"},options:{fieldType:[],uniqueFields:[]}},{status:n,data:i}=await r.POST("message/",o,u.key);return 200===n?(console.log("Email data recorded successfully"),i):"Failed to record email data"}catch(o){return console.error("Error recording email data:",o),o.message}}async function p(e,t,s=""){try{const a={data:{status:t,error:s}},{status:o}=await r.PUT(`message/${e}`,a,u.key);if(200!==o)return"Failed to update email status";console.log("Email status updated successfully")}catch(s){return console.error("Error updating email status:",s),s.message}}function h(e){const t=`Hello ${e.name},\n\nThis is your custom email body.\n\nYour custom data: ${e.content}`,s="Custom Email";return{emailBody:t,emailSubject:s}}function b(){const e="Welcome to our website!",t="Welcome Email";return{emailBody:e,emailSubject:t}}function f(){const e="\n  <p>สวัสดีค่ะ,</p>\n  <p>ขอแจ้งให้ทราบว่าบัญชีของคุณได้รับการเปลี่ยนแปลงรหัสผ่านเรียบร้อยแล้วค่ะ</p>\n  <p>หากคุณไม่ได้ดำเนินการเปลี่ยนรหัสผ่านนี้ กรุณาติดต่อทีมงานเพื่อรายงานให้ทราบค่ะ</p></br></br>\n  <p>ขอบคุณค่ะ</p>\n  ",t="แจ้งเตือน: บัญชีของคุณได้รับการเปลี่ยนรหัสผ่าน";return{emailBody:e,emailSubject:t}}async function x(e){try{const s={method:"find",args:[{$and:[{email:e.email}]}]},{data:a}=await r.POST("user/query",s,u.key);if(a.length>0){const e=y(6),s=i().lib.WordArray.random(16),o=i().SHA256(e+s).toString();try{const e={data:{password:o,salt:s.toString(),req_reset:!0}},{status:t}=await r.PUT(`user/${a[0]._id}`,e,u.key);if(200!==t)return"Failed to update email status";console.log("Email status updated successfully")}catch(t){return console.error("Error updating email status:",t),t.message}const n="แจ้งเตือน: รีเซ็ตรหัสผ่าน",l=`\n        <p>สวัสดีค่ะ,</p>\n        <p>ขอแจ้งให้ทราบว่าบัญชีของคุณได้รับการเปลี่ยนแปลงรหัสผ่านเรียบร้อยแล้วค่ะ</p>\n        <p>รหัสผ่านใหม่ของคุณคือ: <strong>${e}</strong></p>\n        <p>โปรดจำรหัสผ่านใหม่นี้ไว้เพื่อเข้าสู่ระบบในครั้งถัดไปค่ะ</p>\n        <p>หากคุณไม่ได้ดำเนินการเปลี่ยนรหัสผ่านนี้ กรุณาติดต่อทีมงานเพื่อรายงานให้ทราบค่ะ</p></br></br>\n        <p>ขอบคุณค่ะ</p>\n      `;return{emailBody:l,emailSubject:n}}return console.log("No User"),"User not found"}catch(t){return console.error("Error retrieving user information:",t),t.message}}function y(e){const t="0123456789";let s="";for(let a=0;a<e;a++){const e=Math.floor(Math.random()*t.length);s+=t[e]}return s}}}]);
//# sourceMappingURL=3588.4211fbeb.js.map