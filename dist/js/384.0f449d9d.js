"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[384],{80384:function(t,e,s){s.r(e),s.d(e,{default:function(){return B}});var a=s(20641);function n(t,e,s,n,o,i){const l=(0,a.g2)("Authen"),r=(0,a.g2)("Dashboard");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(l),this.login?((0,a.uX)(),(0,a.Wv)(r,{key:0})):(0,a.Q3)("",!0)],64)}var o=s(52968),i=s(75220),l=s(90033);const r={key:0,class:"text-center"},c={key:2,class:"flex-1 pb-8 bg-gray-100 pt-2 pb-5 border-t"},d={class:"mt-8"},g={class:"mx-auto max-w-7xl px-6 sm:px-6 lg:px-6"},m={class:"mt-8 flex flex-col"},u={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},p={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},h={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},x={class:"min-w-full divide-y divide-gray-300"},f={class:"divide-y divide-gray-200 bg-white"},y={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6"},k={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},v=["href"],b={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},L={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},A={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},w={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},C={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-md font-medium sm:pr-6"},_=["onClick"],E=["onClick"],P={key:1,class:"mr-2 text-sm text-red-500"};function F(t,e,s,n,o,i){const F=(0,a.g2)("Loader"),X=(0,a.g2)("breadcrumbs"),I=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)(a.FK,null,[o.loading_sources?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(F)])),o.loading_sources?((0,a.uX)(),(0,a.Wv)(X,{key:1,navigation:[{name:"ย้อนกลับ",link:"/asset/asset/"+this.dataItem,style:"chevron-left"},{name:"เพิ่มผู้ดูแลระบบ",link:"/asset/user/add/"+this.dataItem,style:"plus"}]},null,8,["navigation"])):(0,a.Q3)("",!0),o.loading_sources?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",d,[(0,a.Lk)("div",g,[(0,a.Lk)("div",m,[(0,a.Lk)("div",u,[(0,a.Lk)("div",p,[(0,a.Lk)("div",h,[(0,a.Lk)("table",x,[e[3]||(e[3]=(0,a.Lk)("thead",{class:"bg-gray-50"},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"},"#"),(0,a.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"ชื่อ"),(0,a.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"ชื่อบัญชี"),(0,a.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"อีเมล์"),(0,a.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"โทร"),(0,a.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"ผู้ดูแล"),(0,a.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"เครื่องมือ")])],-1)),(0,a.Lk)("tbody",f,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.listItems,((s,n)=>((0,a.uX)(),(0,a.CE)("tr",{key:s._id},[(0,a.Lk)("td",y,(0,l.v_)(n+1),1),(0,a.Lk)("td",k,[(0,a.Lk)("a",{href:"/origin/user/detail/"+s._id,class:"text-gray-500 hover:text-indigo-900"},(0,l.v_)(s.firstname)+" "+(0,l.v_)(s.lastname),9,v)]),(0,a.Lk)("td",b,(0,l.v_)(s.username),1),(0,a.Lk)("td",L,(0,l.v_)(s.email),1),(0,a.Lk)("td",A,(0,l.v_)(s.phone),1),(0,a.Lk)("td",w,(0,l.v_)(s.asset&&s.asset.length>0?s.asset.length:"0")+" Assets",1),(0,a.Lk)("td",C,[s.asset&&0!==s.asset.length?((0,a.uX)(),(0,a.CE)("span",P,[(0,a.bF)(I,{icon:["fas","times"],class:"text-red-500 mt-[3px] mr-2 text-md"}),e[2]||(e[2]=(0,a.eW)(" Assign ไปที่ Collection อื่นแล้ว"))])):((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("button",{onClick:t=>i.assignAdmin(s._id),type:"button",class:"mr-2 inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"},[(0,a.bF)(I,{icon:["fas","square-pen"],class:"text-black mt-[3px] mr-2 text-md"}),e[0]||(e[0]=(0,a.Lk)("span",null,"เลือก",-1))],8,_),(0,a.Lk)("button",{onClick:e=>t.deleteAdmin(s._id),type:"button",class:"inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"},[(0,a.bF)(I,{icon:["fas","trash-can"],class:"text-black mt-[3px] mr-2 text-md"}),e[1]||(e[1]=(0,a.Lk)("span",null,"ลบ",-1))],8,E)],64))])])))),128))])])])])])])])])])):(0,a.Q3)("",!0)],64)}var X=s(59911),I=s.n(X),N=s(75435),T=s(36406),j=s(40475),D={inject:["apiServer"],data(){return{accessToken:j.A.get("session","token"),listItems:[],dataItem:this.$route.params.id,configs:j.A.get("configs"),loading_sources:!0}},components:{Loader:N.A,Breadcrumbs:T.A},methods:{async getData(){if(j.A.get("session","login"))try{this.loading_sources=!1;const t=await fetch("https://gateway.cloudrestfulapi.com/api/user/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({method:"find",args:[{role:"admin"},{parent:this.configs.siteID}]})}),e=await t.json();console.log(e),this.listItems=e,this.loading_sources=!0}catch(t){console.log(t)}},async assignAdmin(t){try{this.activeBlock=!0;const e=await fetch("https://gateway.cloudrestfulapi.com/api/user/"+t+"/asset",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({action:"add",element:this.dataItem,type:"string"})}),s=await e.json();200===e.status&&(window.location.href="/asset/detail/"+this.dataItem),console.log(s)}catch(e){console.log(e)}},async deleteData(t){if(j.A.get("session","login"))try{this.loading_sources=!1,console.log("id",t);const e=await fetch("https://gateway.cloudrestfulapi.com/api/user/"+t,{method:"DELETE",headers:{"Content-Type":"application/json","client-token-key":this.configs.key}});console.log(await e),this.loading_sources=!0,await this.getData()}catch(e){console.log(e)}},updated(){I().replace()}},async mounted(){try{await this.getData()}catch(t){console.log(Error)}},setup(){}},q=s(64621);const $=(0,q.A)(D,[["render",F]]);var K=$,S=s(74284),Q={name:"Home",components:{Dashboard:K,Authen:S.A},data(){return{login:j.A.get("session","login")}},methods:{},mounted(){},setup(){const t=(0,i.lq)(),e=t.meta.title;(0,o.K7)(e),console.log("Dashboard")}};const W=(0,q.A)(Q,[["render",n]]);var B=W},36406:function(t,e,s){s.d(e,{A:function(){return E}});s(44114);var a=s(20641),n=s(90033);const o={class:"flex-1 bg-white"},i={class:"pt-4"},l={class:"mx-auto max-w-7xl px-6 sm:px-6 lg:px-6"},r={class:"hidden sm:flex","aria-label":"Breadcrumb"},c={role:"list",class:"flex items-center space-x-4"},d={class:"flex"},g={href:"/",class:"text-sm font-medium text-gray-500 hover:text-gray-700"},m={key:0},u={class:"flex items-center"},p=["href"],h={class:"flex items-center"},x={class:"ml-4 text-sm font-medium text-gray-400"},f={class:"mt-2 md:flex md:items-center md:justify-between pb-3"},y={class:"min-w-0 flex-1"},k={class:"text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-2xl sm:tracking-tight"},v={class:"mt-4 flex flex-shrink-0 md:mt-0 md:ml-4"},b=["onClick"];function L(t,e,s,L,A,w){const C=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",o,[(0,a.Lk)("div",i,[(0,a.Lk)("div",l,[(0,a.Lk)("div",null,[(0,a.Lk)("div",null,[(0,a.Lk)("nav",r,[(0,a.Lk)("ol",c,[(0,a.Lk)("li",null,[(0,a.Lk)("div",d,[(0,a.Lk)("a",g,[(0,a.bF)(C,{icon:["fas","home"]})])])]),t.$route.matched.length>1?((0,a.uX)(),(0,a.CE)("li",m,[(0,a.Lk)("div",u,[(0,a.bF)(C,{icon:["fas","chevron-right"],class:"text-gray-200"}),(0,a.Lk)("a",{href:"/"+this.ParentPage,class:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700"},(0,n.v_)(this.ParentName),9,p)])])):(0,a.Q3)("",!0),(0,a.Lk)("li",null,[(0,a.Lk)("div",h,[(0,a.bF)(C,{icon:["fas","chevron-right"],class:"text-gray-200"}),(0,a.Lk)("span",x,(0,n.v_)(this.PageName),1)])])])])]),(0,a.Lk)("div",f,[(0,a.Lk)("div",y,[(0,a.Lk)("h2",k,[(0,a.bF)(C,{icon:["fas",`${this.PageIcon}`],class:"text-gray-500 text-[18px]"},null,8,["icon"]),(0,a.eW)(" "+(0,n.v_)(this.PageName),1)])]),(0,a.Lk)("div",v,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.navigation,((e,s)=>((0,a.uX)(),(0,a.CE)("button",{key:s,onClick:s=>t.$router.push(e.link),type:"button",class:"ml-3 inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},[(0,a.bF)(C,{icon:["fas",`${e.style}`],class:"text-gray-200 mr-2"},null,8,["icon"]),(0,a.eW)(" "+(0,n.v_)(e.name),1)],8,b)))),128))])])])])])])}var A=s(75220),w={data(){const t=(0,A.lq)();return{PageName:t.meta.title,PageIcon:t.meta.icon,PagePath:t.meta.path,ParentName:t.meta.parent,ParentPage:t.meta.page}},components:{},props:{navigation:{type:Array,default:()=>[]}}},C=s(64621);const _=(0,C.A)(w,[["render",L]]);var E=_},74284:function(t,e,s){s.d(e,{A:function(){return g}});var a=s(20641);function n(t,e,s,n,o,i){return(0,a.uX)(),(0,a.CE)("div")}var o=s(75220),i=s(63084),l=s(40475),r={name:"Authen",data(){return{configs:l.A.get("configs"),session:l.A.get("session")}},created(){i.A.option(this.$route)},computed:{},components:{},mounted(){this.checkAuth()},updated(){},methods:{async checkAuth(){const t=(0,o.lq)(),e=t.meta.auth,s=t.name,a=l.A.get("session");let n=a.token,r=a.login,c=a.current;i.A.log("hasLogin",r),i.A.log("Page -> Auth:",e),i.A.log("User -> Token:",n),i.A.log("User -> Login:",r),"frontend"===this.session.interface?i.A.log("Front-End"):"backend"===this.session.interface&&(i.A.log("Back-End"),r?("Login"==s||void 0==c?(i.A.log("Not Login Again"),this.$router.replace({path:"/"})):(i.A.log("Has School Active"),e?(i.A.log("This page is : Authen Request"),""===n||null===n||void 0==n?i.A.log("Your Cannot Access"):i.A.log("Your Can Access")):i.A.log("This page is : No Authen Request")),i.A.log("Login")):(i.A.log("Not Login"),"Login"!=s?(window.location.href="/member/login",i.A.log("Not Login Page",s)):i.A.log("Login Page",s)))}},setup(){}},c=s(64621);const d=(0,c.A)(r,[["render",n]]);var g=d}}]);
//# sourceMappingURL=384.0f449d9d.js.map