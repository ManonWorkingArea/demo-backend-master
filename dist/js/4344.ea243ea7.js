"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[4344],{6989:function(e,t,s){s.d(t,{A:function(){return S}});var o=s(20641),n=s(90033);const a={key:0,class:"text-center"},l={key:2,class:"flex-1 pb-8 bg-gray-100 pt-2 pb-5 border-t"},i={class:"mt-8"},r={class:"mx-auto max-w-7xl px-6 sm:px-6 lg:px-6"},c={class:"mt-8 flex flex-col"},u={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},d={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},g={class:"overflow-hidden shadow ring-1 ring-black ring-opacity-5 md:rounded-lg"},p={class:"min-w-full divide-y divide-gray-300"},m={class:"divide-y divide-gray-200 bg-white"},h={class:"whitespace-nowrap py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-6"},f={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},y=["href"],x={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},b={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},k={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},v={class:"whitespace-nowrap px-3 py-4 text-sm text-gray-500"},w={class:"relative whitespace-nowrap py-4 pl-3 pr-4 text-right text-md font-medium sm:pr-6"},L=["onClick"],C=["onClick"],A={key:1,class:"mr-2 text-sm text-red-500"};function _(e,t,s,_,E,X){const F=(0,o.g2)("Loader"),T=(0,o.g2)("Subhead"),P=(0,o.g2)("font-awesome-icon");return(0,o.uX)(),(0,o.CE)(o.FK,null,[E.loading_sources?(0,o.Q3)("",!0):((0,o.uX)(),(0,o.CE)("div",a,[(0,o.bF)(F)])),E.loading_sources?((0,o.uX)(),(0,o.Wv)(T,{key:1,navigation:[{name:"ย้อนกลับ",link:"/origin/collection/detail/"+this.dataItem,style:"chevron-left",class:"default-btn",visible:!0,type:"button"},{name:"เพิ่มผู้ดูแลระบบ",link:"/origin/user/add/"+this.dataItem,style:"plus",class:"primary-btn",visible:!0,type:"button"}]},null,8,["navigation"])):(0,o.Q3)("",!0),E.loading_sources?((0,o.uX)(),(0,o.CE)("div",l,[(0,o.Lk)("div",i,[(0,o.Lk)("div",r,[(0,o.Lk)("div",c,[(0,o.Lk)("div",u,[(0,o.Lk)("div",d,[(0,o.Lk)("div",g,[(0,o.Lk)("table",p,[t[3]||(t[3]=(0,o.Lk)("thead",{class:"bg-gray-50"},[(0,o.Lk)("tr",null,[(0,o.Lk)("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-6"},"#"),(0,o.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"ชื่อ"),(0,o.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"ชื่อบัญชี"),(0,o.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"อีเมล์"),(0,o.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"โทร"),(0,o.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"ผู้ดูแล"),(0,o.Lk)("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"เครื่องมือ")])],-1)),(0,o.Lk)("tbody",m,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(E.listItems,((s,a)=>((0,o.uX)(),(0,o.CE)("tr",{key:s._id},[(0,o.Lk)("td",h,(0,n.v_)(a+1),1),(0,o.Lk)("td",f,[(0,o.Lk)("a",{href:"/origin/user/detail/"+s._id,class:"text-gray-500 hover:text-indigo-900"},(0,n.v_)(s.firstname)+" "+(0,n.v_)(s.lastname),9,y)]),(0,o.Lk)("td",x,(0,n.v_)(s.username),1),(0,o.Lk)("td",b,(0,n.v_)(s.email),1),(0,o.Lk)("td",k,(0,n.v_)(s.phone),1),(0,o.Lk)("td",v,(0,n.v_)(s.collection&&s.collection.length>0?s.collection.length:"0")+" Collection",1),(0,o.Lk)("td",w,[s.collection&&0!==s.collection.length?((0,o.uX)(),(0,o.CE)("span",A,[(0,o.bF)(P,{icon:["fas","times"],class:"text-red-500 mt-[3px] mr-2 text-md"}),t[2]||(t[2]=(0,o.eW)(" Assign ไปที่ Collection อื่นแล้ว"))])):((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("button",{onClick:e=>X.assignAdmin(s._id),type:"button",class:"mr-2 inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"},[(0,o.bF)(P,{icon:["fas","square-pen"],class:"text-black mt-[3px] mr-2 text-md"}),t[0]||(t[0]=(0,o.Lk)("span",null,"เลือก",-1))],8,L),(0,o.Lk)("button",{onClick:t=>e.deleteAdmin(s._id),type:"button",class:"inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"},[(0,o.bF)(P,{icon:["fas","trash-can"],class:"text-black mt-[3px] mr-2 text-md"}),t[1]||(t[1]=(0,o.Lk)("span",null,"ลบ",-1))],8,C)],64))])])))),128))])])])])])])])])])):(0,o.Q3)("",!0)],64)}var E=s(59911),X=s.n(E),F=s(75435),T=s(87814),P=s(40475),I={inject:["apiServer"],data(){return{hostkey:this.$Key,accessToken:P.A.get("session","token"),listItems:[],dataItem:this.$route.params.id,loading_sources:!0}},components:{Loader:F.A,Subhead:T.A},methods:{async getData(){if(P.A.get("session","login"))try{this.loading_sources=!1;const e=await fetch("https://gateway.cloudrestfulapi.com/api/user/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.hostkey},body:JSON.stringify({method:"find",args:[{role:"superadmin"}]})}),t=await e.json();console.log(t),this.listItems=t,this.loading_sources=!0}catch(e){console.log(e)}},async assignAdmin(e){try{this.activeBlock=!0;const t=await fetch("https://gateway.cloudrestfulapi.com/api/user/"+e+"/collection",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.hostkey},body:JSON.stringify({action:"add",element:this.dataItem,type:"string"})}),s=await t.json();200===t.status&&(window.location.href="/origin/collection/detail/"+this.dataItem),console.log(s)}catch(t){console.log(t)}},async deleteData(e){if(P.A.get("session","login"))try{this.loading_sources=!1,console.log("id",e);const t=await fetch("https://gateway.cloudrestfulapi.com/api/user/"+e,{method:"DELETE",headers:{"Content-Type":"application/json","client-token-key":this.hostkey}});console.log(await t),this.loading_sources=!0,await this.getData()}catch(t){console.log(t)}},updated(){X().replace()}},async mounted(){try{await this.getData()}catch(e){console.log(Error)}},setup(){}},N=s(64621);const K=(0,N.A)(I,[["render",_]]);var S=K},87814:function(e,t,s){s.d(t,{A:function(){return F}});var o=s(20641),n=s(90033),a=s(53751);const l={class:"py-2 bg-white border-l border-r border-b border-1 border-gray-200"},i={class:"mx-auto px-2 sm:px-6 lg:px-6 xl:flex xl:items-center xl:justify-between"},r={class:"min-w-0 flex-1"},c={class:"mt-1 text-[18px] font-semibold leading-8 text-gray-700"},u={key:0,class:"text-sm text-gray-500"},d={class:"mt-5 flex xl:mt-0 xl:ml-4"},g={class:"flex items-center space-x-2"},p={class:"text-sm text-gray-400"},m=["onUpdate:modelValue","placeholder","onChange"],h={value:"",disabled:""},f=["value"],y=["onClick"],x={class:"text-sm hidden sm:inline-block ml-1"},b=["onClick"],k={class:"text-sm hidden sm:inline-block ml-1"};function v(e,t,s,v,w,L){const C=(0,o.g2)("font-awesome-icon");return(0,o.uX)(),(0,o.CE)("header",l,[(0,o.Lk)("div",i,[(0,o.Lk)("div",r,[(0,o.Lk)("h1",c,[(0,o.bF)(C,{icon:["fas",this.PageIcon],class:"text-gray-500 text-[18px]"},null,8,["icon"]),(0,o.eW)(" "+(0,n.v_)(s.pageTitle?s.pageTitle:this.PageName),1)]),s.subhead?((0,o.uX)(),(0,o.CE)("p",u,(0,n.v_)(s.subhead),1)):(0,o.Q3)("",!0)]),(0,o.Lk)("div",d,[(0,o.Lk)("div",g,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(s.navigation,((t,s)=>((0,o.uX)(),(0,o.CE)(o.FK,{key:s},["select"===t.type?((0,o.uX)(),(0,o.CE)(o.FK,{key:0},[(0,o.Lk)("label",p,(0,n.v_)(t.placeholder),1),(0,o.bo)((0,o.Lk)("select",{"onUpdate:modelValue":e=>t.value=e,class:"block w-36 py-2 px-3 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-md",placeholder:t.placeholder,onChange:s=>e.$emit("toggleStatus",t.value)},[(0,o.Lk)("option",h,"-- "+(0,n.v_)(t.placeholder)+" --",1),((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.options,((e,t)=>((0,o.uX)(),(0,o.CE)("option",{key:t,value:e.value},(0,n.v_)(e.name),9,f)))),128))],40,m),[[a.u1,t.value]])],64)):"call-function"===t.type?((0,o.uX)(),(0,o.CE)(o.FK,{key:1},[!1!==t.visible?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:s=>e.$emit(t.function),type:"button",class:(0,n.C4)(L.getClasses(t.class))},[(0,o.bF)(C,{icon:["fas",`${t.style}`],class:(0,n.C4)({"text-gray-500 mr-2":"icon-btn"===t.class,"text-white":"primary-btn"===t.class})},null,8,["icon","class"]),(0,o.Lk)("span",x,(0,n.v_)(t.name),1)],10,y)):(0,o.Q3)("",!0)],64)):((0,o.uX)(),(0,o.CE)(o.FK,{key:2},[!1!==t.visible?((0,o.uX)(),(0,o.CE)("button",{key:0,onClick:e=>L.handleNavigationClick(t),type:"button",class:(0,n.C4)(L.getClasses(t.class))},[(0,o.bF)(C,{icon:["fas",`${t.style}`],class:(0,n.C4)({"text-gray-500 mr-2":"icon-btn"===t.class,"text-white":"primary-btn"===t.class})},null,8,["icon","class"]),(0,o.Lk)("span",k,(0,n.v_)(t.name),1)],10,b)):(0,o.Q3)("",!0)],64))],64)))),128))])])])])}s(44114);var w=s(75220),L=s(52968),C=s(23264),A=s(93426),_={props:{navigation:{type:Array,default:()=>[]},pageTitle:{type:String,default:()=>null},subhead:{type:String,default:()=>null}},data(){const e=(0,w.lq)();return console.log("Translate",(0,A.Tl)("router-"+e.meta.parent+"-"+e.meta.key)),{PageName:(0,A.iX)(),PageIcon:e.meta.icon,PagePath:e.meta.path,ParentName:e.meta.parent,ParentPage:e.meta.page}},setup(){(0,L.K7)((0,A.iX)())},methods:{getClasses(e){const t=(0,C.c)(e);return`${t}`},handleNavigationClick(e){e.function?this.$emit(e.eventName||e.function):this.$router.push(e.link)}}},E=s(64621);const X=(0,E.A)(_,[["render",v]]);var F=X},74284:function(e,t,s){s.d(t,{A:function(){return d}});var o=s(20641);function n(e,t,s,n,a,l){return(0,o.uX)(),(0,o.CE)("div")}var a=s(75220),l=s(63084),i=s(40475),r={name:"Authen",data(){return{configs:i.A.get("configs"),session:i.A.get("session")}},created(){l.A.option(this.$route)},computed:{},components:{},mounted(){this.checkAuth()},updated(){},methods:{async checkAuth(){const e=(0,a.lq)(),t=e.meta.auth,s=e.name,o=i.A.get("session");let n=o.token,r=o.login,c=o.current;l.A.log("hasLogin",r),l.A.log("Page -> Auth:",t),l.A.log("User -> Token:",n),l.A.log("User -> Login:",r),"frontend"===this.session.interface?l.A.log("Front-End"):"backend"===this.session.interface&&(l.A.log("Back-End"),r?("Login"==s||void 0==c?(l.A.log("Not Login Again"),this.$router.replace({path:"/"})):(l.A.log("Has School Active"),t?(l.A.log("This page is : Authen Request"),""===n||null===n||void 0==n?l.A.log("Your Cannot Access"):l.A.log("Your Can Access")):l.A.log("This page is : No Authen Request")),l.A.log("Login")):(l.A.log("Not Login"),"Login"!=s?(window.location.href="/member/login",l.A.log("Not Login Page",s)):l.A.log("Login Page",s)))}},setup(){}},c=s(64621);const u=(0,c.A)(r,[["render",n]]);var d=u},23264:function(e,t,s){function o(e){switch(e){case"input-plaintext":return"pl-0 focus:outline-none focus:ring-0 shadow-none border-0";case"primary-btn":return"px-4 py-2 text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"icon-btn":return"px-4 py-2 text-gray-700 bg-transparent hover:bg-transparent hover:text-gray-800";case"default-btn":return"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"danger-btn":return"px-4 py-2 text-white bg-red-600 rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"success-btn":return"px-4 py-2 text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-50";default:return""}}s.d(t,{c:function(){return o}})}}]);
//# sourceMappingURL=4344.ea243ea7.js.map