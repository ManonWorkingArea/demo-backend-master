"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[5355],{85355:function(e,t,a){a.r(t),a.d(t,{default:function(){return wn}});var s=a(20641);function n(e,t,a,n,l,o){const r=(0,s.g2)("List");return this.login?((0,s.uX)(),(0,s.Wv)(r,{key:0})):(0,s.Q3)("",!0)}var l=a(52968),o=a(75220),r=a(90033),i=a(53751);const c={class:"min-h-screen bg-gray-50 flex"},d={class:"hidden lg:flex lg:w-64 lg:flex-col"},u={class:"flex flex-col flex-grow bg-white border-r border-gray-200"},g={class:"flex items-center justify-between px-4 py-4 border-b border-gray-200"},h={class:"text-lg font-semibold text-gray-900"},v={class:"px-4 py-4 border-b border-gray-200"},p={class:"space-y-2"},f={class:"flex items-center justify-between p-2 bg-blue-50 rounded-lg stats-card"},m={class:"text-sm font-semibold text-blue-600"},b={class:"flex items-center justify-between p-2 bg-green-50 rounded-lg stats-card"},x={class:"text-sm font-semibold text-green-600"},k={class:"px-4 py-4 border-b border-gray-200"},y={class:"space-y-1"},C={key:0,class:"w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors duration-200 sidebar-menu-item bg-blue-100 text-blue-700 font-medium active"},L={class:"flex-1 text-left"},w={class:"px-4 py-4 border-b border-gray-200"},D={class:"space-y-2"},E={class:"mt-auto px-4 py-4"},T={class:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg"},I={class:"flex-1 min-w-0"},M={class:"text-sm font-medium text-gray-900 truncate"},_={class:"flex-1 flex flex-col min-w-0"},U={class:"lg:hidden bg-white border-b border-gray-200 px-4 py-3"},S={class:"flex items-center justify-between"},j={class:"text-lg font-semibold text-gray-900"},F={class:"bg-white border-b border-gray-200 px-4 py-3"},$={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3"},X={class:"flex-1 p-4 overflow-hidden"},O={class:"h-full"},A={class:"mb-4 flex items-center justify-between"},Y={class:"flex items-center gap-2"},V={class:"text-lg font-semibold text-gray-900"},K={class:"px-2 py-1 bg-gray-100 text-gray-600 text-sm rounded-full"},P={class:"h-full overflow-y-auto"},W={class:"event-view bg-white p-4 rounded-lg shadow"},B={class:"calendar-system"},Q={key:0,class:"calendar-list bg-white p-2"},z={class:"grid grid-cols-1 md:grid-cols-3 gap-2 mb-0"},R=["onClick"],q=["datetime"],N={class:"calendar-details"},H={class:"calendar-title text-lg font-semibold text-blue-600"},J={class:"calendar-description text-gray-600"},G={class:"calendar-created text-sm text-gray-400 mt-1"},Z={class:"pt-1 border-t border-gray-100"},ee=["onClick"],te=["onClick"],ae={class:"flex flex-col h-full"},se={class:"flex items-center justify-between px-4 py-4 border-b border-gray-200"},ne={class:"text-lg font-semibold text-gray-900"},le={class:"px-4 py-4 border-b border-gray-200"},oe={class:"space-y-2"},re={class:"flex items-center justify-between p-2 bg-blue-50 rounded-lg stats-card"},ie={class:"text-sm font-semibold text-blue-600"},ce={class:"flex items-center justify-between p-2 bg-green-50 rounded-lg stats-card"},de={class:"text-sm font-semibold text-green-600"},ue={class:"px-4 py-4 border-b border-gray-200"},ge={class:"space-y-1"};function he(e,t,a,n,l,o){const he=(0,s.g2)("font-awesome-icon"),ve=(0,s.g2)("calendar-view"),pe=(0,s.g2)("CalendarConfig"),fe=(0,s.g2)("Chat");return(0,s.uX)(),(0,s.CE)("div",c,[(0,s.Lk)("div",d,[(0,s.Lk)("div",u,[(0,s.Lk)("div",g,[(0,s.Lk)("h1",h,(0,r.v_)(l.title),1),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.prepareAddCalendar&&o.prepareAddCalendar(...e)),class:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg transition-colors duration-200",title:"เพิ่มปฏิทินใหม่"},t[10]||(t[10]=[(0,s.Lk)("i",{class:"fas fa-plus text-sm"},null,-1)]))]),(0,s.Lk)("div",v,[t[14]||(t[14]=(0,s.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"สถิติรวม",-1)),(0,s.Lk)("div",p,[(0,s.Lk)("div",f,[t[11]||(t[11]=(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full"}),(0,s.Lk)("span",{class:"text-sm text-gray-700"},"ปฏิทินทั้งหมด")],-1)),(0,s.Lk)("span",m,(0,r.v_)(l.calendarList.length),1)]),(0,s.Lk)("div",b,[t[12]||(t[12]=(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),(0,s.Lk)("span",{class:"text-sm text-gray-700"},"กิจกรรม")],-1)),(0,s.Lk)("span",x,(0,r.v_)(l.eventList?l.eventList.length:0),1)]),t[13]||(t[13]=(0,s.Fv)('<div class="flex items-center justify-between p-2 bg-yellow-50 rounded-lg stats-card" data-v-f1ee46ce><div class="flex items-center gap-2" data-v-f1ee46ce><div class="w-2 h-2 bg-yellow-500 rounded-full" data-v-f1ee46ce></div><span class="text-sm text-gray-700" data-v-f1ee46ce>เดือนนี้</span></div><span class="text-sm font-semibold text-yellow-600" data-v-f1ee46ce>0</span></div>',1))])]),(0,s.Lk)("div",k,[t[18]||(t[18]=(0,s.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"เมนู",-1)),(0,s.Lk)("nav",y,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.backToCalendarList&&o.backToCalendarList(...e)),class:(0,r.C4)(["w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors duration-200 sidebar-menu-item",{"bg-blue-100 text-blue-700 font-medium active":!l.selectedCalendar,"text-gray-600 hover:bg-gray-100 hover:text-gray-900":l.selectedCalendar}])},[t[15]||(t[15]=(0,s.Lk)("i",{class:"fas fa-th-large text-sm w-4"},null,-1)),t[16]||(t[16]=(0,s.Lk)("span",{class:"flex-1 text-left"},"ปฏิทินทั้งหมด",-1)),l.calendarList.length>0?((0,s.uX)(),(0,s.CE)("span",{key:0,class:(0,r.C4)(["px-2 py-1 text-xs rounded-full status-badge",{"bg-blue-200 text-blue-800":!l.selectedCalendar,"bg-gray-200 text-gray-600":l.selectedCalendar}])},(0,r.v_)(l.calendarList.length),3)):(0,s.Q3)("",!0)],2),l.selectedCalendar?((0,s.uX)(),(0,s.CE)("button",C,[t[17]||(t[17]=(0,s.Lk)("i",{class:"fas fa-calendar text-sm w-4"},null,-1)),(0,s.Lk)("span",L,(0,r.v_)(l.selectedCalendar.title),1)])):(0,s.Q3)("",!0)])]),(0,s.Lk)("div",w,[t[21]||(t[21]=(0,s.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"การดำเนินการ",-1)),(0,s.Lk)("div",D,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>o.prepareAddCalendar&&o.prepareAddCalendar(...e)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},t[19]||(t[19]=[(0,s.Lk)("i",{class:"fas fa-plus text-sm w-4"},null,-1),(0,s.Lk)("span",null,"เพิ่มปฏิทินใหม่",-1)])),(0,s.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>o.fetchCalendars&&o.fetchCalendars(...e)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},t[20]||(t[20]=[(0,s.Lk)("i",{class:"fas fa-sync-alt text-sm w-4"},null,-1),(0,s.Lk)("span",null,"รีเฟรช",-1)]))])]),(0,s.Lk)("div",E,[(0,s.Lk)("div",T,[t[23]||(t[23]=(0,s.Lk)("div",{class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-user text-white text-sm"})],-1)),(0,s.Lk)("div",I,[(0,s.Lk)("p",M,(0,r.v_)(l.session?.current?.name||"ผู้ใช้"),1),t[22]||(t[22]=(0,s.Lk)("p",{class:"text-xs text-gray-500"},"ผู้ดูแลระบบ",-1))])])])])]),(0,s.Lk)("div",_,[(0,s.Lk)("div",U,[(0,s.Lk)("div",S,[(0,s.Lk)("h1",j,(0,r.v_)(l.title),1),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>o.toggleMobileSidebar&&o.toggleMobileSidebar(...e)),class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},t[24]||(t[24]=[(0,s.Lk)("i",{class:"fas fa-bars"},null,-1)]))])]),(0,s.Lk)("div",F,[(0,s.Lk)("div",$,[t[26]||(t[26]=(0,s.Lk)("div",{class:"flex-1 max-w-md"},[(0,s.Lk)("div",{class:"relative"},[(0,s.Lk)("i",{class:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"}),(0,s.Lk)("input",{type:"text",placeholder:"ค้นหาปฏิทิน...",class:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"})])],-1)),(0,s.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>o.prepareAddCalendar&&o.prepareAddCalendar(...e)),class:"lg:hidden bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200 text-sm flex items-center gap-2"},t[25]||(t[25]=[(0,s.Lk)("i",{class:"fas fa-plus text-xs"},null,-1),(0,s.eW)(" เพิ่มปฏิทิน ")]))])]),(0,s.Lk)("div",X,[(0,s.Lk)("div",O,[(0,s.Lk)("div",A,[(0,s.Lk)("div",Y,[(0,s.Lk)("h2",V,(0,r.v_)(l.selectedCalendar?l.selectedCalendar.title:"ปฏิทินทั้งหมด"),1),(0,s.Lk)("span",K,(0,r.v_)(l.selectedCalendar?(l.eventList?l.eventList.length:0)+" กิจกรรม":l.calendarList.length+" ปฏิทิน"),1)])]),(0,s.Lk)("div",P,[(0,s.Lk)("div",W,[(0,s.Lk)("div",B,[l.selectedCalendar?((0,s.uX)(),(0,s.Wv)(ve,{key:1,"selected-calendar":l.selectedCalendar,"event-list":l.eventList,onDateSelected:o.handleDateSelected,onEditEvent:o.handleEditEvent,onBackToList:o.backToCalendarList},null,8,["selected-calendar","event-list","onDateSelected","onEditEvent","onBackToList"])):((0,s.uX)(),(0,s.CE)("div",Q,[(0,s.Lk)("ul",z,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.calendarList,((e,a)=>((0,s.uX)(),(0,s.CE)("li",{key:e._id,class:(0,r.C4)(["calendar-item flex items-center justify-between bg-white cursor-pointer p-4 relative",{"border-r md:border-gray-100":a%3!==2}])},[(0,s.Lk)("div",{onClick:t=>o.selectCalendar(e),class:"flex items-center"},[(0,s.Lk)("time",{datetime:o.parseDate(e.createdAt).dateISO,class:"icon mr-4"},[(0,s.Lk)("strong",{style:(0,r.Tr)({backgroundColor:o.getColorCode(e.color)})},(0,r.v_)(o.parseDate(e.createdAt).month),5),(0,s.Lk)("span",null,(0,r.v_)(o.parseDate(e.createdAt).date),1),(0,s.Lk)("em",{style:(0,r.Tr)({color:o.getColorCode(e.color)})},(0,r.v_)(o.parseDate(e.createdAt).day),5)],8,q),(0,s.Lk)("div",N,[(0,s.Lk)("div",H,(0,r.v_)(e.title),1),(0,s.Lk)("div",J,(0,r.v_)(e.description),1),(0,s.Lk)("div",G,(0,r.v_)(e.createdAt),1),t[27]||(t[27]=(0,s.Lk)("div",{class:"calendar-events text-sm text-gray-400 mt-1"},"100 Events",-1)),(0,s.Lk)("div",Z,[(0,s.Lk)("button",{onClick:(0,i.D$)((t=>o.editCalendar(e)),["stop"]),class:"bg-blue-500 hover:bg-blue-600 text-white px-2 py-1 rounded text-xs mr-1"},[(0,s.bF)(he,{icon:["fas","edit"],class:"text-white"})],8,ee),(0,s.Lk)("button",{onClick:(0,i.D$)((t=>o.editCalendar(e)),["stop"]),class:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs"},[(0,s.bF)(he,{icon:["fas","trash"],class:"text-white"})],8,te)])])],8,R)],2)))),128))])])),l.showCalendarConfig?((0,s.uX)(),(0,s.Wv)(pe,{key:2,"calendar-data":l.calendarData,"is-editing":void 0!==l.calendarData._id,onSaveCalendar:o.saveCalendar,onCloseCalendarConfig:o.closeCalendarConfig},null,8,["calendar-data","is-editing","onSaveCalendar","onCloseCalendarConfig"])):(0,s.Q3)("",!0),(0,s.bF)(fe)])])])])])]),l.showMobileSidebar?((0,s.uX)(),(0,s.CE)("div",{key:0,class:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-50",onClick:t[9]||(t[9]=(...e)=>o.toggleMobileSidebar&&o.toggleMobileSidebar(...e))},[(0,s.Lk)("div",{class:"w-64 h-full bg-white transform transition-transform duration-300",onClick:t[8]||(t[8]=(0,i.D$)((()=>{}),["stop"]))},[(0,s.Lk)("div",ae,[(0,s.Lk)("div",se,[(0,s.Lk)("h1",ne,(0,r.v_)(l.title),1),(0,s.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>o.toggleMobileSidebar&&o.toggleMobileSidebar(...e)),class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},t[28]||(t[28]=[(0,s.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,s.Lk)("div",le,[t[31]||(t[31]=(0,s.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"สถิติรวม",-1)),(0,s.Lk)("div",oe,[(0,s.Lk)("div",re,[t[29]||(t[29]=(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full"}),(0,s.Lk)("span",{class:"text-sm text-gray-700"},"ปฏิทินทั้งหมด")],-1)),(0,s.Lk)("span",ie,(0,r.v_)(l.calendarList.length),1)]),(0,s.Lk)("div",ce,[t[30]||(t[30]=(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),(0,s.Lk)("span",{class:"text-sm text-gray-700"},"กิจกรรม")],-1)),(0,s.Lk)("span",de,(0,r.v_)(l.eventList?l.eventList.length:0),1)])])]),(0,s.Lk)("div",ue,[t[34]||(t[34]=(0,s.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"เมนู",-1)),(0,s.Lk)("nav",ge,[(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>o.backToCalendarListAndCloseMobile&&o.backToCalendarListAndCloseMobile(...e)),class:(0,r.C4)(["w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors duration-200 sidebar-menu-item",{"bg-blue-100 text-blue-700 font-medium active":!l.selectedCalendar,"text-gray-600 hover:bg-gray-100 hover:text-gray-900":l.selectedCalendar}])},[t[32]||(t[32]=(0,s.Lk)("i",{class:"fas fa-th-large text-sm w-4"},null,-1)),t[33]||(t[33]=(0,s.Lk)("span",{class:"flex-1 text-left"},"ปฏิทินทั้งหมด",-1)),l.calendarList.length>0?((0,s.uX)(),(0,s.CE)("span",{key:0,class:(0,r.C4)(["px-2 py-1 text-xs rounded-full status-badge",{"bg-blue-200 text-blue-800":!l.selectedCalendar,"bg-gray-200 text-gray-600":l.selectedCalendar}])},(0,r.v_)(l.calendarList.length),3)):(0,s.Q3)("",!0)],2)])])])])])):(0,s.Q3)("",!0)])}a(44114),a(98992),a(72577);var ve=a(40475),pe=a(40471);const fe={class:"calendar-view bg-white rounded-xl shadow-lg overflow-hidden"},me={class:"bg-gradient-to-r from-blue-600 to-blue-700 text-white p-6"},be={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},xe={class:"flex items-center gap-4"},ke={class:"text-xl md:text-2xl font-bold"},ye={class:"flex items-center gap-2 flex-wrap"},Ce=["value"],Le=["value"],we={class:"p-6"},De={class:"grid grid-cols-7 gap-1 mb-4"},Ee={class:"grid grid-cols-7 gap-1"},Te=["onDrop","onDblclick"],Ie={key:0,class:"absolute top-2 right-2"},Me={key:1,class:"mt-10 space-y-1"},_e=["onDragstart","onClick"],Ue={class:"flex items-center gap-1"},Se={key:0,class:"fas fa-star text-yellow-300 text-xs"},je={class:"truncate"},Fe={key:2,class:"absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-100 transition-opacity duration-200"},$e={class:"bg-gray-50 p-6 border-t border-gray-200"},Xe={class:"grid grid-cols-1 md:grid-cols-3 gap-4"},Oe={class:"bg-white p-4 rounded-lg shadow-sm"},Ae={class:"flex items-center gap-3"},Ye={class:"text-xl font-bold text-gray-900"},Ve={class:"bg-white p-4 rounded-lg shadow-sm"},Ke={class:"flex items-center gap-3"},Pe={class:"text-xl font-bold text-gray-900"},We={class:"bg-white p-4 rounded-lg shadow-sm"},Be={class:"flex items-center gap-3"},Qe={class:"text-xl font-bold text-gray-900"},ze={key:0,class:"fixed inset-0 flex items-center justify-center z-50 modal-overlay"},Re={class:"bg-white rounded-xl p-6 shadow-2xl max-w-2xl w-full mx-4 relative modal-content max-h-[90vh] overflow-y-auto"},qe={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200"},Ne={class:"flex items-center gap-3"},He={class:"text-xl font-semibold text-gray-900"},Je={class:"text-sm text-gray-500"},Ge={class:"space-y-4"},Ze={class:"space-y-4"},et={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},tt={class:"space-y-4"},at={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},st=["value"],nt={class:"flex items-center p-3 bg-gray-50 rounded-lg"},lt={class:"relative inline-flex items-center cursor-pointer"},ot={class:"flex flex-wrap gap-2 p-3 bg-gray-50 rounded-lg"},rt=["onUpdate:modelValue","value"],it={key:0,class:"fas fa-check text-white text-xs"},ct={class:"flex items-center justify-between pt-6 border-t border-gray-200"},dt={class:"flex items-center gap-3"},ut={type:"submit",class:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2"},gt={class:"bg-white border-t border-gray-200 p-6"},ht={class:"flex items-center gap-3"};function vt(e,t,a,n,l,o){const c=(0,s.g2)("event-view"),d=(0,s.g2)("task-view");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.Lk)("div",fe,[(0,s.Lk)("div",me,[(0,s.Lk)("div",be,[(0,s.Lk)("div",xe,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.goBackToList&&o.goBackToList(...e)),class:"flex items-center gap-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-all duration-200 backdrop-blur-sm"},t[24]||(t[24]=[(0,s.Lk)("i",{class:"fas fa-arrow-left"},null,-1),(0,s.Lk)("span",{class:"hidden sm:inline"},"กลับไปรายการ",-1)])),t[25]||(t[25]=(0,s.Lk)("div",{class:"h-8 w-px bg-white/30"},null,-1)),(0,s.Lk)("h2",ke,(0,r.v_)(o.currentMonthYear),1)]),(0,s.Lk)("div",ye,[(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.previousMonth&&o.previousMonth(...e)),class:"p-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-all duration-200"},t[26]||(t[26]=[(0,s.Lk)("i",{class:"fas fa-chevron-left"},null,-1)])),(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>o.goToToday&&o.goToToday(...e)),class:"px-4 py-2 bg-white text-blue-600 hover:bg-blue-50 rounded-lg font-medium transition-all duration-200"}," วันนี้ "),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[3]||(t[3]=e=>l.selectedMonth=e),onChange:t[4]||(t[4]=(...e)=>o.fetchCalendarEvents&&o.fetchCalendarEvents(...e)),class:"px-3 py-2 bg-white/20 backdrop-blur-sm text-white rounded-lg border border-white/30 focus:outline-none focus:ring-2 focus:ring-white/50"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.months,((e,t)=>((0,s.uX)(),(0,s.CE)("option",{key:t,value:t,class:"text-gray-900"},(0,r.v_)(e),9,Ce)))),128))],544),[[i.u1,l.selectedMonth]]),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>l.selectedYear=e),onChange:t[6]||(t[6]=(...e)=>o.fetchCalendarEvents&&o.fetchCalendarEvents(...e)),class:"px-3 py-2 bg-white/20 backdrop-blur-sm text-white rounded-lg border border-white/30 focus:outline-none focus:ring-2 focus:ring-white/50"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.yearOptions,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e,class:"text-gray-900"},(0,r.v_)(e+543),9,Le)))),128))],544),[[i.u1,l.selectedYear]]),(0,s.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>o.nextMonth&&o.nextMonth(...e)),class:"p-2 bg-white/20 hover:bg-white/30 text-white rounded-lg transition-all duration-200"},t[27]||(t[27]=[(0,s.Lk)("i",{class:"fas fa-chevron-right"},null,-1)]))])])]),(0,s.Lk)("div",we,[(0,s.Lk)("div",De,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.daysOfWeek,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e,class:"text-center text-sm font-semibold text-gray-600 py-3 bg-gray-50 rounded-lg"},(0,r.v_)(e),1)))),128))]),(0,s.Lk)("div",Ee,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.flattenedDays,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:(0,r.C4)(["relative min-h-[120px] p-2 border border-gray-100 rounded-lg cursor-pointer day-block transition-all duration-200 hover:shadow-md",{"bg-blue-50 border-blue-200 shadow-md":o.isToday(e),"opacity-30 cursor-not-allowed bg-gray-50":!e,"bg-gray-50":o.isWeekend(a)&&e,"hover:bg-blue-50 hover:border-blue-200":e&&!o.isToday(e)}]),onDragover:t[8]||(t[8]=(0,i.D$)((()=>{}),["prevent"])),onDragenter:t[9]||(t[9]=(0,i.D$)((()=>{}),["prevent"])),onDrop:t=>o.onDrop(e),onDblclick:t=>o.createNewEvent(e)},[e?((0,s.uX)(),(0,s.CE)("div",Ie,[(0,s.Lk)("span",{class:(0,r.C4)(["inline-flex items-center justify-center w-8 h-8 text-sm font-semibold rounded-full transition-all",{"bg-blue-600 text-white shadow-lg":o.isToday(e),"text-gray-700 hover:bg-blue-100":!o.isToday(e)}])},(0,r.v_)(e),3)])):(0,s.Q3)("",!0),e?((0,s.uX)(),(0,s.CE)("div",Me,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.getEventsForDate(e),(e=>((0,s.uX)(),(0,s.CE)(s.FK,{key:e?._id},[e?((0,s.uX)(),(0,s.CE)("div",{key:0,style:(0,r.Tr)({backgroundColor:o.getColorCode(e.color)}),class:"text-white text-xs rounded-md px-2 py-1 cursor-pointer event-item transition-all duration-200 hover:shadow-md hover:scale-105",onDragstart:t=>o.onDragStart(t,e),draggable:"true",onClick:(0,i.D$)((t=>o.editTask(e)),["stop"])},[(0,s.Lk)("div",Ue,[e.priority?((0,s.uX)(),(0,s.CE)("i",Se)):(0,s.Q3)("",!0),(0,s.Lk)("span",je,(0,r.v_)(e?.title||"ไม่มีชื่อ"),1)])],44,_e)):(0,s.Q3)("",!0)],64)))),128))])):(0,s.Q3)("",!0),e&&0===o.getEventsForDate(e).length?((0,s.uX)(),(0,s.CE)("div",Fe,t[28]||(t[28]=[(0,s.Lk)("div",{class:"text-gray-400 text-xs text-center"},[(0,s.Lk)("i",{class:"fas fa-plus mb-1"}),(0,s.Lk)("div",null,"เพิ่มกิจกรรม")],-1)]))):(0,s.Q3)("",!0)],42,Te)))),128))])]),(0,s.Lk)("div",$e,[t[35]||(t[35]=(0,s.Lk)("h3",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-chart-bar text-blue-600"}),(0,s.eW)(" สถิติวันว่าง ")],-1)),(0,s.Lk)("div",Xe,[(0,s.Lk)("div",Oe,[(0,s.Lk)("div",Ae,[t[30]||(t[30]=(0,s.Lk)("div",{class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-calendar text-blue-600"})],-1)),(0,s.Lk)("div",null,[t[29]||(t[29]=(0,s.Lk)("p",{class:"text-sm text-gray-600"},"วันว่างทั้งหมด",-1)),(0,s.Lk)("p",Ye,(0,r.v_)(o.freeDays.freeDaysIncludingWeekends),1)])])]),(0,s.Lk)("div",Ve,[(0,s.Lk)("div",Ke,[t[32]||(t[32]=(0,s.Lk)("div",{class:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-briefcase text-green-600"})],-1)),(0,s.Lk)("div",null,[t[31]||(t[31]=(0,s.Lk)("p",{class:"text-sm text-gray-600"},"วันทำงานว่าง",-1)),(0,s.Lk)("p",Pe,(0,r.v_)(o.freeDays.freeDaysOnlyWeekdays),1)])])]),(0,s.Lk)("div",We,[(0,s.Lk)("div",Be,[t[34]||(t[34]=(0,s.Lk)("div",{class:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-home text-purple-600"})],-1)),(0,s.Lk)("div",null,[t[33]||(t[33]=(0,s.Lk)("p",{class:"text-sm text-gray-600"},"วันหยุดว่าง",-1)),(0,s.Lk)("p",Qe,(0,r.v_)(o.freeDays.freeWeekendDays),1)])])])])]),l.showEventConfig?((0,s.uX)(),(0,s.CE)("div",ze,[(0,s.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:t[10]||(t[10]=(...e)=>o.closeEventConfig&&o.closeEventConfig(...e))}),(0,s.Lk)("div",Re,[(0,s.Lk)("div",qe,[(0,s.Lk)("div",Ne,[t[36]||(t[36]=(0,s.Lk)("div",{class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-calendar-plus text-blue-600"})],-1)),(0,s.Lk)("div",null,[(0,s.Lk)("h2",He,(0,r.v_)(l.isEditingEvent?"แก้ไขกิจกรรม":"เพิ่มกิจกรรมใหม่"),1),(0,s.Lk)("p",Je,(0,r.v_)(l.isEditingEvent?"ปรับแต่งรายละเอียดกิจกรรม":"สร้างกิจกรรมใหม่ในปฏิทิน"),1)])]),(0,s.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>o.closeEventConfig&&o.closeEventConfig(...e)),class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},t[37]||(t[37]=[(0,s.Lk)("i",{class:"fas fa-times text-lg"},null,-1)]))]),(0,s.Lk)("form",{onSubmit:t[21]||(t[21]=(0,i.D$)(((...e)=>o.saveEvent&&o.saveEvent(...e)),["prevent"])),class:"space-y-6"},[(0,s.Lk)("div",Ge,[t[40]||(t[40]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-info-circle text-blue-500"}),(0,s.eW)(" ข้อมูลพื้นฐาน ")],-1)),(0,s.Lk)("div",null,[t[38]||(t[38]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ชื่อกิจกรรม *",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[12]||(t[12]=e=>l.eventData.title=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",type:"text",placeholder:"เช่น ประชุมทีม, งานเลี้ยง",required:""},null,512),[[i.Jo,l.eventData.title]])]),(0,s.Lk)("div",null,[t[39]||(t[39]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"รายละเอียด",-1)),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[13]||(t[13]=e=>l.eventData.description=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",rows:"3",placeholder:"อธิบายรายละเอียดของกิจกรรม..."},null,512),[[i.Jo,l.eventData.description]])])]),(0,s.Lk)("div",Ze,[t[43]||(t[43]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-clock text-green-500"}),(0,s.eW)(" วันที่และเวลา ")],-1)),(0,s.Lk)("div",et,[(0,s.Lk)("div",null,[t[41]||(t[41]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"วันที่เริ่มต้น",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[14]||(t[14]=e=>l.eventData.startDate=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",type:"date"},null,512),[[i.Jo,l.eventData.startDate]])]),(0,s.Lk)("div",null,[t[42]||(t[42]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"วันที่สิ้นสุด",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[15]||(t[15]=e=>l.eventData.endDate=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",type:"date"},null,512),[[i.Jo,l.eventData.endDate]])])])]),(0,s.Lk)("div",tt,[t[50]||(t[50]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-cog text-purple-500"}),(0,s.eW)(" การตั้งค่า ")],-1)),(0,s.Lk)("div",at,[(0,s.Lk)("div",null,[t[44]||(t[44]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ประเภทกิจกรรม",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[16]||(t[16]=e=>l.eventData.type=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.types,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e.value,value:e.value},(0,r.v_)(e.label),9,st)))),128))],512),[[i.u1,l.eventData.type]])]),(0,s.Lk)("div",null,[t[47]||(t[47]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ความสำคัญ",-1)),(0,s.Lk)("div",nt,[(0,s.Lk)("label",lt,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[17]||(t[17]=e=>l.eventData.priority=e),type:"checkbox",class:"sr-only peer"},null,512),[[i.lH,l.eventData.priority]]),t[45]||(t[45]=(0,s.Lk)("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1)),t[46]||(t[46]=(0,s.Lk)("span",{class:"ml-3 text-sm font-medium text-gray-700"},"ความสำคัญสูง",-1))])])])]),(0,s.Lk)("div",null,[t[48]||(t[48]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"สถานที่",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[18]||(t[18]=e=>l.eventData.location=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",type:"text",placeholder:"เช่น ห้องประชุม A, ออนไลน์"},null,512),[[i.Jo,l.eventData.location]])]),(0,s.Lk)("div",null,[t[49]||(t[49]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"สีกิจกรรม",-1)),(0,s.Lk)("div",ot,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.colors,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.value,style:(0,r.Tr)({backgroundColor:e.colorCode}),class:(0,r.C4)(["color-circle cursor-pointer w-8 h-8 rounded-full flex items-center justify-center transition-all hover:scale-110 hover:shadow-lg",{"ring-2 ring-offset-2 ring-blue-500":l.eventData.color===e.value}])},[(0,s.bo)((0,s.Lk)("input",{type:"radio","onUpdate:modelValue":e=>l.eventData.color=e,value:e.value,class:"hidden"},null,8,rt),[[i.XL,l.eventData.color]]),l.eventData.color===e.value?((0,s.uX)(),(0,s.CE)("i",it)):(0,s.Q3)("",!0)],6)))),128))])])]),(0,s.Lk)("div",ct,[(0,s.Lk)("div",dt,[(0,s.Lk)("button",{type:"button",onClick:t[19]||(t[19]=(...e)=>o.closeEventConfig&&o.closeEventConfig(...e)),class:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors"}," ยกเลิก "),(0,s.Lk)("button",ut,[t[51]||(t[51]=(0,s.Lk)("i",{class:"fas fa-save"},null,-1)),(0,s.eW)(" "+(0,r.v_)(l.isEditingEvent?"บันทึกการเปลี่ยนแปลง":"สร้างกิจกรรม"),1)])]),l.isEditingEvent?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:t[20]||(t[20]=(0,i.D$)(((...e)=>o.deleteEvent&&o.deleteEvent(...e)),["prevent"])),class:"px-6 py-3 bg-red-600 hover:bg-red-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2"},t[52]||(t[52]=[(0,s.Lk)("i",{class:"fas fa-trash"},null,-1),(0,s.eW)(" ลบกิจกรรม ")]))):(0,s.Q3)("",!0)])],32)])])):(0,s.Q3)("",!0),(0,s.Lk)("div",gt,[t[54]||(t[54]=(0,s.Lk)("h3",{class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-share-alt text-indigo-600"}),(0,s.eW)(" แชร์ปฏิทินสาธารณะ ")],-1)),(0,s.Lk)("div",ht,[(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[22]||(t[22]=e=>o.apiUrl=e),readonly:"",class:"flex-1 px-4 py-3 border border-gray-200 rounded-lg bg-gray-50 text-gray-600 text-sm",placeholder:"URL สำหรับแชร์ปฏิทิน"},null,512),[[i.Jo,o.apiUrl]]),(0,s.Lk)("button",{onClick:t[23]||(t[23]=(...e)=>o.copyToClipboard&&o.copyToClipboard(...e)),class:"px-6 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2"},t[53]||(t[53]=[(0,s.Lk)("i",{class:"fas fa-copy"},null,-1),(0,s.eW)(" คัดลอก ")]))])])]),(0,s.bF)(c,{"event-list":l.localEventList,"current-calendar":l.currentCalendar,onEditEvent:o.editTask},null,8,["event-list","current-calendar","onEditEvent"]),(0,s.bF)(d,{"event-list":l.localEventList,"current-calendar":l.currentCalendar,onEditEvent:o.editTask},null,8,["event-list","current-calendar","onEditEvent"])],64)}a(54520);const pt={class:"event-view bg-white rounded-xl shadow-lg overflow-hidden mt-6"},ft={class:"bg-gradient-to-r from-green-600 to-green-700 text-white p-6"},mt={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},bt={class:"flex items-center gap-3"},xt=["value"],kt={class:"p-6"},yt={key:0,class:"text-center py-12"},Ct={key:1},Lt={class:"grid grid-cols-2 md:grid-cols-4 gap-4 mb-8"},wt={class:"bg-gradient-to-br from-blue-50 to-blue-100 p-4 rounded-xl border border-blue-200"},Dt={class:"flex items-center gap-3"},Et={class:"text-2xl font-bold text-blue-700"},Tt={class:"bg-gradient-to-br from-yellow-50 to-yellow-100 p-4 rounded-xl border border-yellow-200"},It={class:"flex items-center gap-3"},Mt={class:"text-2xl font-bold text-yellow-700"},_t={class:"bg-gradient-to-br from-red-50 to-red-100 p-4 rounded-xl border border-red-200"},Ut={class:"flex items-center gap-3"},St={class:"text-2xl font-bold text-red-700"},jt={class:"bg-gradient-to-br from-purple-50 to-purple-100 p-4 rounded-xl border border-purple-200"},Ft={class:"flex items-center gap-3"},$t={class:"text-2xl font-bold text-purple-700"},Xt={class:"space-y-6"},Ot={class:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2"},At={class:"ml-auto text-sm font-normal text-gray-500"},Yt={class:"space-y-3"},Vt={class:"grid grid-cols-1 md:grid-cols-3 gap-4 items-start"},Kt={class:"flex flex-col gap-2"},Pt={class:"flex items-center gap-2"},Wt={class:"text-sm font-medium text-gray-700"},Bt={key:0},Qt={key:1},zt={key:0,class:"fas fa-star text-yellow-500 text-xs"},Rt={key:0,class:"flex items-center gap-2 text-sm text-gray-500"},qt={class:"flex flex-col gap-1"},Nt={class:"font-semibold text-gray-900"},Ht={key:0,class:"text-sm text-gray-600 line-clamp-2"},Jt={class:"flex items-center gap-2 mt-2"},Gt={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Zt={class:"flex items-center justify-end"},ea=["onClick"];function ta(e,t,a,n,l,o){return(0,s.uX)(),(0,s.CE)("div",pt,[(0,s.Lk)("div",ft,[(0,s.Lk)("div",mt,[t[4]||(t[4]=(0,s.Fv)('<div class="flex items-center gap-3" data-v-09b7bf8d><div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center" data-v-09b7bf8d><i class="fas fa-calendar-alt text-white" data-v-09b7bf8d></i></div><div data-v-09b7bf8d><h2 class="text-xl font-bold" data-v-09b7bf8d>รายการกิจกรรม</h2><p class="text-green-100 text-sm" data-v-09b7bf8d>จัดการและติดตามกิจกรรมทั้งหมด</p></div></div>',1)),(0,s.Lk)("div",bt,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.fetchCalendarEvents&&o.fetchCalendarEvents(...e)),class:"flex items-center gap-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-all duration-200"},t[3]||(t[3]=[(0,s.Lk)("i",{class:"fas fa-sync-alt"},null,-1),(0,s.Lk)("span",{class:"hidden sm:inline"},"รีเฟรช",-1)])),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[1]||(t[1]=e=>l.selectedYear=e),onChange:t[2]||(t[2]=(...e)=>o.updateYear&&o.updateYear(...e)),class:"px-3 py-2 bg-white/20 backdrop-blur-sm text-white rounded-lg border border-white/30 focus:outline-none focus:ring-2 focus:ring-white/50"},[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.yearOptions,(e=>((0,s.uX)(),(0,s.CE)("option",{key:e,value:e,class:"text-gray-900"},(0,r.v_)(e+543),9,xt)))),128))],544),[[i.u1,l.selectedYear]])])])]),(0,s.Lk)("div",kt,[0===o.filteredEventList.length?((0,s.uX)(),(0,s.CE)("div",yt,t[5]||(t[5]=[(0,s.Lk)("div",{class:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-4"},[(0,s.Lk)("i",{class:"fas fa-calendar-times text-gray-400 text-2xl"})],-1),(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-2"},"ไม่มีกิจกรรม",-1),(0,s.Lk)("p",{class:"text-gray-500"},"ยังไม่มีกิจกรรมในปีที่เลือก",-1)]))):((0,s.uX)(),(0,s.CE)("div",Ct,[(0,s.Lk)("div",Lt,[(0,s.Lk)("div",wt,[(0,s.Lk)("div",Dt,[t[7]||(t[7]=(0,s.Lk)("div",{class:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-calendar text-white text-sm"})],-1)),(0,s.Lk)("div",null,[t[6]||(t[6]=(0,s.Lk)("p",{class:"text-sm text-blue-600 font-medium"},"กิจกรรมทั้งหมด",-1)),(0,s.Lk)("p",Et,(0,r.v_)(o.totalTasks),1)])])]),(0,s.Lk)("div",Tt,[(0,s.Lk)("div",It,[t[9]||(t[9]=(0,s.Lk)("div",{class:"w-10 h-10 bg-yellow-500 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-clock text-white text-sm"})],-1)),(0,s.Lk)("div",null,[t[8]||(t[8]=(0,s.Lk)("p",{class:"text-sm text-yellow-600 font-medium"},"กำลังดำเนินการ",-1)),(0,s.Lk)("p",Mt,(0,r.v_)(o.tasksInProgress),1)])])]),(0,s.Lk)("div",_t,[(0,s.Lk)("div",Ut,[t[11]||(t[11]=(0,s.Lk)("div",{class:"w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-exclamation-triangle text-white text-sm"})],-1)),(0,s.Lk)("div",null,[t[10]||(t[10]=(0,s.Lk)("p",{class:"text-sm text-red-600 font-medium"},"เกินกำหนด",-1)),(0,s.Lk)("p",St,(0,r.v_)(o.overdueTasks),1)])])]),(0,s.Lk)("div",jt,[(0,s.Lk)("div",Ft,[t[13]||(t[13]=(0,s.Lk)("div",{class:"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-calendar-week text-white text-sm"})],-1)),(0,s.Lk)("div",null,[t[12]||(t[12]=(0,s.Lk)("p",{class:"text-sm text-purple-600 font-medium"},"7 วันข้างหน้า",-1)),(0,s.Lk)("p",$t,(0,r.v_)(o.upcomingTasks),1)])])])]),(0,s.Lk)("div",Xt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.groupedEvents,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"bg-gray-50 rounded-xl p-6"},[(0,s.Lk)("h3",Ot,[t[14]||(t[14]=(0,s.Lk)("i",{class:"fas fa-calendar-alt text-blue-600"},null,-1)),(0,s.eW)(" "+(0,r.v_)(o.formatMonthYear(a))+" ",1),(0,s.Lk)("span",At,(0,r.v_)(e.length)+" กิจกรรม",1)]),(0,s.Lk)("div",Yt,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e._id,class:(0,r.C4)(["bg-white rounded-lg p-4 border border-gray-200 hover:shadow-md transition-all duration-200 event-card",{"ring-2 ring-red-200 bg-red-50":e.priority}])},[(0,s.Lk)("div",Vt,[(0,s.Lk)("div",Kt,[(0,s.Lk)("div",Pt,[(0,s.Lk)("span",{class:"inline-block w-3 h-3 rounded-full",style:(0,r.Tr)({backgroundColor:o.getColorCode(e.color)})},null,4),(0,s.Lk)("span",Wt,[o.isSameDate(e.startDate,e.endDate)?((0,s.uX)(),(0,s.CE)("span",Bt,(0,r.v_)(o.formatDate(e.startDate)),1)):((0,s.uX)(),(0,s.CE)("span",Qt,(0,r.v_)(o.formatDateRange(e.startDate,e.endDate)),1))]),e.priority?((0,s.uX)(),(0,s.CE)("i",zt)):(0,s.Q3)("",!0)]),e.location?((0,s.uX)(),(0,s.CE)("div",Rt,[t[15]||(t[15]=(0,s.Lk)("i",{class:"fas fa-map-marker-alt text-xs"},null,-1)),(0,s.Lk)("span",null,(0,r.v_)(e.location),1)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",qt,[(0,s.Lk)("h4",Nt,(0,r.v_)(e.title),1),e.description?((0,s.uX)(),(0,s.CE)("p",Ht,(0,r.v_)(e.description),1)):(0,s.Q3)("",!0),(0,s.Lk)("div",Jt,[(0,s.Lk)("span",Gt,(0,r.v_)(o.getTypeLabel(e.type)),1)])]),(0,s.Lk)("div",Zt,[(0,s.Lk)("button",{onClick:t=>o.editEvent(e),class:"flex items-center gap-2 bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-medium transition-colors duration-200"},t[16]||(t[16]=[(0,s.Lk)("i",{class:"fas fa-edit text-sm"},null,-1),(0,s.Lk)("span",{class:"hidden sm:inline"},"แก้ไข",-1)]),8,ea)])])],2)))),128))])])))),128))])]))])])}a(3949);const aa=new pe.A(!1);var sa={props:{eventList:{type:Array,required:!0},currentCalendar:Object},data(){return{selectedYear:(new Date).getFullYear(),localEventList:[],selectedMonth:0,configs:ve.A.get("configs")}},computed:{yearOptions(){const e=(new Date).getFullYear(),t=e-2,a=e+2,s=[];for(let n=t;n<=a;n++)s.push(n);return s},filteredEventList(){return this.localEventList.filter((e=>new Date(e.startDate).getFullYear()===this.selectedYear))},groupedEvents(){const e={};this.filteredEventList.forEach((t=>{const a=new Date(t.startDate),s=`${a.getFullYear()}-${a.getMonth()}`;e[s]||(e[s]=[]),e[s].push(t)}));for(const t in e)e[t].sort(((e,t)=>new Date(e.startDate)-new Date(t.startDate)));return e},totalTasks(){return this.filteredEventList.length},tasksInProgress(){const e=new Date;return this.filteredEventList.filter((t=>{const a=new Date(t.startDate),s=new Date(t.endDate);return e>=a&&e<=s})).length},overdueTasks(){const e=new Date;return this.filteredEventList.filter((t=>new Date(t.endDate)<e)).length},upcomingTasks(){const e=new Date,t=new Date(e);return t.setDate(e.getDate()+7),this.filteredEventList.filter((a=>{const s=new Date(a.startDate);return s>e&&s<=t})).length}},methods:{formatDate(e){const t={year:"numeric",month:"long",day:"numeric"};return new Date(e).toLocaleDateString(void 0,t)},formatDateRange(e,t){const a=new Date(e),s=new Date(t),n=a.getMonth()===s.getMonth()&&a.getFullYear()===s.getFullYear();if(n){const e=a.getDate(),t=s.getDate();return`${a.toLocaleDateString(void 0,{month:"long"})} ${e}-${t}, ${a.getFullYear()}`}return`${this.formatDate(e)} - ${this.formatDate(t)}`},isSameDate(e,t){const a=new Date(e),s=new Date(t);return a.toDateString()===s.toDateString()},formatMonthYear(e){const[t,a]=e.split("-"),s=new Date(t,a),n={year:"numeric",month:"long"};return s.toLocaleDateString(void 0,n)},async fetchCalendarEvents(){try{const e=new Date(this.selectedYear,0,1),t=new Date(this.selectedYear,11,31),a=await aa.POST("calendar_event/query",{method:"find",args:[{calendarId:this.currentCalendar._id,$or:[{startDate:{$gte:e,$lte:t}},{endDate:{$gte:e,$lte:t}}]}]},this.configs.key);200===a.status&&(this.localEventList=a.data,console.log(this.localEventList))}catch(e){console.error("Error fetching events:",e)}},updateYear(){this.fetchCalendarEvents()},editEvent(e){this.$emit("editEvent",e)},getColorCode(e){const t=[{value:"pink",colorCode:"#f28b82"},{value:"red",colorCode:"#ea4335"},{value:"orange",colorCode:"#fbbc04"},{value:"yellow",colorCode:"#fdd835"},{value:"green",colorCode:"#81c995"},{value:"lightBlue",colorCode:"#aecbfa"},{value:"blue",colorCode:"#4285f4"},{value:"purple",colorCode:"#aa66cc"},{value:"gray",colorCode:"#9e9e9e"},{value:"black",colorCode:"#000000"}],a=t.find((t=>t.value===e));return a?a.colorCode:"#4285f4"},getTypeLabel(e){const t={event:"กิจกรรม",todo:"สิ่งที่ต้องทำ",job:"งาน",work:"ทำงาน",remind:"เตือนความจำ"};return t[e]||e}},mounted(){this.fetchCalendarEvents()}},na=a(64621);const la=(0,na.A)(sa,[["render",ta],["__scopeId","data-v-09b7bf8d"]]);var oa=la;const ra={class:"kanban-board bg-white rounded-xl shadow-lg overflow-hidden mt-6"},ia={class:"bg-gradient-to-r from-purple-600 to-purple-700 text-white p-6"},ca={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-4"},da={class:"p-6"},ua={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},ga={class:"kanban-column"},ha={class:"column-header bg-gradient-to-r from-red-500 to-red-600 text-white p-4 rounded-lg mb-4"},va={class:"flex items-center justify-between"},pa={class:"bg-white/20 px-2 py-1 rounded-full text-sm"},fa={class:"space-y-3 max-h-96 overflow-y-auto"},ma={key:0,class:"text-center py-8 text-gray-500"},ba={class:"flex items-start justify-between mb-2"},xa={class:"font-semibold text-gray-900 flex-1"},ka={class:"text-sm text-gray-600 mb-2"},ya={class:"flex items-center gap-1 mb-1"},Ca={class:"flex items-center gap-1 text-red-500"},La={key:0,class:"text-sm text-gray-600 line-clamp-2"},wa={class:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100"},Da={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800"},Ea=["onClick"],Ta={class:"kanban-column"},Ia={class:"column-header bg-gradient-to-r from-blue-500 to-blue-600 text-white p-4 rounded-lg mb-4"},Ma={class:"flex items-center justify-between"},_a={class:"bg-white/20 px-2 py-1 rounded-full text-sm"},Ua={class:"space-y-3 max-h-96 overflow-y-auto"},Sa={key:0,class:"text-center py-8 text-gray-500"},ja={class:"flex items-start justify-between mb-2"},Fa={class:"font-semibold text-gray-900 flex-1"},$a={class:"text-sm text-gray-600 mb-2"},Xa={class:"flex items-center gap-1"},Oa={key:0,class:"text-sm text-gray-600 line-clamp-2"},Aa={class:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100"},Ya={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-blue-100 text-blue-800"},Va=["onClick"],Ka={class:"kanban-column"},Pa={class:"column-header bg-gradient-to-r from-green-500 to-green-600 text-white p-4 rounded-lg mb-4"},Wa={class:"flex items-center justify-between"},Ba={class:"bg-white/20 px-2 py-1 rounded-full text-sm"},Qa={class:"space-y-3 max-h-96 overflow-y-auto"},za={key:0,class:"text-center py-8 text-gray-500"},Ra={class:"flex items-start justify-between mb-2"},qa={class:"font-semibold text-gray-900 flex-1"},Na={class:"text-sm text-gray-600 mb-2"},Ha={class:"flex items-center gap-1 mb-1"},Ja={class:"flex items-center gap-1 text-green-600"},Ga={key:0,class:"text-sm text-gray-600 line-clamp-2"},Za={class:"flex items-center justify-between mt-3 pt-3 border-t border-gray-100"},es={class:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800"},ts=["onClick"];function as(e,t,a,n,l,o){return(0,s.uX)(),(0,s.CE)("div",ra,[(0,s.Lk)("div",ia,[(0,s.Lk)("div",ca,[t[2]||(t[2]=(0,s.Fv)('<div class="flex items-center gap-3" data-v-4badea6a><div class="w-10 h-10 bg-white/20 rounded-lg flex items-center justify-center" data-v-4badea6a><i class="fas fa-tasks text-white" data-v-4badea6a></i></div><div data-v-4badea6a><h2 class="text-xl font-bold" data-v-4badea6a>Kanban Board</h2><p class="text-purple-100 text-sm" data-v-4badea6a>จัดการงานแบบ Kanban</p></div></div>',1)),(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>o.fetchCalendarEvents&&o.fetchCalendarEvents(...e)),class:"flex items-center gap-2 bg-white/20 hover:bg-white/30 text-white px-4 py-2 rounded-lg transition-all duration-200"},t[1]||(t[1]=[(0,s.Lk)("i",{class:"fas fa-sync-alt"},null,-1),(0,s.Lk)("span",{class:"hidden sm:inline"},"รีเฟรช",-1)]))])]),(0,s.Lk)("div",da,[(0,s.Lk)("div",ua,[(0,s.Lk)("div",ga,[(0,s.Lk)("div",ha,[(0,s.Lk)("div",va,[t[3]||(t[3]=(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-exclamation-triangle"}),(0,s.Lk)("h3",{class:"font-semibold"},"เกินกำหนด")],-1)),(0,s.Lk)("span",pa,(0,r.v_)(o.overdueTasks.length),1)])]),(0,s.Lk)("div",fa,[0===o.overdueTasks.length?((0,s.uX)(),(0,s.CE)("div",ma,t[4]||(t[4]=[(0,s.Lk)("i",{class:"fas fa-check-circle text-3xl mb-2"},null,-1),(0,s.Lk)("p",null,"ไม่มีงานเกินกำหนด",-1)]))):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.overdueTasks,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e._id,class:"kanban-task bg-white border border-red-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-all duration-200"},[(0,s.Lk)("div",ba,[(0,s.Lk)("h4",xa,(0,r.v_)(e.title),1),(0,s.Lk)("span",{class:"w-3 h-3 rounded-full flex-shrink-0 ml-2",style:(0,r.Tr)({backgroundColor:o.getColorCode(e.color)})},null,4)]),(0,s.Lk)("div",ka,[(0,s.Lk)("div",ya,[t[5]||(t[5]=(0,s.Lk)("i",{class:"fas fa-calendar text-xs"},null,-1)),(0,s.Lk)("span",null,(0,r.v_)(o.formatDate(e.startDate))+" - "+(0,r.v_)(o.formatDate(e.endDate)),1)]),(0,s.Lk)("div",Ca,[t[6]||(t[6]=(0,s.Lk)("i",{class:"fas fa-clock text-xs"},null,-1)),(0,s.Lk)("span",null,"เกิน "+(0,r.v_)(o.daysAgo(e.endDate))+" วัน",1)])]),e.description?((0,s.uX)(),(0,s.CE)("p",La,(0,r.v_)(e.description),1)):(0,s.Q3)("",!0),(0,s.Lk)("div",wa,[(0,s.Lk)("span",Da,(0,r.v_)(o.getTypeLabel(e.type)),1),(0,s.Lk)("button",{onClick:t=>o.editTask(e),class:"text-blue-600 hover:text-blue-700 text-sm font-medium"}," แก้ไข ",8,Ea)])])))),128))])]),(0,s.Lk)("div",Ta,[(0,s.Lk)("div",Ia,[(0,s.Lk)("div",Ma,[t[7]||(t[7]=(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-play-circle"}),(0,s.Lk)("h3",{class:"font-semibold"},"กำลังดำเนินการ")],-1)),(0,s.Lk)("span",_a,(0,r.v_)(o.tasksInProgress.length),1)])]),(0,s.Lk)("div",Ua,[0===o.tasksInProgress.length?((0,s.uX)(),(0,s.CE)("div",Sa,t[8]||(t[8]=[(0,s.Lk)("i",{class:"fas fa-plus-circle text-3xl mb-2"},null,-1),(0,s.Lk)("p",null,"ไม่มีงานที่กำลังดำเนินการ",-1)]))):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.tasksInProgress,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e._id,class:"kanban-task bg-white border border-blue-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-all duration-200"},[(0,s.Lk)("div",ja,[(0,s.Lk)("h4",Fa,(0,r.v_)(e.title),1),(0,s.Lk)("span",{class:"w-3 h-3 rounded-full flex-shrink-0 ml-2",style:(0,r.Tr)({backgroundColor:o.getColorCode(e.color)})},null,4)]),(0,s.Lk)("div",$a,[(0,s.Lk)("div",Xa,[t[9]||(t[9]=(0,s.Lk)("i",{class:"fas fa-calendar text-xs"},null,-1)),(0,s.Lk)("span",null,(0,r.v_)(o.formatDate(e.startDate))+" - "+(0,r.v_)(o.formatDate(e.endDate)),1)])]),e.description?((0,s.uX)(),(0,s.CE)("p",Oa,(0,r.v_)(e.description),1)):(0,s.Q3)("",!0),(0,s.Lk)("div",Aa,[(0,s.Lk)("span",Ya,(0,r.v_)(o.getTypeLabel(e.type)),1),(0,s.Lk)("button",{onClick:t=>o.editTask(e),class:"text-blue-600 hover:text-blue-700 text-sm font-medium"}," แก้ไข ",8,Va)])])))),128))])]),(0,s.Lk)("div",Ka,[(0,s.Lk)("div",Pa,[(0,s.Lk)("div",Wa,[t[10]||(t[10]=(0,s.Lk)("div",{class:"flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-calendar-week"}),(0,s.Lk)("h3",{class:"font-semibold"},"7 วันข้างหน้า")],-1)),(0,s.Lk)("span",Ba,(0,r.v_)(o.upcomingTasks.length),1)])]),(0,s.Lk)("div",Qa,[0===o.upcomingTasks.length?((0,s.uX)(),(0,s.CE)("div",za,t[11]||(t[11]=[(0,s.Lk)("i",{class:"fas fa-calendar-check text-3xl mb-2"},null,-1),(0,s.Lk)("p",null,"ไม่มีงานในสัปดาห์นี้",-1)]))):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.upcomingTasks,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e._id,class:"kanban-task bg-white border border-green-200 rounded-lg p-4 shadow-sm hover:shadow-md transition-all duration-200"},[(0,s.Lk)("div",Ra,[(0,s.Lk)("h4",qa,(0,r.v_)(e.title),1),(0,s.Lk)("span",{class:"w-3 h-3 rounded-full flex-shrink-0 ml-2",style:(0,r.Tr)({backgroundColor:o.getColorCode(e.color)})},null,4)]),(0,s.Lk)("div",Na,[(0,s.Lk)("div",Ha,[t[12]||(t[12]=(0,s.Lk)("i",{class:"fas fa-calendar text-xs"},null,-1)),(0,s.Lk)("span",null,(0,r.v_)(o.formatDate(e.startDate))+" - "+(0,r.v_)(o.formatDate(e.endDate)),1)]),(0,s.Lk)("div",Ja,[t[13]||(t[13]=(0,s.Lk)("i",{class:"fas fa-clock text-xs"},null,-1)),(0,s.Lk)("span",null,"อีก "+(0,r.v_)(o.daysUntil(e.startDate))+" วัน",1)])]),e.description?((0,s.uX)(),(0,s.CE)("p",Ga,(0,r.v_)(e.description),1)):(0,s.Q3)("",!0),(0,s.Lk)("div",Za,[(0,s.Lk)("span",es,(0,r.v_)(o.getTypeLabel(e.type)),1),(0,s.Lk)("button",{onClick:t=>o.editTask(e),class:"text-blue-600 hover:text-blue-700 text-sm font-medium"}," แก้ไข ",8,ts)])])))),128))])])])])])}const ss=new pe.A(!1);var ns={props:{currentCalendar:Object},data(){return{localEventList:[],configs:ve.A.get("configs"),currentMonth:(new Date).getMonth(),currentYear:(new Date).getFullYear()}},computed:{tasksInProgress(){const e=new Date,t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()));return this.localEventList.filter((e=>{const a=new Date(e.startDate),s=new Date(e.endDate),n=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate())),l=new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()));return t>=n&&t<=l}))},overdueTasks(){const e=new Date,t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()));return this.localEventList.filter((e=>{const a=new Date(e.endDate),s=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()));return s<t}))},upcomingTasks(){const e=new Date,t=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate())),a=new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()+7));return this.localEventList.filter((e=>{const s=new Date(e.startDate),n=new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()));return n>t&&n<=a}))}},methods:{formatDate(e){const t={year:"numeric",month:"long",day:"numeric"},a=new Date(e),s=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()));return s.toLocaleDateString(void 0,t)},daysAgo(e){const t=new Date,a=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())),s=new Date(e),n=new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate())),l=a.getTime()-n.getTime(),o=Math.ceil(l/864e5);return o},daysUntil(e){const t=new Date,a=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate())),s=new Date(e),n=new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate())),l=n.getTime()-a.getTime(),o=Math.ceil(l/864e5);return o},async fetchCalendarEvents(){try{const e=new Date(Date.UTC(this.currentYear,this.currentMonth,1)),t=new Date(Date.UTC(this.currentYear,this.currentMonth+1,0)),a=await ss.POST("calendar_event/query",{method:"find",args:[{calendarId:this.currentCalendar._id,$or:[{startDate:{$gte:e,$lte:t}},{endDate:{$gte:e,$lte:t}}]}]},this.configs.key);200===a.status&&(this.localEventList=a.data)}catch(e){console.error("Error fetching events:",e)}},getColorCode(e){const t=[{value:"pink",colorCode:"#f28b82"},{value:"red",colorCode:"#ea4335"},{value:"orange",colorCode:"#fbbc04"},{value:"yellow",colorCode:"#fdd835"},{value:"green",colorCode:"#81c995"},{value:"lightBlue",colorCode:"#aecbfa"},{value:"blue",colorCode:"#4285f4"},{value:"purple",colorCode:"#aa66cc"},{value:"gray",colorCode:"#9e9e9e"},{value:"black",colorCode:"#000000"}],a=t.find((t=>t.value===e));return a?a.colorCode:"#4285f4"},getTypeLabel(e){const t={event:"กิจกรรม",todo:"สิ่งที่ต้องทำ",job:"งาน",work:"ทำงาน",remind:"เตือนความจำ"};return t[e]||e},editTask(e){this.$emit("editEvent",e)}},mounted(){this.fetchCalendarEvents()}};const ls=(0,na.A)(ns,[["render",as],["__scopeId","data-v-4badea6a"]]);var os=ls;const rs=new pe.A(!1);var is={components:{EventView:oa,TaskView:os},props:{selectedCalendar:Object,eventList:Array},data(){return{localEventList:[],currentCalendar:this.selectedCalendar,currentDate:new Date,selectedMonth:(new Date).getMonth(),selectedYear:(new Date).getFullYear(),configs:ve.A.get("configs"),session:ve.A.get("session"),showEventConfig:!1,eventData:null,isEditingEvent:!1,colors:[{value:"pink",colorCode:"#f28b82"},{value:"red",colorCode:"#ea4335"},{value:"orange",colorCode:"#fbbc04"},{value:"yellow",colorCode:"#fdd835"},{value:"green",colorCode:"#81c995"},{value:"lightBlue",colorCode:"#aecbfa"},{value:"blue",colorCode:"#4285f4"},{value:"purple",colorCode:"#aa66cc"},{value:"gray",colorCode:"#9e9e9e"},{value:"black",colorCode:"#000000"}],types:[{value:"event",label:"Event"},{value:"todo",label:"Todo"},{value:"job",label:"Job"},{value:"work",label:"Work"},{value:"remind",label:"Remind"}]}},computed:{apiUrl(){return`https://gateway.cloudrestfulapi.com/api/appointment/${this.selectedCalendar?._id}?key=${this.configs?.key}`},currentMonthYear(){const e=["January","February","March","April","May","June","July","August","September","October","November","December"],t=e[this.selectedMonth],a=this.selectedYear+543;return`${t} ${a} BE`},freeDays(){const{freeDaysIncludingWeekends:e,freeDaysOnlyWeekdays:t}=this.calculateFreeDaysInMonth(),a=this.calculateFreeWeekendDaysInMonth();return{freeDaysIncludingWeekends:e,freeDaysOnlyWeekdays:t,freeWeekendDays:a}},daysOfWeek(){return["อา","จ","อ","พ","พฤ","ศ","ส"]},weeksInMonth(){const e=this.selectedYear,t=this.selectedMonth,a=new Date(e,t,1).getDay(),s=new Date(e,t+1,0).getDate(),n=[[]];let l=n[0];for(let o=0;o<a;o++)l.push(null);for(let o=1;o<=s;o++)7===l.length&&(l=[],n.push(l)),l.push(o);while(l.length<7)l.push(null);return n},flattenedDays(){return this.weeksInMonth.flat()},months(){return["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"]},yearOptions(){const e=(new Date).getFullYear();return[e-1,e,e+1]}},methods:{copyToClipboard(){const e=document.createElement("textarea");e.value=this.apiUrl,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),alert("URL copied to clipboard")},convertToBangkokTimezone(e){const t={timeZone:"Asia/Bangkok",year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1},a=new Intl.DateTimeFormat("en-US",t),s=a.formatToParts(e),n=s.find((e=>"year"===e.type)).value,l=s.find((e=>"month"===e.type)).value,o=s.find((e=>"day"===e.type)).value,r=s.find((e=>"hour"===e.type)).value,i=s.find((e=>"minute"===e.type)).value,c=s.find((e=>"second"===e.type)).value;return new Date(`${n}-${l}-${o}T${r}:${i}:${c}+07:00`).toISOString()},isToday(e){if(!e)return!1;const t=new Date,a=new Date(Date.UTC(this.selectedYear,this.selectedMonth,e)),s=new Date(Date.UTC(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()));return a.getTime()===s.getTime()},isWeekend(e){return e%7===0||e%7===6},async fetchCalendarEvents(){try{const e=new Date(Date.UTC(this.selectedYear,this.selectedMonth,1)),t=new Date(Date.UTC(this.selectedYear,this.selectedMonth+1,0,23,59,59,999)),a=e.toISOString(),s=t.toISOString(),n=await rs.POST("calendar_event/query",{method:"find",args:[{calendarId:this.selectedCalendar._id,$or:[{startDate:{$gte:a,$lte:s}},{endDate:{$gte:a,$lte:s}}]}]},this.configs.key);200===n.status&&(this.localEventList=n.data,console.log(this.localEventList))}catch(e){console.error("Error fetching events:",e)}},calculateFreeDaysInMonth(){const e=this.selectedYear,t=this.selectedMonth,a=new Date(e,t+1,0).getDate();let s=0,n=0;for(let l=1;l<=a;l++){const a=new Date(e,t,l),o=a.getDay(),r=this.getEventsForDate(l);0===r.length&&(s++,0!==o&&6!==o&&n++)}return{freeDaysIncludingWeekends:s,freeDaysOnlyWeekdays:n}},calculateFreeWeekendDaysInMonth(){const e=this.selectedYear,t=this.selectedMonth,a=new Date(e,t+1,0).getDate();let s=0;for(let n=1;n<=a;n++){const a=new Date(e,t,n),l=a.getDay(),o=this.getEventsForDate(n);0!==o.length||0!==l&&6!==l||s++}return s},adjustDateForTimeZone(e){const t=e.getTimezoneOffset();return new Date(e.getTime()+60*t*1e3)},getEventsForDate(e){const t=this.selectedYear,a=this.selectedMonth,s=new Date(Date.UTC(t,a,e)),n=this.localEventList.filter((t=>{const a=new Date(t.startDate),n=new Date(t.endDate);console.log("day",e),console.log("eventStartDate",a),console.log("eventEndDate",n);const l=new Date(this.convertToBangkokTimezone(a)),o=new Date(this.convertToBangkokTimezone(n));return s>=l&&s<=o}));return n},onDragStart(e,t){e.dataTransfer.setData("eventData",JSON.stringify(t))},async onDrop(e){if(!e)return;const t=JSON.parse(event.dataTransfer.getData("eventData")),a=new Date(t.startDate),s=new Date(t.endDate),n=new Date(Date.UTC(this.selectedYear,this.selectedMonth,e)),l=(n-a)/864e5,o=new Date(Date.UTC(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate()+l)),r=new Date(Date.UTC(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate()+l));this.eventData={...t,startDate:o.toISOString(),endDate:r.toISOString()};try{await this.updateEvent(),this.fetchCalendarEvents()}catch(i){console.error("Failed to update event:",i)}},formatDateForInput(e){const t=new Date(e),a=t.getFullYear(),s=("0"+(t.getMonth()+1)).slice(-2),n=("0"+t.getDate()).slice(-2);return`${a}-${s}-${n}`},editTask(e){this.eventData={...e},this.eventData.startDate=this.formatDateForInput(e.startDate),this.eventData.endDate=this.formatDateForInput(e.endDate),this.isEditingEvent=!0,this.showEventConfig=!0},closeEventConfig(){this.showEventConfig=!1,this.eventData=null,this.isEditingEvent=!1},async saveEvent(){this.isEditingEvent?await this.updateEvent():await this.addEvent()},async addEvent(){try{const e=this.convertToBangkokTimezone(new Date(this.eventData.startDate)),t=this.convertToBangkokTimezone(new Date(this.eventData.endDate)),a=await rs.POST("calendar_event/",{data:{...this.eventData,startDate:e,endDate:t,calendarId:this.selectedCalendar._id}},this.configs.key);200===a.status&&(this.fetchCalendarEvents(),this.showEventConfig=!1)}catch(e){console.error("Error adding event:",e)}},async updateEvent(){try{const e=this.convertToBangkokTimezone(new Date(this.eventData.startDate)),t=this.convertToBangkokTimezone(new Date(this.eventData.endDate)),a=await rs.PUT(`calendar_event/${this.eventData._id}`,{data:{...this.eventData,startDate:e,endDate:t,_id:void 0,calendarId:this.selectedCalendar._id}},this.configs.key);200===a.status&&(this.fetchCalendarEvents(),this.showEventConfig=!1)}catch(e){console.error("Error updating event:",e)}},async deleteEvent(){try{const e=await rs.DELETE(`calendar_event/${this.eventData._id}`,{},this.configs.key);if(200===e.status){const e=this.eventList.findIndex((e=>e._id===this.eventData._id));-1!==e&&this.fetchCalendarEvents(),this.showEventConfig=!1}}catch(e){console.error("Error deleting event:",e)}},createNewEvent(e){if(!e)return;const t=new Date(Date.UTC(this.selectedYear,this.selectedMonth,e)),a=this.convertToBangkokTimezone(t);this.eventData={title:"",startDate:a.substring(0,10),endDate:a.substring(0,10),color:this.colors[0].value,description:"",type:this.types[0].value,priority:"",location:""},this.isEditingEvent=!1,this.showEventConfig=!0},selectDate(e){this.$emit("dateSelected",new Date(this.selectedYear,this.selectedMonth,e))},previousMonth(){0===this.selectedMonth?(this.selectedMonth=11,this.selectedYear--):this.selectedMonth--,this.fetchCalendarEvents()},nextMonth(){11===this.selectedMonth?(this.selectedMonth=0,this.selectedYear++):this.selectedMonth++,this.fetchCalendarEvents()},goToToday(){const e=new Date;this.selectedMonth=e.getMonth(),this.selectedYear=e.getFullYear(),this.fetchCalendarEvents()},goBackToList(){this.$emit("backToList")},getColorCode(e){const t=this.colors.find((t=>t.value===e));return t?t.colorCode:"#4285f4"}},watch:{selectedMonth(){this.fetchCalendarEvents()},selectedYear(){this.fetchCalendarEvents()}},mounted(){this.fetchCalendarEvents()}};const cs=(0,na.A)(is,[["render",vt],["__scopeId","data-v-01e0d4a8"]]);var ds=cs;const us={class:"fixed inset-0 flex items-center justify-center z-50 modal-overlay"},gs={class:"bg-white rounded-xl p-6 shadow-2xl max-w-2xl w-full mx-4 relative modal-content max-h-[90vh] overflow-y-auto"},hs={class:"flex items-center justify-between mb-6 pb-4 border-b border-gray-200"},vs={class:"flex items-center gap-3"},ps={class:"text-xl font-semibold text-gray-900"},fs={class:"text-sm text-gray-500"},ms={class:"space-y-4"},bs={class:"space-y-4"},xs={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},ks={class:"flex flex-wrap gap-2 p-3 bg-gray-50 rounded-lg"},ys=["onUpdate:modelValue","value"],Cs={key:0,class:"fas fa-check text-white text-xs"},Ls={class:"space-y-4"},ws={class:"grid grid-cols-1 md:grid-cols-2 gap-6"},Ds={class:"space-y-4"},Es={class:"space-y-2"},Ts=["onUpdate:modelValue"],Is=["onClick"],Ms={key:0,class:"space-y-4"},_s={class:"p-4 bg-gray-50 rounded-lg space-y-4"},Us={class:"flex items-center justify-between"},Ss={class:"relative inline-flex items-center cursor-pointer"},js={key:0},Fs={class:"space-y-2"},$s=["onUpdate:modelValue"],Xs=["onClick"],Os={class:"flex items-center justify-between pt-6 border-t border-gray-200"},As={type:"submit",class:"px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors flex items-center gap-2"};function Ys(e,t,a,n,l,o){return(0,s.uX)(),(0,s.CE)("div",us,[(0,s.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-50 backdrop-blur-sm",onClick:t[0]||(t[0]=(...e)=>o.closeCalendarConfig&&o.closeCalendarConfig(...e))}),(0,s.Lk)("div",gs,[(0,s.Lk)("div",hs,[(0,s.Lk)("div",vs,[t[12]||(t[12]=(0,s.Lk)("div",{class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center"},[(0,s.Lk)("i",{class:"fas fa-calendar-plus text-blue-600"})],-1)),(0,s.Lk)("div",null,[(0,s.Lk)("h2",ps,(0,r.v_)(a.isEditing?"แก้ไขปฏิทิน":"เพิ่มปฏิทินใหม่"),1),(0,s.Lk)("p",fs,(0,r.v_)(a.isEditing?"ปรับแต่งการตั้งค่าปฏิทิน":"สร้างปฏิทินใหม่สำหรับจัดการกิจกรรม"),1)])]),(0,s.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>o.closeCalendarConfig&&o.closeCalendarConfig(...e)),class:"p-2 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-lg transition-colors"},t[13]||(t[13]=[(0,s.Lk)("i",{class:"fas fa-times text-lg"},null,-1)]))]),(0,s.Lk)("form",{onSubmit:t[11]||(t[11]=(0,i.D$)(((...e)=>o.saveCalendar&&o.saveCalendar(...e)),["prevent"])),class:"space-y-6"},[(0,s.Lk)("div",ms,[t[16]||(t[16]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-info-circle text-blue-500"}),(0,s.eW)(" ข้อมูลพื้นฐาน ")],-1)),(0,s.Lk)("div",null,[t[14]||(t[14]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ชื่อปฏิทิน *",-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>l.localCalendarData.title=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",type:"text",placeholder:"เช่น ปฏิทินงาน, ปฏิทินส่วนตัว",required:""},null,512),[[i.Jo,l.localCalendarData.title]])]),(0,s.Lk)("div",null,[t[15]||(t[15]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"คำอธิบาย",-1)),(0,s.bo)((0,s.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>l.localCalendarData.description=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all resize-none",rows:"3",placeholder:"อธิบายเกี่ยวกับปฏิทินนี้..."},null,512),[[i.Jo,l.localCalendarData.description]])])]),(0,s.Lk)("div",bs,[t[20]||(t[20]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-palette text-purple-500"}),(0,s.eW)(" การแสดงผล ")],-1)),(0,s.Lk)("div",xs,[(0,s.Lk)("div",null,[t[18]||(t[18]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"ประเภทปฏิทิน",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>l.localCalendarData.type=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"},t[17]||(t[17]=[(0,s.Lk)("option",{value:"default"},"ทั่วไป",-1),(0,s.Lk)("option",{value:"work"},"งาน",-1),(0,s.Lk)("option",{value:"personal"},"ส่วนตัว",-1),(0,s.Lk)("option",{value:"holiday"},"วันหยุด",-1)]),512),[[i.u1,l.localCalendarData.type]])]),(0,s.Lk)("div",null,[t[19]||(t[19]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"สีปฏิทิน",-1)),(0,s.Lk)("div",ks,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.colors,(e=>((0,s.uX)(),(0,s.CE)("label",{key:e.value,style:(0,r.Tr)({backgroundColor:e.colorCode}),class:(0,r.C4)(["color-circle cursor-pointer w-8 h-8 rounded-full flex items-center justify-center transition-all hover:scale-110 hover:shadow-lg",{"ring-2 ring-offset-2 ring-blue-500":l.localCalendarData.color===e.value}])},[(0,s.bo)((0,s.Lk)("input",{type:"radio","onUpdate:modelValue":e=>l.localCalendarData.color=e,value:e.value,class:"hidden"},null,8,ys),[[i.XL,l.localCalendarData.color]]),l.localCalendarData.color===e.value?((0,s.uX)(),(0,s.CE)("i",Cs)):(0,s.Q3)("",!0)],6)))),128))])])])]),(0,s.Lk)("div",Ls,[t[25]||(t[25]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-eye text-green-500"}),(0,s.eW)(" การตั้งค่าการแสดงผล ")],-1)),(0,s.Lk)("div",ws,[(0,s.Lk)("div",null,[t[22]||(t[22]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"มุมมองเริ่มต้น",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[5]||(t[5]=e=>l.localCalendarData.viewType=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"},t[21]||(t[21]=[(0,s.Lk)("option",{value:"day"},"รายวัน",-1),(0,s.Lk)("option",{value:"week"},"รายสัปดาห์",-1),(0,s.Lk)("option",{value:"month"},"รายเดือน",-1),(0,s.Lk)("option",{value:"agenda"},"รายการกิจกรรม",-1)]),512),[[i.u1,l.localCalendarData.viewType]])]),(0,s.Lk)("div",null,[t[24]||(t[24]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"เขตเวลา",-1)),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":t[6]||(t[6]=e=>l.localCalendarData.timezone=e),class:"w-full px-4 py-3 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"},t[23]||(t[23]=[(0,s.Lk)("option",{value:"UTC"},"UTC",-1),(0,s.Lk)("option",{value:"Asia/Bangkok"},"เวลาประเทศไทย",-1),(0,s.Lk)("option",{value:"America/New_York"},"Eastern Time (US & Canada)",-1),(0,s.Lk)("option",{value:"Europe/London"},"London",-1)]),512),[[i.u1,l.localCalendarData.timezone]])])])]),(0,s.Lk)("div",Ds,[t[29]||(t[29]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-bell text-yellow-500"}),(0,s.eW)(" การแจ้งเตือน ")],-1)),(0,s.Lk)("div",null,[t[28]||(t[28]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"การแจ้งเตือนเริ่มต้น (นาที)",-1)),(0,s.Lk)("div",Es,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.localCalendarData.defaultReminders,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"flex items-center gap-2"},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e=>l.localCalendarData.defaultReminders[a]=e,class:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",type:"number",placeholder:"เช่น 15",min:"0"},null,8,Ts),[[i.Jo,l.localCalendarData.defaultReminders[a],void 0,{number:!0}]]),l.localCalendarData.defaultReminders.length>1?((0,s.uX)(),(0,s.CE)("button",{key:0,type:"button",onClick:e=>o.removeReminder(a),class:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors"},t[26]||(t[26]=[(0,s.Lk)("i",{class:"fas fa-trash text-sm"},null,-1)]),8,Is)):(0,s.Q3)("",!0)])))),128)),(0,s.Lk)("button",{type:"button",class:"flex items-center gap-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",onClick:t[7]||(t[7]=(...e)=>o.addReminder&&o.addReminder(...e))},t[27]||(t[27]=[(0,s.Lk)("i",{class:"fas fa-plus text-sm"},null,-1),(0,s.eW)(" เพิ่มการแจ้งเตือน ")]))])])]),l.localCalendarData.sharingOptions?((0,s.uX)(),(0,s.CE)("div",Ms,[t[35]||(t[35]=(0,s.Lk)("h3",{class:"text-lg font-medium text-gray-900 flex items-center gap-2"},[(0,s.Lk)("i",{class:"fas fa-share-alt text-indigo-500"}),(0,s.eW)(" การแชร์ ")],-1)),(0,s.Lk)("div",_s,[(0,s.Lk)("div",Us,[t[31]||(t[31]=(0,s.Lk)("div",null,[(0,s.Lk)("label",{class:"text-sm font-medium text-gray-700"},"ปฏิทินสาธารณะ"),(0,s.Lk)("p",{class:"text-xs text-gray-500"},"อนุญาตให้ผู้อื่นเข้าถึงปฏิทินนี้ได้")],-1)),(0,s.Lk)("label",Ss,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[8]||(t[8]=e=>l.localCalendarData.sharingOptions.public=e),type:"checkbox",class:"sr-only peer"},null,512),[[i.lH,l.localCalendarData.sharingOptions.public]]),t[30]||(t[30]=(0,s.Lk)("div",{class:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"},null,-1))])]),l.localCalendarData.sharingOptions.public?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",js,[t[34]||(t[34]=(0,s.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"แชร์กับผู้ใช้",-1)),(0,s.Lk)("div",Fs,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(l.localCalendarData.sharingOptions.sharedWith,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{key:a,class:"flex items-center gap-2"},[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":e=>l.localCalendarData.sharingOptions.sharedWith[a]=e,class:"flex-1 px-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all",type:"text",placeholder:"ID ผู้ใช้หรืออีเมล"},null,8,$s),[[i.Jo,l.localCalendarData.sharingOptions.sharedWith[a]]]),l.localCalendarData.sharingOptions.sharedWith.length>1?((0,s.uX)(),(0,s.CE)("button",{key:0,type:"button",onClick:e=>o.removeSharedUser(a),class:"p-2 text-red-500 hover:text-red-700 hover:bg-red-50 rounded-lg transition-colors"},t[32]||(t[32]=[(0,s.Lk)("i",{class:"fas fa-trash text-sm"},null,-1)]),8,Xs)):(0,s.Q3)("",!0)])))),128)),(0,s.Lk)("button",{type:"button",class:"flex items-center gap-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",onClick:t[9]||(t[9]=(...e)=>o.addSharedUser&&o.addSharedUser(...e))},t[33]||(t[33]=[(0,s.Lk)("i",{class:"fas fa-plus text-sm"},null,-1),(0,s.eW)(" เพิ่มผู้ใช้ ")]))])]))])])):(0,s.Q3)("",!0),(0,s.Lk)("div",Os,[(0,s.Lk)("button",{type:"button",onClick:t[10]||(t[10]=(...e)=>o.closeCalendarConfig&&o.closeCalendarConfig(...e)),class:"px-6 py-3 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg font-medium transition-colors"}," ยกเลิก "),(0,s.Lk)("button",As,[t[36]||(t[36]=(0,s.Lk)("i",{class:"fas fa-save"},null,-1)),(0,s.eW)(" "+(0,r.v_)(a.isEditing?"บันทึกการเปลี่ยนแปลง":"สร้างปฏิทิน"),1)])])],32)])])}var Vs={props:{calendarData:Object,isEditing:Boolean},data(){return{localCalendarData:{...this.calendarData},colors:[{value:"pink",colorCode:"#f28b82"},{value:"red",colorCode:"#ea4335"},{value:"orange",colorCode:"#fbbc04"},{value:"yellow",colorCode:"#fdd835"},{value:"green",colorCode:"#81c995"},{value:"lightBlue",colorCode:"#aecbfa"},{value:"blue",colorCode:"#4285f4"},{value:"purple",colorCode:"#aa66cc"},{value:"gray",colorCode:"#9e9e9e"},{value:"black",colorCode:"#000000"}]}},methods:{saveCalendar(){this.$emit("saveCalendar",this.localCalendarData)},closeCalendarConfig(){this.$emit("closeCalendarConfig")},addReminder(){this.localCalendarData.defaultReminders.push(15)},removeReminder(e){this.localCalendarData.defaultReminders.length>1&&this.localCalendarData.defaultReminders.splice(e,1)},addSharedUser(){this.localCalendarData.sharingOptions.sharedWith.push("")},removeSharedUser(e){this.localCalendarData.sharingOptions.sharedWith.length>1&&this.localCalendarData.sharingOptions.sharedWith.splice(e,1)}}};const Ks=(0,na.A)(Vs,[["render",Ys],["__scopeId","data-v-7dea46f8"]]);var Ps=Ks;const Ws={class:"live-chat-widget"},Bs={class:"chat-icon"},Qs={key:0,class:"unread-badge"},zs={key:1,class:"chat-box"},Rs={class:"chat-header"},qs={key:0},Ns={key:1},Hs={class:"chat-content",ref:"chatContent"},Js={class:"message-text"},Gs={class:"timestamp"},Zs={key:0,class:"choices"},en=["onClick"],tn={key:1,class:"close-conversation"},an={key:0,class:"chat-input"};function sn(e,t,a,n,l,o){const c=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("div",Ws,[l.isChatOpen?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",{key:0,class:"chat-head",onClick:t[0]||(t[0]=(...e)=>o.toggleChat&&o.toggleChat(...e))},[(0,s.Lk)("span",Bs,[(0,s.bF)(c,{icon:["fas","comment-dots"],class:"text-white"})]),l.unreadCount>0?((0,s.uX)(),(0,s.CE)("span",Qs,(0,r.v_)(l.unreadCount),1)):(0,s.Q3)("",!0)])),l.isChatOpen?((0,s.uX)(),(0,s.CE)("div",zs,[(0,s.Lk)("div",Rs,[l.isAgentMode?((0,s.uX)(),(0,s.CE)("h3",qs,"Chat with Agent")):((0,s.uX)(),(0,s.CE)("h3",Ns,"Chat with Bot")),(0,s.Lk)("button",{class:"close-button",onClick:t[1]||(t[1]=(...e)=>o.minimizeChat&&o.minimizeChat(...e))},[(0,s.bF)(c,{icon:["fas","circle-xmark"],class:"text-white text-lg"})])]),(0,s.Lk)("div",Hs,[l.conversation&&l.conversation.message?((0,s.uX)(!0),(0,s.CE)(s.FK,{key:0},(0,s.pI)(l.conversation.message,(e=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,class:(0,r.C4)(["chat-message","customer"!=e.sender?"agent-bubble":"customer-bubble"])},[(0,s.Lk)("p",Js,(0,r.v_)(e.text),1),(0,s.Lk)("span",Gs,(0,r.v_)(e.time),1),e.choices?((0,s.uX)(),(0,s.CE)("div",Zs,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.choices,(e=>((0,s.uX)(),(0,s.CE)("button",{key:e,onClick:t=>o.handleChoiceClick(e),class:"choice-button"},(0,r.v_)(e),9,en)))),128))])):(0,s.Q3)("",!0)],2)))),128)):(0,s.Q3)("",!0),l.isEndConversation?((0,s.uX)(),(0,s.CE)("div",tn,[(0,s.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>o.handleCloseButtonClick&&o.handleCloseButtonClick(...e)),class:"close-conversation-button"},"End Conversation")])):(0,s.Q3)("",!0)],512),l.isEndConversation?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",an,[(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[3]||(t[3]=e=>l.newMessage=e),placeholder:"Type a message...",onFocus:t[4]||(t[4]=(...t)=>e.handleFocus&&e.handleFocus(...t)),onKeyup:t[5]||(t[5]=(0,i.jR)(((...e)=>o.sendMessage&&o.sendMessage(...e)),["enter"])),class:"text-sm"},null,544),[[i.Jo,l.newMessage]]),(0,s.Lk)("button",{class:"send-button text-sm",onClick:t[6]||(t[6]=(...e)=>o.sendMessage&&o.sendMessage(...e))},[(0,s.bF)(c,{icon:["fas","paper-plane"],class:"text-white mr-2"}),t[7]||(t[7]=(0,s.eW)(" Send"))])]))])):(0,s.Q3)("",!0)])}a(37550);var nn=a(77160),ln=a(53216);a(81454);const on=[{objective:"greet",prompt:"greeting and get user name",message:"Hello! Welcome to our service. What's your name?",contextLabel:"",contextKey:"name",inputValidate:dn,validationMessage:"Please enter your name.",nextObjective:"getName",renameTrigger:!0},{objective:"getName",prompt:"hello client name and get user e-mail",message:"Nice to meet you, [context.name]! Can I have your email address?",contextKey:"email",contextLabel:"Name",inputValidate:rn,validationMessage:"Please enter a valid email address.",nextObjective:"getEmail",renameTrigger:!1},{objective:"getEmail",prompt:"Thank user and get user phone",message:"Thanks, [context.name]. Could you also provide your phone number?",contextKey:"phone",contextLabel:"Email",inputValidate:cn,validationMessage:"Please enter a valid phone number.",nextObjective:"getPhone",renameTrigger:!1},{objective:"getPhone",prompt:"Thank user and ask to your assistance [yes, no]",message:"Thanks, [context.name]! Would you like assistance with something else?",contextLabel:"Phone",contextKey:"assistanceChoice",conditionValidate:[{label:"yes",return:"offerHelp"},{label:"no",return:"endConversation"}],validationMessage:"Please answer with 'yes' or 'no'.",renameTrigger:!1},{objective:"offerHelp",prompt:"offer help options: [1.Product Support, 2.Sales Inquiry, 3.General Question] to user select",message:"Please select from the following options: \n1. Product Support \n2. Sales Inquiry \n3. General Question",contextKey:"helpType",conditionValidate:[{label:"1",return:"productSupport"},{label:"2",return:"salesInquiry"},{label:"3",return:"generalQuestion"}],validationMessage:"Please select a valid option (1, 2, or 3).",renameTrigger:!1},{objective:"productSupport",prompt:"ask user for product support help only",message:"For product support, please describe the issue you're facing.",contextKey:"productIssue",inputValidate:dn,validationMessage:"Please describe your issue.",nextObjective:"confirmInput",summaryLabel:"Product Issue",isAssistance:!0,renameTrigger:!1},{objective:"salesInquiry",prompt:"ask user for sale inquiry help only",message:"For sales inquiries, what product are you interested in?",contextKey:"productInterest",inputValidate:dn,validationMessage:"Please provide the product name or description.",nextObjective:"confirmInput",summaryLabel:"Product Interest",isAssistance:!0,renameTrigger:!1},{objective:"generalQuestion",prompt:"ask user for general qestion only",message:"Please ask your question, and I'll do my best to assist you.",contextKey:"generalQuestion",inputValidate:dn,validationMessage:"Please ask your question.",nextObjective:"confirmInput",summaryLabel:"General Question",isAssistance:!0,renameTrigger:!1},{objective:"confirmInput",prompt:"confirm user input data [yes, no]",message:'You said: "[context.currentStepContextValue]". Is that correct?',contextKey:"confirmation",conditionValidate:[{label:"yes",return:"moreQuestions"},{label:"no",return:un}],validationMessage:"Please answer with 'yes' or 'no'.",renameTrigger:!1},{objective:"moreQuestions",prompt:"ask user for more question [yes, no]",message:"Do you have any more questions, [context.name]?",contextKey:"moreQuestions",conditionValidate:[{label:"yes",return:"offerHelp"},{label:"no",return:"endConversation"}],validationMessage:"Please answer with 'yes' or 'no'.",renameTrigger:!1},{objective:"endConversation",prompt:"thank user and tell no worry issue we will support soon and make summary from context_ai show user",message:["Thank you, [context.name]! Have a great day!","[summary]"],contextKey:null,validation:null,validationMessage:null,nextObjective:null,renameTrigger:!1}];function rn(e){const t=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return t.test(String(e).toLowerCase())}function cn(e){const t=/^[0-9]{10}$/;return t.test(String(e))}function dn(e){return!!e.trim()}function un(e){return e.previousObjective}function gn(e,t){let a="",s=[],n="";if(!t)throw new Error("chatFlow is undefined or not passed correctly.");t.forEach((t=>{e[t.contextKey]&&(t.contextLabel&&(a+=`- ${t.contextLabel}: ${e[t.contextKey]||"N/A"}\n`),t.summaryLabel&&(n+=`${t.summaryLabel}: ${e[t.contextKey]}\n`,t.isAssistance&&s.push(t.summaryLabel)))}));const l=s.length>0?s.join(", "):"No assistance needed";return`\n    Here's a summary of our conversation:\n    ${a.trim()}\n      - Assistance: ${l}\n      - Details: ${n.trim()||"N/A"}\n    `}async function hn(e,t,a,s){const n=s.find((e=>e.objective===t));n.contextKey&&(a[n.contextKey]=e.trim()),n.contextKey&&"confirmInput"!==t&&(a.currentStepContextKey=n.contextKey,a.currentStepContextValue=a[n.contextKey],a.previousObjective=t);const l={currentStepContextKey:n.contextKey,currentStepContextValue:a[n.contextKey]};if(n.inputValidate&&!n.inputValidate(e.trim()))return{nextObjective:t,message:n.validationMessage,choices:n.conditionValidate?n.conditionValidate.map((e=>e.label)):null,end:!1,objective:t};let o,r=null,i=!1;if(n.conditionValidate){r=n.conditionValidate.map((e=>e.label));const s=n.conditionValidate.find((t=>t.label.toLowerCase()===e.trim().toLowerCase()));if(!s)return{nextObjective:t,message:n.validationMessage,choices:r,end:!1,objective:t};o="function"===typeof s.return?s.return(a):s.return}else o="function"===typeof n.nextObjective?n.nextObjective(a):n.nextObjective;n.renameTrigger&&a.name&&(i=a.name);const c=s.find((e=>e.objective===o));if(!c)throw new Error(`No step found for objective: ${o}`);let d='You are "Peter AI Assis," a polite and knowledgeable AI support agent for an E-Learning platform. Your goal is to provide clear, helpful responses, adapting to the user\'s language and tone.',u=`${d} Fulfill the objective: "${c.prompt}". Use this context: context_ai = ${JSON.stringify(l)}. Ensure clarity and relevance. If there are options in brackets (e.g., [1. xxxx, 2. xxxx, 3. xxxx]), list each option on a new line.`;try{const e=await(0,nn.k)(u);return{nextObjective:c.objective,message:e,choices:c.conditionValidate?c.conditionValidate.map((e=>e.label)):null,end:"endConversation"===o,objective:c.objective,data:a.data||null,rename:i}}catch(g){return console.error("Error generating custom message:",g),{nextObjective:c.objective,message:"Sorry, I couldn't generate a response.",choices:c.conditionValidate?c.conditionValidate.map((e=>e.label)):null,end:"endConversation"===o,objective:c.objective,data:a.data||null,rename:i}}}var vn=a(8605),pn={data(){return{isAgentMode:!1,isChatOpen:!1,newMessage:"",currentStepIndex:0,context:{},unreadCount:0,chatFlow:on,chatSummary:null,isEndConversation:!1,showCloseButton:!1,conversation:null,conversationID:ve.A.get("conversationID"),session:ve.A.get("session"),originalTitle:""}},mounted(){this.initializeConversationOnLoad(),this.subscribeToHostChannel(this.session.current._id,this.handleHostMessages),this.subscribeToConversationChannel(this.conversationID,this.handleConversationMessages)},methods:{subscribeToHostChannel(e,t){const a=(0,ln.al)(`host-${e}`);(0,ln.SR)(a,(e=>{t(e)}))},subscribeToConversationChannel(e,t){const a=(0,ln.al)(`conversation-${e}`);(0,ln.SR)(a,(e=>{t(e)}))},async publishToHostChannel(e,t,a){const s=(0,ln.al)(`host-${e}`);try{await(0,ln.Le)(s,{type:t,data:a})}catch(n){console.error(n)}},async publishToConversationChannel(e,t,a){const s=(0,ln.al)(`conversation-${e}`);try{await(0,ln.Le)(s,{type:t,data:a})}catch(n){console.error(n)}},handleHostMessages(e){e.data&&e.data.type},handleConversationMessages(e){e.data&&"agent_reply"===e.data.type&&(this.initializeConversation(),this.startTitleFlashing(),setTimeout((()=>{this.stopTitleFlashing()}),2e3))},startTitleFlashing(){if(this.titleInterval)return;this.originalTitle=document.title;let e="New Message!",t=!0;this.titleInterval=setInterval((()=>{document.title=t?e:this.originalTitle,t=!t}),500)},stopTitleFlashing(){this.titleInterval&&(clearInterval(this.titleInterval),this.titleInterval=null,document.title=this.originalTitle)},async initializeConversationOnLoad(){this.conversationID&&(await this.initializeConversation(),this.isChatOpen=!0)},async toggleChat(){this.isChatOpen=!this.isChatOpen,this.isChatOpen&&await this.initializeConversation()},async initializeConversation(){try{if(this.conversationID){const e=await(0,vn.me)(this.conversationID);e?(this.conversation=e,this.currentStepIndex=e.currentStepIndex||0,this.isChatOpen=!0,this.isAgentMode="agent"===e.mode,this.resumeChatProcess()):console.error("Conversation not found")}else await this.startNewChat();this.scrollToBottom()}catch(e){console.error(e.message)}},async startNewChat(){try{const e={sender:this.isAgentMode?"agent":"bot",preview:"",mode:"bot",status:"active",message:[],unreadCount:0,lastUpdate:new Date,currentStepIndex:0},t=await(0,vn.cK)(e);if(!t||!t._id)throw new Error("Failed to create a new conversation");this.conversationID=t._id,ve.A.set("conversationID",this.conversationID),this.conversation=t,this.startChatbotProcess()}catch(e){console.error(e.message)}},async startChatbotProcess(){const e=this.chatFlow[0];let t='You are "Peter AI Assis," a polite and knowledgeable AI support agent for an E-Learning platform. Your goal is to provide clear, helpful responses, adapting to the user\'s language and tone.',a=`${t} Fulfill the objective: "${e?.prompt}".`,s="bot";await this.showThinkingEffect("...",null,null,s,"",!0);const n=await(0,nn.k)(a);await this.showThinkingEffect(n,e?.objective,null,s),this.addBotMessage(n,e?.objective)},resumeChatProcess(){if(this.isEndConversation)return;const e=this.chatFlow[this.currentStepIndex]?.objective,t=this.getLastUserResponse();if(t&&this.conversation.lastProcessedMessageId!==t.id){const{nextObjective:a,message:s,choices:n,end:l}=hn(t.text,e,this.context,this.chatFlow);a&&a!==e&&(this.currentStepIndex=this.chatFlow.findIndex((e=>e.objective===a)),this.addBotMessage(s,a,n)),l&&(this.chatSummary=gn(this.context,this.chatFlow),this.isEndConversation=!0),this.conversation.lastProcessedMessageId=t.id,this.saveConversation()}},getLastUserResponse(){const e=this.conversation.message.slice().reverse().find((e=>"customer"===e.sender));return e?e.text:""},async sendMessage(){if(this.newMessage.trim()){const e=this.newMessage.trim();this.newMessage="",this.addCustomerMessage(e),this.isAgentMode||await this.handleBotMessage(e),this.publishToHostChannel(this.session.current._id,"conversation_update",{conversationId:this.conversationID,updateInfo:"New message received"}),this.publishToConversationChannel(this.conversationID,"client_reply",{text:"Thank you for your message. How can I assist you further?",timestamp:(new Date).toISOString()}),this.updateConversationPreview()}},handleAgentMessage(e){this.conversation.message.push({id:this.conversation.message.length+1,text:e,time:(new Date).toLocaleTimeString(),sender:"customer"}),this.saveConversation(),this.scrollToBottom()},async renameSenderInConversation(e){if(this.conversationID&&e)try{await(0,vn.T$)(this.conversationID,e),await this.initializeConversation(),console.log("Sender name updated successfully")}catch(t){console.error(t.message)}},async handleBotMessage(e){if(this.isAgentMode)return;let t=this.isAgentMode?"agent":"bot";await this.showThinkingEffect("...",null,null,t,"",!0);const{nextObjective:a,message:s,choices:n,end:l,rename:o}=await hn(e,this.chatFlow[this.currentStepIndex]?.objective||"",this.context,this.chatFlow);o&&await this.renameSenderInConversation(o);const r=this.chatFlow.findIndex((e=>e.objective===a));r>=0&&(this.currentStepIndex=r),await this.showThinkingEffect(s,a,n,t),l&&(this.chatSummary=gn(this.context,this.chatFlow),this.isEndConversation=!0,setTimeout((()=>{this.showCloseButton=!0}),1500))},addCustomerMessage(e){const t={id:(new Date).getTime(),text:e,time:(new Date).toLocaleTimeString(),sender:"customer"};this.conversation.message.push(t),this.saveConversation(),this.scrollToBottom()},async showThinkingEffect(e,t,a,s,n=" Typing",l=!1){return new Promise((o=>{let r="",i=0;this.typingInterval&&clearInterval(this.typingInterval),this.typingInterval=setInterval((()=>{i++,r=".".repeat(i)+n,i>4&&(i=1),this.updateTypingMessage(r)}),300),l?o():setTimeout((()=>{clearInterval(this.typingInterval),this.removeTypingMessage(),this.addBotMessage(e,t,a,s),this.scrollToBottom(),o()}),1e3)}))},addBotMessage(e,t,a=null,s="bot"){if(this.isAgentMode)return;const n=Array.isArray(e)?e:[e];n.forEach((e=>{const n=this.conversation.message.find((a=>a.text===e&&a.objective===t));if(n)console.warn("Duplicate.");else{const n={id:this.conversation.message.length+1,text:e,time:(new Date).toLocaleTimeString(),sender:s,choices:a,objective:t};this.conversation.message.push(n),this.conversation.currentStepIndex=this.currentStepIndex,this.saveConversation()}})),this.scrollToBottom()},updateTypingMessage(e){"agent"===this.conversation.message[this.conversation.message.length-1]?.sender?this.conversation.message[this.conversation.message.length-1].text=e:this.conversation.message.push({id:this.conversation.message.length+1,text:e,time:(new Date).toLocaleTimeString(),sender:"agent"}),this.scrollToBottom()},removeTypingMessage(){const e=this.conversation.message[this.conversation.message.length-1];if(e){const t=[/.*Typing\.*$/,/.*\.\sTyping\s\.\.\.$/,/.*\.\.\.\sTyping\s\.$/,/.*\.\.\.\sTyping$/,/.*Typing\s\.\.\.$/,/.*Typing\s\.\.$/,/.*Typing\s\.$/],a=t.some((t=>t.test(e.text)));a&&this.conversation.message.pop()}this.scrollToBottom()},updateConversationPreview(){if(this.conversation){const e=this.conversation.message[this.conversation.message.length-1];this.conversation.preview=e.text,this.conversation.lastUpdate=new Date,this.saveConversation()}},scrollToBottom(){this.$nextTick((()=>{const e=this.$refs.chatContent;e&&(e.scrollTop=e.scrollHeight)}))},async saveConversation(){try{if(this.conversationID&&this.conversation){const e=this.conversation.message[this.conversation.message.length-1];if("..."===e.text)return void console.warn("Skipping save for typing indicator.");const t=this.conversation.message.filter((t=>t.text===e.text&&t.time===e.time));if(t.length>1)return void console.warn("Duplicate.");await(0,vn.xR)(this.conversationID,this.conversation)}}catch(e){console.error(e.message)}},minimizeChat(){this.isChatOpen=!1},handleCloseButtonClick(){this.isChatOpen=!1,this.resetChat()},resetChat(){this.newMessage="",this.currentStepIndex=0,this.context={},this.chatSummary=null,this.isEndConversation=!1,this.showCloseButton=!1,this.conversation&&(this.conversation.status="resolved",this.conversation.preview="Conversation ended",this.conversation.lastUpdate=new Date,this.saveConversation())},handleChoiceClick(e){this.newMessage=e,this.sendMessage()}}};const fn=(0,na.A)(pn,[["render",sn],["__scopeId","data-v-3066579a"]]);var mn=fn;const bn=new pe.A(!1);var xn={components:{CalendarView:ds,CalendarConfig:Ps,Chat:mn},data(){return{loader:!1,calendarList:[],selectedCalendar:null,showCalendarConfig:!1,isEditingEvent:!1,calendarData:this.getEmptyCalendarData(),configs:ve.A.get("configs"),session:ve.A.get("session"),title:"ปฏิทิน",showMobileSidebar:!1,eventList:[],navigationData:[{name:"เพิ่มปฏิทินใหม่",function:"callFunction",style:"plus",class:"primary-btn",visible:!0,type:"call-function"}],colors:[{value:"pink",colorCode:"#f28b82"},{value:"red",colorCode:"#ea4335"},{value:"orange",colorCode:"#fbbc04"},{value:"yellow",colorCode:"#fdd835"},{value:"green",colorCode:"#81c995"},{value:"lightBlue",colorCode:"#aecbfa"},{value:"blue",colorCode:"#4285f4"},{value:"purple",colorCode:"#aa66cc"},{value:"gray",colorCode:"#9e9e9e"},{value:"black",colorCode:"#000000"}]}},methods:{toggleMobileSidebar(){this.showMobileSidebar=!this.showMobileSidebar},backToCalendarListAndCloseMobile(){this.backToCalendarList(),this.toggleMobileSidebar()},getColorCode(e){const t=this.colors.find((t=>t.value===e));return t?t.colorCode:"#000000"},parseDate(e){const t=new Date(e),a={weekday:"long",year:"numeric",month:"long",day:"numeric"},[s,n,l]=t.toLocaleDateString("en-US",a).split(" ");return{day:s||"Monday",month:n||"August",date:l||"13",dateISO:t.toISOString().split("T")[0]||"2024-08-13"}},getEmptyCalendarData(){return{title:"",description:"",type:"default",color:"#3498db",notifications:!1,viewType:"month",timezone:"UTC",defaultReminders:[15,30],sharingOptions:{public:!1,sharedWith:[]},recurrenceOptions:{allowRecurringEvents:!0,defaultRecurrence:"none"},permissions:{canEdit:!0,canDelete:!0},customFields:[]}},async fetchCalendars(){this.loader=!1;try{const e=await bn.POST("calendar/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===e.status&&(this.calendarList=e.data)}catch(e){console.error("Error fetching calendars:",e)}finally{this.loader=!0}},selectCalendar(e){this.selectedCalendar=e,this.$router.push({query:{item:e._id}}),this.title="ปฏิทิน : "+e.title,this.fetchCalendarEvents()},backToCalendarList(){this.selectedCalendar=null,this.$router.push({query:{item:null}}),this.title="ปฏิทิน"},async fetchCalendarEvents(){try{const e=await bn.POST("calendar_event/query",{method:"find",args:[{calendarId:this.selectedCalendar._id}]},this.configs.key);200===e.status&&(this.eventList=e.data)}catch(e){console.error("Error fetching events:",e)}},prepareAddCalendar(){this.backToCalendarList(),this.calendarData=this.getEmptyCalendarData(),this.showCalendarConfig=!0},async saveCalendar(e){e._id?await this.updateCalendar(e):await this.addCalendar(e)},async addCalendar(e){try{const t=await bn.POST("calendar/",{data:{...e,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(this.calendarList.push(t.data),this.selectCalendar(t.data),this.showCalendarConfig=!1)}catch(t){console.error("Error adding calendar:",t)}},async updateCalendar(e){try{const t=await bn.PUT(`calendar/${this.calendarData._id}`,{data:{...e,_id:void 0,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(this.showCalendarConfig=!1,this.fetchCalendars())}catch(t){console.error("Error updating calendar:",t)}},editCalendar(e){this.calendarData={...e},this.showCalendarConfig=!0},closeCalendarConfig(){this.showCalendarConfig=!1},prepareAddEvent(e){this.eventData=this.getEmptyEventData(),this.eventData.startDate=e.toISOString().split("T")[0],this.eventData.endDate=e.toISOString().split("T")[0],this.isEditingEvent=!1,this.showEventConfig=!0},closeEventConfig(){this.showEventConfig=!1},handleDateSelected(e){this.prepareAddEvent(e)},handleEditEvent(e){this.eventData={...e},this.isEditingEvent=!0,this.showEventConfig=!0}},mounted(){this.fetchCalendars().then((()=>{const e=this.$route.query.item;if(e){const t=this.calendarList.find((t=>t._id===e));t&&this.selectCalendar(t)}}))}};const kn=(0,na.A)(xn,[["render",he],["__scopeId","data-v-f1ee46ce"]]);var yn=kn,Cn={name:"AdminList",components:{List:yn},data(){return{login:ve.A.get("session","login")}},methods:{showAlert(){this.$swal("Hello Vue world!!!")}},setup(){const e=(0,o.lq)(),t=e.meta.title;(0,l.K7)(t)}};const Ln=(0,na.A)(Cn,[["render",n]]);var wn=Ln},77160:function(e,t,a){a.d(t,{k:function(){return s}});const s=async e=>{const t="AIzaSyB_DNNNAbBpaQ41rKHgDeL-zzGpQmjcRH4",a=`https://generativelanguage.googleapis.com/v1/models/gemini-pro:generateContent?key=${t}`,s={"Content-Type":"application/json"},n=JSON.stringify({contents:[{role:"user",parts:[{text:e}]}]});try{const e=await fetch(a,{method:"POST",headers:s,body:n}),t=await e.json();if(e.ok){const e=t.candidates[0]?.content.parts[0]?.text.trim();return e||"Sorry, I couldn't generate a response."}return console.error("Error generating message:",t),"Sorry, I couldn't generate a response."}catch(l){return console.error("Network error generating message:",l),"Sorry, I couldn't generate a response."}}},8605:function(e,t,a){a.d(t,{T$:function(){return g},bX:function(){return i},cK:function(){return d},me:function(){return c},xR:function(){return u}});var s=a(40475),n=a(40471);const l=new n.A(!1),o=s.A.get("configs"),r=s.A.get("session"),i=async()=>{const e=await l.POST("conversation/query",{method:"find",args:[{$and:[{unit:r.current._id}]}]},o.key);if(200===e.status)return e.data;throw new Error("Failed to fetch conversations")},c=async e=>{const t=await l.GET(`conversation/${e}`,o.key);if(200===t.status)return t.data;throw new Error(`Failed to fetch conversation with ID ${e}`)},d=async e=>{const t=await l.POST("conversation",{data:{...e,unit:r.current._id}},o.key);if(200===t.status)return t.data;throw new Error("Failed to create conversation")},u=async(e,t)=>{t._id&&delete t._id;const a=await l.PUT(`conversation/${e}`,{data:t},o.key);if(200===a.status)return a.data;throw new Error(`Failed to update conversation with ID ${e}`)},g=async(e,t,a)=>{try{const s=await c(e);if(s){s.sender=t,a&&(s.preview=a);const n=await u(e,{sender:s.sender,preview:s.preview,updatedAt:new Date});return n}throw new Error(`Conversation with ID ${e} not found`)}catch(s){throw console.error("Error updating sender in conversation:",s.message),s}}}}]);
//# sourceMappingURL=5355.a5e7d0f4.js.map