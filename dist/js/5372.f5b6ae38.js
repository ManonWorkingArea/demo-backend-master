(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[5372],{66339:function(t,e,r){"use strict";var i=r(12954),n=r(251),s="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */e.hp=h,e.IS=50;var o=2147483647;function a(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(r){return!1}}function l(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,h.prototype),e}function h(t,e,r){if("number"===typeof t){if("string"===typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return d(t)}return u(t,e,r)}function u(t,e,r){if("string"===typeof t)return p(t,e);if(ArrayBuffer.isView(t))return m(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Q(t,ArrayBuffer)||t&&Q(t.buffer,ArrayBuffer))return g(t,e,r);if("undefined"!==typeof SharedArrayBuffer&&(Q(t,SharedArrayBuffer)||t&&Q(t.buffer,SharedArrayBuffer)))return g(t,e,r);if("number"===typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return h.from(i,e,r);var n=w(t);if(n)return n;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof t[Symbol.toPrimitive])return h.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!==typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function f(t,e,r){return c(t),t<=0?l(t):void 0!==e?"string"===typeof r?l(t).fill(e,r):l(t).fill(e):l(t)}function d(t){return c(t),l(t<0?0:0|b(t))}function p(t,e){if("string"===typeof e&&""!==e||(e="utf8"),!h.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|v(t,e),i=l(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function m(t){for(var e=t.length<0?0:0|b(t.length),r=l(e),i=0;i<e;i+=1)r[i]=255&t[i];return r}function g(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var i;return i=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(i,h.prototype),i}function w(t){if(h.isBuffer(t)){var e=0|b(t.length),r=l(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!==typeof t.length||Z(t.length)?l(0):m(t):"Buffer"===t.type&&Array.isArray(t.data)?m(t.data):void 0}function b(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function y(t){return+t!=t&&(t=0),h.alloc(+t)}function v(t,e){if(h.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Q(t,ArrayBuffer))return t.byteLength;if("string"!==typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(t).length;default:if(n)return i?-1:q(t).length;e=(""+e).toLowerCase(),n=!0}}function x(t,e,r){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";t||(t="utf8");while(1)switch(t){case"hex":return U(this,e,r);case"utf8":case"utf-8":return R(this,e,r);case"ascii":return F(this,e,r);case"latin1":case"binary":return B(this,e,r);case"base64":return D(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function k(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function _(t,e,r,i,n){if(0===t.length)return-1;if("string"===typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Z(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0){if(!n)return-1;r=0}if("string"===typeof e&&(e=h.from(e,i)),h.isBuffer(e))return 0===e.length?-1:M(t,e,r,i,n);if("number"===typeof e)return e&=255,"function"===typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):M(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function M(t,e,r,i,n){var s,o=1,a=t.length,l=e.length;if(void 0!==i&&(i=String(i).toLowerCase(),"ucs2"===i||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,l/=2,r/=2}function h(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(n){var u=-1;for(s=r;s<a;s++)if(h(t,s)===h(e,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===l)return u*o}else-1!==u&&(s-=s-u),u=-1}else for(r+l>a&&(r=a-l),s=r;s>=0;s--){for(var c=!0,f=0;f<l;f++)if(h(t,s+f)!==h(e,f)){c=!1;break}if(c)return s}return-1}function E(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;var s=e.length;i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(Z(a))return o;t[r+o]=a}return o}function S(t,e,r,i){return K(q(e,t.length-r),t,r,i)}function A(t,e,r,i){return K(G(e),t,r,i)}function C(t,e,r,i){return A(t,e,r,i)}function L(t,e,r,i){return K(W(e),t,r,i)}function I(t,e,r,i){return K(H(e,t.length-r),t,r,i)}function D(t,e,r){return 0===e&&r===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,r))}function R(t,e,r){r=Math.min(t.length,r);var i=[],n=e;while(n<r){var s,o,a,l,h=t[n],u=null,c=h>239?4:h>223?3:h>191?2:1;if(n+c<=r)switch(c){case 1:h<128&&(u=h);break;case 2:s=t[n+1],128===(192&s)&&(l=(31&h)<<6|63&s,l>127&&(u=l));break;case 3:s=t[n+1],o=t[n+2],128===(192&s)&&128===(192&o)&&(l=(15&h)<<12|(63&s)<<6|63&o,l>2047&&(l<55296||l>57343)&&(u=l));break;case 4:s=t[n+1],o=t[n+2],a=t[n+3],128===(192&s)&&128===(192&o)&&128===(192&a)&&(l=(15&h)<<18|(63&s)<<12|(63&o)<<6|63&a,l>65535&&l<1114112&&(u=l))}null===u?(u=65533,c=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=c}return T(i)}h.TYPED_ARRAY_SUPPORT=a(),h.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),h.poolSize=8192,h.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(h.prototype,Uint8Array.prototype),Object.setPrototypeOf(h,Uint8Array),h.alloc=function(t,e,r){return f(t,e,r)},h.allocUnsafe=function(t){return d(t)},h.allocUnsafeSlow=function(t){return d(t)},h.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==h.prototype},h.compare=function(t,e){if(Q(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),Q(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,i=e.length,n=0,s=Math.min(r,i);n<s;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=h.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){var s=t[r];if(Q(s,Uint8Array)&&(s=h.from(s)),!h.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,n),n+=s.length}return i},h.byteLength=v,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)k(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)k(this,e,e+3),k(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)k(this,e,e+7),k(this,e+1,e+6),k(this,e+2,e+5),k(this,e+3,e+4);return this},h.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?R(this,0,t):x.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",r=e.IS;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},s&&(h.prototype[s]=h.prototype.inspect),h.prototype.compare=function(t,e,r,i,n){if(Q(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,i>>>=0,n>>>=0,this===t)return 0;for(var s=n-i,o=r-e,a=Math.min(s,o),l=this.slice(i,n),u=t.slice(e,r),c=0;c<a;++c)if(l[c]!==u[c]){s=l[c],o=u[c];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},h.prototype.indexOf=function(t,e,r){return _(this,t,e,r,!0)},h.prototype.lastIndexOf=function(t,e,r){return _(this,t,e,r,!1)},h.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"===typeof e)i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return E(this,t,e,r);case"utf8":case"utf-8":return S(this,t,e,r);case"ascii":return A(this,t,e,r);case"latin1":case"binary":return C(this,t,e,r);case"base64":return L(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function T(t){var e=t.length;if(e<=P)return String.fromCharCode.apply(String,t);var r="",i=0;while(i<e)r+=String.fromCharCode.apply(String,t.slice(i,i+=P));return r}function F(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}function B(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function U(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=e;s<r;++s)n+=J[t[s]];return n}function O(t,e,r){for(var i=t.slice(e,r),n="",s=0;s<i.length;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function N(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function z(t,e,r,i,n,s){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function j(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function X(t,e,r,i,s){return e=+e,r>>>=0,s||j(t,e,r,4,34028234663852886e22,-34028234663852886e22),n.write(t,e,r,i,23,4),r+4}function $(t,e,r,i,s){return e=+e,r>>>=0,s||j(t,e,r,8,17976931348623157e292,-17976931348623157e292),n.write(t,e,r,i,52,8),r+8}h.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t);var i=this.subarray(t,e);return Object.setPrototypeOf(i,h.prototype),i},h.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);var i=this[t],n=1,s=0;while(++s<e&&(n*=256))i+=this[t+s]*n;return i},h.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);var i=this[t+--e],n=1;while(e>0&&(n*=256))i+=this[t+--e]*n;return i},h.prototype.readUInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);var i=this[t],n=1,s=0;while(++s<e&&(n*=256))i+=this[t+s]*n;return n*=128,i>=n&&(i-=Math.pow(2,8*e)),i},h.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);var i=e,n=1,s=this[t+--i];while(i>0&&(n*=256))s+=this[t+--i]*n;return n*=128,s>=n&&(s-=Math.pow(2,8*e)),s},h.prototype.readInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){t>>>=0,e||N(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt16BE=function(t,e){t>>>=0,e||N(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return t>>>=0,e||N(t,4,this.length),n.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return t>>>=0,e||N(t,4,this.length),n.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return t>>>=0,e||N(t,8,this.length),n.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return t>>>=0,e||N(t,8,this.length),n.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,r,i){if(t=+t,e>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;z(this,t,e,r,n,0)}var s=1,o=0;this[e]=255&t;while(++o<r&&(s*=256))this[e+o]=t/s&255;return e+r},h.prototype.writeUIntBE=function(t,e,r,i){if(t=+t,e>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;z(this,t,e,r,n,0)}var s=r-1,o=1;this[e+s]=255&t;while(--s>=0&&(o*=256))this[e+s]=t/o&255;return e+r},h.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,1,255,0),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},h.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e>>>=0,!i){var n=Math.pow(2,8*r-1);z(this,t,e,r,n-1,-n)}var s=0,o=1,a=0;this[e]=255&t;while(++s<r&&(o*=256))t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o|0)-a&255;return e+r},h.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e>>>=0,!i){var n=Math.pow(2,8*r-1);z(this,t,e,r,n-1,-n)}var s=r-1,o=1,a=0;this[e+s]=255&t;while(--s>=0&&(o*=256))t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o|0)-a&255;return e+r},h.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},h.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeFloatLE=function(t,e,r){return X(this,t,e,!0,r)},h.prototype.writeFloatBE=function(t,e,r){return X(this,t,e,!1,r)},h.prototype.writeDoubleLE=function(t,e,r){return $(this,t,e,!0,r)},h.prototype.writeDoubleBE=function(t,e,r){return $(this,t,e,!1,r)},h.prototype.copy=function(t,e,r,i){if(!h.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n=i-r;if(this===t&&"function"===typeof Uint8Array.prototype.copyWithin)this.copyWithin(e,r,i);else if(this===t&&r<e&&e<i)for(var s=n-1;s>=0;--s)t[s+e]=this[s+r];else Uint8Array.prototype.set.call(t,this.subarray(r,i),e);return n},h.prototype.fill=function(t,e,r,i){if("string"===typeof t){if("string"===typeof e?(i=e,e=0,r=this.length):"string"===typeof r&&(i=r,r=this.length),void 0!==i&&"string"!==typeof i)throw new TypeError("encoding must be a string");if("string"===typeof i&&!h.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){var n=t.charCodeAt(0);("utf8"===i&&n<128||"latin1"===i)&&(t=n)}}else"number"===typeof t?t&=255:"boolean"===typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"===typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=h.isBuffer(t)?t:h.from(t,i),a=o.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=o[s%a]}return this};var V=/[^+/0-9A-Za-z-_]/g;function Y(t){if(t=t.split("=")[0],t=t.trim().replace(V,""),t.length<2)return"";while(t.length%4!==0)t+="=";return t}function q(t,e){var r;e=e||1/0;for(var i=t.length,n=null,s=[],o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function G(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function H(t,e){for(var r,i,n,s=[],o=0;o<t.length;++o){if((e-=2)<0)break;r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i)}return s}function W(t){return i.toByteArray(Y(t))}function K(t,e,r,i){for(var n=0;n<i;++n){if(n+r>=e.length||n>=t.length)break;e[n+r]=t[n]}return n}function Q(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!==t}var J=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)e[i+n]=t[r]+t[n];return e}()},91330:function(t,e,r){t.exports=s;var i=r(37007).EventEmitter,n=r(56698);function s(){i.call(this)}n(s,i),s.Readable=r(45412),s.Writable=r(16708),s.Duplex=r(25382),s.Transform=r(74610),s.PassThrough=r(63600),s.finished=r(86238),s.pipeline=r(57758),s.Stream=s,s.prototype.pipe=function(t,e){var r=this;function n(e){t.writable&&!1===t.write(e)&&r.pause&&r.pause()}function s(){r.readable&&r.resume&&r.resume()}r.on("data",n),t.on("drain",s),t._isStdio||e&&!1===e.end||(r.on("end",a),r.on("close",l));var o=!1;function a(){o||(o=!0,t.end())}function l(){o||(o=!0,"function"===typeof t.destroy&&t.destroy())}function h(t){if(u(),0===i.listenerCount(this,"error"))throw t}function u(){r.removeListener("data",n),t.removeListener("drain",s),r.removeListener("end",a),r.removeListener("close",l),r.removeListener("error",h),t.removeListener("error",h),r.removeListener("end",u),r.removeListener("close",u),t.removeListener("close",u)}return r.on("error",h),t.on("error",h),r.on("end",u),r.on("close",u),t.on("close",u),t.emit("pipe",r),t}},55372:function(t,e,r){"use strict";r.d(e,{A:function(){return Rv}});var i={};r.r(i),r.d(i,{CMYK:function(){return id},GREY:function(){return Jf},HSL:function(){return ed},HSV:function(){return rd},RGB:function(){return td}});var n={};r.r(n),r.d(n,{tagsById:function(){return Dd},tagsByName:function(){return Rd}});var s={};r.r(s),r.d(s,{tagsById:function(){return Pd},tagsByName:function(){return Td}});var o={};r.r(o),r.d(o,{tagsById:function(){return Fd},tagsByName:function(){return Bd}});r(98992),r(54520);var a=r(20641),l=r(90033),h=r(53751);const u={key:0,class:"hidden lg:flex lg:w-64 lg:flex-col"},c={class:"flex flex-col flex-grow bg-white border-r border-gray-200 h-full"},f={class:"flex items-center justify-between px-4 py-4 border-b border-gray-200 flex-shrink-0"},d={class:"flex items-center space-x-3"},p={class:"p-2 bg-blue-100 rounded-lg"},m={class:"text-lg font-semibold text-gray-900"},g={class:"px-4 py-4 border-b border-gray-200"},w={class:"space-y-2"},b={class:"flex items-center justify-between p-2 bg-blue-50 rounded-lg stats-card"},y={class:"text-sm font-semibold text-blue-600"},v={class:"flex items-center justify-between p-2 bg-yellow-50 rounded-lg stats-card"},x={class:"text-sm font-semibold text-yellow-600"},k={class:"flex items-center justify-between p-2 bg-green-50 rounded-lg stats-card"},_={class:"text-sm font-semibold text-green-600"},M={class:"flex items-center justify-between p-2 bg-purple-50 rounded-lg stats-card"},E={class:"text-sm font-semibold text-purple-600"},S={class:"px-4 py-4 border-b border-gray-200"},A={class:"space-y-1"},C=["onClick"],L={class:"flex-1 text-left"},I={class:"px-4 py-4 border-b border-gray-200"},D={class:"space-y-2"},R={class:"px-4 py-4 border-b border-gray-200"},P={class:"space-y-3"},T={class:"flex items-center justify-between text-sm"},F={class:"font-medium text-gray-900"},B={class:"w-full bg-gray-200 rounded-full h-2"},U={class:"flex items-center justify-between text-xs text-gray-500"},O={class:"mt-auto px-4 py-4 flex-shrink-0"},N={class:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg"},z={class:"flex-1 min-w-0"},j={class:"text-sm font-medium text-gray-900 truncate"},X={class:"flex-1 flex flex-col min-w-0 h-full"},$={class:"lg:hidden bg-white border-b border-gray-200 px-4 py-3"},V={class:"flex items-center justify-between"},Y={class:"text-lg font-semibold text-gray-900"},q={class:"bg-white border-b border-gray-200 px-4 py-3"},G={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3"},H={class:"flex-1 max-w-md"},W={class:"relative"},K={class:"flex items-center space-x-2"},Q={class:"flex items-center space-x-2"},Z={class:"flex items-center space-x-2 bg-gray-50 rounded-lg p-1"},J={class:"bg-white border-b border-gray-200 px-4 py-3"},tt={class:"flex items-center space-x-2","aria-label":"Breadcrumb"},et={key:0,class:"flex items-center text-sm font-medium text-blue-600 p-2 rounded-md bg-blue-50"},rt=["onClick","onDrop"],it={class:"lg:hidden bg-white border-b border-gray-200"},nt={class:"px-4 py-2"},st={value:"all"},ot={value:"folder"},at={value:"image"},lt={value:"media"},ht={value:"document"},ut={class:"mb-4 flex items-center justify-between"},ct={class:"flex items-center gap-2"},ft={class:"text-lg font-semibold text-gray-900"},dt={class:"px-2 py-1 bg-gray-100 text-gray-600 text-sm rounded-full"},pt={key:0,class:"flex items-center space-x-2 bg-red-50 px-3 py-2 rounded-lg border border-red-200"},mt={class:"text-sm font-medium text-red-800"},gt={key:0,class:"grid grid-cols-2 gap-4 sm:grid-cols-3 sm:gap-6 lg:grid-cols-4 xl:grid-cols-5 2xl:grid-cols-6"},wt=["onDrop","onClick","data-item"],bt=["onContextmenu","onDblclick"],yt={class:"aspect-square bg-gradient-to-br from-yellow-100 to-yellow-200 relative overflow-hidden flex items-center justify-center"},vt={class:"absolute top-3 right-3 bg-blue-500 text-white text-xs px-2 py-1 rounded-full font-medium shadow-sm"},xt={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center"},kt={class:"p-3"},_t=["title"],Mt={class:"flex justify-between items-center text-xs text-gray-500"},Et=["onDragstart","data-item"],St=["onContextmenu","onDblclick","onClick"],At={class:"aspect-square bg-gray-200 relative overflow-hidden"},Ct=["src"],Lt={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center"},It={key:1,class:"w-full h-full flex items-center justify-center bg-gray-200"},Dt={type:"button",class:"absolute inset-0 focus:outline-none"},Rt={class:"sr-only"},Pt=["onContextmenu","onDblclick","onClick"],Tt={class:"aspect-square bg-gray-200 flex items-center justify-center relative"},Ft={type:"button",class:"absolute inset-0 focus:outline-none"},Bt={class:"sr-only"},Ut=["onContextmenu","onDblclick","onClick"],Ot={class:"aspect-square bg-gray-200 relative overflow-hidden"},Nt=["src"],zt={class:"absolute top-2 left-2 flex flex-col space-y-1"},jt={key:0,class:"bg-green-500 text-white text-xs px-2 py-1 rounded-md font-medium shadow-sm flex items-center"},Xt={key:1,class:"bg-blue-500 text-white text-xs px-2 py-1 rounded-md font-medium shadow-sm"},$t={key:0},Vt={key:1},Yt={key:2},qt={class:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 transition-all duration-200 flex items-center justify-center"},Gt={key:1,class:"w-full h-full flex items-center justify-center bg-gray-200 relative"},Ht={class:"absolute top-2 left-2 flex flex-col space-y-1"},Wt={key:0,class:"bg-green-500 text-white text-xs px-2 py-1 rounded-md font-medium shadow-sm flex items-center"},Kt={key:1,class:"bg-blue-500 text-white text-xs px-2 py-1 rounded-md font-medium shadow-sm"},Qt={key:0},Zt={key:1},Jt={key:2},te={type:"button",class:"absolute inset-0 focus:outline-none"},ee={class:"sr-only"},re={class:"p-3"},ie={key:0},ne={class:"flex items-center space-x-2 cursor-pointer"},se=["value"],oe={class:"text-sm font-medium text-gray-900 truncate"},ae={class:"text-xs text-gray-500 mt-1"},le=["onClick"],he={key:1},ue=["title"],ce={class:"text-gray-900"},fe={class:"text-gray-500"},de={class:"flex justify-between items-center text-xs text-gray-500"},pe={key:0},me={key:0,class:"mt-2"},ge={disabled:"",class:"w-full inline-flex items-center justify-center px-3 py-1.5 bg-gray-300 text-gray-500 rounded-md text-xs font-medium cursor-not-allowed"},we={key:1,class:"bg-white rounded-xl shadow-sm border border-gray-200 overflow-hidden"},be={class:"bg-gradient-to-r from-gray-50 to-gray-100 px-6 py-3 border-b border-gray-200"},ye={class:"col-span-1 flex items-center"},ve={key:0,class:"col-span-2"},xe={role:"list",class:"divide-y divide-gray-100"},ke=["onClick"],_e=["onContextmenu","onDblclick"],Me={class:"col-span-1"},Ee={class:"w-10 h-10 bg-gradient-to-br from-yellow-100 to-yellow-200 rounded-lg flex items-center justify-center relative"},Se={class:"absolute -top-1 -right-1 bg-blue-500 text-white text-xs px-1.5 py-0.5 rounded-full font-medium shadow-sm min-w-[18px] text-center"},Ae={class:"flex items-center space-x-3"},Ce={class:"text-sm font-semibold text-gray-900 group-hover:text-blue-700 transition-colors duration-200"},Le={class:"text-xs text-gray-500"},Ie={class:"col-span-2"},De={class:"text-sm text-gray-600 font-medium"},Re={class:"col-span-2"},Pe={class:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800"},Te={class:"col-span-2"},Fe={class:"text-sm text-gray-500"},Be={key:0,class:"col-span-2"},Ue=["onClick"],Oe={key:1,disabled:"",class:"inline-flex items-center px-2 py-1 bg-gray-200 text-gray-500 rounded-md text-xs font-medium cursor-not-allowed"},Ne=["onContextmenu","onDblclick"],ze={class:"col-span-1"},je={class:"w-10 h-10 rounded-lg overflow-hidden bg-gray-100 flex items-center justify-center"},Xe=["src"],$e={key:1,class:"relative w-full h-full"},Ve=["src"],Ye={class:"absolute inset-0 bg-black bg-opacity-30 flex items-center justify-center"},qe={class:"flex items-center space-x-3"},Ge={class:"min-w-0 flex-1"},He={class:"text-sm font-semibold text-gray-900 group-hover:text-blue-700 transition-colors duration-200 truncate"},We={class:"text-gray-500 font-normal"},Ke={class:"flex items-center space-x-2 mt-1"},Qe={key:0,class:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-green-100 text-green-800"},Ze={key:1,class:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-blue-100 text-blue-800"},Je={key:2,class:"text-xs text-gray-500"},tr={class:"col-span-2"},er={class:"text-sm text-gray-600 font-medium"},rr={class:"col-span-2"},ir={class:"col-span-2"},nr={class:"text-sm text-gray-500"},sr={key:2,class:"text-center py-12"},or={key:0,class:"bg-white border-t border-gray-200 px-4 py-3 flex-shrink-0"},ar={class:"flex items-center justify-between"},lr={class:"flex items-center space-x-3"},hr={key:0,class:"flex items-center space-x-2"},ur={class:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center"},cr=["title"],fr={class:"text-xs text-gray-500"},dr={key:1,class:"text-sm text-gray-500"},pr={class:"flex items-center space-x-3"},mr=["disabled"],gr={class:"flex flex-col h-full"},wr={class:"flex items-center justify-between px-4 py-4 border-b border-gray-200"},br={class:"text-lg font-semibold text-gray-900"},yr={class:"px-4 py-4 border-b border-gray-200"},vr={class:"space-y-2"},xr={class:"flex items-center justify-between p-2 bg-blue-50 rounded-lg"},kr={class:"text-sm font-semibold text-blue-600"},_r={class:"px-4 py-4 border-b border-gray-200"},Mr={class:"space-y-1"},Er=["onClick"],Sr={class:"flex-1 text-left"},Ar={key:2,class:"fixed inset-0 z-50 overflow-y-auto"},Cr={class:"flex min-h-full items-center justify-center p-4"},Lr={class:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden transform transition-all duration-300"},Ir={class:"p-6"},Dr={class:"mb-6"},Rr={class:"grid grid-cols-4 gap-2"},Pr=["onClick"],Tr={class:"mb-6"},Fr={class:"flex items-center space-x-4"},Br={class:"min-w-[4rem] text-right"},Ur={class:"inline-flex items-center px-3 py-1 bg-blue-100 text-blue-800 text-sm font-medium rounded-full"},Or={class:"bg-gray-50 px-6 py-4 flex justify-end space-x-3"},Nr={key:3,class:"fixed inset-0 z-50 overflow-y-auto"},zr={class:"flex min-h-full items-center justify-center p-4"},jr={class:"relative w-full max-w-md bg-white rounded-2xl shadow-2xl overflow-hidden transform transition-all duration-300"},Xr={class:"p-6 space-y-4"},$r={class:"bg-gray-50 px-6 py-4 flex justify-end space-x-3"},Vr={class:"flex min-h-full items-center justify-center p-2"},Yr={class:"relative bg-gradient-to-r from-gray-900 via-gray-800 to-gray-900 px-4 py-3"},qr={class:"flex items-center justify-between"},Gr={class:"flex items-center space-x-3"},Hr={class:"flex items-center space-x-2"},Wr={class:"w-8 h-8 bg-white/10 rounded-lg flex items-center justify-center"},Kr=["title"],Qr={class:"text-gray-300 text-xs"},Zr={class:"flex items-center space-x-2"},Jr={key:0,class:"mt-3 p-3 bg-white/10 rounded-lg backdrop-blur-sm"},ti={class:"flex items-center space-x-3"},ei={class:"relative"},ri={key:0,class:"absolute top-full left-0 mt-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden"},ii={class:"py-1"},ni=["onClick","disabled"],si={key:0,class:"text-green-600 text-xs"},oi={key:0,class:"w-full h-full flex items-center justify-center p-3"},ai=["src"],li={key:1,class:"w-full h-full flex items-center justify-center p-3"},hi={key:0,class:"relative w-full max-w-4xl"},ui={class:"absolute top-2 left-2 z-10"},ci={class:"inline-flex items-center px-2 py-1 bg-green-600 text-white text-xs font-medium rounded-full shadow-lg"},fi={key:1,class:"relative w-full max-w-4xl"},di={class:"absolute top-2 left-2 z-10"},pi={class:"inline-flex items-center px-2 py-1 bg-blue-600 text-white text-xs font-medium rounded-full shadow-lg"},mi=["src"],gi={key:2,class:"w-full h-full flex items-center justify-center p-3"},wi={class:"relative w-full max-w-5xl"},bi={class:"absolute top-2 left-2 z-10"},yi={class:"inline-flex items-center px-2 py-1 bg-red-600 text-white text-xs font-medium rounded-full shadow-lg"},vi=["src"],xi={class:"absolute bottom-2 right-2 flex items-center space-x-2"},ki=["href"],_i=["href"],Mi={class:"bg-white border-t border-gray-200 px-4 py-3"},Ei={class:"flex flex-col sm:flex-row sm:items-center sm:justify-between space-y-3 sm:space-y-0"},Si={class:"flex items-center space-x-4"},Ai={class:"flex items-center space-x-3"},Ci={class:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center"},Li=["title"],Ii={class:"flex items-center space-x-3 text-xs text-gray-500 mt-1"},Di={class:"flex items-center"},Ri={key:0,class:"flex items-center"},Pi={key:1,class:"flex items-center"},Ti={class:"flex items-center space-x-3"},Fi={key:0,class:"flex items-center space-x-2"},Bi={class:"flex items-center space-x-1 px-2 py-1 bg-green-100 text-green-800 rounded-full text-xs font-medium"},Ui={key:0,class:"absolute bottom-full right-0 mb-2 w-48 bg-white border border-gray-200 rounded-lg shadow-lg z-10 overflow-hidden"},Oi={class:"py-1"},Ni={key:1,class:"flex items-center space-x-1"},zi={class:"flex items-center space-x-1 px-2 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium"},ji={class:"flex items-center space-x-1 px-2 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium"},Xi={class:"flex items-center space-x-2"},$i=["href"],Vi={key:5,class:"fixed inset-0 z-50 overflow-y-auto"},Yi={class:"flex min-h-full items-center justify-center p-4"},qi={class:"relative w-full max-w-2xl bg-white rounded-2xl shadow-2xl overflow-hidden transform transition-all duration-300"},Gi={class:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4"},Hi={class:"flex items-center justify-between"},Wi={class:"p-6"},Ki={class:"space-y-4"},Qi={class:"mx-auto w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center"},Zi={type:"button",class:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm"},Ji={key:0,class:"mt-6"},tn={class:"text-lg font-semibold text-gray-900 mb-4"},en={class:"space-y-3 max-h-60 overflow-y-auto"},rn={class:"flex items-center space-x-3 flex-1 min-w-0"},nn={class:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center flex-shrink-0"},sn={class:"flex-1 min-w-0"},on=["title"],an={class:"text-xs text-gray-500"},ln={key:0,class:"mt-2"},hn={class:"flex items-center justify-between text-xs text-gray-600 mb-1"},un={class:"w-full bg-gray-200 rounded-full h-1.5"},cn={key:1,class:"mt-1"},fn={class:"flex items-center space-x-2 flex-shrink-0"},dn=["onClick"],pn=["onClick"],mn={class:"bg-gray-50 px-6 py-4 flex justify-between items-center"},gn={class:"text-sm text-gray-600"},wn={key:0},bn={key:1},yn={class:"flex space-x-3"},vn=["disabled"];function xn(t,e,r,i,n,s){const o=(0,a.g2)("font-awesome-icon"),xn=(0,a.g2)("CreateFolder"),kn=(0,a.g2)("RenameFolder"),_n=(0,a.g2)("VideoPlayer");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("div",{class:(0,l.C4)(["bg-gray-50 flex overflow-hidden file-manager-container",[t.headerType&&`with-${t.headerType}`,t.customClass,"popup"===r.Mode?"popup-mode":""]]),style:(0,l.Tr)("popup"===r.Mode?{height:"70vh",maxHeight:"600px"}:t.customHeight?{height:t.customHeight,maxHeight:t.customHeight}:{})},["popup"!==r.Mode?((0,a.uX)(),(0,a.CE)("div",u,[(0,a.Lk)("div",c,[(0,a.Lk)("div",f,[(0,a.Lk)("div",d,[(0,a.Lk)("div",p,[(0,a.bF)(o,{icon:["fas",n.PageIcon],class:"text-blue-600 text-lg"},null,8,["icon"])]),(0,a.Lk)("div",null,[(0,a.Lk)("h1",m,(0,l.v_)(n.PageName),1)])])]),(0,a.Lk)("div",g,[e[53]||(e[53]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"สถิติรวม",-1)),(0,a.Lk)("div",w,[(0,a.Lk)("div",b,[e[49]||(e[49]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"ไฟล์ทั้งหมด")],-1)),(0,a.Lk)("span",y,(0,l.v_)(n.fileListing.length),1)]),(0,a.Lk)("div",v,[e[50]||(e[50]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"โฟลเดอร์")],-1)),(0,a.Lk)("span",x,(0,l.v_)(n.fileListing.filter((t=>"folder"===t.mimetype)).length),1)]),(0,a.Lk)("div",k,[e[51]||(e[51]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"รูปภาพ")],-1)),(0,a.Lk)("span",_,(0,l.v_)(n.fileListing.filter((t=>"image"===t.type)).length),1)]),(0,a.Lk)("div",M,[e[52]||(e[52]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-purple-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"วิดีโอ")],-1)),(0,a.Lk)("span",E,(0,l.v_)(n.fileListing.filter((t=>"media"===t.type)).length),1)])])]),(0,a.Lk)("div",S,[e[54]||(e[54]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"ประเภทไฟล์",-1)),(0,a.Lk)("nav",A,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)([{value:"all",label:"ไฟล์ทั้งหมด",icon:"fas fa-th-large"},{value:"folder",label:"โฟลเดอร์",icon:"fas fa-folder"},{value:"image",label:"รูปภาพ",icon:"fas fa-image"},{value:"media",label:"วิดีโอ",icon:"fas fa-video"},{value:"document",label:"เอกสาร",icon:"fas fa-file-alt"}],(t=>(0,a.Lk)("button",{key:t.value,onClick:e=>s.filterByType(t.value),class:(0,l.C4)(["w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors duration-200 sidebar-menu-item",{"bg-blue-100 text-blue-700 font-medium active":n.fileTypeFilter===t.value,"text-gray-600 hover:bg-gray-100 hover:text-gray-900":n.fileTypeFilter!==t.value}])},[(0,a.Lk)("i",{class:(0,l.C4)([t.icon,"text-sm w-4"])},null,2),(0,a.Lk)("span",L,(0,l.v_)(t.label),1),s.getFilterCount(t.value)>0?((0,a.uX)(),(0,a.CE)("span",{key:0,class:(0,l.C4)(["px-2 py-1 text-xs rounded-full status-badge",{"bg-blue-200 text-blue-800":n.fileTypeFilter===t.value,"bg-gray-200 text-gray-600":n.fileTypeFilter!==t.value}])},(0,l.v_)(s.getFilterCount(t.value)),3)):(0,a.Q3)("",!0)],10,C))),64))])]),(0,a.Lk)("div",I,[e[60]||(e[60]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"การดำเนินการ",-1)),(0,a.Lk)("div",D,[(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>s.openUploadBox&&s.openUploadBox(...t)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},e[55]||(e[55]=[(0,a.Lk)("i",{class:"fas fa-upload text-sm w-4"},null,-1),(0,a.Lk)("span",null,"อัพโหลดไฟล์",-1)])),(0,a.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>s.openCreateFolder&&s.openCreateFolder(...t)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},e[56]||(e[56]=[(0,a.Lk)("i",{class:"fas fa-folder-plus text-sm w-4"},null,-1),(0,a.Lk)("span",null,"สร้างโฟลเดอร์",-1)])),(0,a.Lk)("button",{onClick:e[2]||(e[2]=t=>s.openModal()),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},e[57]||(e[57]=[(0,a.Lk)("i",{class:"fas fa-stream text-sm w-4"},null,-1),(0,a.Lk)("span",null,"เพิ่ม Streaming",-1)])),(0,a.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>s.listFile&&s.listFile(...t)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},e[58]||(e[58]=[(0,a.Lk)("i",{class:"fas fa-sync-alt text-sm w-4"},null,-1),(0,a.Lk)("span",null,"รีเฟรช",-1)])),n.fileListing.filter((t=>"image"===t.type)).length>0?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e[4]||(e[4]=(...t)=>s.batchResizeImages&&s.batchResizeImages(...t)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},e[59]||(e[59]=[(0,a.Lk)("i",{class:"fas fa-magic text-sm w-4"},null,-1),(0,a.Lk)("span",null,"ปรับขนาดรูปทั้งหมด",-1)]))):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",R,[e[62]||(e[62]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"พื้นที่ใช้งาน",-1)),(0,a.Lk)("div",P,[(0,a.Lk)("div",T,[e[61]||(e[61]=(0,a.Lk)("span",{class:"text-gray-600"},"ใช้แล้ว",-1)),(0,a.Lk)("span",F,(0,l.v_)(s.formatBytes(n.summaryFileSize)),1)]),(0,a.Lk)("div",B,[(0,a.Lk)("div",{class:(0,l.C4)(["h-2 rounded-full transition-all duration-300",{"bg-green-500":s.calculateDiskUsagePercentage(n.summaryFileSize)<70,"bg-yellow-500":s.calculateDiskUsagePercentage(n.summaryFileSize)>=70&&s.calculateDiskUsagePercentage(n.summaryFileSize)<90,"bg-red-500":s.calculateDiskUsagePercentage(n.summaryFileSize)>=90}]),style:(0,l.Tr)({width:s.calculateDiskUsagePercentage(n.summaryFileSize)+"%"})},null,6)]),(0,a.Lk)("div",U,[(0,a.Lk)("span",null,(0,l.v_)(s.calculateDiskUsagePercentage(n.summaryFileSize))+"% ใช้งาน",1),(0,a.Lk)("span",null,(0,l.v_)(n.space)+" MB",1)])])]),(0,a.Lk)("div",O,[(0,a.Lk)("div",N,[e[64]||(e[64]=(0,a.Lk)("div",{class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-user text-white text-sm"})],-1)),(0,a.Lk)("div",z,[(0,a.Lk)("p",j,(0,l.v_)(n.session?.current?.name||"ผู้ใช้"),1),e[63]||(e[63]=(0,a.Lk)("p",{class:"text-xs text-gray-500"},"ผู้จัดการไฟล์",-1))])])])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",X,[(0,a.Lk)("div",$,[(0,a.Lk)("div",V,[(0,a.Lk)("h1",Y,(0,l.v_)(n.PageName),1),(0,a.Lk)("button",{onClick:e[5]||(e[5]=(...t)=>s.toggleMobileSidebar&&s.toggleMobileSidebar(...t)),class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},e[65]||(e[65]=[(0,a.Lk)("i",{class:"fas fa-bars"},null,-1)]))])]),(0,a.Lk)("div",q,[(0,a.Lk)("div",G,[(0,a.Lk)("div",H,[(0,a.Lk)("div",W,[e[66]||(e[66]=(0,a.Lk)("i",{class:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"},null,-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":e[6]||(e[6]=t=>n.searchQuery=t),placeholder:"ค้นหาไฟล์...",class:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"},null,512),[[h.Jo,n.searchQuery]])])]),(0,a.Lk)("div",K,[(0,a.Lk)("div",Q,[(0,a.Lk)("button",{onClick:e[7]||(e[7]=(...t)=>s.openCreateFolder&&s.openCreateFolder(...t)),class:"inline-flex items-center px-3 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm"},e[67]||(e[67]=[(0,a.Lk)("i",{class:"fas fa-folder-plus mr-2 text-xs"},null,-1),(0,a.Lk)("span",{class:"hidden sm:inline"},"สร้างโฟลเดอร์",-1)])),(0,a.Lk)("button",{onClick:e[8]||(e[8]=(...t)=>s.openUploadBox&&s.openUploadBox(...t)),class:"inline-flex items-center px-3 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm"},e[68]||(e[68]=[(0,a.Lk)("i",{class:"fas fa-upload mr-2 text-xs"},null,-1),(0,a.Lk)("span",{class:"hidden sm:inline"},"อัพโหลด",-1)]))]),(0,a.Lk)("div",Z,[(0,a.Lk)("button",{onClick:e[9]||(e[9]=(...t)=>s.toggleLayout&&s.toggleLayout(...t)),class:(0,l.C4)(["grid"===n.layout?"bg-white shadow-sm":"hover:bg-gray-100","p-2 rounded-md transition-all duration-200"])},[(0,a.bF)(o,{icon:["fas","th-large"],class:"w-4 h-4 text-gray-600"})],2),(0,a.Lk)("button",{onClick:e[10]||(e[10]=(...t)=>s.toggleLayout&&s.toggleLayout(...t)),class:(0,l.C4)(["list"===n.layout?"bg-white shadow-sm":"hover:bg-gray-100","p-2 rounded-md transition-all duration-200"])},[(0,a.bF)(o,{icon:["fas","list"],class:"w-4 h-4 text-gray-600"})],2)]),"popup"!==r.Mode?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e[11]||(e[11]=(...t)=>s.openUploadBox&&s.openUploadBox(...t)),class:"lg:hidden bg-blue-600 hover:bg-blue-700 text-white font-medium px-4 py-2 rounded-lg transition-colors duration-200 text-sm flex items-center gap-2"},e[69]||(e[69]=[(0,a.Lk)("i",{class:"fas fa-upload text-xs"},null,-1),(0,a.eW)(" อัพโหลด ")]))):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",J,[(0,a.Lk)("nav",tt,[(0,a.Lk)("button",{onClick:e[12]||(e[12]=t=>s.openFolder()),onDragover:e[13]||(e[13]=(0,h.D$)((()=>{}),["prevent"])),onDrop:e[14]||(e[14]=t=>s.handleDrop("")),class:"flex items-center text-sm text-gray-500 hover:text-blue-600 transition-colors duration-200 p-2 rounded-md hover:bg-blue-50"},[(0,a.bF)(o,{icon:["fas","home"],class:"text-gray-400 mr-2 w-4 h-4"}),e[70]||(e[70]=(0,a.Lk)("span",{class:"font-medium"},"หน้าแรก",-1))],32),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.folderPath,((t,r)=>((0,a.uX)(),(0,a.CE)("span",{key:r,class:"flex items-center"},[(0,a.bF)(o,{icon:["fas","chevron-right"],class:"text-gray-300 w-3 h-3 mx-2"}),r+1==n.folderPath.length?((0,a.uX)(),(0,a.CE)("button",et,[(0,a.bF)(o,{icon:["fas","folder-open"],class:"text-blue-500 mr-2 w-4 h-4"}),(0,a.eW)(" "+(0,l.v_)(t),1)])):((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:e=>s.openFolder(s.getFullPath(t)),onDragover:e[15]||(e[15]=(0,h.D$)((()=>{}),["prevent"])),onDrop:e=>s.handleDrop(s.getFullPath(t)),class:"flex items-center text-sm font-medium text-gray-600 hover:text-blue-600 transition-colors duration-200 p-2 rounded-md hover:bg-blue-50"},[(0,a.bF)(o,{icon:["fas","folder"],class:"text-yellow-500 mr-2 w-4 h-4"}),(0,a.eW)(" "+(0,l.v_)(t),1)],40,rt))])))),128))])]),(0,a.Lk)("div",it,[(0,a.Lk)("div",nt,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[16]||(e[16]=t=>n.fileTypeFilter=t),onChange:e[17]||(e[17]=t=>s.filterByType(n.fileTypeFilter)),class:"w-full border border-gray-200 rounded-lg px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-blue-500"},[(0,a.Lk)("option",st,"ไฟล์ทั้งหมด ("+(0,l.v_)(n.fileListing.length)+")",1),(0,a.Lk)("option",ot,"โฟลเดอร์ ("+(0,l.v_)(n.fileListing.filter((t=>"folder"===t.mimetype)).length)+")",1),(0,a.Lk)("option",at,"รูปภาพ ("+(0,l.v_)(n.fileListing.filter((t=>"image"===t.type)).length)+")",1),(0,a.Lk)("option",lt,"วิดีโอ ("+(0,l.v_)(n.fileListing.filter((t=>"media"===t.type)).length)+")",1),(0,a.Lk)("option",ht,"เอกสาร ("+(0,l.v_)(n.fileListing.filter((t=>"document"===t.type)).length)+")",1)],544),[[h.u1,n.fileTypeFilter]])])]),(0,a.Lk)("div",{class:(0,l.C4)(["flex-1 p-4","popup"===r.Mode?"overflow-y-auto":"overflow-hidden"]),style:(0,l.Tr)("popup"===r.Mode?{maxHeight:"calc(70vh - 140px)"}:{})},[(0,a.Lk)("div",ut,[(0,a.Lk)("div",ct,[(0,a.Lk)("h2",ft,(0,l.v_)(s.getFilterLabel(n.fileTypeFilter)),1),(0,a.Lk)("span",dt,(0,l.v_)(s.displayedFiles.length)+" รายการ ",1)]),n.error?((0,a.uX)(),(0,a.CE)("div",pt,[(0,a.bF)(o,{icon:["fas","exclamation-triangle"],class:"text-red-600 text-sm"}),(0,a.Lk)("span",mt,(0,l.v_)(n.errorText),1),(0,a.Lk)("button",{onClick:e[18]||(e[18]=t=>n.error=!1),class:"text-red-600 hover:text-red-800 ml-2"},[(0,a.bF)(o,{icon:["fas","times"],class:"text-xs"})])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",{class:(0,l.C4)("popup"===r.Mode?"h-auto":"h-full overflow-y-auto")},["grid"===n.layout?((0,a.uX)(),(0,a.CE)("div",gt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.displayedFiles,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t._id,class:(0,l.C4)(["relative group",{"ring-2 ring-blue-500 ring-offset-2":t._id===n.selectItem}])},["folder"===t.mimetype?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,l.C4)(["folder-"+t._id,"bg-white rounded-xl transition-all duration-200 overflow-hidden cursor-pointer border border-gray-200 hover:border-blue-300 group"]),onDragover:e[19]||(e[19]=(0,h.D$)((()=>{}),["prevent"])),onDrop:(0,h.D$)((e=>s.handleDrop(t.path)),["stop"]),onClick:(0,h.D$)((e=>s.openViewFile(t.name)),["stop"]),"data-item":t.path,ref_for:!0,ref:`dropTarget-${t.path}`},[(0,a.Lk)("div",{class:"folder-content",onContextmenu:(0,h.D$)((e=>s.onContextMenu(e,t.name,t.name,t._id,t.count)),["stop"]),onDblclick:(0,h.D$)((e=>s.openFolder(t.path)),["stop"])},[(0,a.Lk)("div",yt,[(0,a.bF)(o,{icon:["fas","folder"],class:"text-yellow-500 text-6xl drop-shadow-sm group-hover:scale-105 transition-transform duration-200"}),(0,a.Lk)("div",vt,(0,l.v_)(t.count),1),(0,a.Lk)("div",xt,[(0,a.bF)(o,{icon:["fas","folder-open"],class:"text-yellow-600 text-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-200"})])]),(0,a.Lk)("div",kt,[(0,a.Lk)("p",{class:"text-sm font-semibold text-gray-900 truncate mb-1",title:t.name},(0,l.v_)(t.name),9,_t),(0,a.Lk)("div",Mt,[(0,a.Lk)("span",null,(0,l.v_)(this.formatBytes(t.size)),1),(0,a.Lk)("span",null,(0,l.v_)(t.count)+" ไฟล์",1)])])],40,bt)],42,wt)):(0,a.Q3)("",!0),"folder"!=t.mimetype?((0,a.uX)(),(0,a.CE)("div",{key:1,draggable:"true",onDragstart:(0,h.D$)((e=>s.handleDragStart(t._id)),["stop"]),onDragend:e[21]||(e[21]=(0,h.D$)(((...t)=>s.handleDragEnd&&s.handleDragEnd(...t)),["stop"])),"data-item":t._id,ref_for:!0,ref:`draggableItem-${t._id}`,class:"bg-white rounded-xl transition-all duration-200 overflow-hidden cursor-pointer border border-gray-200 hover:border-blue-300 group"},["image"==t.type?((0,a.uX)(),(0,a.CE)("div",{key:0,onContextmenu:(0,h.D$)((e=>s.onFileContextMenu(e,t.name,t.name,t._id,t.original)),["stop"]),onDblclick:(0,h.D$)((e=>s.onDoubleClick(t.name)),["stop"]),onClick:(0,h.D$)((e=>s.openViewFile(t.name)),["stop"]),class:"relative"},[(0,a.Lk)("div",At,[t.thumbnail||t.path?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("img",{src:t.thumbnail?t.thumbnail:t.path,alt:"",class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"},null,8,Ct),(0,a.Lk)("div",Lt,[(0,a.bF)(o,{icon:["fas","image"],class:"text-white text-2xl opacity-0 group-hover:opacity-100 transition-opacity duration-200"})])],64)):((0,a.uX)(),(0,a.CE)("div",It,[(0,a.bF)(o,{icon:["fas","image"],class:"text-gray-400 text-4xl"})]))]),(0,a.Lk)("button",Dt,[(0,a.Lk)("span",Rt,"View details for "+(0,l.v_)(t.name),1)])],40,St)):(0,a.Q3)("",!0),"document"==t.type?((0,a.uX)(),(0,a.CE)("div",{key:1,onContextmenu:(0,h.D$)((e=>s.onFileContextMenu(e,t.name,t.name,t._id,t.original)),["stop"]),onDblclick:(0,h.D$)((e=>s.onDoubleClick(t.name)),["stop"]),onClick:(0,h.D$)((e=>s.openViewFile(t.name)),["stop"]),class:"relative"},[(0,a.Lk)("div",Tt,[(0,a.bF)(o,{icon:["fas",s.getDocumentIcon(s.getNewFileExtension(t.name))],class:(0,l.C4)([s.getDocumentIconColor(s.getNewFileExtension(t.name)),"text-5xl"])},null,8,["icon","class"]),(0,a.Lk)("div",{class:(0,l.C4)([{"bg-gray-500":["default","txt"].includes(s.getNewFileExtension(t.name)),"bg-red-500":"pdf"===s.getNewFileExtension(t.name),"bg-green-500":["xlsx","xls"].includes(s.getNewFileExtension(t.name)),"bg-blue-500":["docx","doc"].includes(s.getNewFileExtension(t.name)),"bg-purple-500":["pptx","ppt"].includes(s.getNewFileExtension(t.name)),"bg-black":"csv"===s.getNewFileExtension(t.name),"bg-orange-500":"js"===s.getNewFileExtension(t.name),"bg-yellow-500":"zip"===s.getNewFileExtension(t.name),"bg-pink-500":["jpg","jpeg","png","gif"].includes(s.getNewFileExtension(t.name)),"bg-brown-500":["html","htm"].includes(s.getNewFileExtension(t.name)),"bg-cyan-500":["xml"].includes(s.getNewFileExtension(t.name))},"absolute top-3 right-3 text-white text-xs px-2 py-1 rounded-md font-medium shadow-sm"])},(0,l.v_)(s.getNewFileExtension(t.name).toUpperCase()),3)]),(0,a.Lk)("button",Ft,[(0,a.Lk)("span",Bt,"View details for "+(0,l.v_)(t.name),1)])],40,Pt)):(0,a.Q3)("",!0),"media"==t.type?((0,a.uX)(),(0,a.CE)("div",{key:2,onContextmenu:(0,h.D$)((e=>s.onFileContextMenu(e,t.name,t.name,t._id,t.original,t.duration)),["stop"]),onDblclick:(0,h.D$)((e=>s.onDoubleClick(t.name)),["stop"]),onClick:(0,h.D$)((e=>s.openViewFile(t.name)),["stop"]),class:"relative"},[(0,a.Lk)("div",Ot,[t.thumbnail?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("img",{src:t.thumbnail,alt:"",class:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200"},null,8,Nt),(0,a.Lk)("div",zt,[t?.stream?((0,a.uX)(),(0,a.CE)("div",jt,[(0,a.bF)(o,{icon:["fas","play-circle"],class:"mr-1"}),e[71]||(e[71]=(0,a.eW)(" Stream "))])):(0,a.Q3)("",!0),t?.transcode?((0,a.uX)(),(0,a.CE)("div",Xt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.transcode,((e,r,i)=>((0,a.uX)(),(0,a.CE)("span",{key:i},["string"===typeof e&&e.includes("http")?((0,a.uX)(),(0,a.CE)("span",$t,(0,l.v_)(r),1)):((0,a.uX)(),(0,a.CE)("span",Vt,(0,l.v_)(r)+": "+(0,l.v_)(e)+"%",1)),i<Object.keys(t.transcode).length-1?((0,a.uX)(),(0,a.CE)("span",Yt,", ")):(0,a.Q3)("",!0)])))),128))])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",qt,[(0,a.bF)(o,{icon:["fas","play-circle"],class:"text-white text-3xl opacity-0 group-hover:opacity-100 transition-opacity duration-200"})])],64)):((0,a.uX)(),(0,a.CE)("div",Gt,[(0,a.bF)(o,{icon:["fas","file-video"],class:"text-gray-400 text-5xl"}),(0,a.Lk)("div",Ht,[t?.stream?((0,a.uX)(),(0,a.CE)("div",Wt,[(0,a.bF)(o,{icon:["fas","play-circle"],class:"mr-1"}),e[72]||(e[72]=(0,a.eW)(" Stream "))])):(0,a.Q3)("",!0),t?.transcode?((0,a.uX)(),(0,a.CE)("div",Kt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.transcode,((e,r,i)=>((0,a.uX)(),(0,a.CE)("span",{key:i},["string"===typeof e&&e.includes("http")?((0,a.uX)(),(0,a.CE)("span",Qt,(0,l.v_)(r),1)):((0,a.uX)(),(0,a.CE)("span",Zt,(0,l.v_)(r)+": "+(0,l.v_)(e)+"%",1)),i<Object.keys(t.transcode).length-1?((0,a.uX)(),(0,a.CE)("span",Jt,", ")):(0,a.Q3)("",!0)])))),128))])):(0,a.Q3)("",!0)])]))]),(0,a.Lk)("button",te,[(0,a.Lk)("span",ee,"View details for "+(0,l.v_)(t.name),1)])],40,Ut)):(0,a.Q3)("",!0),(0,a.Lk)("div",re,["popup"===r.Mode&&s.isAllowedFile(t.name)?((0,a.uX)(),(0,a.CE)("div",ie,[(0,a.Lk)("label",ne,[(0,a.bo)((0,a.Lk)("input",{type:"radio",value:t,"onUpdate:modelValue":e[20]||(e[20]=t=>n.selectFile=t),class:"w-4 h-4 text-blue-600 border-gray-300 focus:ring-blue-500"},null,8,se),[[h.XL,n.selectFile]]),(0,a.Lk)("span",oe,(0,l.v_)(t.name),1)]),(0,a.Lk)("p",ae,(0,l.v_)(this.formatBytes(t.size)),1),(0,a.Lk)("button",{onClick:(0,h.D$)((e=>s.selectFileFunc(t,t?.duration,t?.thumbnail)),["stop"]),class:"mt-2 w-full inline-flex items-center justify-center px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-xs font-medium transition-colors duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","check"],class:"mr-1 text-xs"}),e[73]||(e[73]=(0,a.eW)(" เลือกไฟล์นี้ "))],8,le)])):((0,a.uX)(),(0,a.CE)("div",he,[(0,a.Lk)("p",{class:"text-sm font-medium text-gray-900 truncate mb-1",title:t.name},[(0,a.Lk)("span",ce,(0,l.v_)(s.getFileName(t.name)),1),(0,a.Lk)("span",fe,(0,l.v_)(s.getFileExtension(t.name)),1)],8,ue),(0,a.Lk)("div",de,[(0,a.Lk)("span",null,(0,l.v_)(this.formatBytes(t.size)),1),"media"==t.type?((0,a.uX)(),(0,a.CE)("span",pe,(0,l.v_)(s.formatDuration(t.duration)),1)):(0,a.Q3)("",!0)]),"popup"===r.Mode?((0,a.uX)(),(0,a.CE)("div",me,[(0,a.Lk)("button",ge,[(0,a.bF)(o,{icon:["fas","ban"],class:"mr-1 text-xs"}),e[74]||(e[74]=(0,a.eW)(" ไม่อนุญาต "))])])):(0,a.Q3)("",!0)]))])],40,Et)):(0,a.Q3)("",!0)],2)))),128))])):((0,a.uX)(),(0,a.CE)("div",we,[(0,a.Lk)("div",be,[(0,a.Lk)("div",{class:(0,l.C4)(["popup"===r.Mode?"grid grid-cols-13 gap-4":"grid grid-cols-12 gap-4","text-xs font-semibold text-gray-600 uppercase tracking-wider"])},[(0,a.Lk)("div",ye,[(0,a.bF)(o,{icon:["fas","image"],class:"w-4 h-4"})]),(0,a.Lk)("div",{class:(0,l.C4)("popup"===r.Mode?"col-span-4":"col-span-5")},"ชื่อไฟล์",2),e[75]||(e[75]=(0,a.Lk)("div",{class:"col-span-2"},"ขนาด",-1)),e[76]||(e[76]=(0,a.Lk)("div",{class:"col-span-2"},"ประเภท",-1)),e[77]||(e[77]=(0,a.Lk)("div",{class:"col-span-2"},"วันที่แก้ไข",-1)),"popup"===r.Mode?((0,a.uX)(),(0,a.CE)("div",ve,"การดำเนินการ")):(0,a.Q3)("",!0)],2)]),(0,a.Lk)("ul",xe,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.displayedFiles,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id,class:(0,l.C4)(["group hover:bg-blue-50 transition-colors duration-200 cursor-pointer",{"bg-blue-100 border-l-4 border-blue-500":t._id===n.selectItem}]),onClick:(0,h.D$)((e=>s.openViewFile(t.name)),["stop"])},["folder"===t.mimetype?((0,a.uX)(),(0,a.CE)("div",{key:0,onContextmenu:(0,h.D$)((e=>s.onContextMenu(e,t.name,t.name,t._id,t.count)),["stop"]),onDblclick:(0,h.D$)((e=>s.openFolder(t.path)),["stop"]),class:"px-6 py-4"},[(0,a.Lk)("div",{class:(0,l.C4)("popup"===r.Mode?"grid grid-cols-13 gap-4 items-center":"grid grid-cols-12 gap-4 items-center")},[(0,a.Lk)("div",Me,[(0,a.Lk)("div",Ee,[(0,a.bF)(o,{icon:["fas","folder"],class:"text-yellow-500 text-xl"}),(0,a.Lk)("div",Se,(0,l.v_)(t.count),1)])]),(0,a.Lk)("div",{class:(0,l.C4)("popup"===r.Mode?"col-span-4":"col-span-5")},[(0,a.Lk)("div",Ae,[(0,a.Lk)("div",null,[(0,a.Lk)("p",Ce,(0,l.v_)(t.name),1),(0,a.Lk)("p",Le,(0,l.v_)(t.count)+" ไฟล์",1)])])],2),(0,a.Lk)("div",Ie,[(0,a.Lk)("span",De,(0,l.v_)(s.formatBytes(t.size)),1)]),(0,a.Lk)("div",Re,[(0,a.Lk)("span",Pe,[(0,a.bF)(o,{icon:["fas","folder"],class:"w-3 h-3 mr-1"}),e[78]||(e[78]=(0,a.eW)(" โฟลเดอร์ "))])]),(0,a.Lk)("div",Te,[(0,a.Lk)("span",Fe,(0,l.v_)(s.formatDate(t.createdAt)),1)]),"popup"===r.Mode?((0,a.uX)(),(0,a.CE)("div",Be,[s.isAllowedFile(t.name)?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:(0,h.D$)((e=>s.selectFileFunc(t,t?.duration,t?.thumbnail)),["stop"]),class:"inline-flex items-center px-2 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-xs font-medium transition-colors duration-200"},[(0,a.bF)(o,{icon:["fas","check"],class:"mr-1 text-xs"}),e[79]||(e[79]=(0,a.eW)(" เลือก "))],8,Ue)):((0,a.uX)(),(0,a.CE)("button",Oe,[(0,a.bF)(o,{icon:["fas","ban"],class:"mr-1 text-xs"}),e[80]||(e[80]=(0,a.eW)(" ไม่อนุญาต "))]))])):(0,a.Q3)("",!0)],2)],40,_e)):((0,a.uX)(),(0,a.CE)("div",{key:1,onContextmenu:(0,h.D$)((e=>s.onFileContextMenu(e,t.name,t.name,t._id,t.original)),["stop"]),onDblclick:(0,h.D$)((e=>s.onDoubleClick(t.name)),["stop"]),class:"px-6 py-4"},[(0,a.Lk)("div",{class:(0,l.C4)("popup"===r.Mode?"grid grid-cols-13 gap-4 items-center":"grid grid-cols-12 gap-4 items-center")},[(0,a.Lk)("div",ze,[(0,a.Lk)("div",je,["image"===t.type&&(t.thumbnail||t.path)?((0,a.uX)(),(0,a.CE)("img",{key:0,src:t.thumbnail?t.thumbnail:t.path,alt:"",class:"w-full h-full object-cover"},null,8,Xe)):"media"===t.type&&t.thumbnail?((0,a.uX)(),(0,a.CE)("div",$e,[(0,a.Lk)("img",{src:t.thumbnail,alt:"",class:"w-full h-full object-cover"},null,8,Ve),(0,a.Lk)("div",Ye,[(0,a.bF)(o,{icon:["fas","play"],class:"text-white text-xs"})])])):((0,a.uX)(),(0,a.Wv)(o,{key:2,icon:["fas",s.getDocumentIcon(s.getNewFileExtension(t.name))],class:(0,l.C4)([s.getDocumentIconColor(s.getNewFileExtension(t.name)),"text-lg"])},null,8,["icon","class"]))])]),(0,a.Lk)("div",{class:(0,l.C4)("popup"===r.Mode?"col-span-4":"col-span-5")},[(0,a.Lk)("div",qe,[(0,a.Lk)("div",Ge,[(0,a.Lk)("p",He,[(0,a.Lk)("span",null,(0,l.v_)(s.getFileName(t.name)),1),(0,a.Lk)("span",We,(0,l.v_)(s.getFileExtension(t.name)),1)]),(0,a.Lk)("div",Ke,[t.stream?((0,a.uX)(),(0,a.CE)("span",Qe,[(0,a.bF)(o,{icon:["fas","play-circle"],class:"w-3 h-3 mr-1"}),e[81]||(e[81]=(0,a.eW)(" Stream "))])):(0,a.Q3)("",!0),t.transcode?((0,a.uX)(),(0,a.CE)("span",Ze," Transcoded ")):(0,a.Q3)("",!0),"media"===t.type&&t.duration?((0,a.uX)(),(0,a.CE)("span",Je,(0,l.v_)(s.formatDuration(t.duration)),1)):(0,a.Q3)("",!0)])])])],2),(0,a.Lk)("div",tr,[(0,a.Lk)("span",er,(0,l.v_)(s.formatBytes(t.size)),1)]),(0,a.Lk)("div",rr,[(0,a.Lk)("span",{class:(0,l.C4)(["inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium",{"bg-blue-100 text-blue-800":"image"===t.type,"bg-purple-100 text-purple-800":"media"===t.type,"bg-gray-100 text-gray-800":"document"===t.type}])},[(0,a.bF)(o,{icon:["fas","image"===t.type?"image":"media"===t.type?"video":"file-alt"],class:"w-3 h-3 mr-1"},null,8,["icon"]),(0,a.eW)(" "+(0,l.v_)("image"===t.type?"รูปภาพ":"media"===t.type?"วิดีโอ":"เอกสาร"),1)],2)]),(0,a.Lk)("div",ir,[(0,a.Lk)("span",nr,(0,l.v_)(s.formatDate(t.createdAt)),1)])],2)],40,Ne))],10,ke)))),128))])])),0===s.displayedFiles.length?((0,a.uX)(),(0,a.CE)("div",sr,[(0,a.bF)(o,{icon:["fas","folder-open"],class:"text-gray-300 text-4xl mb-4"}),e[82]||(e[82]=(0,a.Lk)("p",{class:"text-gray-500"},"ไม่พบไฟล์ที่ตรงกับการค้นหา",-1))])):(0,a.Q3)("",!0)],2)],6),"popup"===r.Mode?((0,a.uX)(),(0,a.CE)("div",or,[(0,a.Lk)("div",ar,[(0,a.Lk)("div",lr,[n.selectFile?((0,a.uX)(),(0,a.CE)("div",hr,[(0,a.Lk)("div",ur,[(0,a.bF)(o,{icon:["fas","image"===n.selectFile.type?"image":"media"===n.selectFile.type?"video":"file-alt"],class:"text-blue-600 text-sm"},null,8,["icon"])]),(0,a.Lk)("div",null,[(0,a.Lk)("p",{class:"text-sm font-medium text-gray-900 truncate max-w-xs",title:n.selectFile.name},(0,l.v_)(n.selectFile.name),9,cr),(0,a.Lk)("p",fr,(0,l.v_)(s.formatBytes(n.selectFile.size)),1)])])):((0,a.uX)(),(0,a.CE)("div",dr," กรุณาเลือกไฟล์ "))]),(0,a.Lk)("div",pr,[(0,a.Lk)("button",{onClick:e[22]||(e[22]=e=>t.$emit("close")),class:"inline-flex items-center px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg text-sm font-medium transition-colors duration-200"}," ยกเลิก "),(0,a.Lk)("button",{onClick:e[23]||(e[23]=t=>s.selectFileFunc(n.selectFile,n.selectFile?.duration,n.selectFile?.thumbnail)),disabled:!n.selectFile,class:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","check"],class:"mr-2 text-xs"}),e[83]||(e[83]=(0,a.eW)(" เลือกไฟล์ "))],8,mr)])])])):(0,a.Q3)("",!0)]),n.showMobileSidebar?((0,a.uX)(),(0,a.CE)("div",{key:1,class:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-50",onClick:e[26]||(e[26]=(...t)=>s.toggleMobileSidebar&&s.toggleMobileSidebar(...t))},[(0,a.Lk)("div",{class:"w-64 h-full bg-white transform transition-transform duration-300",onClick:e[25]||(e[25]=(0,h.D$)((()=>{}),["stop"]))},[(0,a.Lk)("div",gr,[(0,a.Lk)("div",wr,[(0,a.Lk)("h1",br,(0,l.v_)(n.PageName),1),(0,a.Lk)("button",{onClick:e[24]||(e[24]=(...t)=>s.toggleMobileSidebar&&s.toggleMobileSidebar(...t)),class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},e[84]||(e[84]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,a.Lk)("div",yr,[e[86]||(e[86]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"สถิติรวม",-1)),(0,a.Lk)("div",vr,[(0,a.Lk)("div",xr,[e[85]||(e[85]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"ไฟล์ทั้งหมด")],-1)),(0,a.Lk)("span",kr,(0,l.v_)(n.fileListing.length),1)])])]),(0,a.Lk)("div",_r,[e[87]||(e[87]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"ประเภทไฟล์",-1)),(0,a.Lk)("nav",Mr,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)([{value:"all",label:"ไฟล์ทั้งหมด",icon:"fas fa-th-large"},{value:"folder",label:"โฟลเดอร์",icon:"fas fa-folder"},{value:"image",label:"รูปภาพ",icon:"fas fa-image"},{value:"media",label:"วิดีโอ",icon:"fas fa-video"},{value:"document",label:"เอกสาร",icon:"fas fa-file-alt"}],(t=>(0,a.Lk)("button",{key:t.value,onClick:e=>{s.filterByType(t.value),s.toggleMobileSidebar()},class:(0,l.C4)(["w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors duration-200",{"bg-blue-100 text-blue-700 font-medium":n.fileTypeFilter===t.value,"text-gray-600 hover:bg-gray-100 hover:text-gray-900":n.fileTypeFilter!==t.value}])},[(0,a.Lk)("i",{class:(0,l.C4)([t.icon,"text-sm w-4"])},null,2),(0,a.Lk)("span",Sr,(0,l.v_)(t.label),1),s.getFilterCount(t.value)>0?((0,a.uX)(),(0,a.CE)("span",{key:0,class:(0,l.C4)(["px-2 py-1 text-xs rounded-full",{"bg-blue-200 text-blue-800":n.fileTypeFilter===t.value,"bg-gray-200 text-gray-600":n.fileTypeFilter!==t.value}])},(0,l.v_)(s.getFilterCount(t.value)),3)):(0,a.Q3)("",!0)],10,Er))),64))])])])])])):(0,a.Q3)("",!0)],6),n.createFolderModal?((0,a.uX)(),(0,a.Wv)(xn,{key:0,class:"z-[99999]",isWindowsOpen:!0,onCreateFolderTrigger:s.createFolderTrigger,onCreateFolderEvent:s.createFolder},null,8,["onCreateFolderTrigger","onCreateFolderEvent"])):(0,a.Q3)("",!0),n.RenameFolderModal?((0,a.uX)(),(0,a.Wv)(kn,{key:1,class:"z-[99999]",isWindowsOpen:!0,renameTriggerObj:this.renameTriggerObj,renameTriggerId:this.renameTriggerId,oldname:this.oldname,onRenameFolderTrigger:s.RenameFolderTrigger,onRenameFolderEvent:s.RenameFolder},null,8,["renameTriggerObj","renameTriggerId","oldname","onRenameFolderTrigger","onRenameFolderEvent"])):(0,a.Q3)("",!0),n.isResizeModalOpen?((0,a.uX)(),(0,a.CE)("div",Ar,[e[92]||(e[92]=(0,a.Lk)("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300"},null,-1)),(0,a.Lk)("div",Cr,[(0,a.Lk)("div",Lr,[e[91]||(e[91]=(0,a.Lk)("div",{class:"bg-gradient-to-r from-blue-600 to-indigo-600 px-6 py-4"},[(0,a.Lk)("h2",{class:"text-xl font-semibold text-white"},"ปรับคุณภาพรูปภาพ"),(0,a.Lk)("p",{class:"text-blue-100 text-sm mt-1"},"เลือกคุณภาพที่ต้องการสำหรับรูปภาพ")],-1)),(0,a.Lk)("div",Ir,[(0,a.Lk)("div",Dr,[e[88]||(e[88]=(0,a.Lk)("label",{class:"block text-sm font-medium text-gray-700 mb-3"},"เลือกคุณภาพด่วน",-1)),(0,a.Lk)("div",Rr,[((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)([10,30,50,80],(t=>(0,a.Lk)("button",{key:t,onClick:e=>n.selectedImageQuality=t/100,class:(0,l.C4)(["px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200",{"bg-blue-600 text-white shadow-md":n.selectedImageQuality===t/100,"bg-gray-100 text-gray-700 hover:bg-gray-200":n.selectedImageQuality!==t/100}])},(0,l.v_)(t)+"% ",11,Pr))),64))])]),(0,a.Lk)("div",Tr,[e[89]||(e[89]=(0,a.Lk)("label",{for:"quality",class:"block text-sm font-medium text-gray-700 mb-3"},"ปรับแต่งคุณภาพ",-1)),(0,a.Lk)("div",Fr,[(0,a.bo)((0,a.Lk)("input",{type:"range","onUpdate:modelValue":e[27]||(e[27]=t=>n.selectedImageQuality=t),id:"quality",min:"0.1",max:"1",step:"0.01",class:"flex-1 h-2 bg-gray-200 rounded-lg appearance-none cursor-pointer slider"},null,512),[[h.Jo,n.selectedImageQuality]]),(0,a.Lk)("div",Br,[(0,a.Lk)("span",Ur,(0,l.v_)((100*n.selectedImageQuality).toFixed(0))+"% ",1)])])])]),(0,a.Lk)("div",Or,[(0,a.Lk)("button",{onClick:e[28]||(e[28]=t=>n.isResizeModalOpen=!1),class:"inline-flex items-center px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg text-sm font-medium transition-colors duration-200"}," ยกเลิก "),(0,a.Lk)("button",{onClick:e[29]||(e[29]=(...t)=>s.handleResizeImage&&s.handleResizeImage(...t)),class:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","magic"],class:"mr-2 text-xs"}),e[90]||(e[90]=(0,a.eW)(" ปรับคุณภาพ "))])])])])])):(0,a.Q3)("",!0),n.isModalVisible?((0,a.uX)(),(0,a.CE)("div",Nr,[e[97]||(e[97]=(0,a.Lk)("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300"},null,-1)),(0,a.Lk)("div",zr,[(0,a.Lk)("div",jr,[e[96]||(e[96]=(0,a.Lk)("div",{class:"bg-gradient-to-r from-green-600 to-emerald-600 px-6 py-4"},[(0,a.Lk)("h3",{class:"text-xl font-semibold text-white"},"เพิ่ม Streaming File"),(0,a.Lk)("p",{class:"text-green-100 text-sm mt-1"},"เพิ่มไฟล์จาก URL ภายนอก")],-1)),(0,a.Lk)("div",Xr,[(0,a.Lk)("div",null,[e[93]||(e[93]=(0,a.Lk)("label",{for:"name",class:"block text-sm font-medium text-gray-700 mb-2"},"ชื่อไฟล์",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[30]||(e[30]=t=>n.fileName=t),type:"text",id:"name",placeholder:"กรอกชื่อไฟล์",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors duration-200"},null,512),[[h.Jo,n.fileName]])]),(0,a.Lk)("div",null,[e[94]||(e[94]=(0,a.Lk)("label",{for:"url",class:"block text-sm font-medium text-gray-700 mb-2"},"URL",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[31]||(e[31]=t=>n.fileUrl=t),type:"url",id:"url",placeholder:"กรอก URL ของไฟล์",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500 focus:border-green-500 transition-colors duration-200"},null,512),[[h.Jo,n.fileUrl]])])]),(0,a.Lk)("div",$r,[(0,a.Lk)("button",{onClick:e[32]||(e[32]=(...t)=>s.closeModal&&s.closeModal(...t)),class:"inline-flex items-center px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg text-sm font-medium transition-colors duration-200"}," ยกเลิก "),(0,a.Lk)("button",{onClick:e[33]||(e[33]=(...t)=>s.submitFile&&s.submitFile(...t)),class:"inline-flex items-center px-4 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","plus"],class:"mr-2 text-xs"}),e[95]||(e[95]=(0,a.eW)(" เพิ่มไฟล์ "))])])])])])):(0,a.Q3)("",!0),n.showModal?((0,a.uX)(),(0,a.CE)("div",{key:4,class:(0,l.C4)(["popup"===r.Mode?"fixed inset-0 z-[60]":"fixed inset-0 z-50","overflow-y-auto"])},[e[112]||(e[112]=(0,a.Lk)("div",{class:"fixed inset-0 bg-black/80 backdrop-blur-sm transition-opacity duration-300"},null,-1)),(0,a.Lk)("div",Vr,[(0,a.Lk)("div",{class:(0,l.C4)(["relative w-full bg-white rounded-xl shadow-2xl overflow-hidden transform transition-all duration-300","popup"===r.Mode?"max-w-3xl max-h-[50vh]":"max-w-5xl"]),style:(0,l.Tr)("popup"===r.Mode?{maxHeight:"50vh"}:{})},[(0,a.Lk)("div",Yr,[(0,a.Lk)("div",qr,[(0,a.Lk)("div",Gr,[(0,a.Lk)("div",Hr,[(0,a.Lk)("div",Wr,[(0,a.bF)(o,{icon:["fas","image"===n.modalContent?"image":"video"===n.modalContent?"video":"pdf"===n.modalContent?"file-pdf":"file"],class:"text-white text-sm"},null,8,["icon"])]),(0,a.Lk)("div",null,[(0,a.Lk)("h3",{class:"text-white font-semibold text-base truncate max-w-md",title:n.viewFilename},(0,l.v_)(n.viewFilename),9,Kr),(0,a.Lk)("p",Qr,(0,l.v_)(s.formatBytes(n.viewFilesize)),1)])])]),(0,a.Lk)("div",Zr,[(0,a.Lk)("button",{onClick:e[34]||(e[34]=t=>n.showConvertOptions=!n.showConvertOptions),type:"button",class:"inline-flex items-center px-2 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-md text-xs font-medium transition-colors duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","cog"],class:"mr-1 text-xs"}),(0,a.eW)(" "+(0,l.v_)(n.showConvertOptions?"ยกเลิก":"แปลงไฟล์"),1)]),(0,a.Lk)("button",{onClick:e[35]||(e[35]=t=>s.deleteFile(n.viewFileurl)),type:"button",class:"inline-flex items-center px-2 py-1.5 bg-red-600 hover:bg-red-700 text-white rounded-md text-xs font-medium transition-colors duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","trash"],class:"mr-1 text-xs"}),e[98]||(e[98]=(0,a.eW)(" ลบไฟล์ "))]),(0,a.Lk)("button",{onClick:e[36]||(e[36]=t=>n.showModal=!1),type:"button",class:"inline-flex items-center justify-center w-8 h-8 bg-gray-600 hover:bg-gray-700 text-white rounded-md transition-colors duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","times"],class:"text-sm"})])])]),n.showConvertOptions?((0,a.uX)(),(0,a.CE)("div",Jr,[(0,a.Lk)("div",ti,[(0,a.Lk)("div",ei,[(0,a.Lk)("button",{onClick:e[37]||(e[37]=(...t)=>s.toggleDropdown&&s.toggleDropdown(...t)),type:"button",class:"flex items-center px-3 py-1.5 bg-indigo-600 hover:bg-indigo-700 text-white rounded-md shadow-sm transition-colors duration-200 text-xs font-medium"},[(0,a.Lk)("span",null,(0,l.v_)(n.selectedQuality||"เลือกคุณภาพ"),1),(0,a.bF)(o,{icon:["fas","chevron-down"],class:"ml-2 text-xs"})]),n.dropdownOpen?((0,a.uX)(),(0,a.CE)("div",ri,[(0,a.Lk)("ul",ii,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.filteredQualities,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t},[(0,a.Lk)("button",{onClick:e=>s.selectQuality(t),disabled:n.selectItemData.transcode&&n.selectItemData.transcode[t],class:(0,l.C4)([{"opacity-50 cursor-not-allowed":n.selectItemData.transcode&&n.selectItemData.transcode[t]},"block w-full text-left px-4 py-2 text-gray-700 hover:bg-gray-100 text-sm transition-colors duration-200"])},[(0,a.eW)((0,l.v_)(t)+" ",1),n.selectItemData.transcode&&n.selectItemData.transcode[t]?((0,a.uX)(),(0,a.CE)("span",si," (แปลงแล้ว) ")):(0,a.Q3)("",!0)],10,ni)])))),128))])])):(0,a.Q3)("",!0)]),n.selectedQuality?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e[38]||(e[38]=t=>s.convertVideo(n.selectItemData)),type:"button",class:"inline-flex items-center px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md shadow-sm transition-colors duration-200 text-xs font-medium"},[(0,a.bF)(o,{icon:["fas","check"],class:"mr-1 text-xs"}),e[99]||(e[99]=(0,a.eW)(" แปลงไฟล์ "))])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",{class:(0,l.C4)(["relative bg-gray-900 flex items-center justify-center","popup"===r.Mode?"min-h-[200px] max-h-[30vh]":"min-h-[400px]"]),style:(0,l.Tr)("popup"===r.Mode?{maxHeight:"30vh"}:{})},["image"===n.modalContent?((0,a.uX)(),(0,a.CE)("div",oi,[(0,a.Lk)("img",{src:t.selectedFile,alt:"Preview",class:(0,l.C4)("popup"===r.Mode?"max-w-full max-h-[25vh] object-contain rounded-lg shadow-2xl":"max-w-full max-h-[60vh] object-contain rounded-lg shadow-2xl")},null,10,ai)])):"video"===n.modalContent?((0,a.uX)(),(0,a.CE)("div",li,[n.selectItemData?.stream&&n.selectItemData?.stream?.streamId?((0,a.uX)(),(0,a.CE)("div",hi,[(0,a.Lk)("div",ui,[(0,a.Lk)("div",ci,[e[100]||(e[100]=(0,a.Lk)("div",{class:"w-1.5 h-1.5 bg-green-300 rounded-full mr-1.5 animate-pulse"},null,-1)),(0,a.eW)(" Stream: "+(0,l.v_)(n.selectItemData.stream.streamStatus),1)])]),(0,a.bF)(_n,{type:"default",onPause:s.processPause,previewImageLink:n.selectItemData?.stream?.streamThumbnail,link:n.selectItemData?.stream?.streamPlayback,isMuted:!1,isControls:!0,class:"w-full h-full rounded-lg overflow-hidden shadow-2xl"},null,8,["onPause","previewImageLink","link"])])):((0,a.uX)(),(0,a.CE)("div",fi,[(0,a.Lk)("div",di,[(0,a.Lk)("div",pi,[(0,a.bF)(o,{icon:["fas","play"],class:"mr-1.5 text-xs"}),e[101]||(e[101]=(0,a.eW)(" Video "))])]),(0,a.Lk)("video",{ref:"videoStreaming",controls:"",crossorigin:"",playsinline:"",class:"w-full h-full rounded-lg shadow-2xl",style:(0,l.Tr)("popup"===r.Mode?"max-height: 25vh;":"max-height: 60vh;")},[(0,a.Lk)("source",{src:t.selectedFile},null,8,mi)],4)]))])):"pdf"===n.modalContent?((0,a.uX)(),(0,a.CE)("div",gi,[(0,a.Lk)("div",wi,[(0,a.Lk)("div",bi,[(0,a.Lk)("div",yi,[(0,a.bF)(o,{icon:["fas","file-pdf"],class:"mr-1.5 text-xs"}),e[102]||(e[102]=(0,a.eW)(" PDF Document "))])]),(0,a.Lk)("div",{class:"w-full bg-white rounded-lg shadow-2xl overflow-hidden",style:(0,l.Tr)("popup"===r.Mode?"height: 25vh;":"height: 60vh;")},[(0,a.Lk)("iframe",{src:t.selectedFile+"#toolbar=1&navpanes=1&scrollbar=1&page=1&view=FitH",class:"w-full h-full border-0",type:"application/pdf",title:"PDF Preview"},null,8,vi)],4),(0,a.Lk)("div",xi,[(0,a.Lk)("a",{href:t.selectedFile,target:"_blank",class:"inline-flex items-center px-2 py-1.5 bg-white bg-opacity-90 hover:bg-opacity-100 text-gray-700 rounded-md text-xs font-medium transition-all duration-200 shadow-sm border border-gray-200"},[(0,a.bF)(o,{icon:["fas","external-link-alt"],class:"mr-1 text-xs"}),e[103]||(e[103]=(0,a.eW)(" เปิดในแท็บใหม่ "))],8,ki),(0,a.Lk)("a",{href:t.selectedFile,download:"",class:"inline-flex items-center px-2 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-xs font-medium transition-all duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","download"],class:"mr-1 text-xs"}),e[104]||(e[104]=(0,a.eW)(" ดาวน์โหลด "))],8,_i)])])])):(0,a.Q3)("",!0)],6),(0,a.Lk)("div",Mi,[(0,a.Lk)("div",Ei,[(0,a.Lk)("div",Si,[(0,a.Lk)("div",Ai,[(0,a.Lk)("div",Ci,[(0,a.bF)(o,{icon:["fas","image"===n.modalContent?"image":"video"===n.modalContent?"video":"pdf"===n.modalContent?"file-pdf":"file"],class:"text-gray-600 text-lg"},null,8,["icon"])]),(0,a.Lk)("div",null,[(0,a.Lk)("h4",{class:"text-sm font-semibold text-gray-900 truncate max-w-xs",title:n.viewFilename},(0,l.v_)(n.viewFilename),9,Li),(0,a.Lk)("div",Ii,[(0,a.Lk)("span",Di,[(0,a.bF)(o,{icon:["fas","hdd"],class:"mr-1"}),(0,a.eW)(" "+(0,l.v_)(s.formatBytes(n.viewFilesize)),1)]),"video"===n.modalContent&&n.viewFileDuration?((0,a.uX)(),(0,a.CE)("span",Ri,[(0,a.bF)(o,{icon:["fas","clock"],class:"mr-1"}),(0,a.eW)(" "+(0,l.v_)(s.formatDuration(n.viewFileDuration)),1)])):(0,a.Q3)("",!0),n.viewFilecreate?((0,a.uX)(),(0,a.CE)("span",Pi,[(0,a.bF)(o,{icon:["fas","calendar"],class:"mr-1"}),(0,a.eW)(" "+(0,l.v_)(s.formatDate(n.viewFilecreate)),1)])):(0,a.Q3)("",!0)])])])]),(0,a.Lk)("div",Ti,["video"===n.modalContent&&n.selectItemData?.stream?((0,a.uX)(),(0,a.CE)("div",Fi,[(0,a.Lk)("div",Bi,[e[105]||(e[105]=(0,a.Lk)("div",{class:"w-2 h-2 bg-green-500 rounded-full animate-pulse"},null,-1)),(0,a.Lk)("span",null,"Stream: "+(0,l.v_)(n.selectItemData.stream.streamStatus),1)]),(0,a.Lk)("button",{onClick:e[39]||(e[39]=(...t)=>s.toggleStreamMenu&&s.toggleStreamMenu(...t)),class:"p-1.5 text-gray-400 hover:text-gray-600 hover:bg-gray-100 rounded-md transition-colors duration-200",title:"จัดการ Stream"},[(0,a.bF)(o,{icon:["fas","cog"],class:"text-xs"})]),n.showStreamMenu?((0,a.uX)(),(0,a.CE)("div",Ui,[(0,a.Lk)("div",Oi,[(0,a.Lk)("button",{onClick:e[40]||(e[40]=t=>s.streamFile(n.selectItemData.path,n.selectItemData.name)),class:"block w-full text-left px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 transition-colors duration-200"},[(0,a.bF)(o,{icon:["fas","sync-alt"],class:"mr-2 text-xs"}),e[106]||(e[106]=(0,a.eW)(" รีเฟรช Stream "))]),(0,a.Lk)("button",{onClick:e[41]||(e[41]=t=>s.deleteStream(n.selectItemData.stream.streamId,n.selectItemData._id)),class:"block w-full text-left px-4 py-2 text-sm text-red-600 hover:bg-red-50 transition-colors duration-200"},[(0,a.bF)(o,{icon:["fas","trash"],class:"mr-2 text-xs"}),e[107]||(e[107]=(0,a.eW)(" ลบ Stream "))])])])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"video"===n.modalContent&&n.selectItemData?.transcode?((0,a.uX)(),(0,a.CE)("div",Ni,[(0,a.Lk)("div",zi,[(0,a.bF)(o,{icon:["fas","video"],class:"text-xs"}),e[108]||(e[108]=(0,a.Lk)("span",null,"Transcoded",-1))])])):(0,a.Q3)("",!0),(0,a.Lk)("div",ji,[(0,a.Lk)("span",null,(0,l.v_)(s.getFileExtension(n.viewFilename).replace(".","").toUpperCase()),1)]),(0,a.Lk)("div",Xi,["popup"===r.Mode&&s.isAllowedFile(n.viewFilename)?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e[42]||(e[42]=e=>s.selectFileFunc({name:n.viewFilename,path:t.selectedFile,type:n.modalContent,duration:n.viewFileDuration,thumbnail:n.viewFileThumbnail},n.viewFileDuration,n.viewFileThumbnail)),class:"inline-flex items-center px-3 py-1.5 bg-green-600 hover:bg-green-700 text-white rounded-md text-xs font-medium transition-colors duration-200 shadow-sm",title:"เลือกไฟล์นี้"},[(0,a.bF)(o,{icon:["fas","check"],class:"mr-1 text-xs"}),e[109]||(e[109]=(0,a.eW)(" เลือกไฟล์ "))])):(0,a.Q3)("",!0),(0,a.Lk)("a",{href:t.selectedFile,download:"",class:"inline-flex items-center px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-md text-xs font-medium transition-colors duration-200 shadow-sm",title:"ดาวน์โหลดไฟล์"},[(0,a.bF)(o,{icon:["fas","download"],class:"mr-1 text-xs"}),e[110]||(e[110]=(0,a.eW)(" ดาวน์โหลด "))],8,$i),(0,a.Lk)("button",{onClick:e[43]||(e[43]=e=>s.copyToClipboard(t.selectedFile)),class:"inline-flex items-center px-3 py-1.5 bg-gray-600 hover:bg-gray-700 text-white rounded-md text-xs font-medium transition-colors duration-200 shadow-sm",title:"คัดลอกลิงก์"},[(0,a.bF)(o,{icon:["fas","link"],class:"mr-1 text-xs"}),e[111]||(e[111]=(0,a.eW)(" คัดลอก "))])])])])])],6)])],2)):(0,a.Q3)("",!0),n.uploadPanel?((0,a.uX)(),(0,a.CE)("div",Vi,[e[117]||(e[117]=(0,a.Lk)("div",{class:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity duration-300"},null,-1)),(0,a.Lk)("div",Yi,[(0,a.Lk)("div",qi,[(0,a.Lk)("div",Gi,[(0,a.Lk)("div",Hi,[e[113]||(e[113]=(0,a.Lk)("div",null,[(0,a.Lk)("h3",{class:"text-xl font-semibold text-white"},"อัพโหลดไฟล์"),(0,a.Lk)("p",{class:"text-blue-100 text-sm mt-1"},"เลือกไฟล์ที่ต้องการอัพโหลด")],-1)),(0,a.Lk)("button",{onClick:e[44]||(e[44]=(...t)=>s.closeUploadBox&&s.closeUploadBox(...t)),class:"p-2 text-blue-100 hover:text-white hover:bg-white/10 rounded-lg transition-colors duration-200"},[(0,a.bF)(o,{icon:["fas","times"],class:"text-lg"})])])]),(0,a.Lk)("div",Wi,[(0,a.Lk)("input",{type:"file",ref:"files",onChange:e[45]||(e[45]=(...t)=>s.handleFilesUpload&&s.handleFilesUpload(...t)),multiple:"",class:"hidden"},null,544),(0,a.Lk)("div",{onClick:e[46]||(e[46]=(...t)=>s.addFiles&&s.addFiles(...t)),class:"border-2 border-dashed border-gray-300 hover:border-blue-400 rounded-xl p-8 text-center cursor-pointer transition-colors duration-200 bg-gray-50 hover:bg-blue-50"},[(0,a.Lk)("div",Ki,[(0,a.Lk)("div",Qi,[(0,a.bF)(o,{icon:["fas","cloud-upload-alt"],class:"text-blue-600 text-2xl"})]),e[115]||(e[115]=(0,a.Lk)("div",null,[(0,a.Lk)("h4",{class:"text-lg font-semibold text-gray-900 mb-2"},"เลือกไฟล์หรือลากไฟล์มาวาง"),(0,a.Lk)("p",{class:"text-gray-500 text-sm"},"คลิกเพื่อเลือกไฟล์หรือลากไฟล์มาวางในพื้นที่นี้")],-1)),(0,a.Lk)("button",Zi,[(0,a.bF)(o,{icon:["fas","folder-open"],class:"mr-2 text-xs"}),e[114]||(e[114]=(0,a.eW)(" เลือกไฟล์ "))])])]),n.files.length>0?((0,a.uX)(),(0,a.CE)("div",Ji,[(0,a.Lk)("h4",tn,"ไฟล์ที่เลือก ("+(0,l.v_)(n.files.length)+" ไฟล์)",1),(0,a.Lk)("div",en,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(n.files,((t,r)=>((0,a.uX)(),(0,a.CE)("div",{key:r,class:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200"},[(0,a.Lk)("div",rn,[(0,a.Lk)("div",nn,[(0,a.bF)(o,{icon:["fas","file"],class:"text-blue-600 text-sm"})]),(0,a.Lk)("div",sn,[(0,a.Lk)("p",{class:"text-sm font-medium text-gray-900 truncate",title:t.name},(0,l.v_)(t.name),9,on),(0,a.Lk)("p",an,(0,l.v_)(s.formatBytes(t.size)),1),"uploading"===t.status?((0,a.uX)(),(0,a.CE)("div",ln,[(0,a.Lk)("div",hn,[e[116]||(e[116]=(0,a.Lk)("span",null,"กำลังอัพโหลด...",-1)),(0,a.Lk)("span",null,(0,l.v_)(t.progress||0)+"%",1)]),(0,a.Lk)("div",un,[(0,a.Lk)("div",{class:"bg-blue-600 h-1.5 rounded-full transition-all duration-300",style:(0,l.Tr)({width:(t.progress||0)+"%"})},null,4)])])):(0,a.Q3)("",!0),t.status?((0,a.uX)(),(0,a.CE)("div",cn,[(0,a.Lk)("span",{class:(0,l.C4)(["inline-flex items-center px-2 py-1 rounded-full text-xs font-medium",{"bg-yellow-100 text-yellow-800":"pending"===t.status,"bg-blue-100 text-blue-800":"uploading"===t.status,"bg-green-100 text-green-800":"success"===t.status,"bg-red-100 text-red-800":"error"===t.status,"bg-gray-100 text-gray-800":"cancelled"===t.status}])},[(0,a.bF)(o,{icon:["fas","pending"===t.status?"clock":"uploading"===t.status?"spinner":"success"===t.status?"check":"error"===t.status?"exclamation-triangle":"times"],class:(0,l.C4)([{"animate-spin":"uploading"===t.status},"mr-1 text-xs"])},null,8,["icon","class"]),(0,a.eW)(" "+(0,l.v_)("pending"===t.status?"รอการอัพโหลด":"uploading"===t.status?"กำลังอัพโหลด":"success"===t.status?"อัพโหลดสำเร็จ":"error"===t.status?"อัพโหลดล้มเหลว":"ยกเลิกแล้ว"),1)],2)])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",fn,["uploading"===t.status?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e=>s.cancelUpload(t.name),class:"p-1.5 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-md transition-colors duration-200",title:"ยกเลิกการอัพโหลด"},[(0,a.bF)(o,{icon:["fas","times"],class:"text-xs"})],8,dn)):((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t=>s.removeFile(r),class:"p-1.5 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors duration-200",title:"ลบไฟล์"},[(0,a.bF)(o,{icon:["fas","trash"],class:"text-xs"})],8,pn))])])))),128))])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",mn,[(0,a.Lk)("div",gn,[n.files.length>0?((0,a.uX)(),(0,a.CE)("span",wn,(0,l.v_)(n.files.length)+" ไฟล์ที่เลือก",1)):((0,a.uX)(),(0,a.CE)("span",bn,"ยังไม่ได้เลือกไฟล์"))]),(0,a.Lk)("div",yn,[(0,a.Lk)("button",{onClick:e[47]||(e[47]=(...t)=>s.closeUploadBox&&s.closeUploadBox(...t)),class:"inline-flex items-center px-4 py-2 bg-gray-300 hover:bg-gray-400 text-gray-700 rounded-lg text-sm font-medium transition-colors duration-200"}," ยกเลิก "),(0,a.Lk)("button",{onClick:e[48]||(e[48]=(...t)=>s.submitFiles&&s.submitFiles(...t)),disabled:0===n.files.length,class:"inline-flex items-center px-4 py-2 bg-blue-600 hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-lg text-sm font-medium transition-colors duration-200 shadow-sm"},[(0,a.bF)(o,{icon:["fas","upload"],class:"mr-2 text-xs"}),(0,a.eW)(" อัพโหลด ("+(0,l.v_)(n.files.length)+") ",1)],8,vn)])])])])])):(0,a.Q3)("",!0)],64)}r(44114),r(16573),r(78100),r(77936),r(37467),r(44732),r(79577),r(72577),r(37550);var kn=r(50953),_n=r(94232),Mn=r(10797);const En={class:"fixed inset-0 overflow-y-auto"},Sn={class:"flex min-h-full items-center justify-center p-4 text-center z-[99999]"},An={class:"mt-2 pb-4 border-b"},Cn={class:"mt-4"},Ln={props:["isWindowsOpen","allowFileType","callbackFunction"],data(){return{isOpen:this.isWindowsOpen,loading_sources:!0,activeBlock:!1,foldername:""}},components:{},methods:{createFolder(){console.log("foldername",this.foldername),this.$emit("createFolderEvent",{foldername:this.$refs.form.foldername.value})},isLetterOrNumber(t){let e=String.fromCharCode(t.keyCode);if(/^[a-zA-Z0-9@#&().+_"-]*$/.test(e))return!0;t.preventDefault()},closeModal(){this.isOpen=!1,this.$emit("createFolderTrigger",!1)}},mounted(){},setup(){}};var In=Object.assign(Ln,{__name:"CreateFolder",setup(t){return(t,e)=>{const r=(0,a.g2)("font-awesome-icon");return t.loading_sources?((0,a.uX)(),(0,a.Wv)((0,kn.R1)(_n.O),{key:0,appear:"",show:t.isOpen,as:"template"},{default:(0,a.k6)((()=>[(0,a.bF)((0,kn.R1)(Mn.lG),{as:"div",onClose:t.closeModal,class:"relative z-10"},{default:(0,a.k6)((()=>[(0,a.bF)((0,kn.R1)(_n._),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:(0,a.k6)((()=>e[5]||(e[5]=[(0,a.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)]))),_:1}),(0,a.Lk)("div",En,[(0,a.Lk)("div",Sn,[(0,a.bF)((0,kn.R1)(_n._),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:(0,a.k6)((()=>[(0,a.bF)((0,kn.R1)(Mn.Lj),{class:(0,l.C4)(["w-[20rem] transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all blocking relative",[t.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},{default:(0,a.k6)((()=>[(0,a.bF)((0,kn.R1)(Mn.L3),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 pb-4 border-b"},{default:(0,a.k6)((()=>e[6]||(e[6]=[(0,a.eW)("สร้างโฟลเดอร์ใหม่ (Create Folder)")]))),_:1}),(0,a.Lk)("div",An,[(0,a.Lk)("form",{onSubmit:e[2]||(e[2]=(0,h.D$)(((...e)=>t.createFolder&&t.createFolder(...e)),["prevent"])),ref:"form"},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=e=>t.foldername=e),onKeydown:e[1]||(e[1]=(0,h.jR)((0,h.D$)(((...e)=>t.createFolder&&t.createFolder(...e)),["prevent"]),["enter"])),type:"text",name:"foldername",id:"foldername",autocomplete:"foldername",class:"mt-1 block w-full rounded-md py-2 px-3 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-gray-900 sm:text-sm"},null,544),[[h.Jo,t.foldername]])],544)]),(0,a.Lk)("div",Cn,[(0,a.Lk)("button",{type:"button",class:"w-50 inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-md font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:e[3]||(e[3]=(...e)=>t.createFolder&&t.createFolder(...e))},[(0,a.bF)(r,{icon:["fas","check"],class:"text-white text-[12px] mr-2"}),e[7]||(e[7]=(0,a.eW)(" สร้าง "))]),(0,a.Lk)("button",{type:"button",class:"w-50 inline-flex items-center rounded-md border border-transparent bg-indigo-600 ml-2 px-4 py-2 text-md font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:e[4]||(e[4]=(...e)=>t.closeModal&&t.closeModal(...e))},[(0,a.bF)(r,{icon:["fas","check"],class:"text-white text-[12px] mr-2"}),e[8]||(e[8]=(0,a.eW)(" ยกเลิก "))])])])),_:1},8,["class"])])),_:1})])])])),_:1},8,["onClose"])])),_:1},8,["show"])):(0,a.Q3)("",!0)}}});const Dn=In;var Rn=Dn;const Pn={class:"fixed inset-0 overflow-y-auto"},Tn={class:"flex min-h-full items-center justify-center p-4 text-center"},Fn={class:"text-gray-500"},Bn={class:"mt-2 pb-4 border-b"},Un=["value"],On=["value"],Nn=["value"],zn={class:"mt-4"},jn={data(){return{loading_sources:!0,activeBlock:!1,foldername:"",originalname:"",originalid:""}},components:{},methods:{renameFolder(){this.$emit("rename-folder-event",{foldername:this.$refs.form.foldername.value,originalname:this.$refs.form.originalname.value,originalid:this.$refs.form.originalid.value})},isLetterOrNumber(t){let e=String.fromCharCode(t.keyCode);if(/^[a-zA-Z0-9@#&().+_"-]*$/.test(e))return!0;t.preventDefault()}},async mounted(){},setup(){},watch:{foldername(t){console.log(t);let e=t.replace(/[^\x20-\x7E]/g,"");console.log(e),this.foldername=e}}};var Xn=Object.assign(jn,{__name:"RenameFolder",props:{isWindowsOpen:Boolean,renameTriggerObj:String,renameTriggerId:String,oldname:String},emits:["rename-folder-trigger","rename-folder-event"],setup(t,{emit:e}){const r=t,i=e,n=(0,kn.KR)(r.isWindowsOpen),s=(0,kn.KR)(r.renameTriggerObj),o=(0,kn.KR)(r.renameTriggerId),u=(0,kn.KR)(r.oldname);function c(){n.value=!1,i("rename-folder-trigger",!1)}return i("rename-folder-trigger",!0),(t,e)=>{const r=(0,a.g2)("font-awesome-icon");return t.loading_sources?((0,a.uX)(),(0,a.Wv)((0,kn.R1)(_n.O),{key:0,appear:"",show:n.value,as:"template"},{default:(0,a.k6)((()=>[(0,a.bF)((0,kn.R1)(Mn.lG),{as:"div",onClose:c,class:"relative z-10"},{default:(0,a.k6)((()=>[(0,a.bF)((0,kn.R1)(_n._),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:(0,a.k6)((()=>e[3]||(e[3]=[(0,a.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)]))),_:1}),(0,a.Lk)("div",Pn,[(0,a.Lk)("div",Tn,[(0,a.bF)((0,kn.R1)(_n._),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:(0,a.k6)((()=>[(0,a.bF)((0,kn.R1)(Mn.Lj),{class:(0,l.C4)(["w-[20rem] transform overflow-hidden rounded-2xl bg-white p-6 text-left align-middle shadow-xl transition-all blocking relative",[t.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},{default:(0,a.k6)((()=>[(0,a.bF)((0,kn.R1)(Mn.L3),{as:"h3",class:"text-lg font-medium leading-6 text-gray-900 pb-4 border-b"},{default:(0,a.k6)((()=>[e[4]||(e[4]=(0,a.eW)("เปลี่ยนชื่อ ")),e[5]||(e[5]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("small",Fn,(0,l.v_)(u.value),1)])),_:1}),(0,a.Lk)("div",Bn,[(0,a.Lk)("form",{onSubmit:e[1]||(e[1]=(0,h.D$)(((...e)=>t.renameFolder&&t.renameFolder(...e)),["prevent"])),ref:"form"},[(0,a.Lk)("input",{type:"text",name:"foldername",id:"foldername",autocomplete:"foldername",class:"mt-1 block w-full rounded-md py-2 px-3 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-gray-900 sm:text-sm",value:u.value,onKeydown:e[0]||(e[0]=(0,h.jR)((0,h.D$)(((...e)=>t.renameFolder&&t.renameFolder(...e)),["prevent"]),["enter"]))},null,40,Un),(0,a.Lk)("input",{type:"hidden",name:"originalname",id:"originalname",autocomplete:"originalname",class:"mt-1 block w-full rounded-md py-2 px-3 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-gray-900 sm:text-sm",value:s.value},null,8,On),(0,a.Lk)("input",{type:"hidden",name:"originalid",id:"originalid",autocomplete:"originalid",class:"mt-1 block w-full rounded-md py-2 px-3 shadow-sm focus:border-gray-900 focus:outline-none focus:ring-gray-900 sm:text-sm",value:o.value},null,8,Nn)],544)]),(0,a.Lk)("div",zn,[(0,a.Lk)("button",{type:"button",class:"w-50 inline-flex items-center rounded-md border border-transparent bg-indigo-600 px-4 py-2 text-md font-medium text-white shadow-sm hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:e[2]||(e[2]=(...e)=>t.renameFolder&&t.renameFolder(...e))},[(0,a.bF)(r,{icon:["fas","check"],class:"text-white text-[12px] mr-2"}),e[6]||(e[6]=(0,a.eW)(" เปลี่ยนชื่อ "))]),(0,a.Lk)("button",{type:"button",class:"w-50 inline-flex items-center rounded-md border border-gray-300 bg-gray-200 ml-2 px-4 py-2 text-md font-medium text-black shadow-sm hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:c}," ยกเลิก ")])])),_:1},8,["class"])])),_:1})])])])),_:1})])),_:1},8,["show"])):(0,a.Q3)("",!0)}}});const $n=Xn;var Vn=$n,Yn=r(75220),qn=r(30554),Gn=r(6743),Hn=r(48663),Wn=r(25581),Kn=r(58604),Qn=r(86668),Zn=r(43679);class Jn{constructor(){this.onabort=null,this._aborted=!1,Object.defineProperty(this,"_aborted",{value:!1,writable:!0})}get aborted(){return this._aborted}abort(){this._aborted=!0,this.onabort&&(this.onabort(this),this.onabort=null)}}class ts{constructor(){this.signal=new Jn}abort(){this.signal.abort()}}var es=r(84255),rs=r(90146),is=r(37007),ns=r(66339);const ss={lstatSync:()=>{}},os={...ss,runtime:"browser"},as=t=>{if(null===t||void 0===t)return 0;if("string"===typeof t)return ns.hp.byteLength(t);if("number"===typeof t.byteLength)return t.byteLength;if("number"===typeof t.length)return t.length;if("number"===typeof t.size)return t.size;if("string"===typeof t.path)try{return os.lstatSync(t.path).size}catch(e){return}};var ls=r(91330);async function*hs(t,e,r){let i=1;const n={chunks:[],length:0};for await(const s of r(t)){n.chunks.push(s),n.length+=s.byteLength;while(n.length>e){const t=n.chunks.length>1?ns.hp.concat(n.chunks):n.chunks[0];yield{partNumber:i,data:t.subarray(0,e)},n.chunks=[t.subarray(e)],n.length=n.chunks[0].byteLength,i+=1}}yield{partNumber:i,data:1!==n.chunks.length?ns.hp.concat(n.chunks):n.chunks[0],lastPart:!0}}async function*us(t,e){let r=1,i=0,n=e;while(n<t.byteLength)yield{partNumber:r,data:t.subarray(i,n)},r+=1,i=n,n=i+e;yield{partNumber:r,data:t.subarray(i),lastPart:!0}}async function*cs(t){for await(const e of t)ns.hp.isBuffer(e)||e instanceof Uint8Array?yield e:yield ns.hp.from(e)}async function*fs(t){const e=t.getReader();try{while(1){const{done:t,value:r}=await e.read();if(t)return;ns.hp.isBuffer(r)||r instanceof Uint8Array?yield r:yield ns.hp.from(r)}}catch(r){throw r}finally{e.releaseLock()}}const ds=(t,e)=>{if(t instanceof Uint8Array)return us(t,e);if(t instanceof ls.Readable)return hs(t,e,cs);if(t instanceof String||"string"===typeof t)return us(ns.hp.from(t),e);if("function"===typeof t.stream)return hs(t.stream(),e,fs);if(t instanceof ReadableStream)return hs(t,e,fs);throw new Error("Body Data is unsupported format, expected data to be one of: string | Uint8Array | Buffer | Readable | ReadableStream | Blob;.")};class ps extends is.EventEmitter{static MIN_PART_SIZE=5242880;MAX_PARTS=1e4;queueSize=4;partSize=ps.MIN_PART_SIZE;leavePartsOnError=!1;tags=[];client;params;totalBytes;bytesUploadedSoFar;abortController;concurrentUploaders=[];createMultiPartPromise;abortMultipartUploadCommand=null;uploadedParts=[];uploadEnqueuedPartsCount=0;uploadId;uploadEvent;isMultiPart=!0;singleUploadResult;sent=!1;constructor(t){super(),this.queueSize=t.queueSize||this.queueSize,this.partSize=t.partSize||this.partSize,this.leavePartsOnError=t.leavePartsOnError||this.leavePartsOnError,this.tags=t.tags||this.tags,this.client=t.client,this.params=t.params,this.__validateInput(),this.totalBytes=as(this.params.Body),this.bytesUploadedSoFar=0,this.abortController=t.abortController??new ts}async abort(){this.abortController.abort()}async done(){if(this.sent)throw new Error("@aws-sdk/lib-storage: this instance of Upload has already executed .done(). Create a new instance.");return this.sent=!0,await Promise.race([this.__doMultipartUpload(),this.__abortTimeout(this.abortController.signal)])}on(t,e){return this.uploadEvent=t,super.on(t,e)}async __uploadUsingPut(t){this.isMultiPart=!1;const e={...this.params,Body:t.data},r=this.client.config,i=r.requestHandler,n=i instanceof is.EventEmitter?i:null,s=e=>{this.bytesUploadedSoFar=e.loaded,this.totalBytes=e.total,this.__notifyProgress({loaded:this.bytesUploadedSoFar,total:this.totalBytes,part:t.partNumber,Key:this.params.Key,Bucket:this.params.Bucket})};null!==n&&n.on("xhr.upload.progress",s);const o=await Promise.all([this.client.send(new qn.w(e)),r?.endpoint?.()]),a=o[0];let l=o[1];if(l||(l=(0,es.a0)(await(0,es.rC)(e,qn.w,{...r}))),!l)throw new Error('Could not resolve endpoint from S3 "client.config.endpoint()" nor EndpointsV2.');null!==n&&n.off("xhr.upload.progress",s);const h=this.params.Key.split("/").map((t=>(0,rs.$6)(t))).join("/"),u=(0,rs.$6)(this.params.Bucket),c=(()=>{const t=l.hostname.startsWith(`${u}.`),e=this.client.config.forcePathStyle,r=l.port?`:${l.port}`:"";return e?`${l.protocol}//${l.hostname}${r}/${u}/${h}`:t?`${l.protocol}//${l.hostname}${r}/${h}`:`${l.protocol}//${u}.${l.hostname}${r}/${h}`})();this.singleUploadResult={...a,Bucket:this.params.Bucket,Key:this.params.Key,Location:c};const f=as(t.data);this.__notifyProgress({loaded:f,total:f,part:1,Key:this.params.Key,Bucket:this.params.Bucket})}async __createMultipartUpload(){const t=await this.client.config.requestChecksumCalculation();if(!this.createMultiPartPromise){const e={...this.params,Body:void 0};"WHEN_SUPPORTED"===t&&(e.ChecksumAlgorithm=this.params.ChecksumAlgorithm||Gn.VD.CRC32),this.createMultiPartPromise=this.client.send(new Hn.n(e)).then((t=>(this.abortMultipartUploadCommand=new Wn.t({Bucket:this.params.Bucket,Key:this.params.Key,UploadId:t.UploadId}),t)))}return this.createMultiPartPromise}async __doConcurrentUpload(t){for await(const e of t){if(this.uploadEnqueuedPartsCount>this.MAX_PARTS)throw new Error(`Exceeded ${this.MAX_PARTS} parts in multipart upload to Bucket: ${this.params.Bucket} Key: ${this.params.Key}.`);if(this.abortController.signal.aborted)return;if(1===e.partNumber&&e.lastPart)return await this.__uploadUsingPut(e);if(!this.uploadId){const{UploadId:t}=await this.__createMultipartUpload();if(this.uploadId=t,this.abortController.signal.aborted)return}const t=as(e.data)||0,r=this.client.config.requestHandler,i=r instanceof is.EventEmitter?r:null;let n=0;const s=(r,i)=>{const s=Number(i.query["partNumber"])||-1;s===e.partNumber&&(r.total&&t&&(this.bytesUploadedSoFar+=r.loaded-n,n=r.loaded),this.__notifyProgress({loaded:this.bytesUploadedSoFar,total:this.totalBytes,part:e.partNumber,Key:this.params.Key,Bucket:this.params.Bucket}))};null!==i&&i.on("xhr.upload.progress",s),this.uploadEnqueuedPartsCount+=1;const o=await this.client.send(new Kn.i({...this.params,ContentLength:void 0,UploadId:this.uploadId,Body:e.data,PartNumber:e.partNumber}));if(null!==i&&i.off("xhr.upload.progress",s),this.abortController.signal.aborted)return;if(!o.ETag)throw new Error(`Part ${e.partNumber} is missing ETag in UploadPart response. Missing Bucket CORS configuration for ETag header?`);this.uploadedParts.push({PartNumber:e.partNumber,ETag:o.ETag,...o.ChecksumCRC32&&{ChecksumCRC32:o.ChecksumCRC32},...o.ChecksumCRC32C&&{ChecksumCRC32C:o.ChecksumCRC32C},...o.ChecksumSHA1&&{ChecksumSHA1:o.ChecksumSHA1},...o.ChecksumSHA256&&{ChecksumSHA256:o.ChecksumSHA256}}),null===i&&(this.bytesUploadedSoFar+=t),this.__notifyProgress({loaded:this.bytesUploadedSoFar,total:this.totalBytes,part:e.partNumber,Key:this.params.Key,Bucket:this.params.Bucket})}}async __doMultipartUpload(){const t=ds(this.params.Body,this.partSize),e=[];for(let i=0;i<this.queueSize;i++){const r=this.__doConcurrentUpload(t).catch((t=>{e.push(t)}));this.concurrentUploaders.push(r)}if(await Promise.all(this.concurrentUploaders),e.length>=1)throw await this.markUploadAsAborted(),e[0];if(this.abortController.signal.aborted)throw await this.markUploadAsAborted(),Object.assign(new Error("Upload aborted."),{name:"AbortError"});let r;if(this.isMultiPart){this.uploadedParts.sort(((t,e)=>t.PartNumber-e.PartNumber));const t={...this.params,Body:void 0,UploadId:this.uploadId,MultipartUpload:{Parts:this.uploadedParts}};r=await this.client.send(new Qn.G(t)),"string"===typeof r?.Location&&r.Location.includes("%2F")&&(r.Location=r.Location.replace(/%2F/g,"/"))}else r=this.singleUploadResult;return this.abortMultipartUploadCommand=null,this.tags.length&&await this.client.send(new Zn.n({...this.params,Tagging:{TagSet:this.tags}})),r}async markUploadAsAborted(){this.uploadId&&!this.leavePartsOnError&&null!==this.abortMultipartUploadCommand&&(await this.client.send(this.abortMultipartUploadCommand),this.abortMultipartUploadCommand=null)}__notifyProgress(t){this.uploadEvent&&this.emit(this.uploadEvent,t)}async __abortTimeout(t){return new Promise(((e,r)=>{t.onabort=()=>{const t=new Error("Upload aborted.");t.name="AbortError",r(t)}}))}__validateInput(){if(!this.params)throw new Error("InputError: Upload requires params to be passed to upload.");if(!this.client)throw new Error("InputError: Upload requires a AWS client to do uploads with.");if(this.partSize<ps.MIN_PART_SIZE)throw new Error(`EntityTooSmall: Your proposed upload partsize [${this.partSize}] is smaller than the minimum allowed size [${ps.MIN_PART_SIZE}] (5MB)`);if(this.queueSize<1)throw new Error("Queue size: Must have at least one uploading queue.")}}var ms=r(57146),gs=r(34330),ws=r.n(gs),bs=r(24834),ys=r(58436),vs=r(22988),xs=r(40475),ks=r(64945);const _s=["poster","controls","title"],Ms=["src"];var Es={__name:"BasePlayer",props:{previewImageLink:{type:String,default:""},link:{type:String,default:""},progress:{type:Number,default:0},title:{type:String,default:""},isMuted:{type:Boolean,default:!1},isControls:{type:Boolean,default:!0}},emits:["pause","test"],setup(t,{emit:e}){const r=t,i=e,n=(0,kn.KR)(null);function s(){let t=new ks.Ay,e=r.link;t.loadSource(e),n.value&&(t.attachMedia(n.value),n.value.muted=r.isMuted,n.value.currentTime=r.progress)}function o(){const t=n?.value?.currentTime||0;i("pause",t)}function l(t){"w"===t.key&&n.value?n.value.playbackRate=n.value.playbackRate+.25:"s"===t.key&&n.value&&(n.value.playbackRate=n.value.playbackRate-.25)}return(0,a.sV)((()=>{s()})),(0,a.$u)((()=>{s()})),(e,r)=>((0,a.uX)(),(0,a.CE)("video",{onPause:o,onEnded:o,onKeyup:l,ref_key:"video",ref:n,poster:t.previewImageLink,controls:t.isControls,title:t.title},[(0,a.Lk)("source",{src:t.link,type:"application/x-mpegURL"},null,8,Ms)],40,_s))}};const Ss=Es;var As=Ss,Cs={__name:"VDefaultVideoPlayer",props:{previewImageLink:{type:String,default:""},link:{type:String,default:""},progress:{type:Number,default:0},isMuted:{type:Boolean,default:!1},isControls:{type:Boolean,default:!0}},emits:["pause"],setup(t,{emit:e}){const r=e;function i(t){r("pause",t)}return(e,r)=>((0,a.uX)(),(0,a.Wv)(As,{previewImageLink:t.previewImageLink,link:t.link,progress:t.progress,isMuted:t.isMuted,isControls:t.isControls,onPause:i},null,8,["previewImageLink","link","progress","isMuted","isControls"]))}};const Ls=Cs;var Is=Ls,Ds={__name:"VPreviewVideoPlayer",props:{previewImageLink:{type:String,default:""},link:{type:String,default:""}},setup(t){function e(t){t.target.play()}function r(t){t.target.pause()}return(i,n)=>((0,a.uX)(),(0,a.Wv)(As,{previewImageLink:t.previewImageLink,link:t.link,isMuted:!0,isControls:!1,onMouseover:e,onMouseleave:r},null,8,["previewImageLink","link"]))}};const Rs=Ds;var Ps=Rs,Ts={__name:"index",props:{previewImageLink:{type:String,default:""},link:{type:String,default:""},type:{type:String,default:""},progress:{type:Number,default:0},isMuted:{type:Boolean,default:!1},isControls:{type:Boolean,default:!0}},emits:["pause"],setup(t,{emit:e}){const r=e;function i(t){r("pause",t)}return(e,r)=>"default"===t.type?((0,a.uX)(),(0,a.Wv)(Is,{key:0,onPause:i,previewImageLink:t.previewImageLink,link:t.link,progress:t.progress,isMuted:t.isMuted,isControls:t.isControls},null,8,["previewImageLink","link","progress","isMuted","isControls"])):"preview"===t.type?((0,a.uX)(),(0,a.Wv)(Ps,{key:1,previewImageLink:t.previewImageLink,link:t.link},null,8,["previewImageLink","link"])):(0,a.Q3)("",!0)}};const Fs=Ts;var Bs=Fs;const Us={getBit(t){return this.data[Os(t)]&1<<Ns(t)?1:0},setBit(t){this.data[Os(t)]|=1<<Ns(t)},clearBit(t){this.data[Os(t)]&=~(1<<Ns(t))},toggleBit(t){this.data[Os(t)]^=1<<Ns(t)},getBitXY(t,e){return t>=this.width||e>=this.height?0:this.getBit(e*this.width+t)},setBitXY(t,e){this.setBit(e*this.width+t)},clearBitXY(t,e){this.clearBit(e*this.width+t)},toggleBitXY(t,e){this.toggleBit(e*this.width+t)}};function Os(t){return t>>3}function Ns(t){return 7-(7&t)}function zs(t){for(const e in Us)t.prototype[e]=Us[e]}function js(t,e={}){let{bitDepth:r,alpha:i,colorModel:n,components:s,channels:o}=e;if("string"!==typeof t||0===t.length)throw new TypeError("processName must be a string");if(r&&(Array.isArray(r)||(r=[r]),!r.includes(this.bitDepth)))throw new TypeError(`The process: ${t} can only be applied if bit depth is in: ${r}`);if(i&&(Array.isArray(i)||(i=[i]),!i.includes(this.alpha)))throw new TypeError(`The process: ${t} can only be applied if alpha is in: ${i}`);if(n&&(Array.isArray(n)||(n=[n]),!n.includes(this.colorModel)))throw new TypeError(`The process: ${t} can only be applied if color model is in: ${n}`);if(s&&(Array.isArray(s)||(s=[s]),!s.includes(this.components))){let e=`The process: ${t} can only be applied if the number of components is in: ${s}`;throw 1===s.length&&1===s[0]?new TypeError(`${e}.\rYou should transform your image using "image.grey()" before applying the algorithm.`):new TypeError(e)}if(o&&(Array.isArray(o)||(o=[o]),!o.includes(this.channels)))throw new TypeError(`The process: ${t} can only be applied if the number of channels is in: ${o}`)}function Xs(t,e){t=t||[],e=e||{},"string"===typeof e&&(e={type:e});try{return new Blob(t,e)}catch(s){if("TypeError"!==s.name)throw s;for(var r="undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof MSBlobBuilder?MSBlobBuilder:"undefined"!==typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,i=new r,n=0;n<t.length;n+=1)i.append(t[n]);return i.getBlob(e.type)}}function $s(t){var e=t.match(/data:([^;]+)/)[1],r=t.replace(/^[^,]+,/,""),i=Ys(atob(r));return Xs([i],{type:e})}function Vs(t,e,r){return"function"===typeof t.toBlob?new Promise((function(i){t.toBlob(i,e,r)})):Promise.resolve($s(t.toDataURL(e,r)))}function Ys(t){var e=t.length,r=new ArrayBuffer(e),i=new Uint8Array(r),n=-1;while(++n<e)i[n]=t.charCodeAt(n);return r}var qs=r(41176),Gs=r(18851);
/*! pako 2.1.0 https://github.com/nodeca/pako @license (MIT AND Zlib) */
const Hs=4,Ws=0,Ks=1,Qs=2;function Zs(t){let e=t.length;while(--e>=0)t[e]=0}const Js=0,to=1,eo=2,ro=3,io=258,no=29,so=256,oo=so+1+no,ao=30,lo=19,ho=2*oo+1,uo=15,co=16,fo=7,po=256,mo=16,go=17,wo=18,bo=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),yo=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),vo=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),xo=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ko=512,_o=new Array(2*(oo+2));Zs(_o);const Mo=new Array(2*ao);Zs(Mo);const Eo=new Array(ko);Zs(Eo);const So=new Array(io-ro+1);Zs(So);const Ao=new Array(no);Zs(Ao);const Co=new Array(ao);function Lo(t,e,r,i,n){this.static_tree=t,this.extra_bits=e,this.extra_base=r,this.elems=i,this.max_length=n,this.has_stree=t&&t.length}let Io,Do,Ro;function Po(t,e){this.dyn_tree=t,this.max_code=0,this.stat_desc=e}Zs(Co);const To=t=>t<256?Eo[t]:Eo[256+(t>>>7)],Fo=(t,e)=>{t.pending_buf[t.pending++]=255&e,t.pending_buf[t.pending++]=e>>>8&255},Bo=(t,e,r)=>{t.bi_valid>co-r?(t.bi_buf|=e<<t.bi_valid&65535,Fo(t,t.bi_buf),t.bi_buf=e>>co-t.bi_valid,t.bi_valid+=r-co):(t.bi_buf|=e<<t.bi_valid&65535,t.bi_valid+=r)},Uo=(t,e,r)=>{Bo(t,r[2*e],r[2*e+1])},Oo=(t,e)=>{let r=0;do{r|=1&t,t>>>=1,r<<=1}while(--e>0);return r>>>1},No=t=>{16===t.bi_valid?(Fo(t,t.bi_buf),t.bi_buf=0,t.bi_valid=0):t.bi_valid>=8&&(t.pending_buf[t.pending++]=255&t.bi_buf,t.bi_buf>>=8,t.bi_valid-=8)},zo=(t,e)=>{const r=e.dyn_tree,i=e.max_code,n=e.stat_desc.static_tree,s=e.stat_desc.has_stree,o=e.stat_desc.extra_bits,a=e.stat_desc.extra_base,l=e.stat_desc.max_length;let h,u,c,f,d,p,m=0;for(f=0;f<=uo;f++)t.bl_count[f]=0;for(r[2*t.heap[t.heap_max]+1]=0,h=t.heap_max+1;h<ho;h++)u=t.heap[h],f=r[2*r[2*u+1]+1]+1,f>l&&(f=l,m++),r[2*u+1]=f,u>i||(t.bl_count[f]++,d=0,u>=a&&(d=o[u-a]),p=r[2*u],t.opt_len+=p*(f+d),s&&(t.static_len+=p*(n[2*u+1]+d)));if(0!==m){do{f=l-1;while(0===t.bl_count[f])f--;t.bl_count[f]--,t.bl_count[f+1]+=2,t.bl_count[l]--,m-=2}while(m>0);for(f=l;0!==f;f--){u=t.bl_count[f];while(0!==u)c=t.heap[--h],c>i||(r[2*c+1]!==f&&(t.opt_len+=(f-r[2*c+1])*r[2*c],r[2*c+1]=f),u--)}}},jo=(t,e,r)=>{const i=new Array(uo+1);let n,s,o=0;for(n=1;n<=uo;n++)o=o+r[n-1]<<1,i[n]=o;for(s=0;s<=e;s++){let e=t[2*s+1];0!==e&&(t[2*s]=Oo(i[e]++,e))}},Xo=()=>{let t,e,r,i,n;const s=new Array(uo+1);for(r=0,i=0;i<no-1;i++)for(Ao[i]=r,t=0;t<1<<bo[i];t++)So[r++]=i;for(So[r-1]=i,n=0,i=0;i<16;i++)for(Co[i]=n,t=0;t<1<<yo[i];t++)Eo[n++]=i;for(n>>=7;i<ao;i++)for(Co[i]=n<<7,t=0;t<1<<yo[i]-7;t++)Eo[256+n++]=i;for(e=0;e<=uo;e++)s[e]=0;t=0;while(t<=143)_o[2*t+1]=8,t++,s[8]++;while(t<=255)_o[2*t+1]=9,t++,s[9]++;while(t<=279)_o[2*t+1]=7,t++,s[7]++;while(t<=287)_o[2*t+1]=8,t++,s[8]++;for(jo(_o,oo+1,s),t=0;t<ao;t++)Mo[2*t+1]=5,Mo[2*t]=Oo(t,5);Io=new Lo(_o,bo,so+1,oo,uo),Do=new Lo(Mo,yo,0,ao,uo),Ro=new Lo(new Array(0),vo,0,lo,fo)},$o=t=>{let e;for(e=0;e<oo;e++)t.dyn_ltree[2*e]=0;for(e=0;e<ao;e++)t.dyn_dtree[2*e]=0;for(e=0;e<lo;e++)t.bl_tree[2*e]=0;t.dyn_ltree[2*po]=1,t.opt_len=t.static_len=0,t.sym_next=t.matches=0},Vo=t=>{t.bi_valid>8?Fo(t,t.bi_buf):t.bi_valid>0&&(t.pending_buf[t.pending++]=t.bi_buf),t.bi_buf=0,t.bi_valid=0},Yo=(t,e,r,i)=>{const n=2*e,s=2*r;return t[n]<t[s]||t[n]===t[s]&&i[e]<=i[r]},qo=(t,e,r)=>{const i=t.heap[r];let n=r<<1;while(n<=t.heap_len){if(n<t.heap_len&&Yo(e,t.heap[n+1],t.heap[n],t.depth)&&n++,Yo(e,i,t.heap[n],t.depth))break;t.heap[r]=t.heap[n],r=n,n<<=1}t.heap[r]=i},Go=(t,e,r)=>{let i,n,s,o,a=0;if(0!==t.sym_next)do{i=255&t.pending_buf[t.sym_buf+a++],i+=(255&t.pending_buf[t.sym_buf+a++])<<8,n=t.pending_buf[t.sym_buf+a++],0===i?Uo(t,n,e):(s=So[n],Uo(t,s+so+1,e),o=bo[s],0!==o&&(n-=Ao[s],Bo(t,n,o)),i--,s=To(i),Uo(t,s,r),o=yo[s],0!==o&&(i-=Co[s],Bo(t,i,o)))}while(a<t.sym_next);Uo(t,po,e)},Ho=(t,e)=>{const r=e.dyn_tree,i=e.stat_desc.static_tree,n=e.stat_desc.has_stree,s=e.stat_desc.elems;let o,a,l,h=-1;for(t.heap_len=0,t.heap_max=ho,o=0;o<s;o++)0!==r[2*o]?(t.heap[++t.heap_len]=h=o,t.depth[o]=0):r[2*o+1]=0;while(t.heap_len<2)l=t.heap[++t.heap_len]=h<2?++h:0,r[2*l]=1,t.depth[l]=0,t.opt_len--,n&&(t.static_len-=i[2*l+1]);for(e.max_code=h,o=t.heap_len>>1;o>=1;o--)qo(t,r,o);l=s;do{o=t.heap[1],t.heap[1]=t.heap[t.heap_len--],qo(t,r,1),a=t.heap[1],t.heap[--t.heap_max]=o,t.heap[--t.heap_max]=a,r[2*l]=r[2*o]+r[2*a],t.depth[l]=(t.depth[o]>=t.depth[a]?t.depth[o]:t.depth[a])+1,r[2*o+1]=r[2*a+1]=l,t.heap[1]=l++,qo(t,r,1)}while(t.heap_len>=2);t.heap[--t.heap_max]=t.heap[1],zo(t,e),jo(r,h,t.bl_count)},Wo=(t,e,r)=>{let i,n,s=-1,o=e[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),e[2*(r+1)+1]=65535,i=0;i<=r;i++)n=o,o=e[2*(i+1)+1],++a<l&&n===o||(a<h?t.bl_tree[2*n]+=a:0!==n?(n!==s&&t.bl_tree[2*n]++,t.bl_tree[2*mo]++):a<=10?t.bl_tree[2*go]++:t.bl_tree[2*wo]++,a=0,s=n,0===o?(l=138,h=3):n===o?(l=6,h=3):(l=7,h=4))},Ko=(t,e,r)=>{let i,n,s=-1,o=e[1],a=0,l=7,h=4;for(0===o&&(l=138,h=3),i=0;i<=r;i++)if(n=o,o=e[2*(i+1)+1],!(++a<l&&n===o)){if(a<h)do{Uo(t,n,t.bl_tree)}while(0!==--a);else 0!==n?(n!==s&&(Uo(t,n,t.bl_tree),a--),Uo(t,mo,t.bl_tree),Bo(t,a-3,2)):a<=10?(Uo(t,go,t.bl_tree),Bo(t,a-3,3)):(Uo(t,wo,t.bl_tree),Bo(t,a-11,7));a=0,s=n,0===o?(l=138,h=3):n===o?(l=6,h=3):(l=7,h=4)}},Qo=t=>{let e;for(Wo(t,t.dyn_ltree,t.l_desc.max_code),Wo(t,t.dyn_dtree,t.d_desc.max_code),Ho(t,t.bl_desc),e=lo-1;e>=3;e--)if(0!==t.bl_tree[2*xo[e]+1])break;return t.opt_len+=3*(e+1)+5+5+4,e},Zo=(t,e,r,i)=>{let n;for(Bo(t,e-257,5),Bo(t,r-1,5),Bo(t,i-4,4),n=0;n<i;n++)Bo(t,t.bl_tree[2*xo[n]+1],3);Ko(t,t.dyn_ltree,e-1),Ko(t,t.dyn_dtree,r-1)},Jo=t=>{let e,r=4093624447;for(e=0;e<=31;e++,r>>>=1)if(1&r&&0!==t.dyn_ltree[2*e])return Ws;if(0!==t.dyn_ltree[18]||0!==t.dyn_ltree[20]||0!==t.dyn_ltree[26])return Ks;for(e=32;e<so;e++)if(0!==t.dyn_ltree[2*e])return Ks;return Ws};let ta=!1;const ea=t=>{ta||(Xo(),ta=!0),t.l_desc=new Po(t.dyn_ltree,Io),t.d_desc=new Po(t.dyn_dtree,Do),t.bl_desc=new Po(t.bl_tree,Ro),t.bi_buf=0,t.bi_valid=0,$o(t)},ra=(t,e,r,i)=>{Bo(t,(Js<<1)+(i?1:0),3),Vo(t),Fo(t,r),Fo(t,~r),r&&t.pending_buf.set(t.window.subarray(e,e+r),t.pending),t.pending+=r},ia=t=>{Bo(t,to<<1,3),Uo(t,po,_o),No(t)},na=(t,e,r,i)=>{let n,s,o=0;t.level>0?(t.strm.data_type===Qs&&(t.strm.data_type=Jo(t)),Ho(t,t.l_desc),Ho(t,t.d_desc),o=Qo(t),n=t.opt_len+3+7>>>3,s=t.static_len+3+7>>>3,s<=n&&(n=s)):n=s=r+5,r+4<=n&&-1!==e?ra(t,e,r,i):t.strategy===Hs||s===n?(Bo(t,(to<<1)+(i?1:0),3),Go(t,_o,Mo)):(Bo(t,(eo<<1)+(i?1:0),3),Zo(t,t.l_desc.max_code+1,t.d_desc.max_code+1,o+1),Go(t,t.dyn_ltree,t.dyn_dtree)),$o(t),i&&Vo(t)},sa=(t,e,r)=>(t.pending_buf[t.sym_buf+t.sym_next++]=e,t.pending_buf[t.sym_buf+t.sym_next++]=e>>8,t.pending_buf[t.sym_buf+t.sym_next++]=r,0===e?t.dyn_ltree[2*r]++:(t.matches++,e--,t.dyn_ltree[2*(So[r]+so+1)]++,t.dyn_dtree[2*To(e)]++),t.sym_next===t.sym_end);var oa=ea,aa=ra,la=na,ha=sa,ua=ia,ca={_tr_init:oa,_tr_stored_block:aa,_tr_flush_block:la,_tr_tally:ha,_tr_align:ua};const fa=(t,e,r,i)=>{let n=65535&t,s=t>>>16&65535,o=0;while(0!==r){o=r>2e3?2e3:r,r-=o;do{n=n+e[i++]|0,s=s+n|0}while(--o);n%=65521,s%=65521}return n|s<<16};var da=fa;const pa=()=>{let t,e=[];for(var r=0;r<256;r++){t=r;for(var i=0;i<8;i++)t=1&t?3988292384^t>>>1:t>>>1;e[r]=t}return e},ma=new Uint32Array(pa()),ga=(t,e,r,i)=>{const n=ma,s=i+r;t^=-1;for(let o=i;o<s;o++)t=t>>>8^n[255&(t^e[o])];return~t};var wa=ga,ba={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},ya={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:va,_tr_stored_block:xa,_tr_flush_block:ka,_tr_tally:_a,_tr_align:Ma}=ca,{Z_NO_FLUSH:Ea,Z_PARTIAL_FLUSH:Sa,Z_FULL_FLUSH:Aa,Z_FINISH:Ca,Z_BLOCK:La,Z_OK:Ia,Z_STREAM_END:Da,Z_STREAM_ERROR:Ra,Z_DATA_ERROR:Pa,Z_BUF_ERROR:Ta,Z_DEFAULT_COMPRESSION:Fa,Z_FILTERED:Ba,Z_HUFFMAN_ONLY:Ua,Z_RLE:Oa,Z_FIXED:Na,Z_DEFAULT_STRATEGY:za,Z_UNKNOWN:ja,Z_DEFLATED:Xa}=ya,$a=9,Va=15,Ya=8,qa=29,Ga=256,Ha=Ga+1+qa,Wa=30,Ka=19,Qa=2*Ha+1,Za=15,Ja=3,tl=258,el=tl+Ja+1,rl=32,il=42,nl=57,sl=69,ol=73,al=91,ll=103,hl=113,ul=666,cl=1,fl=2,dl=3,pl=4,ml=3,gl=(t,e)=>(t.msg=ba[e],e),wl=t=>2*t-(t>4?9:0),bl=t=>{let e=t.length;while(--e>=0)t[e]=0},yl=t=>{let e,r,i,n=t.w_size;e=t.hash_size,i=e;do{r=t.head[--i],t.head[i]=r>=n?r-n:0}while(--e);e=n,i=e;do{r=t.prev[--i],t.prev[i]=r>=n?r-n:0}while(--e)};let vl=(t,e,r)=>(e<<t.hash_shift^r)&t.hash_mask,xl=vl;const kl=t=>{const e=t.state;let r=e.pending;r>t.avail_out&&(r=t.avail_out),0!==r&&(t.output.set(e.pending_buf.subarray(e.pending_out,e.pending_out+r),t.next_out),t.next_out+=r,e.pending_out+=r,t.total_out+=r,t.avail_out-=r,e.pending-=r,0===e.pending&&(e.pending_out=0))},_l=(t,e)=>{ka(t,t.block_start>=0?t.block_start:-1,t.strstart-t.block_start,e),t.block_start=t.strstart,kl(t.strm)},Ml=(t,e)=>{t.pending_buf[t.pending++]=e},El=(t,e)=>{t.pending_buf[t.pending++]=e>>>8&255,t.pending_buf[t.pending++]=255&e},Sl=(t,e,r,i)=>{let n=t.avail_in;return n>i&&(n=i),0===n?0:(t.avail_in-=n,e.set(t.input.subarray(t.next_in,t.next_in+n),r),1===t.state.wrap?t.adler=da(t.adler,e,n,r):2===t.state.wrap&&(t.adler=wa(t.adler,e,n,r)),t.next_in+=n,t.total_in+=n,n)},Al=(t,e)=>{let r,i,n=t.max_chain_length,s=t.strstart,o=t.prev_length,a=t.nice_match;const l=t.strstart>t.w_size-el?t.strstart-(t.w_size-el):0,h=t.window,u=t.w_mask,c=t.prev,f=t.strstart+tl;let d=h[s+o-1],p=h[s+o];t.prev_length>=t.good_match&&(n>>=2),a>t.lookahead&&(a=t.lookahead);do{if(r=e,h[r+o]===p&&h[r+o-1]===d&&h[r]===h[s]&&h[++r]===h[s+1]){s+=2,r++;do{}while(h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&h[++s]===h[++r]&&s<f);if(i=tl-(f-s),s=f-tl,i>o){if(t.match_start=e,o=i,i>=a)break;d=h[s+o-1],p=h[s+o]}}}while((e=c[e&u])>l&&0!==--n);return o<=t.lookahead?o:t.lookahead},Cl=t=>{const e=t.w_size;let r,i,n;do{if(i=t.window_size-t.lookahead-t.strstart,t.strstart>=e+(e-el)&&(t.window.set(t.window.subarray(e,e+e-i),0),t.match_start-=e,t.strstart-=e,t.block_start-=e,t.insert>t.strstart&&(t.insert=t.strstart),yl(t),i+=e),0===t.strm.avail_in)break;if(r=Sl(t.strm,t.window,t.strstart+t.lookahead,i),t.lookahead+=r,t.lookahead+t.insert>=Ja){n=t.strstart-t.insert,t.ins_h=t.window[n],t.ins_h=xl(t,t.ins_h,t.window[n+1]);while(t.insert)if(t.ins_h=xl(t,t.ins_h,t.window[n+Ja-1]),t.prev[n&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=n,n++,t.insert--,t.lookahead+t.insert<Ja)break}}while(t.lookahead<el&&0!==t.strm.avail_in)},Ll=(t,e)=>{let r,i,n,s=t.pending_buf_size-5>t.w_size?t.w_size:t.pending_buf_size-5,o=0,a=t.strm.avail_in;do{if(r=65535,n=t.bi_valid+42>>3,t.strm.avail_out<n)break;if(n=t.strm.avail_out-n,i=t.strstart-t.block_start,r>i+t.strm.avail_in&&(r=i+t.strm.avail_in),r>n&&(r=n),r<s&&(0===r&&e!==Ca||e===Ea||r!==i+t.strm.avail_in))break;o=e===Ca&&r===i+t.strm.avail_in?1:0,xa(t,0,0,o),t.pending_buf[t.pending-4]=r,t.pending_buf[t.pending-3]=r>>8,t.pending_buf[t.pending-2]=~r,t.pending_buf[t.pending-1]=~r>>8,kl(t.strm),i&&(i>r&&(i=r),t.strm.output.set(t.window.subarray(t.block_start,t.block_start+i),t.strm.next_out),t.strm.next_out+=i,t.strm.avail_out-=i,t.strm.total_out+=i,t.block_start+=i,r-=i),r&&(Sl(t.strm,t.strm.output,t.strm.next_out,r),t.strm.next_out+=r,t.strm.avail_out-=r,t.strm.total_out+=r)}while(0===o);return a-=t.strm.avail_in,a&&(a>=t.w_size?(t.matches=2,t.window.set(t.strm.input.subarray(t.strm.next_in-t.w_size,t.strm.next_in),0),t.strstart=t.w_size,t.insert=t.strstart):(t.window_size-t.strstart<=a&&(t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,t.insert>t.strstart&&(t.insert=t.strstart)),t.window.set(t.strm.input.subarray(t.strm.next_in-a,t.strm.next_in),t.strstart),t.strstart+=a,t.insert+=a>t.w_size-t.insert?t.w_size-t.insert:a),t.block_start=t.strstart),t.high_water<t.strstart&&(t.high_water=t.strstart),o?pl:e!==Ea&&e!==Ca&&0===t.strm.avail_in&&t.strstart===t.block_start?fl:(n=t.window_size-t.strstart,t.strm.avail_in>n&&t.block_start>=t.w_size&&(t.block_start-=t.w_size,t.strstart-=t.w_size,t.window.set(t.window.subarray(t.w_size,t.w_size+t.strstart),0),t.matches<2&&t.matches++,n+=t.w_size,t.insert>t.strstart&&(t.insert=t.strstart)),n>t.strm.avail_in&&(n=t.strm.avail_in),n&&(Sl(t.strm,t.window,t.strstart,n),t.strstart+=n,t.insert+=n>t.w_size-t.insert?t.w_size-t.insert:n),t.high_water<t.strstart&&(t.high_water=t.strstart),n=t.bi_valid+42>>3,n=t.pending_buf_size-n>65535?65535:t.pending_buf_size-n,s=n>t.w_size?t.w_size:n,i=t.strstart-t.block_start,(i>=s||(i||e===Ca)&&e!==Ea&&0===t.strm.avail_in&&i<=n)&&(r=i>n?n:i,o=e===Ca&&0===t.strm.avail_in&&r===i?1:0,xa(t,t.block_start,r,o),t.block_start+=r,kl(t.strm)),o?dl:cl)},Il=(t,e)=>{let r,i;for(;;){if(t.lookahead<el){if(Cl(t),t.lookahead<el&&e===Ea)return cl;if(0===t.lookahead)break}if(r=0,t.lookahead>=Ja&&(t.ins_h=xl(t,t.ins_h,t.window[t.strstart+Ja-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),0!==r&&t.strstart-r<=t.w_size-el&&(t.match_length=Al(t,r)),t.match_length>=Ja)if(i=_a(t,t.strstart-t.match_start,t.match_length-Ja),t.lookahead-=t.match_length,t.match_length<=t.max_lazy_match&&t.lookahead>=Ja){t.match_length--;do{t.strstart++,t.ins_h=xl(t,t.ins_h,t.window[t.strstart+Ja-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart}while(0!==--t.match_length);t.strstart++}else t.strstart+=t.match_length,t.match_length=0,t.ins_h=t.window[t.strstart],t.ins_h=xl(t,t.ins_h,t.window[t.strstart+1]);else i=_a(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++;if(i&&(_l(t,!1),0===t.strm.avail_out))return cl}return t.insert=t.strstart<Ja-1?t.strstart:Ja-1,e===Ca?(_l(t,!0),0===t.strm.avail_out?dl:pl):t.sym_next&&(_l(t,!1),0===t.strm.avail_out)?cl:fl},Dl=(t,e)=>{let r,i,n;for(;;){if(t.lookahead<el){if(Cl(t),t.lookahead<el&&e===Ea)return cl;if(0===t.lookahead)break}if(r=0,t.lookahead>=Ja&&(t.ins_h=xl(t,t.ins_h,t.window[t.strstart+Ja-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart),t.prev_length=t.match_length,t.prev_match=t.match_start,t.match_length=Ja-1,0!==r&&t.prev_length<t.max_lazy_match&&t.strstart-r<=t.w_size-el&&(t.match_length=Al(t,r),t.match_length<=5&&(t.strategy===Ba||t.match_length===Ja&&t.strstart-t.match_start>4096)&&(t.match_length=Ja-1)),t.prev_length>=Ja&&t.match_length<=t.prev_length){n=t.strstart+t.lookahead-Ja,i=_a(t,t.strstart-1-t.prev_match,t.prev_length-Ja),t.lookahead-=t.prev_length-1,t.prev_length-=2;do{++t.strstart<=n&&(t.ins_h=xl(t,t.ins_h,t.window[t.strstart+Ja-1]),r=t.prev[t.strstart&t.w_mask]=t.head[t.ins_h],t.head[t.ins_h]=t.strstart)}while(0!==--t.prev_length);if(t.match_available=0,t.match_length=Ja-1,t.strstart++,i&&(_l(t,!1),0===t.strm.avail_out))return cl}else if(t.match_available){if(i=_a(t,0,t.window[t.strstart-1]),i&&_l(t,!1),t.strstart++,t.lookahead--,0===t.strm.avail_out)return cl}else t.match_available=1,t.strstart++,t.lookahead--}return t.match_available&&(i=_a(t,0,t.window[t.strstart-1]),t.match_available=0),t.insert=t.strstart<Ja-1?t.strstart:Ja-1,e===Ca?(_l(t,!0),0===t.strm.avail_out?dl:pl):t.sym_next&&(_l(t,!1),0===t.strm.avail_out)?cl:fl},Rl=(t,e)=>{let r,i,n,s;const o=t.window;for(;;){if(t.lookahead<=tl){if(Cl(t),t.lookahead<=tl&&e===Ea)return cl;if(0===t.lookahead)break}if(t.match_length=0,t.lookahead>=Ja&&t.strstart>0&&(n=t.strstart-1,i=o[n],i===o[++n]&&i===o[++n]&&i===o[++n])){s=t.strstart+tl;do{}while(i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&i===o[++n]&&n<s);t.match_length=tl-(s-n),t.match_length>t.lookahead&&(t.match_length=t.lookahead)}if(t.match_length>=Ja?(r=_a(t,1,t.match_length-Ja),t.lookahead-=t.match_length,t.strstart+=t.match_length,t.match_length=0):(r=_a(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++),r&&(_l(t,!1),0===t.strm.avail_out))return cl}return t.insert=0,e===Ca?(_l(t,!0),0===t.strm.avail_out?dl:pl):t.sym_next&&(_l(t,!1),0===t.strm.avail_out)?cl:fl},Pl=(t,e)=>{let r;for(;;){if(0===t.lookahead&&(Cl(t),0===t.lookahead)){if(e===Ea)return cl;break}if(t.match_length=0,r=_a(t,0,t.window[t.strstart]),t.lookahead--,t.strstart++,r&&(_l(t,!1),0===t.strm.avail_out))return cl}return t.insert=0,e===Ca?(_l(t,!0),0===t.strm.avail_out?dl:pl):t.sym_next&&(_l(t,!1),0===t.strm.avail_out)?cl:fl};function Tl(t,e,r,i,n){this.good_length=t,this.max_lazy=e,this.nice_length=r,this.max_chain=i,this.func=n}const Fl=[new Tl(0,0,0,0,Ll),new Tl(4,4,8,4,Il),new Tl(4,5,16,8,Il),new Tl(4,6,32,32,Il),new Tl(4,4,16,16,Dl),new Tl(8,16,32,32,Dl),new Tl(8,16,128,128,Dl),new Tl(8,32,128,256,Dl),new Tl(32,128,258,1024,Dl),new Tl(32,258,258,4096,Dl)],Bl=t=>{t.window_size=2*t.w_size,bl(t.head),t.max_lazy_match=Fl[t.level].max_lazy,t.good_match=Fl[t.level].good_length,t.nice_match=Fl[t.level].nice_length,t.max_chain_length=Fl[t.level].max_chain,t.strstart=0,t.block_start=0,t.lookahead=0,t.insert=0,t.match_length=t.prev_length=Ja-1,t.match_available=0,t.ins_h=0};function Ul(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Xa,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(2*Qa),this.dyn_dtree=new Uint16Array(2*(2*Wa+1)),this.bl_tree=new Uint16Array(2*(2*Ka+1)),bl(this.dyn_ltree),bl(this.dyn_dtree),bl(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(Za+1),this.heap=new Uint16Array(2*Ha+1),bl(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Ha+1),bl(this.depth),this.sym_buf=0,this.lit_bufsize=0,this.sym_next=0,this.sym_end=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ol=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.status!==il&&e.status!==nl&&e.status!==sl&&e.status!==ol&&e.status!==al&&e.status!==ll&&e.status!==hl&&e.status!==ul?1:0},Nl=t=>{if(Ol(t))return gl(t,Ra);t.total_in=t.total_out=0,t.data_type=ja;const e=t.state;return e.pending=0,e.pending_out=0,e.wrap<0&&(e.wrap=-e.wrap),e.status=2===e.wrap?nl:e.wrap?il:hl,t.adler=2===e.wrap?0:1,e.last_flush=-2,va(e),Ia},zl=t=>{const e=Nl(t);return e===Ia&&Bl(t.state),e},jl=(t,e)=>Ol(t)||2!==t.state.wrap?Ra:(t.state.gzhead=e,Ia),Xl=(t,e,r,i,n,s)=>{if(!t)return Ra;let o=1;if(e===Fa&&(e=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),n<1||n>$a||r!==Xa||i<8||i>15||e<0||e>9||s<0||s>Na||8===i&&1!==o)return gl(t,Ra);8===i&&(i=9);const a=new Ul;return t.state=a,a.strm=t,a.status=il,a.wrap=o,a.gzhead=null,a.w_bits=i,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=n+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+Ja-1)/Ja),a.window=new Uint8Array(2*a.w_size),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<n+6,a.pending_buf_size=4*a.lit_bufsize,a.pending_buf=new Uint8Array(a.pending_buf_size),a.sym_buf=a.lit_bufsize,a.sym_end=3*(a.lit_bufsize-1),a.level=e,a.strategy=s,a.method=r,zl(t)},$l=(t,e)=>Xl(t,e,Xa,Va,Ya,za),Vl=(t,e)=>{if(Ol(t)||e>La||e<0)return t?gl(t,Ra):Ra;const r=t.state;if(!t.output||0!==t.avail_in&&!t.input||r.status===ul&&e!==Ca)return gl(t,0===t.avail_out?Ta:Ra);const i=r.last_flush;if(r.last_flush=e,0!==r.pending){if(kl(t),0===t.avail_out)return r.last_flush=-1,Ia}else if(0===t.avail_in&&wl(e)<=wl(i)&&e!==Ca)return gl(t,Ta);if(r.status===ul&&0!==t.avail_in)return gl(t,Ta);if(r.status===il&&0===r.wrap&&(r.status=hl),r.status===il){let e=Xa+(r.w_bits-8<<4)<<8,i=-1;if(i=r.strategy>=Ua||r.level<2?0:r.level<6?1:6===r.level?2:3,e|=i<<6,0!==r.strstart&&(e|=rl),e+=31-e%31,El(r,e),0!==r.strstart&&(El(r,t.adler>>>16),El(r,65535&t.adler)),t.adler=1,r.status=hl,kl(t),0!==r.pending)return r.last_flush=-1,Ia}if(r.status===nl)if(t.adler=0,Ml(r,31),Ml(r,139),Ml(r,8),r.gzhead)Ml(r,(r.gzhead.text?1:0)+(r.gzhead.hcrc?2:0)+(r.gzhead.extra?4:0)+(r.gzhead.name?8:0)+(r.gzhead.comment?16:0)),Ml(r,255&r.gzhead.time),Ml(r,r.gzhead.time>>8&255),Ml(r,r.gzhead.time>>16&255),Ml(r,r.gzhead.time>>24&255),Ml(r,9===r.level?2:r.strategy>=Ua||r.level<2?4:0),Ml(r,255&r.gzhead.os),r.gzhead.extra&&r.gzhead.extra.length&&(Ml(r,255&r.gzhead.extra.length),Ml(r,r.gzhead.extra.length>>8&255)),r.gzhead.hcrc&&(t.adler=wa(t.adler,r.pending_buf,r.pending,0)),r.gzindex=0,r.status=sl;else if(Ml(r,0),Ml(r,0),Ml(r,0),Ml(r,0),Ml(r,0),Ml(r,9===r.level?2:r.strategy>=Ua||r.level<2?4:0),Ml(r,ml),r.status=hl,kl(t),0!==r.pending)return r.last_flush=-1,Ia;if(r.status===sl){if(r.gzhead.extra){let e=r.pending,i=(65535&r.gzhead.extra.length)-r.gzindex;while(r.pending+i>r.pending_buf_size){let n=r.pending_buf_size-r.pending;if(r.pending_buf.set(r.gzhead.extra.subarray(r.gzindex,r.gzindex+n),r.pending),r.pending=r.pending_buf_size,r.gzhead.hcrc&&r.pending>e&&(t.adler=wa(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex+=n,kl(t),0!==r.pending)return r.last_flush=-1,Ia;e=0,i-=n}let n=new Uint8Array(r.gzhead.extra);r.pending_buf.set(n.subarray(r.gzindex,r.gzindex+i),r.pending),r.pending+=i,r.gzhead.hcrc&&r.pending>e&&(t.adler=wa(t.adler,r.pending_buf,r.pending-e,e)),r.gzindex=0}r.status=ol}if(r.status===ol){if(r.gzhead.name){let e,i=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),kl(t),0!==r.pending)return r.last_flush=-1,Ia;i=0}e=r.gzindex<r.gzhead.name.length?255&r.gzhead.name.charCodeAt(r.gzindex++):0,Ml(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),r.gzindex=0}r.status=al}if(r.status===al){if(r.gzhead.comment){let e,i=r.pending;do{if(r.pending===r.pending_buf_size){if(r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i)),kl(t),0!==r.pending)return r.last_flush=-1,Ia;i=0}e=r.gzindex<r.gzhead.comment.length?255&r.gzhead.comment.charCodeAt(r.gzindex++):0,Ml(r,e)}while(0!==e);r.gzhead.hcrc&&r.pending>i&&(t.adler=wa(t.adler,r.pending_buf,r.pending-i,i))}r.status=ll}if(r.status===ll){if(r.gzhead.hcrc){if(r.pending+2>r.pending_buf_size&&(kl(t),0!==r.pending))return r.last_flush=-1,Ia;Ml(r,255&t.adler),Ml(r,t.adler>>8&255),t.adler=0}if(r.status=hl,kl(t),0!==r.pending)return r.last_flush=-1,Ia}if(0!==t.avail_in||0!==r.lookahead||e!==Ea&&r.status!==ul){let i=0===r.level?Ll(r,e):r.strategy===Ua?Pl(r,e):r.strategy===Oa?Rl(r,e):Fl[r.level].func(r,e);if(i!==dl&&i!==pl||(r.status=ul),i===cl||i===dl)return 0===t.avail_out&&(r.last_flush=-1),Ia;if(i===fl&&(e===Sa?Ma(r):e!==La&&(xa(r,0,0,!1),e===Aa&&(bl(r.head),0===r.lookahead&&(r.strstart=0,r.block_start=0,r.insert=0))),kl(t),0===t.avail_out))return r.last_flush=-1,Ia}return e!==Ca?Ia:r.wrap<=0?Da:(2===r.wrap?(Ml(r,255&t.adler),Ml(r,t.adler>>8&255),Ml(r,t.adler>>16&255),Ml(r,t.adler>>24&255),Ml(r,255&t.total_in),Ml(r,t.total_in>>8&255),Ml(r,t.total_in>>16&255),Ml(r,t.total_in>>24&255)):(El(r,t.adler>>>16),El(r,65535&t.adler)),kl(t),r.wrap>0&&(r.wrap=-r.wrap),0!==r.pending?Ia:Da)},Yl=t=>{if(Ol(t))return Ra;const e=t.state.status;return t.state=null,e===hl?gl(t,Pa):Ia},ql=(t,e)=>{let r=e.length;if(Ol(t))return Ra;const i=t.state,n=i.wrap;if(2===n||1===n&&i.status!==il||i.lookahead)return Ra;if(1===n&&(t.adler=da(t.adler,e,r,0)),i.wrap=0,r>=i.w_size){0===n&&(bl(i.head),i.strstart=0,i.block_start=0,i.insert=0);let t=new Uint8Array(i.w_size);t.set(e.subarray(r-i.w_size,r),0),e=t,r=i.w_size}const s=t.avail_in,o=t.next_in,a=t.input;t.avail_in=r,t.next_in=0,t.input=e,Cl(i);while(i.lookahead>=Ja){let t=i.strstart,e=i.lookahead-(Ja-1);do{i.ins_h=xl(i,i.ins_h,i.window[t+Ja-1]),i.prev[t&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=t,t++}while(--e);i.strstart=t,i.lookahead=Ja-1,Cl(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=Ja-1,i.match_available=0,t.next_in=o,t.input=a,t.avail_in=s,i.wrap=n,Ia};var Gl=$l,Hl=Xl,Wl=zl,Kl=Nl,Ql=jl,Zl=Vl,Jl=Yl,th=ql,eh="pako deflate (from Nodeca project)",rh={deflateInit:Gl,deflateInit2:Hl,deflateReset:Wl,deflateResetKeep:Kl,deflateSetHeader:Ql,deflate:Zl,deflateEnd:Jl,deflateSetDictionary:th,deflateInfo:eh};const ih=(t,e)=>Object.prototype.hasOwnProperty.call(t,e);var nh=function(t){const e=Array.prototype.slice.call(arguments,1);while(e.length){const r=e.shift();if(r){if("object"!==typeof r)throw new TypeError(r+"must be non-object");for(const e in r)ih(r,e)&&(t[e]=r[e])}}return t},sh=t=>{let e=0;for(let i=0,n=t.length;i<n;i++)e+=t[i].length;const r=new Uint8Array(e);for(let i=0,n=0,s=t.length;i<s;i++){let e=t[i];r.set(e,n),n+=e.length}return r},oh={assign:nh,flattenChunks:sh};let ah=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(Pv){ah=!1}const lh=new Uint8Array(256);for(let Tv=0;Tv<256;Tv++)lh[Tv]=Tv>=252?6:Tv>=248?5:Tv>=240?4:Tv>=224?3:Tv>=192?2:1;lh[254]=lh[254]=1;var hh=t=>{if("function"===typeof TextEncoder&&TextEncoder.prototype.encode)return(new TextEncoder).encode(t);let e,r,i,n,s,o=t.length,a=0;for(n=0;n<o;n++)r=t.charCodeAt(n),55296===(64512&r)&&n+1<o&&(i=t.charCodeAt(n+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),n++)),a+=r<128?1:r<2048?2:r<65536?3:4;for(e=new Uint8Array(a),s=0,n=0;s<a;n++)r=t.charCodeAt(n),55296===(64512&r)&&n+1<o&&(i=t.charCodeAt(n+1),56320===(64512&i)&&(r=65536+(r-55296<<10)+(i-56320),n++)),r<128?e[s++]=r:r<2048?(e[s++]=192|r>>>6,e[s++]=128|63&r):r<65536?(e[s++]=224|r>>>12,e[s++]=128|r>>>6&63,e[s++]=128|63&r):(e[s++]=240|r>>>18,e[s++]=128|r>>>12&63,e[s++]=128|r>>>6&63,e[s++]=128|63&r);return e};const uh=(t,e)=>{if(e<65534&&t.subarray&&ah)return String.fromCharCode.apply(null,t.length===e?t:t.subarray(0,e));let r="";for(let i=0;i<e;i++)r+=String.fromCharCode(t[i]);return r};var ch=(t,e)=>{const r=e||t.length;if("function"===typeof TextDecoder&&TextDecoder.prototype.decode)return(new TextDecoder).decode(t.subarray(0,e));let i,n;const s=new Array(2*r);for(n=0,i=0;i<r;){let e=t[i++];if(e<128){s[n++]=e;continue}let o=lh[e];if(o>4)s[n++]=65533,i+=o-1;else{e&=2===o?31:3===o?15:7;while(o>1&&i<r)e=e<<6|63&t[i++],o--;o>1?s[n++]=65533:e<65536?s[n++]=e:(e-=65536,s[n++]=55296|e>>10&1023,s[n++]=56320|1023&e)}}return uh(s,n)},fh=(t,e)=>{e=e||t.length,e>t.length&&(e=t.length);let r=e-1;while(r>=0&&128===(192&t[r]))r--;return r<0||0===r?e:r+lh[t[r]]>e?r:e},dh={string2buf:hh,buf2string:ch,utf8border:fh};function ph(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var mh=ph;const gh=Object.prototype.toString,{Z_NO_FLUSH:wh,Z_SYNC_FLUSH:bh,Z_FULL_FLUSH:yh,Z_FINISH:vh,Z_OK:xh,Z_STREAM_END:kh,Z_DEFAULT_COMPRESSION:_h,Z_DEFAULT_STRATEGY:Mh,Z_DEFLATED:Eh}=ya;function Sh(t){this.options=oh.assign({level:_h,method:Eh,chunkSize:16384,windowBits:15,memLevel:8,strategy:Mh},t||{});let e=this.options;e.raw&&e.windowBits>0?e.windowBits=-e.windowBits:e.gzip&&e.windowBits>0&&e.windowBits<16&&(e.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new mh,this.strm.avail_out=0;let r=rh.deflateInit2(this.strm,e.level,e.method,e.windowBits,e.memLevel,e.strategy);if(r!==xh)throw new Error(ba[r]);if(e.header&&rh.deflateSetHeader(this.strm,e.header),e.dictionary){let t;if(t="string"===typeof e.dictionary?dh.string2buf(e.dictionary):"[object ArrayBuffer]"===gh.call(e.dictionary)?new Uint8Array(e.dictionary):e.dictionary,r=rh.deflateSetDictionary(this.strm,t),r!==xh)throw new Error(ba[r]);this._dict_set=!0}}function Ah(t,e){const r=new Sh(e);if(r.push(t,!0),r.err)throw r.msg||ba[r.err];return r.result}function Ch(t,e){return e=e||{},e.raw=!0,Ah(t,e)}function Lh(t,e){return e=e||{},e.gzip=!0,Ah(t,e)}Sh.prototype.push=function(t,e){const r=this.strm,i=this.options.chunkSize;let n,s;if(this.ended)return!1;for(s=e===~~e?e:!0===e?vh:wh,"string"===typeof t?r.input=dh.string2buf(t):"[object ArrayBuffer]"===gh.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;)if(0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),(s===bh||s===yh)&&r.avail_out<=6)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else{if(n=rh.deflate(r,s),n===kh)return r.next_out>0&&this.onData(r.output.subarray(0,r.next_out)),n=rh.deflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===xh;if(0!==r.avail_out){if(s>0&&r.next_out>0)this.onData(r.output.subarray(0,r.next_out)),r.avail_out=0;else if(0===r.avail_in)break}else this.onData(r.output)}return!0},Sh.prototype.onData=function(t){this.chunks.push(t)},Sh.prototype.onEnd=function(t){t===xh&&(this.result=oh.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Ih=Sh,Dh=Ah,Rh=Ch,Ph=Lh,Th=ya,Fh={Deflate:Ih,deflate:Dh,deflateRaw:Rh,gzip:Ph,constants:Th};const Bh=16209,Uh=16191;var Oh=function(t,e){let r,i,n,s,o,a,l,h,u,c,f,d,p,m,g,w,b,y,v,x,k,_,M,E;const S=t.state;r=t.next_in,M=t.input,i=r+(t.avail_in-5),n=t.next_out,E=t.output,s=n-(e-t.avail_out),o=n+(t.avail_out-257),a=S.dmax,l=S.wsize,h=S.whave,u=S.wnext,c=S.window,f=S.hold,d=S.bits,p=S.lencode,m=S.distcode,g=(1<<S.lenbits)-1,w=(1<<S.distbits)-1;t:do{d<15&&(f+=M[r++]<<d,d+=8,f+=M[r++]<<d,d+=8),b=p[f&g];e:for(;;){if(y=b>>>24,f>>>=y,d-=y,y=b>>>16&255,0===y)E[n++]=65535&b;else{if(!(16&y)){if(0===(64&y)){b=p[(65535&b)+(f&(1<<y)-1)];continue e}if(32&y){S.mode=Uh;break t}t.msg="invalid literal/length code",S.mode=Bh;break t}v=65535&b,y&=15,y&&(d<y&&(f+=M[r++]<<d,d+=8),v+=f&(1<<y)-1,f>>>=y,d-=y),d<15&&(f+=M[r++]<<d,d+=8,f+=M[r++]<<d,d+=8),b=m[f&w];r:for(;;){if(y=b>>>24,f>>>=y,d-=y,y=b>>>16&255,!(16&y)){if(0===(64&y)){b=m[(65535&b)+(f&(1<<y)-1)];continue r}t.msg="invalid distance code",S.mode=Bh;break t}if(x=65535&b,y&=15,d<y&&(f+=M[r++]<<d,d+=8,d<y&&(f+=M[r++]<<d,d+=8)),x+=f&(1<<y)-1,x>a){t.msg="invalid distance too far back",S.mode=Bh;break t}if(f>>>=y,d-=y,y=n-s,x>y){if(y=x-y,y>h&&S.sane){t.msg="invalid distance too far back",S.mode=Bh;break t}if(k=0,_=c,0===u){if(k+=l-y,y<v){v-=y;do{E[n++]=c[k++]}while(--y);k=n-x,_=E}}else if(u<y){if(k+=l+u-y,y-=u,y<v){v-=y;do{E[n++]=c[k++]}while(--y);if(k=0,u<v){y=u,v-=y;do{E[n++]=c[k++]}while(--y);k=n-x,_=E}}}else if(k+=u-y,y<v){v-=y;do{E[n++]=c[k++]}while(--y);k=n-x,_=E}while(v>2)E[n++]=_[k++],E[n++]=_[k++],E[n++]=_[k++],v-=3;v&&(E[n++]=_[k++],v>1&&(E[n++]=_[k++]))}else{k=n-x;do{E[n++]=E[k++],E[n++]=E[k++],E[n++]=E[k++],v-=3}while(v>2);v&&(E[n++]=E[k++],v>1&&(E[n++]=E[k++]))}break}}break}}while(r<i&&n<o);v=d>>3,r-=v,d-=v<<3,f&=(1<<d)-1,t.next_in=r,t.next_out=n,t.avail_in=r<i?i-r+5:5-(r-i),t.avail_out=n<o?o-n+257:257-(n-o),S.hold=f,S.bits=d};const Nh=15,zh=852,jh=592,Xh=0,$h=1,Vh=2,Yh=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),qh=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),Gh=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),Hh=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]),Wh=(t,e,r,i,n,s,o,a)=>{const l=a.bits;let h,u,c,f,d,p,m=0,g=0,w=0,b=0,y=0,v=0,x=0,k=0,_=0,M=0,E=null;const S=new Uint16Array(Nh+1),A=new Uint16Array(Nh+1);let C,L,I,D=null;for(m=0;m<=Nh;m++)S[m]=0;for(g=0;g<i;g++)S[e[r+g]]++;for(y=l,b=Nh;b>=1;b--)if(0!==S[b])break;if(y>b&&(y=b),0===b)return n[s++]=20971520,n[s++]=20971520,a.bits=1,0;for(w=1;w<b;w++)if(0!==S[w])break;for(y<w&&(y=w),k=1,m=1;m<=Nh;m++)if(k<<=1,k-=S[m],k<0)return-1;if(k>0&&(t===Xh||1!==b))return-1;for(A[1]=0,m=1;m<Nh;m++)A[m+1]=A[m]+S[m];for(g=0;g<i;g++)0!==e[r+g]&&(o[A[e[r+g]]++]=g);if(t===Xh?(E=D=o,p=20):t===$h?(E=Yh,D=qh,p=257):(E=Gh,D=Hh,p=0),M=0,g=0,m=w,d=s,v=y,x=0,c=-1,_=1<<y,f=_-1,t===$h&&_>zh||t===Vh&&_>jh)return 1;for(;;){C=m-x,o[g]+1<p?(L=0,I=o[g]):o[g]>=p?(L=D[o[g]-p],I=E[o[g]-p]):(L=96,I=0),h=1<<m-x,u=1<<v,w=u;do{u-=h,n[d+(M>>x)+u]=C<<24|L<<16|I}while(0!==u);h=1<<m-1;while(M&h)h>>=1;if(0!==h?(M&=h-1,M+=h):M=0,g++,0===--S[m]){if(m===b)break;m=e[r+o[g]]}if(m>y&&(M&f)!==c){0===x&&(x=y),d+=w,v=m-x,k=1<<v;while(v+x<b){if(k-=S[v+x],k<=0)break;v++,k<<=1}if(_+=1<<v,t===$h&&_>zh||t===Vh&&_>jh)return 1;c=M&f,n[c]=y<<24|v<<16|d-s}}return 0!==M&&(n[d+M]=m-x<<24|64<<16),a.bits=y,0};var Kh=Wh;const Qh=0,Zh=1,Jh=2,{Z_FINISH:tu,Z_BLOCK:eu,Z_TREES:ru,Z_OK:iu,Z_STREAM_END:nu,Z_NEED_DICT:su,Z_STREAM_ERROR:ou,Z_DATA_ERROR:au,Z_MEM_ERROR:lu,Z_BUF_ERROR:hu,Z_DEFLATED:uu}=ya,cu=16180,fu=16181,du=16182,pu=16183,mu=16184,gu=16185,wu=16186,bu=16187,yu=16188,vu=16189,xu=16190,ku=16191,_u=16192,Mu=16193,Eu=16194,Su=16195,Au=16196,Cu=16197,Lu=16198,Iu=16199,Du=16200,Ru=16201,Pu=16202,Tu=16203,Fu=16204,Bu=16205,Uu=16206,Ou=16207,Nu=16208,zu=16209,ju=16210,Xu=16211,$u=852,Vu=592,Yu=15,qu=Yu,Gu=t=>(t>>>24&255)+(t>>>8&65280)+((65280&t)<<8)+((255&t)<<24);function Hu(){this.strm=null,this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Wu=t=>{if(!t)return 1;const e=t.state;return!e||e.strm!==t||e.mode<cu||e.mode>Xu?1:0},Ku=t=>{if(Wu(t))return ou;const e=t.state;return t.total_in=t.total_out=e.total=0,t.msg="",e.wrap&&(t.adler=1&e.wrap),e.mode=cu,e.last=0,e.havedict=0,e.flags=-1,e.dmax=32768,e.head=null,e.hold=0,e.bits=0,e.lencode=e.lendyn=new Int32Array($u),e.distcode=e.distdyn=new Int32Array(Vu),e.sane=1,e.back=-1,iu},Qu=t=>{if(Wu(t))return ou;const e=t.state;return e.wsize=0,e.whave=0,e.wnext=0,Ku(t)},Zu=(t,e)=>{let r;if(Wu(t))return ou;const i=t.state;return e<0?(r=0,e=-e):(r=5+(e>>4),e<48&&(e&=15)),e&&(e<8||e>15)?ou:(null!==i.window&&i.wbits!==e&&(i.window=null),i.wrap=r,i.wbits=e,Qu(t))},Ju=(t,e)=>{if(!t)return ou;const r=new Hu;t.state=r,r.strm=t,r.window=null,r.mode=cu;const i=Zu(t,e);return i!==iu&&(t.state=null),i},tc=t=>Ju(t,qu);let ec,rc,ic=!0;const nc=t=>{if(ic){ec=new Int32Array(512),rc=new Int32Array(32);let e=0;while(e<144)t.lens[e++]=8;while(e<256)t.lens[e++]=9;while(e<280)t.lens[e++]=7;while(e<288)t.lens[e++]=8;Kh(Zh,t.lens,0,288,ec,0,t.work,{bits:9}),e=0;while(e<32)t.lens[e++]=5;Kh(Jh,t.lens,0,32,rc,0,t.work,{bits:5}),ic=!1}t.lencode=ec,t.lenbits=9,t.distcode=rc,t.distbits=5},sc=(t,e,r,i)=>{let n;const s=t.state;return null===s.window&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),i>=s.wsize?(s.window.set(e.subarray(r-s.wsize,r),0),s.wnext=0,s.whave=s.wsize):(n=s.wsize-s.wnext,n>i&&(n=i),s.window.set(e.subarray(r-i,r-i+n),s.wnext),i-=n,i?(s.window.set(e.subarray(r-i,r),0),s.wnext=i,s.whave=s.wsize):(s.wnext+=n,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=n))),0},oc=(t,e)=>{let r,i,n,s,o,a,l,h,u,c,f,d,p,m,g,w,b,y,v,x,k,_,M=0;const E=new Uint8Array(4);let S,A;const C=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(Wu(t)||!t.output||!t.input&&0!==t.avail_in)return ou;r=t.state,r.mode===ku&&(r.mode=_u),o=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,h=r.hold,u=r.bits,c=a,f=l,_=iu;t:for(;;)switch(r.mode){case cu:if(0===r.wrap){r.mode=_u;break}while(u<16){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(2&r.wrap&&35615===h){0===r.wbits&&(r.wbits=15),r.check=0,E[0]=255&h,E[1]=h>>>8&255,r.check=wa(r.check,E,2,0),h=0,u=0,r.mode=fu;break}if(r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&h)<<8)+(h>>8))%31){t.msg="incorrect header check",r.mode=zu;break}if((15&h)!==uu){t.msg="unknown compression method",r.mode=zu;break}if(h>>>=4,u-=4,k=8+(15&h),0===r.wbits&&(r.wbits=k),k>15||k>r.wbits){t.msg="invalid window size",r.mode=zu;break}r.dmax=1<<r.wbits,r.flags=0,t.adler=r.check=1,r.mode=512&h?vu:ku,h=0,u=0;break;case fu:while(u<16){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(r.flags=h,(255&r.flags)!==uu){t.msg="unknown compression method",r.mode=zu;break}if(57344&r.flags){t.msg="unknown header flags set",r.mode=zu;break}r.head&&(r.head.text=h>>8&1),512&r.flags&&4&r.wrap&&(E[0]=255&h,E[1]=h>>>8&255,r.check=wa(r.check,E,2,0)),h=0,u=0,r.mode=du;case du:while(u<32){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}r.head&&(r.head.time=h),512&r.flags&&4&r.wrap&&(E[0]=255&h,E[1]=h>>>8&255,E[2]=h>>>16&255,E[3]=h>>>24&255,r.check=wa(r.check,E,4,0)),h=0,u=0,r.mode=pu;case pu:while(u<16){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}r.head&&(r.head.xflags=255&h,r.head.os=h>>8),512&r.flags&&4&r.wrap&&(E[0]=255&h,E[1]=h>>>8&255,r.check=wa(r.check,E,2,0)),h=0,u=0,r.mode=mu;case mu:if(1024&r.flags){while(u<16){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}r.length=h,r.head&&(r.head.extra_len=h),512&r.flags&&4&r.wrap&&(E[0]=255&h,E[1]=h>>>8&255,r.check=wa(r.check,E,2,0)),h=0,u=0}else r.head&&(r.head.extra=null);r.mode=gu;case gu:if(1024&r.flags&&(d=r.length,d>a&&(d=a),d&&(r.head&&(k=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Uint8Array(r.head.extra_len)),r.head.extra.set(i.subarray(s,s+d),k)),512&r.flags&&4&r.wrap&&(r.check=wa(r.check,i,d,s)),a-=d,s+=d,r.length-=d),r.length))break t;r.length=0,r.mode=wu;case wu:if(2048&r.flags){if(0===a)break t;d=0;do{k=i[s+d++],r.head&&k&&r.length<65536&&(r.head.name+=String.fromCharCode(k))}while(k&&d<a);if(512&r.flags&&4&r.wrap&&(r.check=wa(r.check,i,d,s)),a-=d,s+=d,k)break t}else r.head&&(r.head.name=null);r.length=0,r.mode=bu;case bu:if(4096&r.flags){if(0===a)break t;d=0;do{k=i[s+d++],r.head&&k&&r.length<65536&&(r.head.comment+=String.fromCharCode(k))}while(k&&d<a);if(512&r.flags&&4&r.wrap&&(r.check=wa(r.check,i,d,s)),a-=d,s+=d,k)break t}else r.head&&(r.head.comment=null);r.mode=yu;case yu:if(512&r.flags){while(u<16){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(4&r.wrap&&h!==(65535&r.check)){t.msg="header crc mismatch",r.mode=zu;break}h=0,u=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),t.adler=r.check=0,r.mode=ku;break;case vu:while(u<32){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}t.adler=r.check=Gu(h),h=0,u=0,r.mode=xu;case xu:if(0===r.havedict)return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,r.hold=h,r.bits=u,su;t.adler=r.check=1,r.mode=ku;case ku:if(e===eu||e===ru)break t;case _u:if(r.last){h>>>=7&u,u-=7&u,r.mode=Uu;break}while(u<3){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}switch(r.last=1&h,h>>>=1,u-=1,3&h){case 0:r.mode=Mu;break;case 1:if(nc(r),r.mode=Iu,e===ru){h>>>=2,u-=2;break t}break;case 2:r.mode=Au;break;case 3:t.msg="invalid block type",r.mode=zu}h>>>=2,u-=2;break;case Mu:h>>>=7&u,u-=7&u;while(u<32){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if((65535&h)!==(h>>>16^65535)){t.msg="invalid stored block lengths",r.mode=zu;break}if(r.length=65535&h,h=0,u=0,r.mode=Eu,e===ru)break t;case Eu:r.mode=Su;case Su:if(d=r.length,d){if(d>a&&(d=a),d>l&&(d=l),0===d)break t;n.set(i.subarray(s,s+d),o),a-=d,s+=d,l-=d,o+=d,r.length-=d;break}r.mode=ku;break;case Au:while(u<14){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(r.nlen=257+(31&h),h>>>=5,u-=5,r.ndist=1+(31&h),h>>>=5,u-=5,r.ncode=4+(15&h),h>>>=4,u-=4,r.nlen>286||r.ndist>30){t.msg="too many length or distance symbols",r.mode=zu;break}r.have=0,r.mode=Cu;case Cu:while(r.have<r.ncode){while(u<3){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}r.lens[C[r.have++]]=7&h,h>>>=3,u-=3}while(r.have<19)r.lens[C[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,S={bits:r.lenbits},_=Kh(Qh,r.lens,0,19,r.lencode,0,r.work,S),r.lenbits=S.bits,_){t.msg="invalid code lengths set",r.mode=zu;break}r.have=0,r.mode=Lu;case Lu:while(r.have<r.nlen+r.ndist){for(;;){if(M=r.lencode[h&(1<<r.lenbits)-1],g=M>>>24,w=M>>>16&255,b=65535&M,g<=u)break;if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(b<16)h>>>=g,u-=g,r.lens[r.have++]=b;else{if(16===b){A=g+2;while(u<A){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(h>>>=g,u-=g,0===r.have){t.msg="invalid bit length repeat",r.mode=zu;break}k=r.lens[r.have-1],d=3+(3&h),h>>>=2,u-=2}else if(17===b){A=g+3;while(u<A){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}h>>>=g,u-=g,k=0,d=3+(7&h),h>>>=3,u-=3}else{A=g+7;while(u<A){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}h>>>=g,u-=g,k=0,d=11+(127&h),h>>>=7,u-=7}if(r.have+d>r.nlen+r.ndist){t.msg="invalid bit length repeat",r.mode=zu;break}while(d--)r.lens[r.have++]=k}}if(r.mode===zu)break;if(0===r.lens[256]){t.msg="invalid code -- missing end-of-block",r.mode=zu;break}if(r.lenbits=9,S={bits:r.lenbits},_=Kh(Zh,r.lens,0,r.nlen,r.lencode,0,r.work,S),r.lenbits=S.bits,_){t.msg="invalid literal/lengths set",r.mode=zu;break}if(r.distbits=6,r.distcode=r.distdyn,S={bits:r.distbits},_=Kh(Jh,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,S),r.distbits=S.bits,_){t.msg="invalid distances set",r.mode=zu;break}if(r.mode=Iu,e===ru)break t;case Iu:r.mode=Du;case Du:if(a>=6&&l>=258){t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,r.hold=h,r.bits=u,Oh(t,f),o=t.next_out,n=t.output,l=t.avail_out,s=t.next_in,i=t.input,a=t.avail_in,h=r.hold,u=r.bits,r.mode===ku&&(r.back=-1);break}for(r.back=0;;){if(M=r.lencode[h&(1<<r.lenbits)-1],g=M>>>24,w=M>>>16&255,b=65535&M,g<=u)break;if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(w&&0===(240&w)){for(y=g,v=w,x=b;;){if(M=r.lencode[x+((h&(1<<y+v)-1)>>y)],g=M>>>24,w=M>>>16&255,b=65535&M,y+g<=u)break;if(0===a)break t;a--,h+=i[s++]<<u,u+=8}h>>>=y,u-=y,r.back+=y}if(h>>>=g,u-=g,r.back+=g,r.length=b,0===w){r.mode=Bu;break}if(32&w){r.back=-1,r.mode=ku;break}if(64&w){t.msg="invalid literal/length code",r.mode=zu;break}r.extra=15&w,r.mode=Ru;case Ru:if(r.extra){A=r.extra;while(u<A){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,u-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Pu;case Pu:for(;;){if(M=r.distcode[h&(1<<r.distbits)-1],g=M>>>24,w=M>>>16&255,b=65535&M,g<=u)break;if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(0===(240&w)){for(y=g,v=w,x=b;;){if(M=r.distcode[x+((h&(1<<y+v)-1)>>y)],g=M>>>24,w=M>>>16&255,b=65535&M,y+g<=u)break;if(0===a)break t;a--,h+=i[s++]<<u,u+=8}h>>>=y,u-=y,r.back+=y}if(h>>>=g,u-=g,r.back+=g,64&w){t.msg="invalid distance code",r.mode=zu;break}r.offset=b,r.extra=15&w,r.mode=Tu;case Tu:if(r.extra){A=r.extra;while(u<A){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,u-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){t.msg="invalid distance too far back",r.mode=zu;break}r.mode=Fu;case Fu:if(0===l)break t;if(d=f-l,r.offset>d){if(d=r.offset-d,d>r.whave&&r.sane){t.msg="invalid distance too far back",r.mode=zu;break}d>r.wnext?(d-=r.wnext,p=r.wsize-d):p=r.wnext-d,d>r.length&&(d=r.length),m=r.window}else m=n,p=o-r.offset,d=r.length;d>l&&(d=l),l-=d,r.length-=d;do{n[o++]=m[p++]}while(--d);0===r.length&&(r.mode=Du);break;case Bu:if(0===l)break t;n[o++]=r.length,l--,r.mode=Du;break;case Uu:if(r.wrap){while(u<32){if(0===a)break t;a--,h|=i[s++]<<u,u+=8}if(f-=l,t.total_out+=f,r.total+=f,4&r.wrap&&f&&(t.adler=r.check=r.flags?wa(r.check,n,f,o-f):da(r.check,n,f,o-f)),f=l,4&r.wrap&&(r.flags?h:Gu(h))!==r.check){t.msg="incorrect data check",r.mode=zu;break}h=0,u=0}r.mode=Ou;case Ou:if(r.wrap&&r.flags){while(u<32){if(0===a)break t;a--,h+=i[s++]<<u,u+=8}if(4&r.wrap&&h!==(4294967295&r.total)){t.msg="incorrect length check",r.mode=zu;break}h=0,u=0}r.mode=Nu;case Nu:_=nu;break t;case zu:_=au;break t;case ju:return lu;case Xu:default:return ou}return t.next_out=o,t.avail_out=l,t.next_in=s,t.avail_in=a,r.hold=h,r.bits=u,(r.wsize||f!==t.avail_out&&r.mode<zu&&(r.mode<Uu||e!==tu))&&sc(t,t.output,t.next_out,f-t.avail_out),c-=t.avail_in,f-=t.avail_out,t.total_in+=c,t.total_out+=f,r.total+=f,4&r.wrap&&f&&(t.adler=r.check=r.flags?wa(r.check,n,f,t.next_out-f):da(r.check,n,f,t.next_out-f)),t.data_type=r.bits+(r.last?64:0)+(r.mode===ku?128:0)+(r.mode===Iu||r.mode===Eu?256:0),(0===c&&0===f||e===tu)&&_===iu&&(_=hu),_},ac=t=>{if(Wu(t))return ou;let e=t.state;return e.window&&(e.window=null),t.state=null,iu},lc=(t,e)=>{if(Wu(t))return ou;const r=t.state;return 0===(2&r.wrap)?ou:(r.head=e,e.done=!1,iu)},hc=(t,e)=>{const r=e.length;let i,n,s;return Wu(t)?ou:(i=t.state,0!==i.wrap&&i.mode!==xu?ou:i.mode===xu&&(n=1,n=da(n,e,r,0),n!==i.check)?au:(s=sc(t,e,r,r),s?(i.mode=ju,lu):(i.havedict=1,iu)))};var uc=Qu,cc=Zu,fc=Ku,dc=tc,pc=Ju,mc=oc,gc=ac,wc=lc,bc=hc,yc="pako inflate (from Nodeca project)",vc={inflateReset:uc,inflateReset2:cc,inflateResetKeep:fc,inflateInit:dc,inflateInit2:pc,inflate:mc,inflateEnd:gc,inflateGetHeader:wc,inflateSetDictionary:bc,inflateInfo:yc};function xc(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var kc=xc;const _c=Object.prototype.toString,{Z_NO_FLUSH:Mc,Z_FINISH:Ec,Z_OK:Sc,Z_STREAM_END:Ac,Z_NEED_DICT:Cc,Z_STREAM_ERROR:Lc,Z_DATA_ERROR:Ic,Z_MEM_ERROR:Dc}=ya;function Rc(t){this.options=oh.assign({chunkSize:65536,windowBits:15,to:""},t||{});const e=this.options;e.raw&&e.windowBits>=0&&e.windowBits<16&&(e.windowBits=-e.windowBits,0===e.windowBits&&(e.windowBits=-15)),!(e.windowBits>=0&&e.windowBits<16)||t&&t.windowBits||(e.windowBits+=32),e.windowBits>15&&e.windowBits<48&&0===(15&e.windowBits)&&(e.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new mh,this.strm.avail_out=0;let r=vc.inflateInit2(this.strm,e.windowBits);if(r!==Sc)throw new Error(ba[r]);if(this.header=new kc,vc.inflateGetHeader(this.strm,this.header),e.dictionary&&("string"===typeof e.dictionary?e.dictionary=dh.string2buf(e.dictionary):"[object ArrayBuffer]"===_c.call(e.dictionary)&&(e.dictionary=new Uint8Array(e.dictionary)),e.raw&&(r=vc.inflateSetDictionary(this.strm,e.dictionary),r!==Sc)))throw new Error(ba[r])}function Pc(t,e){const r=new Rc(e);if(r.push(t),r.err)throw r.msg||ba[r.err];return r.result}function Tc(t,e){return e=e||{},e.raw=!0,Pc(t,e)}Rc.prototype.push=function(t,e){const r=this.strm,i=this.options.chunkSize,n=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(o=e===~~e?e:!0===e?Ec:Mc,"[object ArrayBuffer]"===_c.call(t)?r.input=new Uint8Array(t):r.input=t,r.next_in=0,r.avail_in=r.input.length;;){0===r.avail_out&&(r.output=new Uint8Array(i),r.next_out=0,r.avail_out=i),s=vc.inflate(r,o),s===Cc&&n&&(s=vc.inflateSetDictionary(r,n),s===Sc?s=vc.inflate(r,o):s===Ic&&(s=Cc));while(r.avail_in>0&&s===Ac&&r.state.wrap>0&&0!==t[r.next_in])vc.inflateReset(r),s=vc.inflate(r,o);switch(s){case Lc:case Ic:case Cc:case Dc:return this.onEnd(s),this.ended=!0,!1}if(a=r.avail_out,r.next_out&&(0===r.avail_out||s===Ac))if("string"===this.options.to){let t=dh.utf8border(r.output,r.next_out),e=r.next_out-t,n=dh.buf2string(r.output,t);r.next_out=e,r.avail_out=i-e,e&&r.output.set(r.output.subarray(t,t+e),0),this.onData(n)}else this.onData(r.output.length===r.next_out?r.output:r.output.subarray(0,r.next_out));if(s!==Sc||0!==a){if(s===Ac)return s=vc.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(0===r.avail_in)break}}return!0},Rc.prototype.onData=function(t){this.chunks.push(t)},Rc.prototype.onEnd=function(t){t===Sc&&("string"===this.options.to?this.result=this.chunks.join(""):this.result=oh.flattenChunks(this.chunks)),this.chunks=[],this.err=t,this.msg=this.strm.msg};var Fc=Rc,Bc=Pc,Uc=Tc,Oc=Pc,Nc=ya,zc={Inflate:Fc,inflate:Bc,inflateRaw:Uc,ungzip:Oc,constants:Nc};const{Deflate:jc,deflate:Xc,deflateRaw:$c,gzip:Vc}=Fh,{Inflate:Yc,inflate:qc,inflateRaw:Gc,ungzip:Hc}=zc;var Wc=Xc,Kc=Yc,Qc=qc;const Zc=[137,80,78,71,13,10,26,10],Jc=[];for(let Tv=0;Tv<256;Tv++){let t=Tv;for(let e=0;e<8;e++)1&t?t=3988292384^t>>>1:t>>>=1;Jc[Tv]=t}const tf=4294967295;function ef(t,e,r){let i=t;for(let n=0;n<r;n++)i=Jc[255&(i^e[n])]^i>>>8;return i}function rf(t,e){return(ef(tf,t,e)^tf)>>>0}var nf,sf,of,af;(function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["GREYSCALE"]=0]="GREYSCALE",t[t["TRUECOLOUR"]=2]="TRUECOLOUR",t[t["INDEXED_COLOUR"]=3]="INDEXED_COLOUR",t[t["GREYSCALE_ALPHA"]=4]="GREYSCALE_ALPHA",t[t["TRUECOLOUR_ALPHA"]=6]="TRUECOLOUR_ALPHA"})(nf||(nf={})),function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["DEFLATE"]=0]="DEFLATE"}(sf||(sf={})),function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["ADAPTIVE"]=0]="ADAPTIVE"}(of||(of={})),function(t){t[t["UNKNOWN"]=-1]="UNKNOWN",t[t["NO_INTERLACE"]=0]="NO_INTERLACE",t[t["ADAM7"]=1]="ADAM7"}(af||(af={}));const lf=new Uint8Array(0),hf="\0",uf=new Uint16Array([255]),cf=new Uint8Array(uf.buffer),ff=255===cf[0];class df extends Gs.IOBuffer{constructor(t,e={}){super(t);const{checkCrc:r=!1}=e;this._checkCrc=r,this._inflator=new Kc,this._png={width:-1,height:-1,channels:-1,data:new Uint8Array(0),depth:1,text:{}},this._end=!1,this._hasPalette=!1,this._palette=[],this._hasTransparency=!1,this._transparency=new Uint16Array(0),this._compressionMethod=sf.UNKNOWN,this._filterMethod=of.UNKNOWN,this._interlaceMethod=af.UNKNOWN,this._colorType=nf.UNKNOWN,this.setBigEndian()}decode(){this.decodeSignature();while(!this._end)this.decodeChunk();return this.decodeImage(),this._png}decodeSignature(){for(let t=0;t<Zc.length;t++)if(this.readUint8()!==Zc[t])throw new Error(`wrong PNG signature. Byte at ${t} should be ${Zc[t]}.`)}decodeChunk(){const t=this.readUint32(),e=this.readChars(4),r=this.offset;switch(e){case"IHDR":this.decodeIHDR();break;case"PLTE":this.decodePLTE(t);break;case"IDAT":this.decodeIDAT(t);break;case"IEND":this._end=!0;break;case"tRNS":this.decodetRNS(t);break;case"iCCP":this.decodeiCCP(t);break;case"tEXt":this.decodetEXt(t);break;case"pHYs":this.decodepHYs();break;default:this.skip(t);break}if(this.offset-r!==t)throw new Error(`Length mismatch while decoding chunk ${e}`);if(this._checkCrc){const r=this.readUint32(),i=t+4,n=rf(new Uint8Array(this.buffer,this.byteOffset+this.offset-i-4,i),i);if(n!==r)throw new Error(`CRC mismatch for chunk ${e}. Expected ${r}, found ${n}`)}else this.skip(4)}decodeIHDR(){const t=this._png;t.width=this.readUint32(),t.height=this.readUint32(),t.depth=xf(this.readUint8());const e=this.readUint8();let r;switch(this._colorType=e,e){case nf.GREYSCALE:r=1;break;case nf.TRUECOLOUR:r=3;break;case nf.INDEXED_COLOUR:r=1;break;case nf.GREYSCALE_ALPHA:r=2;break;case nf.TRUECOLOUR_ALPHA:r=4;break;default:throw new Error(`Unknown color type: ${e}`)}if(this._png.channels=r,this._compressionMethod=this.readUint8(),this._compressionMethod!==sf.DEFLATE)throw new Error(`Unsupported compression method: ${this._compressionMethod}`);this._filterMethod=this.readUint8(),this._interlaceMethod=this.readUint8()}decodePLTE(t){if(t%3!==0)throw new RangeError(`PLTE field length must be a multiple of 3. Got ${t}`);const e=t/3;this._hasPalette=!0;const r=[];this._palette=r;for(let i=0;i<e;i++)r.push([this.readUint8(),this.readUint8(),this.readUint8()])}decodeIDAT(t){this._inflator.push(new Uint8Array(this.buffer,this.offset+this.byteOffset,t)),this.skip(t)}decodetRNS(t){switch(this._colorType){case nf.GREYSCALE:case nf.TRUECOLOUR:if(t%2!==0)throw new RangeError(`tRNS chunk length must be a multiple of 2. Got ${t}`);if(t/2>this._png.width*this._png.height)throw new Error(`tRNS chunk contains more alpha values than there are pixels (${t/2} vs ${this._png.width*this._png.height})`);this._hasTransparency=!0,this._transparency=new Uint16Array(t/2);for(let e=0;e<t/2;e++)this._transparency[e]=this.readUint16();break;case nf.INDEXED_COLOUR:{if(t>this._palette.length)throw new Error(`tRNS chunk contains more alpha values than there are palette colors (${t} vs ${this._palette.length})`);let e=0;for(;e<t;e++){const t=this.readByte();this._palette[e].push(t)}for(;e<this._palette.length;e++)this._palette[e].push(255);break}default:throw new Error(`tRNS chunk is not supported for color type ${this._colorType}`)}}decodeiCCP(t){let e,r="";while((e=this.readChar())!==hf)r+=e;const i=this.readUint8();if(i!==sf.DEFLATE)throw new Error(`Unsupported iCCP compression method: ${i}`);const n=this.readBytes(t-r.length-2);this._png.iccEmbeddedProfile={name:r,profile:Qc(n)}}decodetEXt(t){let e,r="";while((e=this.readChar())!==hf)r+=e;this._png.text[r]=this.readChars(t-r.length-1)}decodepHYs(){const t=this.readUint32(),e=this.readUint32(),r=this.readByte();this._png.resolution={x:t,y:e,unit:r}}decodeImage(){if(this._inflator.err)throw new Error(`Error while decompressing the data: ${this._inflator.err}`);const t=this._inflator.result;if(this._filterMethod!==of.ADAPTIVE)throw new Error(`Filter method ${this._filterMethod} not supported`);if(this._interlaceMethod!==af.NO_INTERLACE)throw new Error(`Interlace method ${this._interlaceMethod} not supported`);this.decodeInterlaceNull(t)}decodeInterlaceNull(t){const e=this._png.height,r=this._png.channels*this._png.depth/8,i=this._png.width*r,n=new Uint8Array(this._png.height*i);let s,o,a=lf,l=0;for(let h=0;h<e;h++){switch(s=t.subarray(l+1,l+1+i),o=n.subarray(h*i,(h+1)*i),t[l]){case 0:pf(s,o,i);break;case 1:mf(s,o,i,r);break;case 2:gf(s,o,a,i);break;case 3:wf(s,o,a,i,r);break;case 4:bf(s,o,a,i,r);break;default:throw new Error(`Unsupported filter: ${t[l]}`)}a=o,l+=i+1}if(this._hasPalette&&(this._png.palette=this._palette),this._hasTransparency&&(this._png.transparency=this._transparency),16===this._png.depth){const t=new Uint16Array(n.buffer);if(ff)for(let e=0;e<t.length;e++)t[e]=vf(t[e]);this._png.data=t}else this._png.data=n}}function pf(t,e,r){for(let i=0;i<r;i++)e[i]=t[i]}function mf(t,e,r,i){let n=0;for(;n<i;n++)e[n]=t[n];for(;n<r;n++)e[n]=t[n]+e[n-i]&255}function gf(t,e,r,i){let n=0;if(0===r.length)for(;n<i;n++)e[n]=t[n];else for(;n<i;n++)e[n]=t[n]+r[n]&255}function wf(t,e,r,i,n){let s=0;if(0===r.length){for(;s<n;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+(e[s-n]>>1)&255}else{for(;s<n;s++)e[s]=t[s]+(r[s]>>1)&255;for(;s<i;s++)e[s]=t[s]+(e[s-n]+r[s]>>1)&255}}function bf(t,e,r,i,n){let s=0;if(0===r.length){for(;s<n;s++)e[s]=t[s];for(;s<i;s++)e[s]=t[s]+e[s-n]&255}else{for(;s<n;s++)e[s]=t[s]+r[s]&255;for(;s<i;s++)e[s]=t[s]+yf(e[s-n],r[s],r[s-n])&255}}function yf(t,e,r){const i=t+e-r,n=Math.abs(i-t),s=Math.abs(i-e),o=Math.abs(i-r);return n<=s&&n<=o?t:s<=o?e:r}function vf(t){return(255&t)<<8|t>>8&255}function xf(t){if(1!==t&&2!==t&&4!==t&&8!==t&&16!==t)throw new Error(`invalid bit depth: ${t}`);return t}const kf={level:3};class _f extends Gs.IOBuffer{constructor(t,e={}){super(),this._colorType=nf.UNKNOWN,this._zlibOptions={...kf,...e.zlib},this._png=this._checkData(t),this.setBigEndian()}encode(){return this.encodeSignature(),this.encodeIHDR(),this.encodeData(),this.encodeIEND(),this.toArray()}encodeSignature(){this.writeBytes(Zc)}encodeIHDR(){this.writeUint32(13),this.writeChars("IHDR"),this.writeUint32(this._png.width),this.writeUint32(this._png.height),this.writeByte(this._png.depth),this.writeByte(this._colorType),this.writeByte(sf.DEFLATE),this.writeByte(of.ADAPTIVE),this.writeByte(af.NO_INTERLACE),this.writeCrc(17)}encodeIEND(){this.writeUint32(0),this.writeChars("IEND"),this.writeCrc(4)}encodeIDAT(t){this.writeUint32(t.length),this.writeChars("IDAT"),this.writeBytes(t),this.writeCrc(t.length+4)}encodeData(){const{width:t,height:e,channels:r,depth:i,data:n}=this._png,s=r*t,o=(new Gs.IOBuffer).setBigEndian();let a=0;for(let u=0;u<e;u++)if(o.writeByte(0),8===i)a=Sf(n,o,s,a);else{if(16!==i)throw new Error("unreachable");a=Af(n,o,s,a)}const l=o.toArray(),h=Wc(l,this._zlibOptions);this.encodeIDAT(h)}_checkData(t){const{colorType:e,channels:r,depth:i}=Ef(t),n={width:Mf(t.width,"width"),height:Mf(t.height,"height"),channels:r,data:t.data,depth:i,text:{}};this._colorType=e;const s=n.width*n.height*r;if(n.data.length!==s)throw new RangeError(`wrong data size. Found ${n.data.length}, expected ${s}`);return n}writeCrc(t){this.writeUint32(rf(new Uint8Array(this.buffer,this.byteOffset+this.offset-t,t),t))}}function Mf(t,e){if(Number.isInteger(t)&&t>0)return t;throw new TypeError(`${e} must be a positive integer`)}function Ef(t){const{channels:e=4,depth:r=8}=t;if(4!==e&&3!==e&&2!==e&&1!==e)throw new RangeError(`unsupported number of channels: ${e}`);if(8!==r&&16!==r)throw new RangeError(`unsupported bit depth: ${r}`);const i={channels:e,depth:r,colorType:nf.UNKNOWN};switch(e){case 4:i.colorType=nf.TRUECOLOUR_ALPHA;break;case 3:i.colorType=nf.TRUECOLOUR;break;case 1:i.colorType=nf.GREYSCALE;break;case 2:i.colorType=nf.GREYSCALE_ALPHA;break;default:throw new Error("unsupported number of channels")}return i}function Sf(t,e,r,i){for(let n=0;n<r;n++)e.writeByte(t[i++]);return i}function Af(t,e,r,i){for(let n=0;n<r;n++)e.writeUint16(t[i++]);return i}var Cf;function Lf(t,e){const r=new df(t,e);return r.decode()}function If(t,e){const r=new _f(t,e);return r.encode()}(function(t){t[t["UNKNOWN"]=0]="UNKNOWN",t[t["METRE"]=1]="METRE"})(Cf||(Cf={}));var Df=r(15609);let Rf="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pf=new Uint8Array(256);for(let Tv=0;Tv<Rf.length;Tv++)Pf[Rf.charCodeAt(Tv)]=Tv;function Tf(t){let e,r=t.length,i="";for(e=0;e<r;e+=3)i+=Rf[t[e]>>2],i+=Rf[(3&t[e])<<4|t[e+1]>>4],i+=Rf[(15&t[e+1])<<2|t[e+2]>>6],i+=Rf[63&t[e+2]];return r%3===2?i=`${i.substring(0,i.length-1)}=`:r%3===1&&(i=`${i.substring(0,i.length-2)}==`),i}function Ff(t){let e,r,i,n,s=.75*t.length,o=t.length,a=0;"="===t[t.length-1]&&(s--,"="===t[t.length-2]&&s--);const l=new Uint8Array(s);for(let h=0;h<o;h+=4)e=Pf[t.charCodeAt(h)],r=Pf[t.charCodeAt(h+1)],i=Pf[t.charCodeAt(h+2)],n=Pf[t.charCodeAt(h+3)],l[a++]=e<<2|r>>4,l[a++]=(15&r)<<4|i>>2,l[a++]=(3&i)<<6|63&n;return l}function Bf(t,e){const r=Tf(t);return`data:${e};base64,${r}`}const Uf=self.ImageData,Of=self.Image;function Nf(t,e){let r=self.document.createElement("canvas");return r.width=t,r.height=e,r}function zf(t,{withCredentials:e=!1}={}){return new Promise((function(r,i){let n=new self.XMLHttpRequest;n.open("GET",t,!0),n.responseType="arraybuffer",n.withCredentials=e,n.onload=function(t){200!==this.status?i(t):r(this.response)},n.onerror=i,n.send()}))}function jf(){throw new Error("createWriteStream does not exist in the browser")}function Xf(){throw new Error("writeFile does not exist in the browser")}function $f(t){return t.includes("/")||(t=`image/${t}`),t}function Vf(t,e={}){const r={width:t.width,height:t.height,data:t.getRGBAData()};return(0,Df.encode)(r,e.quality).data}function Yf(t,e){const r={width:t.width,height:t.height,channels:t.channels,depth:t.bitDepth,data:t.data};return 1!==r.depth&&32!==r.depth||(r.depth=8,r.channels=4,r.data=t.getRGBAData()),If(r,e)}const qf={save(t,e={}){const{useCanvas:r=!1,encoder:i}=e;let{format:n}=e;if(!n){const e=/\.(?<format>[a-zA-Z]+)$/.exec(t);e&&(n=e.groups.format.toLowerCase())}if(!n)throw new Error("file format not provided");return new Promise(((e,s)=>{let o,a;switch(n.toLowerCase()){case"png":r?o=this.getCanvas().pngStream():a=Yf(this,i);break;case"jpg":case"jpeg":r?o=this.getCanvas().jpegStream():a=Vf(this,i);break;case"bmp":a=(0,qs.l)(this,i);break;default:throw new RangeError(`invalid output format: ${n}`)}if(o){let r=jf(t);r.on("finish",e),r.on("error",s),o.pipe(r)}else a&&Xf(t,a,(t=>{t?s(t):e()}))}))},toDataURL(t="image/png",e={}){"object"===typeof t&&(e=t,t="image/png");const{useCanvas:r=!1,encoder:i}=e;function n(e,r){const n=e(r,i);return Bf(n,t)}return t=$f(t),"image/bmp"===t?n(qs.l,this):"image/png"!==t||r?"image/jpeg"!==t||r?this.getCanvas().toDataURL(t):n(Vf,this):n(Yf,this)},toBuffer(t={}){const{format:e="png",encoder:r}=t;switch(e.toLowerCase()){case"png":return Yf(this,r);case"jpeg":case"jpg":return Vf(this,r);case"bmp":return(0,qs.l)(this,r);default:throw new RangeError(`invalid output format: ${e}`)}},toBase64(t="image/png",e={}){if(e.async)return this.toDataURL(t,e).then((function(t){return t.substring(t.indexOf(",")+1)}));{const r=this.toDataURL(t,e);return r.substring(r.indexOf(",")+1)}},toBlob(t="image/png",e=.8){return Vs(this.getCanvas(),t,e)},getCanvas(){const t=new Uf(this.getRGBAData({clamped:!0}),this.width,this.height);let e=Nf(this.width,this.height),r=e.getContext("2d");return r.putImageData(t,0,0),e}};function Gf(t){for(const e in qf)t.prototype[e]=qf[e]}var Hf=r(82334),Wf=r.n(Hf);let Kf={configurable:!0,enumerable:!1,get:void 0};function Qf(t,e,r={}){let{inPlace:i=!1,returnThis:n=!0,partialArgs:s=[]}=r;return pv.prototype[t]=i?function(...t){this.computed=null;let r=e.apply(this,[...s,...t]);return n?this:r}:function(...t){return e.apply(this,[...s,...t])},pv}function Zf(t,e,r={}){let{partialArgs:i=[]}=r;return Kf.get=function(){if(null===this.computed)this.computed={};else if(Wf()(t,this.computed))return this.computed[t];let r=e.apply(this,i);return this.computed[t]=r,r},Object.defineProperty(pv.prototype,t,Kf),pv}const Jf="GREY",td="RGB",ed="HSL",rd="HSV",id="CMYK";function nd(t={}){const{clamped:e}=t;this.checkProcessable("getRGBAData",{components:[1,3],bitDepth:[1,8,16,32]});const r=this.width*this.height*4;let i=e?new Uint8ClampedArray(r):new Uint8Array(r);return 1===this.bitDepth?sd(this,i):32===this.bitDepth?(this.checkProcessable("getRGBAData",{alpha:0}),1===this.components?od(this,i):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[td]}),ad(this,i))):1===this.components?ld(this,i):3===this.components&&(this.checkProcessable("getRGBAData",{colorModel:[td]}),hd(this,i)),1===this.alpha?(this.checkProcessable("getRGBAData",{bitDepth:[8,16]}),ud(this,i)):cd(this,i),i}function sd(t,e){for(let r=0;r<t.size;r++){const i=t.getBit(r);e[4*r]=255*i,e[4*r+1]=255*i,e[4*r+2]=255*i}}function od(t,e){const r=t.min[0],i=t.max[0],n=i-r;for(let s=0;s<t.size;s++){const i=Math.floor(255*(t.data[s]-r)/n);e[4*s]=i,e[4*s+1]=i,e[4*s+2]=i}}function ad(t,e){const r=Math.min(...t.min),i=Math.max(...t.max),n=i-r;for(let s=0;s<t.size;s++){const i=Math.floor(255*(t.data[3*s]-r)/n),o=Math.floor(255*(t.data[3*s+1]-r)/n),a=Math.floor(255*(t.data[3*s+2]-r)/n);e[4*s]=i,e[4*s+1]=o,e[4*s+2]=a}}function ld(t,e){for(let r=0;r<t.size;r++)e[4*r]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+1]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+2]=t.data[r*t.channels]>>>t.bitDepth-8}function hd(t,e){for(let r=0;r<t.size;r++)e[4*r]=t.data[r*t.channels]>>>t.bitDepth-8,e[4*r+1]=t.data[r*t.channels+1]>>>t.bitDepth-8,e[4*r+2]=t.data[r*t.channels+2]>>>t.bitDepth-8}function ud(t,e){for(let r=0;r<t.size;r++)e[4*r+3]=t.data[r*t.channels+t.components]>>t.bitDepth-8}function cd(t,e){for(let r=0;r<t.size;r++)e[4*r+3]=255}const fd="BINARY",dd="GREY",pd="GREYA",md="RGB",gd="RGBA",wd="CMYK",bd="CMYKA",yd={};function vd(t){const e=yd[t];if(!e)throw new RangeError(`invalid image kind: ${t}`);return e}yd[fd]={components:1,alpha:0,bitDepth:1,colorModel:Jf},yd[pd]={components:1,alpha:1,bitDepth:8,colorModel:Jf},yd[dd]={components:1,alpha:0,bitDepth:8,colorModel:Jf},yd[gd]={components:3,alpha:1,bitDepth:8,colorModel:td},yd[md]={components:3,alpha:0,bitDepth:8,colorModel:td},yd[wd]={components:4,alpha:0,bitDepth:8,colorModel:id},yd[bd]={components:4,alpha:1,bitDepth:8,colorModel:id};const xd=[1,8,16,32];function kd(t){const{components:e,alpha:r,bitDepth:n,colorModel:s}=t;if(!Number.isInteger(e)||e<=0)throw new RangeError(`invalid components: ${e}. Must be a positive integer`);if(0!==r&&1!==r&&"boolean"!==typeof r)throw new TypeError(`invalid alpha: ${r}: must be a boolean, 0 or 1`);if(!xd.includes(n))throw new RangeError(`invalid bitDepth: ${n}. Must be one of ${xd.join(", ")}`);if(!i[s])throw new RangeError(`invalid colorModel: ${s}. Must be one of ${Object.keys(i).join(", ")}`)}function _d(t,e,r){let i=e*t;return 1===r&&(i=Math.ceil(i/8)),i}function Md(t,e,r,i,n,s){const o=i*t;let a;switch(n){case 1:a=new Uint8Array(Math.ceil(o/8));break;case 8:a=new Uint8Array(o);break;case 16:a=new Uint16Array(o);break;case 32:a=new Float32Array(o);break;default:throw new Error(`Cannot create pixel array for bit depth ${n}`)}if(r)for(let l=e;l<a.length;l+=i)a[l]=s;return a}var Ed=r(93773),Sd=r(66277),Ad=r.n(Sd);function Cd(t){if(1!==t.compression)throw new Error("missing mandatory StripByteCounts field in compressed image");const e=t.rowsPerStrip*t.width*t.samplesPerPixel*(t.bitsPerSample/8);return new Array(t.stripOffsets.length).fill(e)}function Ld(t,e,r){let i=0;while(i<t.length){for(let n=r;n<e*r;n+=r)for(let e=0;e<r;e++)t[i+n+e]=t[i+n+e]+t[i+n-(r-e)]&255;i+=e*r}}function Id(t,e,r){let i=0;while(i<t.length){for(let n=r;n<e*r;n+=r)for(let e=0;e<r;e++)t[i+n+e]=t[i+n+e]+t[i+n-(r-e)]&65535;i+=e*r}}const Dd={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},Rd={};for(let Tv in Dd)Rd[Dd[Tv]]=Number(Tv);const Pd={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},Td={};for(let Tv in Pd)Td[Pd[Tv]]=Number(Tv);const Fd={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},Bd={};for(let Tv in Fd)Bd[Fd[Tv]]=Number(Tv);const Ud={standard:o,exif:n,gps:s};class Od{constructor(t){if(!t)throw new Error("missing kind");this.data=new Uint8Array,this.fields=new Map,this.kind=t,this._hasMap=!1,this._map={}}get(t){if("number"===typeof t)return this.fields.get(t);if("string"===typeof t)return this.fields.get(Ud[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._hasMap){const t=Ud[this.kind].tagsById;for(let e of this.fields.keys())t[e]&&(this._map[t[e]]=this.fields.get(e));this._hasMap=!0}return this._map}}let Nd=new Map([[1,[1,Xd]],[2,[1,$d]],[3,[2,Vd]],[4,[4,Yd]],[5,[8,qd]],[6,[1,Gd]],[7,[1,Xd]],[8,[2,Hd]],[9,[4,Wd]],[10,[8,Kd]],[11,[4,Qd]],[12,[8,Zd]]]);function zd(t,e){const r=Nd.get(t);if(!r)throw new Error(`type not found: ${t}`);return r[0]*e}function jd(t,e,r){const i=Nd.get(e);if(!i)throw new Error(`type not found: ${e}`);return i[1](t,r)}function Xd(t,e){if(1===e)return t.readUint8();let r=new Uint8Array(e);for(let i=0;i<e;i++)r[i]=t.readUint8();return r}function $d(t,e){let r=[],i="";for(let n=0;n<e;n++){let e=String.fromCharCode(t.readUint8());"\0"===e?(r.push(i),i=""):i+=e}return 1===r.length?r[0]:r}function Vd(t,e){if(1===e)return t.readUint16();let r=new Uint16Array(e);for(let i=0;i<e;i++)r[i]=t.readUint16();return r}function Yd(t,e){if(1===e)return t.readUint32();let r=new Uint32Array(e);for(let i=0;i<e;i++)r[i]=t.readUint32();return r}function qd(t,e){if(1===e)return t.readUint32()/t.readUint32();let r=new Array(e);for(let i=0;i<e;i++)r[i]=t.readUint32()/t.readUint32();return r}function Gd(t,e){if(1===e)return t.readInt8();let r=new Int8Array(e);for(let i=0;i<e;i++)r[i]=t.readInt8();return r}function Hd(t,e){if(1===e)return t.readInt16();let r=new Int16Array(e);for(let i=0;i<e;i++)r[i]=t.readInt16();return r}function Wd(t,e){if(1===e)return t.readInt32();let r=new Int32Array(e);for(let i=0;i<e;i++)r[i]=t.readInt32();return r}function Kd(t,e){if(1===e)return t.readInt32()/t.readInt32();let r=new Array(e);for(let i=0;i<e;i++)r[i]=t.readInt32()/t.readInt32();return r}function Qd(t,e){if(1===e)return t.readFloat32();let r=new Float32Array(e);for(let i=0;i<e;i++)r[i]=t.readFloat32();return r}function Zd(t,e){if(1===e)return t.readFloat64();let r=new Float64Array(e);for(let i=0;i<e;i++)r[i]=t.readFloat64();return r}const Jd=256,tp=257,ep=258,rp=9;let ip=[];function np(){if(0===ip.length){for(let e=0;e<256;e++)ip.push([e]);const t=[];for(let e=256;e<4096;e++)ip.push(t)}}const sp=[511,1023,2047,4095],op=[0,0,0,0,0,0,0,0,0,511,1023,2047,4095];class ap{constructor(t){this.nextData=0,this.nextBits=0,this.bytePointer=0,this.tableLength=ep,this.currentBitLength=rp,this.stripArray=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),this.outData=new Gs.IOBuffer(t.byteLength),this.initializeTable()}decode(){let t=0,e=0;while((t=this.getNextCode())!==tp)if(t===Jd){if(this.initializeTable(),t=this.getNextCode(),t===tp)break;this.writeString(this.stringFromCode(t)),e=t}else if(this.isInTable(t))this.writeString(this.stringFromCode(t)),this.addStringToTable(this.stringFromCode(e).concat(this.stringFromCode(t)[0])),e=t;else{const r=this.stringFromCode(e).concat(this.stringFromCode(e)[0]);this.writeString(r),this.addStringToTable(r),e=t}const r=this.outData.toArray();return new DataView(r.buffer,r.byteOffset,r.byteLength)}initializeTable(){np(),this.tableLength=ep,this.currentBitLength=rp}writeString(t){this.outData.writeBytes(t)}stringFromCode(t){return ip[t]}isInTable(t){return t<this.tableLength}addStringToTable(t){if(ip[this.tableLength++]=t,ip.length>4096)throw ip=[],new Error("LZW decoding error. Please open an issue at https://github.com/image-js/tiff/issues/new/choose (include a test image).");this.tableLength===op[this.currentBitLength]&&this.currentBitLength++}getNextCode(){this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8,this.nextBits<this.currentBitLength&&(this.nextData=this.nextData<<8|255&this.stripArray[this.bytePointer++],this.nextBits+=8);const t=this.nextData>>this.nextBits-this.currentBitLength&sp[this.currentBitLength-9];return this.nextBits-=this.currentBitLength,this.bytePointer>this.stripArray.length?257:t}}function lp(t){return new ap(t).decode()}const hp=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class up extends Od{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){let t=new Date,e=hp.exec(this.dateTime);if(null===e)throw new Error(`invalid dateTime: ${this.dateTime}`);return t.setFullYear(Number(e[1]),Number(e[2])-1,Number(e[3])),t.setHours(Number(e[4]),Number(e[5]),Number(e[6])),t}get newSubfileType(){return this.get("NewSubfileType")}get imageWidth(){return this.get("ImageWidth")}get imageLength(){return this.get("ImageLength")}get bitsPerSample(){const t=this.get("BitsPerSample");return t&&"number"!==typeof t?t[0]:t}get alpha(){const t=this.extraSamples;return!!t&&0!==t[0]}get associatedAlpha(){const t=this.extraSamples;return!!t&&1===t[0]}get extraSamples(){return cp(this.get("ExtraSamples"))}get compression(){return this.get("Compression")||1}get type(){return this.get("PhotometricInterpretation")}get fillOrder(){return this.get("FillOrder")||1}get documentName(){return this.get("DocumentName")}get imageDescription(){return this.get("ImageDescription")}get stripOffsets(){return cp(this.get("StripOffsets"))}get orientation(){return this.get("Orientation")}get samplesPerPixel(){return this.get("SamplesPerPixel")||1}get rowsPerStrip(){return this.get("RowsPerStrip")}get stripByteCounts(){return cp(this.get("StripByteCounts"))}get minSampleValue(){return this.get("MinSampleValue")||0}get maxSampleValue(){return this.get("MaxSampleValue")||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get("XResolution")}get yResolution(){return this.get("YResolution")}get planarConfiguration(){return this.get("PlanarConfiguration")||1}get resolutionUnit(){return this.get("ResolutionUnit")||2}get dateTime(){return this.get("DateTime")}get predictor(){return this.get("Predictor")||1}get sampleFormat(){return this.get("SampleFormat")||1}get sMinSampleValue(){return this.get("SMinSampleValue")||this.minSampleValue}get sMaxSampleValue(){return this.get("SMaxSampleValue")||this.maxSampleValue}get palette(){const t=2**this.bitsPerSample,e=this.get("ColorMap");if(!e)return;if(e.length!==3*t)throw new Error(`ColorMap size must be ${t}`);const r=[];for(let i=0;i<t;i++)r.push([e[i],e[i+t],e[i+2*t]]);return r}}function cp(t){return"number"===typeof t?[t]:t}function fp(t){const e=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),r=Qc(e);return new DataView(r.buffer,r.byteOffset,r.byteLength)}const dp={ignoreImageData:!1,onlyFirst:!1};class pp extends Gs.IOBuffer{constructor(t){super(t),this._nextIFD=0}get isMultiPage(){let t=0;this.decodeHeader();while(this._nextIFD)if(t++,this.decodeIFD({ignoreImageData:!0},!0),2===t)return!0;if(1===t)return!1;throw yp("ifdCount",t)}get pageCount(){let t=0;this.decodeHeader();while(this._nextIFD)t++,this.decodeIFD({ignoreImageData:!0},!0);if(t>0)return t;throw yp("ifdCount",t)}decode(t={}){t=Object.assign({},dp,t);const e=[];this.decodeHeader();while(this._nextIFD)if(e.push(this.decodeIFD(t,!0)),t.onlyFirst)return[e[0]];return e}decodeHeader(){const t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error(`invalid byte order: 0x${t.toString(16)}`);this.setBigEndian()}if(42!==this.readUint16())throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t,e){let r;if(this.seek(this._nextIFD),e)r=new up;else{if(!t.kind)throw new Error("kind is missing");r=new Od(t.kind)}const i=this.readUint16();for(let n=0;n<i;n++)this.decodeIFDEntry(r);if(!t.ignoreImageData){if(!(r instanceof up))throw new Error("must be a tiff ifd");this.decodeImageData(r)}return this._nextIFD=this.readUint32(),r}decodeIFDEntry(t){const e=this.offset,r=this.readUint16(),i=this.readUint16(),n=this.readUint32();if(i<1||i>12)return void this.skip(4);const s=zd(i,n);s>4&&this.seek(this.readUint32());const o=jd(this,i,n);if(t.fields.set(r,o),34665===r||34853===r){let e=this.offset,i="exif";34665===r?i="exif":34853===r&&(i="gps"),this._nextIFD=o,t[i]=this.decodeIFD({kind:i,ignoreImageData:!0},!1),this.offset=e}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;if(e&&1!==e)throw yp("orientation",e);switch(t.type){case 0:case 1:case 2:case 3:this.readStripData(t);break;default:throw yp("image type",t.type)}if(this.applyPredictor(t),this.convertAlpha(t),0===t.type){const e=t.bitsPerSample,r=Math.pow(2,e)-1;for(let i=0;i<t.data.length;i++)t.data[i]=r-t.data[i]}}readStripData(t){const e=t.width,r=t.height,i=t.bitsPerSample,n=t.sampleFormat,s=e*r*t.samplesPerPixel,o=mp(s,i,n),a=t.rowsPerStrip,l=a*e*t.samplesPerPixel,h=t.stripOffsets,u=t.stripByteCounts||Cd(t);let c=s,f=0;for(let d=0;d<h.length;d++){let e=new DataView(this.buffer,this.byteOffset+h[d],u[d]),r=c>l?l:c;c-=r;let s=e;switch(t.compression){case 1:break;case 5:s=lp(e);break;case 8:s=fp(e);break;case 2:throw yp("Compression","CCITT Group 3");case 32773:throw yp("Compression","PackBits");default:throw yp("Compression",t.compression)}f=this.fillUncompressed(i,n,o,s,f,r)}t.data=o}fillUncompressed(t,e,r,i,n,s){if(8===t)return gp(r,i,n,s);if(16===t)return wp(r,i,n,s,this.isLittleEndian());if(32===t&&3===e)return bp(r,i,n,s,this.isLittleEndian());throw yp("bitDepth",t)}applyPredictor(t){const e=t.bitsPerSample;switch(t.predictor){case 1:break;case 2:if(8===e)Ld(t.data,t.width,t.components);else{if(16!==e)throw new Error(`Horizontal differencing is only supported for images with a bit depth of ${e}`);Id(t.data,t.width,t.components)}break;default:throw new Error(`invalid predictor: ${t.predictor}`)}}convertAlpha(t){if(t.alpha&&t.associatedAlpha){const{data:e,components:r,maxSampleValue:i}=t;for(let t=0;t<e.length;t+=r){const n=e[t+r-1];for(let s=0;s<r-1;s++)e[t+s]=Math.round(e[t+s]*i/n)}}}}function mp(t,e,r){if(8===e)return new Uint8Array(t);if(16===e)return new Uint16Array(t);if(32===e&&3===r)return new Float32Array(t);throw yp("bit depth / sample format",`${e} / ${r}`)}function gp(t,e,r,i){for(let n=0;n<i;n++)t[r++]=e.getUint8(n);return r}function wp(t,e,r,i,n){for(let s=0;s<2*i;s+=2)t[r++]=e.getUint16(s,n);return r}function bp(t,e,r,i,n){for(let s=0;s<4*i;s+=4)t[r++]=e.getFloat32(s,n);return r}function yp(t,e){return new Error(`Unsupported ${t}: ${e}`)}function vp(t,e){const r=new pp(t);return r.decode(e)}function xp(t={}){let{algorithm:e="matchToPrevious",ignoreBorder:r=[0,0]}=t;this.checkProcessable("matchAndCrop",{bitDepth:[8,16]});let i="matchToPrevious"===e,n=this[0],s=[];s[0]={position:[0,0],image:this[0]};let o=[0,0];for(let f=1;f<this.length;f++){let t=n.getBestMatch(this[f],{border:r});s[f]={position:[t[0]+o[0],t[1]+o[1]],image:this[f]},i&&(o[0]+=t[0],o[1]+=t[1],n=this[f])}let a=0,l=0,h=0,u=0;for(let f=0;f<s.length;f++){let t=s[f];t.position[0]>a&&(a=t.position[0]),t.position[0]<l&&(l=t.position[0]),t.position[1]>h&&(h=t.position[1]),t.position[1]<u&&(u=t.position[1])}l=0-l,u=0-u;for(let f=0;f<s.length;f++){let t=s[f];t.crop=t.image.crop({x:a-t.position[0],y:h-t.position[1],width:n.width-l-a,height:n.height-u-h})}let c=[];for(let f=0;f<s.length;f++)c[f]=s[f].crop;return new Tp(c)}function kp(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].min;for(let e=1;e<this.length;e++)for(let r=0;r<t.length;r++)t[r]=Math.min(t[r],this[e].min[r]);return t}function _p(){this.checkProcessable("min",{bitDepth:[8,16]});let t=this[0].max;for(let e=1;e<this.length;e++)for(let r=0;r<t.length;r++)t[r]=Math.max(t[r],this[e].max[r]);return t}function Mp(t){let e=t.reduce(((t,e)=>t+e));if(0===e)throw new Error("unreachable");let r,i=0,n=0,s=e/2;while(1){if(t[i]>0){if(void 0!==r)return(r+i)/2;if(n+=t[i],n>s)return i;n===s&&(r=i)}i++}}function Ep(t){let e=0,r=0;for(let i=0;i<t.length;i++)e+=t[i],r+=t[i]*i;return 0===e?0:r/e}function Sp(){this.checkProcessable("median",{bitDepth:[8,16]});let t=this.getHistograms({maxSlots:this[0].maxValue+1}),e=new Array(t.length);for(let r=0;r<t.length;r++){let i=t[r];e[r]=Mp(i)}return e}function Ap(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistogram(t);for(let r=1;r<this.length;r++){let i=this[r].getHistogram(t);for(let t=0;t<e.length;t++)e[t]+=i[t]}return e}function Cp(t){this.checkProcessable("min",{bitDepth:[8,16]});let e=this[0].getHistograms(t),r=e[0].length;for(let i=1;i<this.length;i++){let n=this[i].getHistograms(t);for(let t=0;t<e.length;t++)for(let i=0;i<r;i++)e[t][i]+=n[t][i]}return e}function Lp(){this.checkProcessable("averageImage",{bitDepth:[8,16]});let t=new Uint32Array(this[0].data.length);for(let i=0;i<this.length;i++){let e=this[i];for(let r=0;r<this[0].data.length;r++)t[r]+=e.data[r]}let e=pv.createFrom(this[0]),r=e.data;for(let i=0;i<this[0].data.length;i++)r[i]=t[i]/this.length;return e}function Ip(){this.checkProcessable("max",{bitDepth:[8,16]});let t=pv.createFrom(this[0]);t.data.fill(0);for(const e of this)for(let r=0;r<t.data.length;r++)t.data[r]=Math.max(e.data[r],t.data[r]);return t}function Dp(){this.checkProcessable("max",{bitDepth:[8,16]});let t=pv.createFrom(this[0]);t.data.fill(t.maxValue);for(const e of this)for(let r=0;r<t.data.length;r++)t.data[r]=Math.min(e.data[r],t.data[r]);return t}function Rp(t){t.extendMethod("matchAndCrop",xp),t.extendMethod("getMin",kp),t.extendMethod("getMax",_p),t.extendMethod("getMedian",Sp),t.extendMethod("getHistogram",Ap),t.extendMethod("getHistograms",Cp),t.extendMethod("getAverage",Lp),t.extendMethod("getAverageImage",Lp),t.extendMethod("getMaxImage",Ip),t.extendMethod("getMinImage",Dp)}let Pp={configurable:!0,enumerable:!1,get:void 0};class Tp extends Array{constructor(t){if(Array.isArray(t)){super(t.length);for(let e=0;e<t.length;e++)this[e]=t[e]}else"number"===typeof t?super(t):super();this.computed=null}static load(t){return Promise.all(t.map(pv.load)).then((t=>new Tp(t)))}static extendMethod(t,e,r={}){let{inPlace:i=!1,returnThis:n=!0,partialArgs:s=[]}=r;return Tp.prototype[t]=i?function(...t){this.computed=null;let r=e.apply(this,[...s,...t]);return n?this:r}:function(...t){return e.apply(this,[...s,...t])},Tp}static extendProperty(t,e,r={}){let{partialArgs:i=[]}=r;return Pp.get=function(){if(null===this.computed)this.computed={};else if(Wf()(t,this.computed))return this.computed[t];let r=e.apply(this,i);return this.computed[t]=r,r},Object.defineProperty(Tp.prototype,t,Pp),Tp}checkProcessable(t,e={}){if("string"!==typeof t)throw new TypeError("checkProcessable requires as first parameter the processName (a string)");if(0===this.size)throw new TypeError(`The process: ${t} can not be applied on an empty stack`);this[0].checkProcessable(t,e);for(let r=1;r<this.length;r++){if((void 0===e.sameSize||e.sameSize)&&this[0].width!==this[r].width)throw new TypeError(`The process: ${t} can not be applied if width is not identical in all images`);if((void 0===e.sameSize||e.sameSize)&&this[0].height!==this[r].height)throw new TypeError(`The process: ${t} can not be applied if height is not identical in all images`);if((void 0===e.sameAlpha||e.sameAlpha)&&this[0].alpha!==this[r].alpha)throw new TypeError(`The process: ${t} can not be applied if alpha is not identical in all images`);if((void 0===e.sameBitDepth||e.sameBitDepth)&&this[0].bitDepth!==this[r].bitDepth)throw new TypeError(`The process: ${t} can not be applied if bitDepth is not identical in all images`);if((void 0===e.sameColorModel||e.sameColorModel)&&this[0].colorModel!==this[r].colorModel)throw new TypeError(`The process: ${t} can not be applied if colorModel is not identical in all images`);if((void 0===e.sameNumberChannels||e.sameNumberChannels)&&this[0].channels!==this[r].channels)throw new TypeError(`The process: ${t} can not be applied if channels is not identical in all images`)}}}Array[Symbol.species]||(Tp.prototype.map=function(t,e){if("function"!==typeof t)throw new TypeError(`${t} is not a function`);let r=new Tp(this.length);for(let i=0;i<this.length;i++)r[i]=t.call(e,this[i],i,this);return r}),Rp(Tp);const Fp=/^data:[a-z]+\/(?:[a-z]+);base64,/;function Bp(t,e){if("string"===typeof t)return Op(t,e);if(t instanceof ArrayBuffer)return Promise.resolve(Up(new Uint8Array(t),void 0,e&&e.ignorePalette));if(t.buffer)return Promise.resolve(Up(t,void 0,e&&e.ignorePalette));throw new Error('argument to "load" must be a string or buffer.')}function Up(t,e,r){const i=Ad()(t);if(i)switch(i.mime){case"image/png":return Np(t);case"image/jpeg":return jp(t);case"image/tiff":return Xp(t,r);default:return Yp(n(i.mime))}return Yp(n("application/octet-stream"));function n(r){return e||Bf(t,r)}}function Op(t,e){const r=t.slice(0,64).match(Fp);let i;return i=null!==r?Promise.resolve(Ff(t.slice(r[0].length))):zf(t,e),i.then((i=>{const n=new Uint8Array(i);return Up(n,r?t:void 0,e&&e.ignorePalette)}))}function Np(t){const e=Lf(t);let r,i=e.channels,n=0;return 2===i||4===i?(r=i-1,n=1):r=i,e.palette?zp(e):new pv(e.width,e.height,e.data,{components:r,alpha:n,bitDepth:e.depth})}function zp(t){const e=t.width*t.height,r=t.palette[0].length,i=new Uint8Array(e*r),n=8/t.depth,s=t.depth<8?n:1,o=parseInt("1".repeat(t.depth),2),a=4===r;let l=0;for(let h=0;h<e;h++){const e=Math.floor(h/s);let r=t.data[e];t.depth<8&&(r=r>>>t.depth*(n-1-h%n)&o);const u=t.palette[r];i[l++]=u[0],i[l++]=u[1],i[l++]=u[2],a&&(i[l++]=u[3])}return new pv(t.width,t.height,i,{components:3,alpha:a,bitDepth:8})}function jp(t){const e=(0,Ed.decode)(t);let r;e.exif&&(r=$p(e.exif));const i=(0,Df.decode)(t,{useTArray:!0,maxMemoryUsageInMB:1024});let n=new pv(i.width,i.height,i.data,{meta:r});if(r&&r.tiff.tags.Orientation){const t=r.tiff.tags.Orientation;t>2&&(n=n.rotate({3:180,4:180,5:90,6:90,7:270,8:270}[t])),[2,4,5,7].includes(t)&&(n=n.flipX())}return n}function Xp(t,e){let r=vp(t);return 1===r.length?Vp(r[0],e):new Tp(r.map((function(t){return Vp(t,e)})))}function $p(t){const e={tiff:{fields:t.fields,tags:t.map}};return t.exif&&(e.exif=t.exif),t.gps&&(e.gps=t.gps),e}function Vp(t,e){if(e||3!==t.type)return new pv(t.width,t.height,t.data,{components:2===t.type?3:1,alpha:t.alpha,colorModel:2===t.type?td:Jf,bitDepth:t.bitsPerSample.length?t.bitsPerSample[0]:t.bitsPerSample,meta:$p(t)});{const e=new Uint16Array(3*t.width*t.height),r=t.palette;let i=0;for(let n=0;n<t.data.length;n++){const s=t.data[n],o=r[s];e[i++]=o[0],e[i++]=o[1],e[i++]=o[2]}return new pv(t.width,t.height,e,{components:3,alpha:t.alpha,colorModel:td,bitDepth:16,meta:$p(t)})}}function Yp(t,e){return e=e||{},new Promise((function(r,i){let n=new Of;n.onload=function(){let t=n.width,i=n.height,s=Nf(t,i),o=s.getContext("2d");o.drawImage(n,0,0,t,i);let a=o.getImageData(0,0,t,i).data;r(new pv(t,i,a,e))},n.onerror=function(){i(new Error(`Could not load ${t}`))},n.src=t}))}const qp={getValueXY(t,e,r){return this.data[(e*this.width+t)*this.channels+r]},setValueXY(t,e,r,i){return this.data[(e*this.width+t)*this.channels+r]=i,this.computed=null,this},getValue(t,e){return this.data[t*this.channels+e]},setValue(t,e,r){return this.data[t*this.channels+e]=r,this.computed=null,this},getPixelXY(t,e){return this.getPixel(e*this.width+t)},setPixelXY(t,e,r){return this.setPixel(e*this.width+t,r)},getPixel(t){const e=new Array(this.channels),r=t*this.channels;for(let i=0;i<this.channels;i++)e[i]=this.data[r+i];return e},setPixel(t,e){const r=t*this.channels;for(let i=0;i<e.length;i++)this.data[r+i]=e[i];return this.computed=null,this}};function Gp(t){for(const e in qp)t.prototype[e]=qp[e]}function Hp(t){return{width:t.width,height:t.height,components:t.components,alpha:t.alpha,colorModel:t.colorModel,bitDepth:t.bitDepth}}function Wp(t,e,r,i={}){const{out:n}=e;if(void 0===n)return i.copy?t.clone():pv.createFrom(t,r);{if(!pv.isImage(n))throw new TypeError("out must be an Image object");const e=Object.assign(Hp(t),r);for(const t in e)if(n[t]!==e[t])throw new RangeError(`cannot use out. Its ${t} must be "${e[t]}" (found "${n[t]}")`);return n}}function Kp(t,e,r){if(void 0!==e.inPlace&&"boolean"!==typeof e.inPlace)throw new TypeError("inPlace option must be a boolean");if(e.inPlace){if(void 0!==e.out)throw new TypeError("out option must not be set if inPlace option is true");return t}return Wp(t,e,null,r)}function Qp(t={}){this.checkProcessable("abs",{bitDepth:[32]});const e=Kp(this,t);return Zp(this,e),e}function Zp(t,e){for(let r=0;r<t.data.length;r++)e.data[r]=Math.abs(t.data[r])}function Jp(t,e){if(1===t.alpha&&1===e.alpha)for(let r=0;r<t.size;r++)e.data[r*e.channels+e.components]=t.data[r*t.channels+t.components]}function tm(t={}){this.checkProcessable("invert",{bitDepth:[1,8,16]});const e=Kp(this,t);return 1===this.bitDepth?em(this,e):(rm(this,e),this!==e&&Jp(this,e)),e}function em(t,e){for(let r=0;r<t.data.length;r++)e.data[r]=~t.data[r]}function rm(t,e){for(let r=0;r<t.data.length;r+=t.channels)for(let i=0;i<t.components;i++)e.data[r+i]=t.maxValue-t.data[r+i]}function im(){this.checkProcessable("flipX",{bitDepth:[8,16]});for(let t=0;t<this.height;t++){let e=t*this.width*this.channels;for(let t=0;t<Math.floor(this.width/2);t++){let r=t*this.channels+e,i=(this.width-t-1)*this.channels+e;for(let t=0;t<this.channels;t++){let e=this.data[r+t];this.data[r+t]=this.data[i+t],this.data[i+t]=e}}}return this}function nm(){this.checkProcessable("flipY",{bitDepth:[8,16]});for(let t=0;t<Math.floor(this.height/2);t++)for(let e=0;e<this.width;e++){let r=e*this.channels+t*this.width*this.channels,i=e*this.channels+(this.height-1-t)*this.channels*this.width;for(let t=0;t<this.channels;t++){let e=this.data[r+t];this.data[r+t]=this.data[i+t],this.data[i+t]=e}}return this}function sm(t={}){const{radius:e=1}=t;if(e<1)throw new Error("radius must be greater than 1");const r=2*e+1,i=new Array(r);for(let n=0;n<r;n++){i[n]=new Array(r);for(let t=0;t<r;t++)i[n][t]=1/(r*r)}return this.convolution(i)}var om=r(41587),am=r.n(om);function lm(t,e={}){let{channels:r,allowAlpha:i,defaultAlpha:n}=e;return"boolean"!==typeof i&&(i=!0),"undefined"===typeof r?hm(t,n):um(t,r,i)}function hm(t,e){let r=e?t.channels:t.components,i=new Array(r);for(let n=0;n<r;n++)i[n]=n;return i}function um(t,e,r){Array.isArray(e)||(e=[e]);for(let i=0;i<e.length;i++)e[i]=cm(t,e[i],r);return e}function cm(t,e,r=!0){if(void 0===e)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if("string"===typeof e){switch(t.colorModel){case Jf:break;case td:if("rgb".includes(e))switch(e){case"r":e=0;break;case"g":e=1;break;case"b":e=2;break}break;case ed:if("hsl".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"l":e=2;break}break;case rd:if("hsv".includes(e))switch(e){case"h":e=0;break;case"s":e=1;break;case"v":e=2;break}break;case id:if("cmyk".includes(e))switch(e){case"c":e=0;break;case"m":e=1;break;case"y":e=2;break;case"k":e=3;break}break;default:throw new Error(`Unexpected color model: ${t.colorModel}`)}if("a"===e){if(!t.alpha)throw new Error("validateChannel : the image does not contain alpha channel");e=t.components}if("string"===typeof e)throw new Error(`validateChannel : undefined channel: ${e}`)}if(e>=t.channels)throw new RangeError(`validateChannel : the channel has to be >=0 and <${t.channels}`);if(!r&&e>=t.components)throw new RangeError("validateChannel : alpha channel may not be selected");return e}function fm(t={}){let{radius:e=1,border:r="copy",channels:i}=t;if(this.checkProcessable("medianFilter",{bitDepth:[8,16]}),e<1)throw new Error("radius must be greater than 0");i=lm(this,i,!0);let n=e,s=e,o=pv.createFrom(this),a=(2*n+1)*(2*s+1),l=new Array(a);for(let h=0;h<i.length;h++){let t=i[h];for(let e=s;e<this.height-s;e++)for(let r=n;r<this.width-n;r++){let i=0;for(let o=-s;o<=s;o++)for(let s=-n;s<=n;s++){let n=((e+o)*this.width+r+s)*this.channels+t;l[i++]=this.data[n]}let a=(e*this.width+r)*this.channels+t;o.data[a]=am()(l)}}if(this.alpha&&!i.includes(this.channels))for(let h=this.components;h<this.data.length;h+=this.channels)o.data[h]=this.data[h];return o.setBorder({size:[n,s],algorithm:r}),o}function dm(t={}){let{radius:e=1,sigma:r,channels:i,border:n="copy"}=t;this.checkProcessable("gaussian",{bitDepth:[8,16]});const s=pm(e,r);return this.convolution([s,s],{border:n,channels:i,algorithm:"separable"})}function pm(t,e){const r=2*t+1,i=new Array(r),n=e||.3*(.5*(r-1)-1)+.8,s=-.5/(n*n);let o=0;for(let a=0;a<r;a++){const e=a-t,r=Math.exp(s*e*e);i[a]=r,o+=r}for(let a=0;a<r;a++)i[a]/=o;return i}const mm=[[-1,0,1],[-2,0,2],[-1,0,1]],gm=[[-1,-2,-1],[0,0,0],[1,2,1]],wm=[[3,0,-3],[10,0,-10],[3,0,-3]],bm=[[3,10,3],[0,0,0],[-3,-10,-3]];var ym=r(99728),vm=r(32742),xm=r.n(vm);function km(t){let e,r;if(!Array.isArray(t))throw new Error(`validateKernel: Invalid Kernel: ${t}`);if(Array.isArray(t[0])){if(0===(1&t.length)||0===(1&t[0].length))throw new RangeError("validateKernel: Kernel rows and columns should be odd numbers");e=Math.floor(t.length/2),r=Math.floor(t[0].length/2)}else{let i=Math.sqrt(t.length);if(!xm()(i))throw new RangeError("validateKernel: Kernel array should be a square");r=e=Math.floor(Math.sqrt(t.length)/2);let n=new Array(i);for(let e=0;e<i;e++){n[e]=new Array(i);for(let r=0;r<i;r++)n[e][r]=t[e*i+r]}t=n}return{kernel:t,kWidth:r,kHeight:e}}function _m(t,e){return Math.round(Math.min(Math.max(t,0),e.maxValue))}function Mm(t,e,r){if(void 0===r){const i=t.length+e.length-1;r=new Array(i)}Em(r);for(var i=0;i<t.length;i++)for(var n=0;n<e.length;n++)r[i+n]+=t[i]*e[n];return r}function Em(t){for(var e=0;e<t.length;e++)t[e]=0}r(9304),r(48881);function Sm(t,e,r,i){const n=new Array(t.length);let s,o,a,l;l=e[1],a=(l.length-1)/2,o=new Array(r+l.length-1),s=new Array(r);for(let h=0;h<i;h++){for(let e=0;e<r;e++)s[e]=t[h*r+e];Mm(s,l,o);for(let t=0;t<r;t++)n[h*r+t]=o[a+t]}l=e[0],a=(l.length-1)/2,o=new Array(i+l.length-1),s=new Array(i);for(let h=0;h<r;h++){for(let t=0;t<i;t++)s[t]=n[t*r+h];Mm(s,l,o);for(let t=0;t<i;t++)n[t*r+h]=o[a+t]}return n}var Am=r(10673);Am.AbstractMatrix,Am.CHO,Am.CholeskyDecomposition,Am.DistanceMatrix,Am.EVD,Am.EigenvalueDecomposition,Am.LU,Am.LuDecomposition;const Cm=Am.Matrix,Lm=(Am.MatrixColumnSelectionView,Am.MatrixColumnView,Am.MatrixFlipColumnView,Am.MatrixFlipRowView,Am.MatrixRowSelectionView,Am.MatrixRowView,Am.MatrixSelectionView,Am.MatrixSubView,Am.MatrixTransposeView,Am.NIPALS,Am.Nipals,Am.QR,Am.QrDecomposition,Am.SVD),Im=Am.SingularValueDecomposition;Am.SymmetricMatrix,Am.WrapperMatrix1D,Am.WrapperMatrix2D,Am.correlation,Am.covariance;Am.Matrix,Am.Matrix;Am.determinant;const Dm=Am.inverse,Rm=(Am.linearDependencies,Am.pseudoInverse,Am.solve);Am.wrap;function Pm(t){const e=new Lm(t,{autoTranspose:!0});if(1!==e.rank)return null;const r=Math.sqrt(e.s[0]),i=e.U.to2DArray().map((t=>t[0]*r)),n=e.V.to2DArray().map((t=>t[0]*r));return[i,n]}function Tm(t,e={}){let{channels:r,bitDepth:i,normalize:n=!1,divisor:s=1,border:o="copy",algorithm:a="auto"}=e,l={};i&&(l.bitDepth=i);let h,u,c=pv.createFrom(this,l);if(r=lm(this,r,!0),"separable"!==a)({kernel:t}=km(t));else if(!Array.isArray(t)||2!==t.length)throw new RangeError("separable convolution requires two arrays of numbers to represent the kernel");if("auto"===a){let e=Pm(t);null!==e?(a="separable",t=e):a=(t.length>9||t[0].length>9)&&this.width<=4096&&this.height<=4096?"fft":"direct"}"separable"===a?(h=Math.floor(t[0].length/2),u=Math.floor(t[1].length/2)):(h=Math.floor(t.length/2),u=Math.floor(t[0].length/2));let f,d,p,m,g,w,b=c.isClamped,y=new Array(this.height*this.width);for(m=0;m<r.length;m++){for(g=r[m],p=0;p<this.height;p++)for(d=0;d<this.width;d++)f=p*this.width+d,y[f]=this.data[f*this.channels+g];if("direct"===a)w=(0,ym.direct)(y,t,{rows:this.height,cols:this.width,normalize:n,divisor:s});else if("separable"===a){if(w=Sm(y,t,this.width,this.height),n){s=0;for(let e=0;e<t[0].length;e++)for(let r=0;r<t[1].length;r++)s+=t[0][e]*t[1][r]}if(1!==s)for(let t=0;t<w.length;t++)w[t]/=s}else w=(0,ym.fft)(y,t,{rows:this.height,cols:this.width,normalize:n,divisor:s});for(p=0;p<this.height;p++)for(d=0;d<this.width;d++)f=p*this.width+d,c.data[f*this.channels+g]=b?_m(w[f],c):w[f]}if(this.alpha&&!r.includes(this.channels))for(d=this.components;d<this.data.length;d+=this.channels)c.data[d]=this.data[d];return"periodic"!==o&&c.setBorder({size:[u,h],algorithm:o}),c}function Fm(t={}){let{direction:e="xy",border:r="copy",kernelX:i,kernelY:n,channels:s,bitDepth:o=this.bitDepth}=t;switch(this.checkProcessable("gradientFilter",{bitDepth:[8,16]}),e){case"x":if(!i)throw new Error("kernelX option is missing");return Tm.call(this,i,{channels:s,border:r,bitDepth:o});case"y":if(!n)throw new Error("kernelY option is missing");return Tm.call(this,n,{channels:s,border:r,bitDepth:o});case"xy":{if(!i)throw new Error("kernelX option is missing");if(!n)throw new Error("kernelY option is missing");const t=Tm.call(this,i,{channels:s,border:r,bitDepth:32}),e=Tm.call(this,n,{channels:s,border:r,bitDepth:32});return t.hypotenuse(e,{bitDepth:o,channels:s})}default:throw new Error(`Unknown parameter direction: ${e}`)}}function Bm(t){return Fm.call(this,Object.assign({},t,{kernelX:mm,kernelY:gm}))}function Um(t){return Fm.call(this,Object.assign({},t,{kernelX:wm,kernelY:bm}))}var Om=r(42161),Nm=r.n(Om);function zm(t={}){let{algorithm:e="range",channels:r,min:i=this.min,max:n=this.max}=t;switch(this.checkProcessable("level",{bitDepth:[8,16,32]}),r=lm(this,{channels:r}),r.length!==this.channel&&(Array.isArray(i)&&i.length===this.channels&&(i=i.filter(((t,e)=>r.includes(e)))),Array.isArray(n)&&n.length===this.channels&&(n=n.filter(((t,e)=>r.includes(e))))),e){case"range":i<0&&(i=0),n>this.maxValue&&(n=this.maxValue),Array.isArray(i)||(i=Nm()(r.length,i)),Array.isArray(n)||(n=Nm()(r.length,n)),jm(this,i,n,r);break;default:throw new Error(`level: algorithm not implement: ${e}`)}return this}function jm(t,e,r,i){let n=1e-5,s=new Array(i.length);for(let o=0;o<i.length;o++)0===e[o]&&r[o]===t.maxValue||r[o]===e[o]?s[o]=0:s[o]=(t.maxValue+1-n)/(r[o]-e[o]),e[o]+=(.5-n/2)/s[o];for(let o=0;o<i.length;o++){let r=i[o];if(0!==s[o])for(let i=0;i<t.data.length;i+=t.channels)t.data[i+r]=Math.min(Math.max(0,(t.data[i+r]-e[o])*s[o]+.5|0),t.maxValue)}}var Xm=r(96623),$m=r.n(Xm);function Vm(t){if(isNaN(t)){if(t instanceof pv)return t.data;if(!$m()(t))throw new Error("checkNumberArray: the value should be either a number, array or Image");return t}if(t<=0)throw new Error("checkNumberArray: the value must be greater than 0");return t}function Ym(t,e={}){let{channels:r}=e;if(this.checkProcessable("add",{bitDepth:[8,16]}),r=lm(this,{channels:r}),t=Vm(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("add: the data size is different");for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]+t[e+i]|0))}}else for(let i=0;i<r.length;i++){let e=r[i];for(let r=0;r<this.data.length;r+=this.channels)this.data[r+e]=Math.min(this.maxValue,this.data[r+e]+t|0)}return this}function qm(t,e={}){let{channels:r}=e;if(this.checkProcessable("subtract",{bitDepth:[8,16]}),r=lm(this,{channels:r}),t=Vm(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("subtract: the data size is different");for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]-t[e+i]|0))}}else for(let i=0;i<r.length;i++){let e=r[i];for(let r=0;r<this.data.length;r+=this.channels)this.data[r+e]=Math.max(0,this.data[r+e]-t|0)}return this}function Gm(t,e={}){let{channels:r,absolute:i=!1}=e;if(this.checkProcessable("subtractImage",{bitDepth:[8,16]}),this.width!==t.width||this.height!==t.height)throw new Error("subtractImage: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("subtractImage: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("subtractImage: both images must have the same number of channels");let n=this.clone();r=lm(this,{channels:r});for(let s=0;s<r.length;s++){let e=r[s];for(let r=e;r<this.data.length;r+=this.channels){let e=this.data[r]-t.data[r];n.data[r]=i?Math.abs(e):Math.max(e,0)}}return n}function Hm(t,e={}){let{bitDepth:r=this.bitDepth,channels:i}=e;if(this.checkProcessable("hypotenuse",{bitDepth:[8,16,32]}),this.width!==t.width||this.height!==t.height)throw new Error("hypotenuse: both images must have the same size");if(this.alpha!==t.alpha||this.bitDepth!==t.bitDepth)throw new Error("hypotenuse: both images must have the same alpha and bitDepth");if(this.channels!==t.channels)throw new Error("hypotenuse: both images must have the same number of channels");let n=pv.createFrom(this,{bitDepth:r});i=lm(this,{channels:i});let s=n.isClamped;for(let o=0;o<i.length;o++){let e=i[o];for(let r=e;r<this.data.length;r+=this.channels){let e=Math.hypot(this.data[r],t.data[r]);n.data[r]=s?Math.min(Math.max(Math.round(e),0),n.maxValue):e}}return n}function Wm(t,e={}){let{channels:r}=e;if(this.checkProcessable("multiply",{bitDepth:[8,16]}),t<=0)throw new Error("multiply: the value must be greater than 0");if(r=lm(this,{channels:r}),t=Vm(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("multiply: the data size is different");for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]*t[e+i]|0))}}else for(let i=0;i<r.length;i++){let e=r[i];for(let r=0;r<this.data.length;r+=this.channels)this.data[r+e]=Math.min(this.maxValue,this.data[r+e]*t|0)}return this}function Km(t,e={}){let{channels:r}=e;if(this.checkProcessable("divide",{bitDepth:[8,16]}),r=lm(this,{channels:r}),t=Vm(t),isNaN(t)){if(this.data.length!==t.length)throw new Error("divide: the: the data size is different");for(let e=0;e<r.length;e++){let i=r[e];for(let e=0;e<this.data.length;e+=this.channels)this.data[e+i]=Math.max(0,Math.min(this.maxValue,this.data[e+i]/t[e+i]|0))}}else for(let i=0;i<r.length;i++){let e=r[i];for(let r=0;r<this.data.length;r+=this.channels)this.data[r+e]=Math.min(this.maxValue,this.data[r+e]/t|0)}return this}var Qm=r(70788);class Zm{constructor(){if(new.target===Zm)throw new Error("BaseRegression must be subclassed")}predict(t){if("number"===typeof t)return this._predict(t);if((0,Qm.isAnyArray)(t)){const e=[];for(let r=0;r<t.length;r++)e.push(this._predict(t[r]));return e}throw new TypeError("x must be a number or array")}_predict(){throw new Error("_predict must be implemented")}train(){}toString(){return""}toLaTeX(){return""}score(t,e){if(!(0,Qm.isAnyArray)(t)||!(0,Qm.isAnyArray)(e)||t.length!==e.length)throw new Error("x and y must be arrays of the same length");const r=t.length,i=new Array(r);for(let f=0;f<r;f++)i[f]=this._predict(t[f]);let n=0,s=0,o=0,a=0,l=0,h=0,u=0;for(let f=0;f<r;f++)n+=i[f],s+=e[f],l+=i[f]*i[f],h+=e[f]*e[f],u+=i[f]*e[f],0!==e[f]&&(o+=(e[f]-i[f])*(e[f]-i[f])/e[f]),a+=(e[f]-i[f])*(e[f]-i[f]);const c=(r*u-n*s)/Math.sqrt((r*l-n*n)*(r*h-s*s));return{r:c,r2:c*c,chi2:o,rmsd:Math.sqrt(a/r)}}}var Jm=r(25426),tg=r.n(Jm);const eg={lambda:.1,kernelType:"gaussian",kernelOptions:{},computeCoefficient:!1};class rg extends Zm{constructor(t,e,r){if(super(),!0===t)this.alpha=e.alpha,this.inputs=e.inputs,this.kernelType=e.kernelType,this.kernelOptions=e.kernelOptions,this.kernel=new(tg())(e.kernelType,e.kernelOptions);else{t=Cm.checkMatrix(t),r=Object.assign({},eg,r);const i=new(tg())(r.kernelType,r.kernelOptions),n=i.compute(t),s=t.rows;n.add(Cm.eye(s,s).mul(r.lambda)),this.alpha=Rm(n,e),this.inputs=t,this.kernelType=r.kernelType,this.kernelOptions=r.kernelOptions,this.kernel=i}}_predict(t){return this.kernel.compute([t],this.inputs).mmul(this.alpha).getRow(0)}toJSON(){return{name:"kernelRidgeRegression",alpha:this.alpha,inputs:this.inputs,kernelType:this.kernelType,kernelOptions:this.kernelOptions}}static load(t){if("kernelRidgeRegression"!==t.name)throw new TypeError("not a KRR model");return new rg(!0,t)}}function ig(t,e,r){const i=new rg(t,e,r),n=new Array(this.size);for(let a=0;a<this.width;a++)for(let t=0;t<this.height;t++)n[t*this.width+a]=[a,t];const s=i.predict(n),o=pv.createFrom(this);for(let a=0;a<this.size;a++)o.data[a]=Math.min(this.maxValue,Math.max(0,s[a][0]));return o}function ng(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("dilate",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("dilate: The number of rows and columns of the kernel must be odd");let i=!0;t:for(const s of e)for(const t of s)if(1!==t){i=!1;break t}let n=this;for(let s=0;s<r;s++)if(1===this.bitDepth)if(i){const t=n.clone();n=lg(n,t,e.length,e[0].length)}else{const t=pv.createFrom(n);n=ag(n,t,e)}else if(i){const t=pv.createFrom(n);n=og(n,t,e.length,e[0].length)}else{const t=pv.createFrom(n);n=sg(n,t,e)}return n}function sg(t,e,r){const i=r.length,n=r[0].length;let s=(i-1)/2,o=(n-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=0;for(let e=0;e<n;e++)for(let n=0;n<i;n++){if(1!==r[n][e])continue;let i=n-s+l,u=e-o+a;if(i<0||u<0||i>=t.width||u>=t.height)continue;const c=t.getValueXY(i,u,0);c>h&&(h=c)}e.setValueXY(l,a,0,h)}return e}function og(t,e,r,i){const n=(r-1)/2,s=(i-1)/2,o=[];for(let a=0;a<t.width;a++)o.push(0);for(let a=0;a<t.height;a++){for(let e=0;e<t.width;e++){let r=0;for(let i=Math.max(0,a-s);i<Math.min(t.height,a+s+1);i++){const n=t.getValueXY(e,i,0);n>r&&(r=n)}o[e]=r}for(let r=0;r<t.width;r++){let i=0;for(let e=Math.max(0,r-n);e<Math.min(t.width,r+n+1);e++)o[e]>i&&(i=o[e]);e.setValueXY(r,a,0,i)}}return e}function ag(t,e,r){const i=r.length,n=r[0].length;let s=(i-1)/2,o=(n-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=0;t:for(let e=0;e<n;e++)for(let n=0;n<i;n++){if(1!==r[n][e])continue;let i=n-s+l,u=e-o+a;if(u<0||i<0||i>=t.width||u>=t.height)continue;const c=t.getBitXY(i,u);if(1===c){h=1;break t}}1===h&&e.setBitXY(l,a)}return e}function lg(t,e,r,i){const n=(r-1)/2,s=(i-1)/2,o=[];for(let a=0;a<t.width;a++)o.push(1);for(let a=0;a<t.height;a++){for(let e=0;e<t.width;e++){o[e]=0;for(let r=Math.max(0,a-s);r<Math.min(t.height,a+s+1);r++)if(1===t.getBitXY(e,r)){o[e]=1;break}}for(let r=0;r<t.width;r++)if(1!==e.getBitXY(r,a))for(let i=Math.max(0,r-n);i<Math.min(t.width,r+n+1);i++)if(1===o[i]){e.setBitXY(r,a);break}}return e}function hg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("erode",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("erode: The number of rows and columns of the kernel must be odd");let i=!0;t:for(const s of e)for(const t of s)if(1!==t){i=!1;break t}let n=this;for(let s=0;s<r;s++)if(1===this.bitDepth)if(i){const t=n.clone();n=dg(n,t,e.length,e[0].length)}else{const t=pv.createFrom(n);n=fg(n,t,e)}else if(i){const t=pv.createFrom(n);n=cg(n,t,e.length,e[0].length)}else{const t=pv.createFrom(n);n=ug(n,t,e)}return n}function ug(t,e,r){const i=r.length,n=r[0].length;let s=(i-1)/2,o=(n-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=t.maxValue;for(let e=0;e<n;e++)for(let n=0;n<i;n++){if(1!==r[n][e])continue;let i=n-s+l,u=e-o+a;if(i<0||u<0||i>=t.width||u>=t.height)continue;const c=t.getValueXY(i,u,0);c<h&&(h=c)}e.setValueXY(l,a,0,h)}return e}function cg(t,e,r,i){const n=(r-1)/2,s=(i-1)/2,o=[];for(let a=0;a<t.width;a++)o.push(0);for(let a=0;a<t.height;a++){for(let e=0;e<t.width;e++){let r=t.maxValue;for(let i=Math.max(0,a-s);i<Math.min(t.height,a+s+1);i++){const n=t.getValueXY(e,i,0);n<r&&(r=n)}o[e]=r}for(let r=0;r<t.width;r++){let i=t.maxValue;for(let e=Math.max(0,r-n);e<Math.min(t.width,r+n+1);e++)o[e]<i&&(i=o[e]);e.setValueXY(r,a,0,i)}}return e}function fg(t,e,r){const i=r.length,n=r[0].length;let s=(i-1)/2,o=(n-1)/2;for(let a=0;a<t.height;a++)for(let l=0;l<t.width;l++){let h=1;t:for(let e=0;e<n;e++)for(let n=0;n<i;n++){if(1!==r[n][e])continue;let i=n-s+l,u=e-o+a;if(u<0||i<0||i>=t.width||u>=t.height)continue;const c=t.getBitXY(i,u);if(0===c){h=0;break t}}1===h&&e.setBitXY(l,a)}return e}function dg(t,e,r,i){const n=(r-1)/2,s=(i-1)/2,o=[];for(let a=0;a<t.width;a++)o.push(0);for(let a=0;a<t.height;a++){for(let e=0;e<t.width;e++){o[e]=1;for(let r=Math.max(0,a-s);r<Math.min(t.height,a+s+1);r++)if(0===t.getBitXY(e,r)){o[e]=0;break}}for(let r=0;r<t.width;r++)if(0!==e.getBitXY(r,a))for(let i=Math.max(0,r-n);i<Math.min(t.width,r+n+1);i++)if(0===o[i]){e.clearBitXY(r,a);break}}return e}function pg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("open",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("open: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++)i=i.erode({kernel:e}),i=i.dilate({kernel:e});return i}function mg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("close",{bitDepth:[1,8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("close: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++)i=i.dilate({kernel:e}).erode({kernel:e});return i}function gg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("topHat",{bitDepth:[8,16],components:1,alpha:0}),e.length%2===0||e[0].length%2===0)throw new TypeError("topHat: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++){let t=i.open({kernel:e});i=t.subtractImage(i,{absolute:!0})}return i}function wg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("blackHat",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("blackHat: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++){const t=i.close({kernel:e});i=t.subtractImage(i,{absolute:!0})}return i}function bg(t={}){let{kernel:e=[[1,1,1],[1,1,1],[1,1,1]],iterations:r=1}=t;if(this.checkProcessable("morphologicalGradient",{bitDepth:[8,16],components:1,alpha:0}),e.columns%2===0||e.rows%2===0)throw new TypeError("morphologicalGradient: The number of rows and columns of the kernel must be odd");let i=this;for(let n=0;n<r;n++){let t=i.dilate({kernel:e}),r=i.erode({kernel:e});i=t.subtractImage(r,{absolute:!0})}return i}function yg(t){let e=0,r=0,i=0,n=0,s=t[0][0],o=0;for(let h=1;h<t.length;h++)t[h][0]<s&&(s=t[h][0],o=h);let a=t[(o+1)%t.length][0],l=(o+1)%t.length;for(let h=1;h<t.length;h++)t[h][0]<a&&h!==o&&(a=t[h][0],l=h);return t[l][1]<t[o][1]?(e=t[l],n=t[o],o!==(l+1)%4?(r=t[(l+1)%4],i=t[(l+2)%4]):(r=t[(l+2)%4],i=t[(l+3)%4])):(n=t[l],e=t[o],l!==(o+1)%4?(r=t[(o+1)%4],i=t[(o+2)%4]):(r=t[(o+2)%4],i=t[(o+3)%4])),[e,r,i,n]}function vg(t,e){return Math.sqrt(Math.pow(t[0]-e[0],2)+Math.pow(t[1]-e[1],2))}function xg(t,e){let r=[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]];return r}function kg(t,e){let r=t[0]*e[0]+t[1]*e[1]+t[2]*e[2];return r}function _g(t,e,r,i,n,s){let o=Math.max(vg(t,e),vg(i,r)),a=Math.max(vg(t,i),vg(e,r)),l=0,h=0,u=Math.ceil(n/2),c=Math.ceil(s/2),f=o/a,d=[t[0],t[1],1],p=[e[0],e[1],1],m=[i[0],i[1],1],g=[r[0],r[1],1],w=kg(xg(d,g),m)/kg(xg(p,g),m),b=kg(xg(d,g),p)/kg(xg(m,g),p),y=[w*p[0]-d[0],w*p[1]-d[1],w*p[2]-d[2]],v=[b*m[0]-d[0],b*m[1]-d[1],b*m[2]-d[2]],x=y[0],k=y[1],_=y[2],M=v[0],E=v[1],S=v[2],A=1/(_*S)*(x*M-(x*S+_*M)*u+_*S*u*u+(k*E-(k*S+_*E)*c+_*S*c*c));A=A>=0?Math.sqrt(A):Math.sqrt(-A);let C=new Cm([[A,0,u],[0,A,c],[0,0,1]]),L=C.transpose(),I=Dm(L),D=Dm(C),R=Cm.rowVector(y),P=Cm.rowVector(v),T=Math.sqrt(kg(R.mmul(I).mmul(D).to1DArray(),y)/kg(P.mmul(I).mmul(D).to1DArray(),v));return 0===T||0===f?(l=Math.ceil(o),h=Math.ceil(a)):T<f?(l=Math.ceil(o),h=Math.ceil(l/T)):(h=Math.ceil(a),l=Math.ceil(T*h)),[l,h]}function Mg(t,e,r,i,n,s,o,a,l,h,u,c){let[f,d]=[(r*t+i*e+n)/(l*t+h*e+1),(s*t+o*e+a)/(l*t+h*e+1)];return u.getValueXY(Math.floor(f),Math.floor(d),c)}function Eg(t,e={}){let{calculateRatio:r=!0}=e;if(4!==t.length)throw new Error(`The array pts must have four elements, which are the four corners. Currently, pts have ${t.length} elements`);let i,n,[s,o,a,l]=t,h=[s,o,a,l],[u,c,f,d]=yg(h);r?[i,n]=_g(u,c,f,d,this.width,this.height):(i=Math.ceil(Math.max(vg(u,c),vg(d,f))),n=Math.ceil(Math.max(vg(u,d),vg(c,f))));let p=pv.createFrom(this,{width:i,height:n}),[m,g]=u,[w,b]=c,[y,v]=f,[x,k]=d,[_,M]=[0,0],[E,S]=[0,i-1],[A,C]=[n-1,i-1],[L,I]=[n-1,0],D=new Cm([[_,M,1,0,0,0,-_*m,-M*m],[E,S,1,0,0,0,-E*w,-S*w],[A,C,1,0,0,0,-A*y,-M*y],[L,I,1,0,0,0,-L*x,-I*x],[0,0,0,_,M,1,-_*g,-M*g],[0,0,0,E,S,1,-E*b,-S*b],[0,0,0,A,C,1,-A*v,-C*v],[0,0,0,L,I,1,-L*k,-I*k]]),R=Cm.columnVector([m,w,y,x,g,b,v,k]),P=new Im(D),T=P.solve(R),[F,B,U,O,N,z,j,X]=T.to1DArray(),$=new Cm(n,i);for(let V=0;V<this.channels;V++){for(let t=0;t<n;t++)for(let e=0;e<i;e++)$.set(t,e,Mg(t,e,F,B,U,O,N,z,j,X,this,V));p.setMatrix($,{channel:V})}return p}function Sg(t={}){let{x:e=0,y:r=0,width:i=this.width-e,height:n=this.height-r}=t;if(this.checkProcessable("crop",{bitDepth:[1,8,16]}),e=Math.round(e),r=Math.round(r),i=Math.round(i),n=Math.round(n),e>this.width-1||r>this.height-1)throw new RangeError(`crop: origin (x:${e}, y:${r}) out of range (${this.width-1}; ${this.height-1})`);if(i<=0||n<=0)throw new RangeError(`crop: width and height (width:${i}; height:${n}) must be positive numbers`);if(e<0||r<0)throw new RangeError(`crop: x and y (x:${e}, y:${r}) must be positive numbers`);if(i>this.width-e||n>this.height-r)throw new RangeError(`crop: (x: ${e}, y:${r}, width:${i}, height:${n}) size is out of range`);let s=this;if(1===this.bitDepth){const t=new pv(i,n,{kind:"BINARY",parent:this});s=Cg(this,t,e,r,i,n)}else{const t=pv.createFrom(this,{width:i,height:n,position:[e,r]});s=Ag(this,t,e,r,i,n)}return s}function Ag(t,e,r,i,n,s){let o=n*t.channels,a=i+s,l=0,h=r*t.channels;for(let u=i;u<a;u++){let r=u*t.width*t.channels+h,i=r+o;for(;r<i;r++)e.data[l++]=t.data[r]}return e}function Cg(t,e,r,i,n,s){let o=n*t.channels,a=i+s,l=0,h=r*t.channels;for(let u=i;u<a;u++){let r=u*t.width*t.channels+h,i=r+o;for(;r<i;r++)t.getBit(r)&&e.setBit(l),++l}return e}function Lg(t={}){this.checkProcessable("cropAlpha",{alpha:1});const{threshold:e=this.maxValue}=t;let r=Ig(this,e,this.components);if(-1===r)throw new Error("Could not find new dimensions. Threshold may be too high.");let i=Dg(this,e,this.components,r),n=Rg(this,e,this.components,r),s=Pg(this,e,this.components,r,i,n);return this.crop({x:r,y:i,width:s-r+1,height:n-i+1})}function Ig(t,e,r){for(let i=0;i<t.width;i++)for(let n=0;n<t.height;n++)if(t.getValueXY(i,n,r)>=e)return i;return-1}function Dg(t,e,r,i){for(let n=0;n<t.height;n++)for(let s=i;s<t.width;s++)if(t.getValueXY(s,n,r)>=e)return n;return-1}function Rg(t,e,r,i){for(let n=t.height-1;n>=0;n--)for(let s=i;s<t.width;s++)if(t.getValueXY(s,n,r)>=e)return n;return-1}function Pg(t,e,r,i,n,s){for(let o=t.width-1;o>=i;o--)for(let i=n;i<=s;i++)if(t.getValueXY(o,i,r)>=e)return o;return-1}function Tg(t){if("string"===typeof t){const e=t[t.length-1];t=parseFloat(t),"%"===e&&(t/=100)}return t}function Fg(t,e){if(!e)throw Error("getThreshold : the maxValue should be specified");if("string"===typeof t){let r=t[t.length-1];if("%"!==r)throw Error("getThreshold : if the value is a string it must finish by %");return parseFloat(t)/100*e}if("number"===typeof t)return t<1?t*e:t;throw Error("getThreshold : the value is not valid")}function Bg(t,e,r){t=Tg(t);let i=Math.round(t*e),n=Math.round(t*r);return i<=0&&(i=1),n<=0&&(n=1),{width:i,height:n}}function Ug(t,e){if(e<0||e>=t.height)throw new RangeError(`row must be included between 0 and ${t.height-1}. Current value: ${e}`)}function Og(t,e){if(e<0||e>=t.width)throw new RangeError(`column must be included between 0 and ${t.width-1}. Current value: ${e}`)}function Ng(t,e){if(e<0||e>=t.channels)throw new RangeError(`channel must be included between 0 and ${t.channels-1}. Current value: ${e}`)}const zg={nearestneighbor:"nearestNeighbor",nearestneighbour:"nearestNeighbor",bilinear:"bilinear"};function jg(t){if("string"!==typeof t)throw new TypeError("interpolation must be a string");if(t=t.toLowerCase(),!zg[t])throw new RangeError(`invalid interpolation algorithm: ${t}`);return zg[t]}function Xg(t,e,r){const i=this.width/e,n=this.height/r;if(this.bitDepth>1)for(let s=0;s<e;s++){const e=Math.floor((s+.5)*i);for(let i=0;i<r;i++){const r=Math.floor((i+.5)*n);for(let n=0;n<this.channels;n++)t.setValueXY(s,i,n,this.getValueXY(e,r,n))}}else for(let s=0;s<e;s++){const e=Math.floor((s+.5)*i);for(let i=0;i<r;i++){const r=Math.floor((i+.5)*n);this.getBitXY(e,r)&&t.setBitXY(s,i)}}}function $g(t={}){const{factor:e=1,interpolation:r=zg.nearestneighbor,preserveAspectRatio:i=!0}=t,n=jg(r);let s=t.width,o=t.height;if(s||(s=o&&i?Math.round(o*(this.width/this.height)):this.width),o||(o=i?Math.round(s*(this.height/this.width)):this.height),({width:s,height:o}=Bg(e,s,o)),s===this.width&&o===this.height){const t=this.clone();return t.position=[0,0],t}let a=Math.round((this.width-s)/2),l=Math.round((this.height-o)/2);const h=pv.createFrom(this,{width:s,height:o,position:[a,l]});switch(n){case zg.nearestneighbor:Xg.call(this,h,s,o);break;default:throw new Error(`unsupported resize interpolation: ${n}`)}return h}function Vg(){this.checkProcessable("hsv",{bitDepth:[8,16],alpha:[0,1],colorModel:[td]});let t=pv.createFrom(this,{colorModel:rd}),e=0,r=this.data;for(let i=0;i<r.length;i+=this.channels){let n=r[i],s=r[i+1],o=r[i+2],a=Math.min(n,s,o),l=Math.max(n,s,o),h=l-a,u=0,c=0===l?0:h/l,f=l;if(l!==a){switch(l){case n:u=(s-o)/h+(s<o?6:0);break;case s:u=(o-n)/h+2;break;case o:u=(n-s)/h+4;break;default:throw new Error("unreachable")}u/=6}t.data[e++]=u*this.maxValue,t.data[e++]=c*this.maxValue,t.data[e++]=f,this.alpha&&(t.data[e++]=r[i+3])}return t}function Yg(){this.checkProcessable("hsl",{bitDepth:[8,16],alpha:[0,1],colorModel:[td]});let t=pv.createFrom(this,{colorModel:ed}),e=Math.floor(this.maxValue/2),r=0,i=this.data;for(let n=0;n<i.length;n+=this.channels){let s=i[n],o=i[n+1],a=i[n+2],l=Math.max(s,o,a),h=Math.min(s,o,a),u=0,c=0,f=(l+h)/2;if(l!==h){let t=l-h;switch(c=f>e?t/(2-l-h):t/(l+h),l){case s:u=(o-a)/t+(o<a?6:0);break;case o:u=(a-s)/t+2;break;case a:u=(s-o)/t+4;break;default:throw new Error("unreachable")}u/=6}t.data[r++]=u*this.maxValue,t.data[r++]=c*this.maxValue,t.data[r++]=f,this.alpha&&(t.data[r++]=i[n+3])}return t}function qg(){this.checkProcessable("cmyk",{bitDepth:[8,16],alpha:[0,1],colorModel:[td]});let t=pv.createFrom(this,{components:4,colorModel:id}),e=0,r=this.data;for(let i=0;i<r.length;i+=this.channels){let n=r[i],s=r[i+1],o=r[i+2],a=Math.min(this.maxValue-n,this.maxValue-s,this.maxValue-o),l=(this.maxValue-n-a)/(1-a/this.maxValue),h=(this.maxValue-s-a)/(1-a/this.maxValue),u=(this.maxValue-o-a)/(1-a/this.maxValue);t.data[e++]=Math.round(l),t.data[e++]=Math.round(h),t.data[e++]=Math.round(u),t.data[e++]=Math.round(a),this.alpha&&(t.data[e++]=r[i+3])}return t}function Gg(){return new pv(this.width,this.height,this.getRGBAData(),{kind:"RGBA",parent:this})}const Hg={luma709(t,e,r){return 6966*t+23436*e+2366*r>>15},luma601(t,e,r){return 9798*t+19235*e+3735*r>>15},maximum(t,e,r){return Math.max(t,e,r)},minimum(t,e,r){return Math.min(t,e,r)},average(t,e,r){return(t+e+r)/3|0},minmax(t,e,r){return(Math.max(t,e,r)+Math.min(t,e,r))/2},red(t){return t},green(t,e){return e},blue(t,e,r){return r},cyan(t,e,r,i){let n=Hg.black(t,e,r,i);return(i.maxValue-t-n)/(1-n/i.maxValue)|0},magenta(t,e,r,i){let n=Hg.black(t,e,r,i);return(i.maxValue-e-n)/(1-n/i.maxValue)|0},yellow(t,e,r,i){let n=Hg.black(t,e,r,i);return(i.maxValue-r-n)/(1-n/i.maxValue)|0},black(t,e,r,i){return Math.min(i.maxValue-t,i.maxValue-e,i.maxValue-r)},hue(t,e,r,i){let n=Hg.min(t,e,r),s=Hg.max(t,e,r);if(s===n)return 0;let o=0,a=s-n;switch(s){case t:o=(e-r)/a+(e<r?6:0);break;case e:o=(r-t)/a+2;break;case r:o=(t-e)/a+4;break;default:throw new Error("unreachable")}return o/6*i.maxValue|0},saturation(t,e,r,i){let n=Hg.min(t,e,r),s=Hg.max(t,e,r),o=s-n;return 0===s?0:o/s*i.maxValue},lightness(t,e,r){let i=Hg.min(t,e,r),n=Hg.max(t,e,r);return(n+i)/2}};Object.defineProperty(Hg,"luminosity",{enumerable:!1,value:Hg.lightness}),Object.defineProperty(Hg,"luminance",{enumerable:!1,value:Hg.lightness}),Object.defineProperty(Hg,"min",{enumerable:!1,value:Hg.minimum}),Object.defineProperty(Hg,"max",{enumerable:!1,value:Hg.maximum}),Object.defineProperty(Hg,"brightness",{enumerable:!1,value:Hg.maximum});const Wg={};function Kg(t={}){let{algorithm:e="luma709",keepAlpha:r=!1,mergeAlpha:i=!0}=t;if("string"!==typeof e&&"function"!==typeof e)throw new TypeError("algorithm must be a string or a function");this.checkProcessable("grey",{bitDepth:[8,16],alpha:[0,1]}),1===this.components&&(e="red"),r&=this.alpha,i&=this.alpha,r&&(i=!1);let n,s=Wp(this,t,{components:1,alpha:r,colorModel:Jf});if("function"===typeof e)n=e;else if(n=Hg[e.toLowerCase()],!n)throw new Error(`unsupported grey algorithm: ${e}`);let o=0;for(let a=0;a<this.data.length;a+=this.channels)i?s.data[o++]=_m(n(this.data[a],this.data[a+1],this.data[a+2],this)*this.data[a+this.components]/this.maxValue,this):(s.data[o++]=_m(n(this.data[a],this.data[a+1],this.data[a+2],this),this),s.alpha&&(s.data[o++]=this.data[a+this.components]));return s}function Qg(t){let e=0;for(let u=0;u<t.length;u++)if(0!==t[u]){e=u;break}let r=t.length-1;for(let u=t.length-1;u>=e;u--)if(0!==t[u]){r=u;break}let i=1/(r-e),n=new Array(t.length),s=0,o=0;for(let u=e;u<t.length;u++)s+=u*t[u],o+=t[u],n[u]=s/o;let a=new Array(t.length);s=o=0;for(let u=r;u>0;u--)s+=u*t[u],o+=t[u],a[u-1]=s/o;let l=-1,h=Number.MAX_VALUE;for(let u=0;u<t.length;u++){let e,r=0;for(let s=0;s<=u;s++)e=1/(1+i*Math.abs(s-n[u])),e<1e-6||e>.999999||(r+=t[s]*(-e*Math.log(e)-(1-e)*Math.log(1-e)));for(let n=u+1;n<t.length;n++)e=1/(1+i*Math.abs(n-a[u])),e<1e-6||e>.999999||(r+=t[n]*(-e*Math.log(e)-(1-e)*Math.log(1-e)));r<h&&(h=r,l=u)}return l}function Zg(t){let e=t.slice(),r=0;while(!Jg(e)){let i=0,n=0,s=e[0];for(let r=0;r<t.length-1;r++)i=n,n=s,s=e[r+1],e[r]=(i+n+s)/3;if(e[t.length-1]=(n+s)/3,r++,r>1e4)throw new Error("Intermodes Threshold not found after 10000 iterations")}let i=0;for(let n=1;n<t.length-1;n++)e[n-1]<e[n]&&e[n+1]<e[n]&&(i+=n);return Math.floor(i/2)}function Jg(t){let e=!1,r=0;for(let i=1;i<t.length-1;i++)if(t[i-1]<t[i]&&t[i+1]<t[i]&&(r++,r>2))return!1;return 2===r&&(e=!0),e}function tw(t){let e,r,i,n,s=0;for(let o=1;o<t.length;o++)if(t[o]>0){s=o+1;break}while(1){e=0,i=0;for(let r=0;r<s;r++)i+=t[r],e+=t[r]*r;n=0,r=0;for(let e=s+1;e<t.length;e++)r+=t[e],n+=t[e]*e;if(i>0&&r>0&&(e/=i,n/=r,s===Math.round((e+n)/2)))break;if(s++,s>t.length-2)throw new Error("Threshold not found")}return s}function ew(t,e){let r,i,n,s,o,a,l,h,u,c,f,d;f=.5,c=0;for(let p=0;p<t.length;p++)c+=p*t[p];c/=e,l=c;do{a=l,r=a+.5|0,i=0,s=0;for(let e=0;e<=r;e++)i+=e*t[e],s+=t[e];h=0===s?0:i/s,n=0,o=0;for(let e=r+1;e<t.length;e++)n+=e*t[e],o+=t[e];u=0===o?0:n/o,d=(h-u)/(Math.log(h)-Math.log(u)),l=d<-Number.EPSILON?d-.5|0:d+.5|0}while(Math.abs(l-a)>f);return r}function rw(t,e){let r=new Array(t.length);for(let f=0;f<t.length;f++)r[f]=t[f]/e;let i=new Array(t.length),n=new Array(t.length);i[0]=r[0],n[0]=1-i[0];for(let f=1;f<t.length;f++)i[f]=i[f-1]+r[f],n[f]=1-i[f];let s=0;for(let f=0;f<t.length;f++)if(Math.abs(i[f])>=Number.EPSILON){s=f;break}let o=t.length-1;for(let f=t.length-1;f>=s;f--)if(Math.abs(n[f])>=Number.EPSILON){o=f;break}let a,l,h,u=-1,c=Number.MIN_VALUE;for(let f=s;f<=o;f++){l=0;for(let e=0;e<=f;e++)0!==t[e]&&(l-=r[e]/i[f]*Math.log(r[e]/i[f]));h=0;for(let e=f+1;e<t.length;e++)0!==t[e]&&(h-=r[e]/n[f]*Math.log(r[e]/n[f]));a=l+h,c<a&&(c=a,u=f)}return u}function iw(t,e){let r=0;for(let i=0;i<t.length;i++)r+=i*t[i];return Math.floor(r/e)}function nw(t,e){let r,i,n,s,o,a,l,h,u,c,f,d,p=-2,m=0;for(let g=0;g<t.length;g++)m+=g*t[g];m/=e,r=m;while(r!==p){let e=sw(t,r),m=sw(t,t.length-1),g=ow(t,r),w=ow(t,t.length-1),b=aw(t,r),y=aw(t,t.length-1);if(i=g/e,n=(w-g)/(m-e),s=e/m,o=(m-e)/m,a=b/e-i*i,l=(y-b)/(m-e)-n*n,h=1/a-1/l,u=i/a-n/l,c=i*i/a-n*n/l+Math.log10(a*(o*o)/(l*(s*s))),f=u*u-h*c,f<0)return r;p=r,d=(u+Math.sqrt(f))/h,r=isNaN(d)?p:Math.floor(d)}return r}function sw(t,e){let r=0;for(let i=0;i<=e;i++)r+=t[i];return r}function ow(t,e){let r=0;for(let i=0;i<=e;i++)r+=i*t[i];return r}function aw(t,e){let r=0;for(let i=0;i<=e;i++)r+=i*i*t[i];return r}function lw(t){if(t.length<2)return 0;let e=0,r=-1,i=-1,n=new Array(t.length);for(let s=0;s<t.length;s++)n[s]=t[s],t[s]>0&&(i=s);while(!cw(n))if(n=hw(n),e++,e>1e4)return r;return r=uw(n,i),r}function hw(t){let e=new Array(t.length);for(let r=1;r<t.length-1;r++)e[r]=(t[r-1]+t[r]+t[r+1])/3;return e[0]=(t[0]+t[1])/3,e[t.length-1]=(t[t.length-2]+t[t.length-1])/3,e}function uw(t,e){let r;for(let i=1;i<e;i++)if(t[i-1]>t[i]&&t[i+1]>=t[i]){r=i;break}return r}function cw(t){let e=t.length,r=!1,i=0;for(let n=1;n<e-1;n++)if(t[n-1]<t[n]&&t[n+1]<t[n]&&(i++,i>2))return!1;return 2===i&&(r=!0),r}function fw(t,e){let r,i,n,s,o,a,l=1,h=0,u=0,c=0,f=0,d=-1,p=t.length,m=new Array(p);for(let g=0;g<p;g++)m[g]=t[g]/e;for(let g=0;g<p;g++)h+=g*m[g],u+=g*g*m[g],c+=g*g*g*m[g];i=l*u-h*h,n=(-u*u+h*c)/i,s=(l*-c+u*h)/i,o=.5*(-s-Math.sqrt(s*s-4*n)),a=.5*(-s+Math.sqrt(s*s-4*n)),r=(a-h)/(a-o);for(let g=0;g<p;g++)if(f+=m[g],f>r){d=g;break}return d}function dw(t,e){let r=0,i=0,n=0,s=0,o=0;for(let a=0;a<t.length;a++)o+=a*t[a];for(let a=0;a<t.length;a++){i+=t[a];const l=e-i;if(0===i||0===l)continue;r+=a*t[a];const h=(o-r)/l,u=i*l*(r/i-h)*(r/i-h);u>=n&&(s=a,n=u)}return s}function pw(t){let e=-1,r=.5,i=new Array(t.length),n=mw(t,t.length-1),s=1;for(let o=0;o<t.length;o++)i[o]=Math.abs(mw(t,o)/n-r),i[o]<s&&(s=i[o],e=o);return e}function mw(t,e){let r=0;for(let i=0;i<=e;i++)r+=t[i];return r}function gw(t,e){let r,i,n,s=new Array(t.length),o=new Array(t.length),a=new Array(t.length),l=0,h=0,u=0,c=0,f=0,d=0,p=.5,m=1/(1-p),g=2,w=1/(1-g);for(let x=0;x<t.length;x++)s[x]=t[x]/e;o[0]=s[0],a[0]=1-o[0];for(let x=1;x<t.length;x++)o[x]=o[x-1]+s[x],a[x]=1-o[x];i=0;for(let x=0;x<t.length;x++)if(Math.abs(o[x])>=Number.EPSILON){i=x;break}n=t.length-1;for(let x=t.length-1;x>=i;x--)if(Math.abs(a[x])>=Number.EPSILON){n=x;break}for(let x=i;x<=n;x++){let e=0,r=0,i=0;for(let a=0;a<=x;a++)0!==t[a]&&(e-=s[a]/o[x]*Math.log(s[a]/o[x])),r+=Math.sqrt(s[a]/o[x]),i+=s[a]*s[a]/(o[x]*o[x]);let n=0,p=0,g=0;for(let o=x+1;o<t.length;o++)0!==t[o]&&(n-=s[o]/a[x]*Math.log(s[o]/a[x])),p+=Math.sqrt(s[o]/a[x]),g+=s[o]*s[o]/(a[x]*a[x]);let b=e+n,y=m*(r*p>0?Math.log(r*p):0),v=w*(i*g>0?Math.log(i*g):0);b>c&&(c=b,l=x),y>f&&(f=y,h=x),v>d&&(d=v,u=x)}let b,y=[l,h,u];y.sort(((t,e)=>t-e)),b=Math.abs(y[0]-y[1])<=5?Math.abs(y[1]-y[2])<=5?[1,2,1]:[0,1,3]:Math.abs(y[1]-y[2])<=5?[3,1,0]:[1,2,1];let v=o[y[2]]-o[y[0]];return r=Math.round(y[0]*(o[y[0]]+.25*v*b[0])+.25*y[1]*v*b[1]+y[2]*(a[y[2]]+.25*v*b[2])),r}function ww(t,e){let r=new Array(t.length);for(let d=0;d<t.length;d++)r[d]=t[d]/e;let i=new Array(t.length),n=new Array(t.length);i[0]=r[0],n[0]=1-i[0];for(let d=1;d<t.length;d++)i[d]=i[d-1]+r[d],n[d]=1-i[d];let s=0;for(let d=0;d<t.length;d++)if(Math.abs(i[d])>=Number.EPSILON){s=d;break}let o=t.length-1;for(let d=t.length-1;d>=s;d--)if(Math.abs(n[d])>=Number.EPSILON){o=d;break}let a,l,h,u,c=-1,f=Number.MAX_VALUE;for(let d=s;d<=o;d++){h=0,a=.5/i[d];for(let t=1;t<=d;t++)h-=r[t]*Math.log(1-a*i[t-1]);h*=a,u=0,a=.5/n[d];for(let e=d+1;e<t.length;e++)u-=r[e]*Math.log(1-a*n[e]);u*=a,l=Math.abs(h-u),l<f&&(f=l,c=d)}return c}function bw(t){let e=0,r=0,i=0,n=0;for(let c=0;c<t.length;c++)if(t[c]>0){e=c;break}e>0&&e--;for(let c=t.length-1;c>0;c--)if(t[c]>0){n=c;break}n<t.length-1&&n++;for(let c=0;c<t.length;c++)t[c]>r&&(i=c,r=t[c]);let s,o,a,l=!1;if(i-e<n-i){l=!0;let r=0,s=t.length-1;while(r<s){let e=t[r];t[r]=t[s],t[s]=e,r++,s--}e=t.length-1-n,i=t.length-1-i}if(e===i)return e;s=t[i],o=e-i,a=Math.sqrt(s*s+o*o),s/=a,o/=a,a=s*e+o*t[e];let h=e,u=0;for(let c=e+1;c<=i;c++){let e=s*c+o*t[c]-a;e>u&&(h=c,u=e)}if(h--,l){let e=0,r=t.length-1;while(e<r){let i=t[e];t[e]=t[r],t[r]=i,e++,r--}return t.length-1-h}return h}function yw(t,e){let r=new Array(t.length);for(let h=0;h<t.length;h++)r[h]=t[h]/e;let i=new Array(t.length);i[0]=r[0];for(let h=1;h<t.length;h++)i[h]=i[h-1]+r[h];let n=new Array(t.length);n[0]=r[0]*r[0];for(let h=1;h<t.length;h++)n[h]=n[h-1]+r[h]*r[h];let s=new Array(t.length);s[t.length-1]=0;for(let h=t.length-2;h>=0;h--)s[h]=s[h+1]+r[h+1]*r[h+1];let o,a=-1,l=Number.MIN_VALUE;for(let h=0;h<t.length;h++)o=-1*(n[h]*s[h]>0?Math.log(n[h]*s[h]):0)+2*(i[h]*(1-i[h])>0?Math.log(i[h]*(1-i[h])):0),o>l&&(l=o,a=h);return a}Object.keys(Hg).forEach((t=>{Wg[t]=t}));const vw={huang:Qg,intermodes:Zg,isodata:tw,li:ew,maxentropy:rw,mean:iw,minerror:nw,minimum:lw,moments:fw,otsu:dw,percentile:pw,renyientropy:gw,shanbhag:ww,triangle:bw,yen:yw},xw={};function kw(t={}){let{algorithm:e=xw.otsu}=t;this.checkProcessable("getThreshold",{components:1,bitDepth:[8,16]});let r=vw[e.toLowerCase()];if(r){let t=this.getHistogram();return r(t,this.size)}throw new Error(`unknown thresholding algorithm: ${e}`)}Object.keys(vw).forEach((t=>{xw[t]=t}));const _w="threshold";function Mw(t={}){let{algorithm:e=_w,threshold:r=.5,useAlpha:i=!0,invert:n=!1}=t;this.checkProcessable("mask",{components:1,bitDepth:[8,16]}),r=e===_w?Fg(r,this.maxValue):kw.call(this,t);let s=new pv(this.width,this.height,{kind:"BINARY",parent:this}),o=0;if(this.alpha&&i)for(let a=0;a<this.data.length;a+=this.channels){let t=this.data[a]+(this.maxValue-this.data[a])*(this.maxValue-this.data[a+1])/this.maxValue;(n&&t<=r||!n&&t>=r)&&s.setBit(o),o++}else for(let a=0;a<this.data.length;a+=this.channels)(n&&this.data[a]<=r||!n&&this.data[a]>=r)&&s.setBit(o),o++;return s}function Ew(t,e,r,i){let n=t.width,s=t.height,o=e.width,a=t.channels;for(let l=0;l<n;l++)for(let h=0;h<s;h++)for(let s=0;s<a;s++){let u=(h*n+l)*a+s,c=((i+h)*o+r+l)*a+s;e.data[c]=t.data[u]}}function Sw(t={}){let{size:e=0,algorithm:r="copy",color:i}=t;if(this.checkProcessable("pad",{bitDepth:[8,16]}),"set"===r){if(i.length!==this.channels)throw new Error(`pad: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<i.length;t++)0===i[t]&&(i[t]=.001)}else i=Nm()(this.channels,null);Array.isArray(e)||(e=[e,e]);let n=this.width+2*e[0],s=this.height+2*e[1],o=this.channels,a=pv.createFrom(this,{width:n,height:s});Ew(this,a,e[0],e[1]);for(let l=e[0];l<n-e[0];l++)for(let t=0;t<o;t++){let r=i[t]||a.data[(e[1]*n+l)*o+t];for(let i=0;i<e[1];i++)a.data[(i*n+l)*o+t]=r;r=i[t]||a.data[((s-e[1]-1)*n+l)*o+t];for(let i=s-e[1];i<s;i++)a.data[(i*n+l)*o+t]=r}for(let l=0;l<s;l++)for(let t=0;t<o;t++){let r=i[t]||a.data[(l*n+e[0])*o+t];for(let i=0;i<e[0];i++)a.data[(l*n+i)*o+t]=r;r=i[t]||a.data[(l*n+n-e[0]-1)*o+t];for(let i=n-e[0];i<n;i++)a.data[(l*n+i)*o+t]=r}return a}function Aw(t=8){if(this.checkProcessable("colorDepth",{bitDepth:[1,8,16]}),![8,16].includes(t))throw Error("You need to specify the new colorDepth as 8 or 16");if(this.bitDepth===t)return this.clone();let e=pv.createFrom(this,{bitDepth:t});switch(t){case 8:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=255);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]>>8;break;case 16:if(1===this.bitDepth)for(let t=0;t<this.size;t++)this.getBit(t)&&(e.data[t]=65535);else for(let t=0;t<this.data.length;t++)e.data[t]=this.data[t]<<8|this.data[t];break;default:throw new Error("colorDepth conversion unexpected case")}return e}function Cw(t,e={}){const{interpolation:r=zg.nearestneighbor,width:i=this.width,height:n=this.height}=e;if("number"!==typeof t)throw new TypeError("degrees must be a number");const s=jg(r),o=t*Math.PI/180,a=Math.floor(Math.abs(i*Math.cos(o))+Math.abs(n*Math.sin(o))),l=Math.floor(Math.abs(n*Math.cos(o))+Math.abs(i*Math.sin(o))),h=Math.cos(-o),u=Math.sin(-o);let c=a/2,f=l/2;a%2===0?(c-=.5,l%2===0?f-=.5:f=Math.floor(f)):(c=Math.floor(c),l%2===0?f-=.5:f=Math.floor(f));const d=Math.floor(i/2-c),p=Math.floor(n/2-f);if(1===this.bitDepth){const t=new pv(a,l,{kind:"BINARY",parent:this});switch(s){case zg.nearestneighbor:return Iw(this,t,d,p,c,f,h,u);case zg.bilinear:return Rw(this,t,d,p,c,f,h,u);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}else{const t=pv.createFrom(this,{width:a,height:l});switch(s){case zg.nearestneighbor:return Lw(this,t,d,p,c,f,h,u);case zg.bilinear:return Dw(this,t,d,p,c,f,h,u);default:throw new Error(`unsupported rotate interpolation: ${s}`)}}}function Lw(t,e,r,i,n,s,o,a){for(let l=0;l<e.width;l+=1)for(let h=0;h<e.height;h+=1)for(let u=0;u<t.channels;u++){let c=Math.round((l-n)*o-(h-s)*a+n)+r,f=Math.round((h-s)*o+(l-n)*a+s)+i;c<0||c>=t.width||f<0||f>=t.height?1===t.alpha&&u===t.channels-1?e.setValueXY(l,h,u,0):e.setValueXY(l,h,u,t.maxValue):e.setValueXY(l,h,u,t.getValueXY(c,f,u))}return e}function Iw(t,e,r,i,n,s,o,a){for(let l=0;l<e.width;l+=1)for(let h=0;h<e.height;h+=1){let u=Math.round((l-n)*o-(h-s)*a+n)+r,c=Math.round((h-s)*o+(l-n)*a+s)+i;(u<0||u>=t.width||c<0||c>=t.height||t.getBitXY(u,c))&&e.setBitXY(l,h)}return e}function Dw(t,e,r,i,n,s,o,a){let l=t.width*t.channels;for(let h=0;h<e.height;h++)for(let u=0;u<e.width;u++){let c=(u-n)*o-(h-s)*a+n+r,f=(h-s)*o+(u-n)*a+s+i,d=0|c,p=0|f,m=c-d,g=f-p;for(let r=0;r<t.channels;r++)if(c<0||c>=t.width||f<0||f>=t.height)1===t.alpha&&r===t.channels-1?e.setValueXY(u,h,r,0):e.setValueXY(u,h,r,t.maxValue);else{let i=(p*t.width+d)*t.channels+r,n=t.data[i],s=t.data[i+t.channels],o=t.data[i+l],a=t.data[i+l+t.channels],c=n+m*(s-n)+g*(o-n)+m*g*(n-s-o+a)|0;e.setValueXY(u,h,r,c)}}return e}function Rw(t,e,r,i,n,s,o,a){let l=t.width;for(let h=0;h<e.height;h++)for(let u=0;u<e.width;u++){let c=(u-n)*o-(h-s)*a+n+r,f=(h-s)*o+(u-n)*a+s+i,d=0|c,p=0|f,m=c-d,g=f-p;if(c<0||c>=t.width||f<0||f>=t.height)e.setBitXY(u,h);else{let r=p*t.width+d,i=t.getBit(r),n=t.getBit(r+1),s=t.getBit(r+l),o=t.getBit(r+1+l),a=i|m&n-i|g&s-i|m&g&i-n-s+o;a>0&&e.setBitXY(u,h)}}return e}function Pw(t,e){if(this.checkProcessable("rotate",{bitDepth:[1,8,16]}),"number"!==typeof t)throw new TypeError("angle must be a number");switch(t<0&&(t=360*Math.ceil(-t/360)+t),t%360){case 0:return this.clone();case 90:return Fw.call(this);case 180:return Bw.call(this);case 270:return Tw.call(this);default:return Cw.call(this,t,e)}}function Tw(){if(1===this.bitDepth){const t=new pv(this.height,this.width,{kind:"BINARY",parent:this}),e=t.height-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)this.getBitXY(i,r)&&t.setBitXY(r,e-i);return t}{const t=pv.createFrom(this,{width:this.height,height:this.width}),e=t.height-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)for(let n=0;n<this.channels;n++)t.setValueXY(r,e-i,n,this.getValueXY(i,r,n));return t}}function Fw(){if(1===this.bitDepth){const t=new pv(this.height,this.width,{kind:"BINARY",parent:this}),e=t.width-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)this.getBitXY(i,r)&&t.setBitXY(e-r,i);return t}{const t=pv.createFrom(this,{width:this.height,height:this.width}),e=t.width-1;for(let r=0;r<this.height;r++)for(let i=0;i<this.width;i++)for(let n=0;n<this.channels;n++)t.setValueXY(e-r,i,n,this.getValueXY(i,r,n));return t}}function Bw(){if(1===this.bitDepth){const t=new pv(this.width,this.height,{kind:"BINARY",parent:this}),e=t.width-1,r=t.height-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)this.getBitXY(n,i)&&t.setBitXY(e-n,r-i);return t}{const t=pv.createFrom(this),e=t.width-1,r=t.height-1;for(let i=0;i<this.height;i++)for(let n=0;n<this.width;n++)for(let s=0;s<this.channels;s++)t.setValueXY(e-n,r-i,s,this.getValueXY(n,i,s));return t}}function Uw(t,e={}){const r=Hp(t);this.checkProcessable("insert",r);let{x:i=0,y:n=0}=e;const s=Kp(this,e,{copy:!0}),o=Math.min(s.height,n+t.height),a=Math.min(s.width,i+t.width);if(1===s.bitDepth)for(let l=n;l<o;l++)for(let e=i;e<a;e++){const r=t.getBitXY(e-i,l-n);r?s.setBitXY(e,l):s.clearBitXY(e,l)}else for(let l=n;l<o;l++)for(let e=i;e<a;e++)s.setPixelXY(e,l,t.getPixelXY(e-i,l-n));return s}function Ow(t={}){let{size:e=0,algorithm:r="copy",color:i}=t;if(this.checkProcessable("setBorder",{bitDepth:[8,16,32,64]}),"set"===r){if(i.length!==this.channels)throw new Error(`setBorder: the color array must have the same length as the number of channels. Here: ${this.channels}`);for(let t=0;t<i.length;t++)0===i[t]&&(i[t]=.001)}else i=Nm()(this.channels,null);Array.isArray(e)||(e=[e,e]);let n=e[0],s=e[1],o=this.channels;for(let a=n;a<this.width-n;a++)for(let t=0;t<o;t++){let e=i[t]||this.data[(a+this.width*s)*o+t];for(let r=0;r<s;r++)this.data[(r*this.width+a)*o+t]=e;e=i[t]||this.data[(a+this.width*(this.height-s-1))*o+t];for(let r=this.height-s;r<this.height;r++)this.data[(r*this.width+a)*o+t]=e}for(let a=0;a<this.height;a++)for(let t=0;t<o;t++){let e=i[t]||this.data[(a*this.width+n)*o+t];for(let r=0;r<n;r++)this.data[(a*this.width+r)*o+t]=e;e=i[t]||this.data[(a*this.width+this.width-n-1)*o+t];for(let r=this.width-n;r<this.width;r++)this.data[(a*this.width+r)*o+t]=e}return this}function Nw(t={}){let{preserveAlpha:e=!0}=t;if(this.checkProcessable("split",{bitDepth:[8,16]}),1===this.components)return new Tp([this.clone()]);let r=new Tp,i=this.data;if(this.alpha&&e)for(let n=0;n<this.components;n++){let t=pv.createFrom(this,{components:1,alpha:!0,colorModel:Jf}),e=0;for(let r=0;r<i.length;r+=this.channels)t.data[e++]=i[r+n],t.data[e++]=i[r+this.components];r.push(t)}else for(let n=0;n<this.channels;n++){let t=pv.createFrom(this,{components:1,alpha:!1,colorModel:Jf}),e=0;for(let r=0;r<i.length;r+=this.channels)t.data[e++]=i[r+n];r.push(t)}return r}function zw(t,e={}){let{keepAlpha:r=!1,mergeAlpha:i=!1}=e;r&=this.alpha,i&=this.alpha,this.checkProcessable("getChannel",{bitDepth:[8,16]}),t=cm(this,t);let n=pv.createFrom(this,{components:1,alpha:r,colorModel:Jf}),s=0;for(let o=0;o<this.data.length;o+=this.channels)i?n.data[s++]=this.data[o+t]*this.data[o+this.components]/this.maxValue:(n.data[s++]=this.data[o+t],r&&(n.data[s++]=this.data[o+this.components]));return n}function jw(t=Xw,e={}){let{mergeAlpha:r=!1,keepAlpha:i=!1}=e;r&=this.alpha,i&=this.alpha,this.checkProcessable("combineChannels",{bitDepth:[8,16]});let n=pv.createFrom(this,{components:1,alpha:i,colorModel:Jf}),s=0;for(let o=0;o<this.size;o++){let e=t(this.getPixel(o));r?n.data[s++]=e*this.data[o*this.channels+this.components]/this.maxValue:(n.data[s++]=e,i&&(n.data[s++]=this.data[o*this.channels+this.components]))}return n}function Xw(t){return(t[0]+t[1]+t[2])/3}function $w(t,e){if(this.checkProcessable("setChannel",{bitDepth:[8,16]}),e.checkProcessable("setChannel (image parameter check)",{bitDepth:[this.bitDepth],alpha:[0],components:[1]}),e.width!==this.width||e.height!==this.height)throw new Error("Images must have exactly the same width and height");t=cm(this,t);let r=t;for(let i=0;i<e.data.length;i++)this.data[r]=e.data[i],r+=this.channels;return this}function Vw(t,e={}){let{shift:r=[0,0],average:i,channels:n,defaultAlpha:s,normalize:o,border:a=[0,0]}=e;if(this.checkProcessable("getSimilarity",{bitDepth:[8,16]}),Array.isArray(a)||(a=[a,a]),n=lm(this,{channels:n,defaultAlpha:s}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");"undefined"===typeof i&&(i=!0);let l=Math.max(a[0],-r[0]),h=Math.min(this.width-a[0],this.width-r[0]),u=Math.max(a[1],-r[1]),c=Math.min(this.height-a[1],this.height-r[1]),f=Nm()(n.length,0);for(let d=0;d<n.length;d++){let e=n[d],i=o?this.sum[e]:Math.max(this.sum[e],t.sum[e]),s=o?t.sum[e]:Math.max(this.sum[e],t.sum[e]);if(0!==i&&0!==s)for(let n=l;n<h;n++)for(let o=u;o<c;o++){let a=n*this.multiplierX+o*this.multiplierY+e,l=a+r[0]*this.multiplierX+r[1]*this.multiplierY;f[d]+=Math.min(this.data[a]/i,t.data[l]/s)}}return i?f.reduce(((t,e)=>t+e))/f.length:f}function Yw(t={}){let{sampling:e=[10,10],painted:r=!1,mask:i}=t;this.checkProcessable("getPixelsGrid",{bitDepth:[8,16],channels:1}),Array.isArray(e)||(e=[e,e]);const n=e[0],s=e[1],o=[],a=[],l=this.width/n,h=this.height/s;let u=Math.floor(l/2);for(let f=0;f<n;f++){let t=Math.floor(h/2);for(let e=0;e<s;e++){let e=Math.round(u),r=Math.round(t);i&&!i.getBitXY(e,r)||(o.push([e,r]),a.push(this.getPixelXY(e,r))),t+=h}u+=l}const c={xyS:o,zS:a};return r&&(c.painted=this.rgba8().paintPoints(o)),c}function qw(t,e,r){const i=new Array(t);for(let n=0;n<t;n++)i[n]=new Array(e);if(r)for(let n=0;n<t;n++)for(let t=0;t<e;t++)i[n][t]=r;return i.width=t,i.height=e,Object.setPrototypeOf(i,qw.prototype),i}function Gw(t,e={}){let{border:r}=e;if(this.checkProcessable("getChannel",{bitDepth:[8,16]}),this.bitDepth!==t.bitDepth)throw new Error("Both images must have the same bitDepth");if(this.channels!==t.channels)throw new Error("Both images must have the same number of channels");if(this.colorModel!==t.colorModel)throw new Error("Both images must have the same colorModel");let i=new qw(t.width,t.height,-1/0),n=Math.floor(t.width/2),s=Math.floor(t.height/2),o=n,a=s,l=!1;while(!l){let e=i.localSearch(n,s,-1/0);for(let n=0;n<e.length;n++){let s=e[n],l=this.getSimilarity(t,{border:r,shift:[o-s[0],a-s[1]]});i[s[0]][s[1]]=l}let h=i.localMax(n,s);h.position[0]!==n||h.position[1]!==s?(n=h.position[0],s=h.position[1]):l=!0}return[n-o,s-a]}function Hw(t,e=0){this.checkProcessable("getRow",{bitDepth:[8,16]}),Ug(this,t),Ng(this,e);let r=new Array(this.width),i=0,n=t*this.width*this.channels+e,s=n+this.width*this.channels;for(let o=n;o<s;o+=this.channels)r[i++]=this.data[o];return r}function Ww(t,e=0){this.checkProcessable("getColumn",{bitDepth:[8,16]}),Og(this,t),Ng(this,e);let r=new Array(this.height),i=0,n=this.width*this.channels;for(let s=e+t*this.channels;s<this.data.length;s+=n)r[i++]=this.data[s];return r}function Kw(t={}){let{channel:e}=t;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===e){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");e=0}let r=new Cm(this.height,this.width);for(let i=0;i<this.height;i++)for(let t=0;t<this.width;t++)r.set(i,t,this.getValueXY(t,i,e));return r}function Qw(t,e={}){t=new Cm(t);let{channel:r}=e;if(this.checkProcessable("getMatrix",{bitDepth:[8,16]}),void 0===r){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");r=0}if(this.width!==t.columns||this.height!==t.rows)throw new RangeError("The size of the matrix must be equal to the size of the image");for(let i=0;i<this.height;i++)for(let e=0;e<this.width;e++)this.setValueXY(e,i,r,t.get(i,e));return this}function Zw(){this.checkProcessable("getPixelsArray",{bitDepth:[8,16,32]});let t=new Array(this.size),e=0;for(let r=0;r<this.data.length;r+=this.channels){let i=new Array(this.components);for(let t=0;t<this.components;t++)i[t]=this.data[r+t];t[e++]=i}return t}function Jw(t){let e=this,r=e.getClosestCommonParent(t),i=e.getRelativePosition(r,{defaultFurther:!0}),n=tb(e,i),s=t.getRelativePosition(r,{defaultFurther:!0}),o=tb(t,s),a=eb(n,o),l={whitePixelsMask1:[],whitePixelsMask2:[],commonWhitePixels:[]};for(let h=0;h<a.length;h++){let r=a[h],n=[r[0]-i[0],r[1]-i[1]],o=[r[0]-s[0],r[1]-s[1]],u=e.getBitXY(n[0],n[1]),c=t.getBitXY(o[0],o[1]);1===u&&1===c&&l.commonWhitePixels.push(r)}for(let h=0;h<n.length;h++){let t,r;0!==h&&(t=Math.floor(h/e.width),r=h%e.width),1===e.getBitXY(t,r)&&l.whitePixelsMask1.push(n[h])}for(let h=0;h<o.length;h++){let e=0,r=0;0!==h&&(e=Math.floor(h/t.width),r=h%t.width),1===t.getBitXY(e,r)&&l.whitePixelsMask2.push(o[h])}return l}function tb(t,e){let r=[];for(let i=0;i<t.height;i++)for(let n=0;n<t.width;n++){let t=[i,n];r.push([t[0]+e[0],t[1]+e[1]])}return r}function eb(t,e){let r=0,i=0,n=[];while(r<t.length&&i<e.length)t[r][0]===e[i][0]&&t[r][1]===e[i][1]?(n.push(t[r]),r++,i++):t[r][0]<e[i][0]||t[r][0]===e[i][0]&&t[r][1]<e[i][1]?r++:i++;return n}function rb(t){let e,r=ib(this),i=ib(t);if(e=r>=i?nb(this,r):nb(t,i),0===r||0===i)return e;let n=this,s=t;while(r!==i)if(r>i){if(n=n.parent,null===n)return e;r-=1}else{if(s=s.parent,null===s)return e;i-=1}while(n!==s&&null!==n&&null!==s)if(n=n.parent,s=s.parent,null===n||null===s)return e;return n!==s?e:n}function ib(t){let e=0,r=t;while(null!=r.parent)r=r.parent,e++;return e}function nb(t,e){let r=t;while(e>0)r=r.parent,e-=1;return r}qw.prototype.localMin=function(t,e){let r=this[t][e],i=[t,e];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]<r&&(r=this[n][t],i=[n,t]);return{position:i,value:r}},qw.prototype.localMax=function(t,e){let r=this[t][e],i=[t,e];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]>r&&(r=this[n][t],i=[n,t]);return{position:i,value:r}},qw.prototype.localSearch=function(t,e,r){let i=[];for(let n=Math.max(0,t-1);n<Math.min(this.length,t+2);n++)for(let t=Math.max(0,e-1);t<Math.min(this[0].length,e+2);t++)this[n][t]===r&&i.push([n,t]);return i};const sb={lowThreshold:10,highThreshold:30,gaussianBlur:1.1},ob=[[-1,0,1],[-2,0,2],[-1,0,1]],ab=[[-1,-2,-1],[0,0,0],[1,2,1]],lb={bitDepth:32,mode:"periodic"};function hb(t,e){t.checkProcessable("Canny edge detector",{bitDepth:8,channels:1,components:1}),e=Object.assign({},sb,e);const r=t.width,i=t.height,n=t.maxValue,s={sigma:e.gaussianBlur,radius:3},o=t.gaussianFilter(s),a=o.convolution(ab,lb),l=o.convolution(ob,lb),h=l.hypotenuse(a),u=t.constructor,c=new u(r,i,{kind:"GREY",bitDepth:32}),f=new u(r,i,{kind:"GREY",bitDepth:32}),d=new u(r,i,{kind:"GREY"});for(var p=1;p<r-1;p++)for(var m=1;m<i-1;m++){var g=(Math.round(Math.atan2(l.getValueXY(p,m,0),a.getValueXY(p,m,0))*(5/Math.PI))+5)%5;0===g&&(h.getValueXY(p,m,0)<=h.getValueXY(p,m-1,0)||h.getValueXY(p,m,0)<=h.getValueXY(p,m+1,0))||1===g&&(h.getValueXY(p,m,0)<=h.getValueXY(p-1,m+1,0)||h.getValueXY(p,m,0)<=h.getValueXY(p+1,m-1,0))||2===g&&(h.getValueXY(p,m,0)<=h.getValueXY(p-1,m,0)||h.getValueXY(p,m,0)<=h.getValueXY(p+1,m,0))||3===g&&(h.getValueXY(p,m,0)<=h.getValueXY(p-1,m-1,0)||h.getValueXY(p,m,0)<=h.getValueXY(p+1,m+1,0))||c.setValueXY(p,m,0,h.getValueXY(p,m,0))}for(p=0;p<r*i;++p){var w=c.data[p],b=0;w>e.highThreshold&&(b++,d.data[p]=n),w>e.lowThreshold&&b++,f.data[p]=b}var y=[];for(p=1;p<r-1;++p)for(m=1;m<i-1;++m)if(1===f.getValueXY(p,m,0))t:for(var v=p-1;v<p+2;++v)for(var x=m-1;x<m+2;++x)if(2===f.getValueXY(v,x,0)){y.push([p,m]),d.setValueXY(p,m,0,n);break t}while(y.length>0){var k=[];for(p=0;p<y.length;++p)for(m=-1;m<2;++m)for(v=-1;v<2;++v)if(0!==m||0!==v){var _=y[p][0]+m,M=y[p][1]+v;1===f.getValueXY(_,M,0)&&0===d.getValueXY(_,M,0)&&(k.push([_,M]),d.setValueXY(_,M,0,n))}y=k}return d}function ub(t){return hb(this,t)}function cb(t,e={}){let{position:r}=e;if(this.checkProcessable("extract",{bitDepth:[1,8,16]}),!r&&(r=t.getRelativePosition(this),!r))throw new Error("extract : can not extract an image because the relative position can not be determined, try to specify manually the position as an array of 2 elements [x,y].");if(this.bitDepth>1){let e=pv.createFrom(this,{width:t.width,height:t.height,alpha:1,position:r,parent:this});for(let i=0;i<t.width;i++)for(let n=0;n<t.height;n++){for(let t=0;t<this.channels;t++){let s=this.getValueXY(i+r[0],n+r[1],t);e.setValueXY(i,n,t,s)}t.getBitXY(i,n)||e.setValueXY(i,n,this.components,0)}return e}{let e=pv.createFrom(this,{width:t.width,height:t.height,position:r,parent:this});for(let i=0;i<t.height;i++)for(let n=0;n<t.width;n++)t.getBitXY(n,i)&&this.getBitXY(n+r[0],i+r[1])&&e.setBitXY(n,i);return e}}var fb=r(55531),db=r.n(fb);function pb(t={}){const{x:e=0,y:r=0,inPlace:i=!0}=t,n=i?this:pv.createFrom(this);this.checkProcessable("floodFill",{bitDepth:1});const s=this.getBitXY(e,r);if(s)return n;const o=new(db());o.push(new mb(e,r));while(o.length>0){const t=o.shift();n.setBitXY(t.x,t.y);for(let e=t.x+1;e<this.width;e++){if(n.getBitXY(e,t.y)||this.getBitXY(e,t.y))break;n.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&o.push(new mb(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&o.push(new mb(e,t.y-1))}for(let e=t.x-1;e>=0;e++){if(n.getBitXY(e,t.y)||this.getBitXY(e,t.y))break;n.setBitXY(e,t.y),t.y+1<this.height&&!this.getBitXY(e,t.y+1)&&o.push(new mb(e,t.y+1)),t.y-1>=0&&!this.getBitXY(e,t.y-1)&&o.push(new mb(e,t.y-1))}}return n}function mb(t,e){this.x=t,this.y=e}function gb(){return gb=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var i in r)({}).hasOwnProperty.call(r,i)&&(t[i]=r[i])}return t},gb.apply(null,arguments)}function wb(t,e,r){e/=100,r/=100;var i=[],n=r*e,s=t/60,o=n*(1-Math.abs(s%2-1)),a=r-n;return i=s>=0&&s<1?[n,o,0]:s>=1&&s<2?[o,n,0]:s>=2&&s<3?[0,n,o]:t>=3&&s<4?[0,o,n]:t>=4&&s<5?[o,0,n]:t>=5&&s<=6?[n,0,o]:[0,0,0],{r:Math.round(255*(i[0]+a)),g:Math.round(255*(i[1]+a)),b:Math.round(255*(i[2]+a))}}function bb(t,e,r){return e*=(r<50?r:100-r)/100,{h:t,s:2*e/(r+e)*100,v:r+e}}function yb(t,e,r){var i=bb(t,e,r);return wb(i.h,i.s,i.v)}var vb={aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,132,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,255,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderblue:[176,224,230],purple:[128,0,128],rebeccapurple:[102,51,153],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[119,128,144],slategrey:[119,128,144],snow:[255,255,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,5]};function xb(t){return kb(t)||Sb(t)||Eb(t)||_b(t)||Mb(t)||Ab(t)||Cb(t)}function kb(t){var e=vb[t.toLowerCase()];if(e)return{r:e[0],g:e[1],b:e[2],a:100}}function _b(t){var e=t.match(/rgb\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */).map(Number);return{r:r[0],g:r[1],b:r[2],a:100}}}function Mb(t){var e=t.match(/rgba\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */).map(Number);return{r:r[0],g:r[1],b:r[2],a:100*r[3]}}}function Eb(t){if("#"===t[0]&&7===t.length)return{r:parseInt(t.slice(1,3),16),g:parseInt(t.slice(3,5),16),b:parseInt(t.slice(5,7),16),a:100}}function Sb(t){if("#"===t[0]&&4===t.length)return{r:parseInt(t[1]+t[1],16),g:parseInt(t[2]+t[2],16),b:parseInt(t[3]+t[3],16),a:100}}function Ab(t){var e=t.match(/hsl\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */),i=parseInt(r[0],10),n=parseInt(r[1],10),s=parseInt(r[2],10),o=yb(i,n,s);return gb({},o,{a:100})}}function Cb(t){var e=t.match(/hsla\(([^)]+)\)/);if(e){var r=e[1].split(/ *, */),i=parseInt(r[0],10),n=parseInt(r[1],10),s=parseInt(r[2],10),o=parseInt(100*parseFloat(r[3]),10),a=yb(i,n,s);return gb({},a,{a:o})}}function Lb(t){let e=xb(t);return[e.r,e.g,e.b,Math.round(255*e.a/100)]}function Ib(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+6*(e-t)*r:r<.5?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Db(t,e,r){let i,n,s,o,a,l;return e/=100,r/=100,0===e?o=a=l=255*r:(n=r<=.5?r*(e+1):r+e-r*e,i=2*r-n,s=t/360,o=Ib(i,n,s+1/3),a=Ib(i,n,s),l=Ib(i,n,s-1/3)),{r:o,g:a,b:l}}function Rb(t){let e=new Array(t),r=0;for(let i=0;i<360;i+=360/t){r++;let t=Db(i,100,30+r%4*15);e[r-1]=[Math.round(255*t.r),Math.round(255*t.g),Math.round(255*t.b)]}return e}function Pb(){return[Math.floor(256*Math.random()),Math.floor(256*Math.random()),Math.floor(256*Math.random())]}function Tb(t){let{color:e,colors:r,randomColors:i,numberColors:n=50}=t;if(e&&!Array.isArray(e)&&(e=Lb(e)),e)return[e];if(r)return r=r.map((function(t){return Array.isArray(t)?t:Lb(t)})),r;if(i){r=new Array(n);for(let t=0;t<n;t++)r[t]=Pb()}return Rb(n)}function Fb(t,e,r={}){let{color:i="blue",colors:n,font:s="12px Helvetica",rotate:o=0}=r;if(this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:td}),!Array.isArray(t))throw Error("paintLabels: labels must be an array");if(!Array.isArray(e))throw Error("paintLabels: positions must be an array");if(i&&!Array.isArray(i)&&(i=Lb(i)),n=n?n.map((function(t){return Array.isArray(t)?t:Lb(t)})):[i],t.length!==e.length)throw Error("paintLabels: positions and labels must be arrays from the same size");Array.isArray(s)||(s=[s]),Array.isArray(o)||(o=[o]);let a=this.getCanvas(),l=a.getContext("2d");for(let h=0;h<t.length;h++){l.save();let r=n[h%n.length];l.fillStyle=`rgba(${r[0]},${r[1]},${r[2]},${r[3]/this.maxValue})`,l.font=s[h%s.length];let i=e[h];l.translate(i[0],i[1]),l.rotate(o[h%o.length]/180*Math.PI),l.fillText(t[h],0,0),l.restore()}return this.data=Uint8Array.from(l.getImageData(0,0,this.width,this.height).data),this}function Bb(t,e={}){let{alpha:r=255,labels:i=[],labelsPosition:n=[],labelColor:s="blue",labelFont:o="12px Helvetica"}=e;this.checkProcessable("paintMasks",{channels:[3,4],bitDepth:[8,16],colorModel:td});let a=Tb(Object.assign({},e,{numberColors:t.length}));Array.isArray(t)||(t=[t]);for(let l=0;l<t.length;l++){let e=t[l],i=a[l%a.length];for(let t=0;t<e.width;t++)for(let n=0;n<e.height;n++)if(e.getBitXY(t,n))for(let s=0;s<Math.min(this.components,i.length);s++)if(255===r)this.setValueXY(t+e.position[0],n+e.position[1],s,i[s]);else{let o=this.getValueXY(t+e.position[0],n+e.position[1],s);o=Math.round((o*(255-r)+i[s]*r)/255),this.setValueXY(t+e.position[0],n+e.position[1],s,o)}}if(Array.isArray(i)&&i.length>0){let e=this.getCanvas(),r=e.getContext("2d");r.fillStyle=s,r.font=o;for(let s=0;s<Math.min(t.length,i.length);s++){let e=n[s]?n[s]:t[s].position;r.fillText(i[s],e[0],e[1])}this.data=Uint8Array.from(r.getImageData(0,0,this.width,this.height).data)}return this}function Ub(t,e){let r=new Array(t);for(let i=0;i<t;i++)r[i]=new Array(e).fill(0);return r}const Ob=[[0,0,1,0,0],[0,0,1,0,0],[1,1,1,1,1],[0,0,1,0,0],[0,0,1,0,0]],Nb=[[0,1,0],[1,1,1],[0,1,0]];class zb{constructor(t={}){let{kind:e="cross",shape:r,size:i,width:n,height:s,filled:o=!0}=t;if(i&&(n=i,s=i),r)switch(r.toLowerCase()){case"square":case"rectangle":this.matrix=jb(n,s,{filled:o});break;case"circle":case"ellipse":this.matrix=Xb(n,s,{filled:o});break;case"triangle":this.matrix=$b(n,s,{filled:o});break;default:throw new Error(`Shape: unexpected shape: ${r}`)}else{if(!e)throw new Error("Shape: expected a kind or a shape option");switch(e.toLowerCase()){case"cross":this.matrix=Ob;break;case"smallcross":this.matrix=Nb;break;default:throw new Error(`Shape: unexpected kind: ${e}`)}}this.height=this.matrix.length,this.width=this.matrix[0].length,this.halfHeight=this.height/2|0,this.halfWidth=this.width/2|0}getPoints(){let t=this.matrix,e=[];for(let r=0;r<t.length;r++)for(let i=0;i<t[0].length;i++)t[r][i]&&e.push([i-this.halfWidth,r-this.halfHeight]);return e}getMask(){let t=new pv(this.width,this.height,{kind:fd});for(let e=0;e<this.matrix.length;e++)for(let r=0;r<this.matrix[0].length;r++)this.matrix[e][r]&&t.setBitXY(r,e);return t}}function jb(t,e,r){const i=Ub(e,t);if(r.filled)for(let n=0;n<e;n++)for(let e=0;e<t;e++)i[n][e]=1;else{for(let r of[0,e-1])for(let e=0;e<t;e++)i[r][e]=1;for(let r=0;r<e;r++)for(let e of[0,t-1])i[r][e]=1}return i}function Xb(t,e,r){const i=Ub(e,t,r);let n=1-e%2,s=1-t%2,o=Math.floor((t-1)/2),a=Math.floor((e-1)/2),l=o*o,h=a*a;if(r.filled)for(let u=0;u<=a;u++){let e=Math.floor(Math.sqrt(l-l*u*u/h));for(let r=o-e;r<=o;r++)i[a-u][r]=1,i[a+u+n][r]=1,i[a-u][t-r-1]=1,i[a+u+n][t-r-1]=1}else{for(let e=0;e<=a;e++){let r=Math.floor(Math.sqrt(l-l*e*e/h)),s=o-r;i[a-e][s]=1,i[a+e+n][s]=1,i[a-e][t-s-1]=1,i[a+e+n][t-s-1]=1}for(let t=0;t<=o;t++){let r=Math.floor(Math.sqrt(h-h*t*t/l)),n=a-r;i[n][o-t]=1,i[n][o+t+s]=1,i[e-n-1][o-t]=1,i[e-n-1][o+t+s]=1}}return i}function $b(t,e,r){if(!r.filled)throw new Error("Non filled triangle is not implemented");const i=Ub(e,t,r);for(let n=0;n<e;n++){let r=Math.floor((1-n/e)*t/2);for(let e=r;e<t-r;e++)i[n][e]=1}return i}function Vb(t,e={}){let{shape:r}=e;this.checkProcessable("paintPoints",{bitDepth:[8,16]});let i=Tb(Object.assign({},e,{numberColors:t.length})),n=new zb(r).getPoints(),s=Math.min(this.channels,i[0].length);for(let o=0;o<t.length;o++){let e=i[o%i.length],r=t[o][0],a=t[o][1];for(let t=0;t<n.length;t++){let i=n[t][0],o=n[t][1];if(r+i>=0&&a+o>=0&&r+i<this.width&&a+o<this.height){let t=(r+i+(a+o)*this.width)*this.channels;for(let r=0;r<s;r++)this.data[t+r]=e[r]}}}return this}function Yb(t,e={}){let{color:r=[this.maxValue,0,0],closed:i=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]});let n=Math.min(this.channels,r.length);for(let s=0;s<t.length-1+i;s++){let e=t[s],i=t[(s+1)%t.length],o=i[0]-e[0],a=i[1]-e[1],l=Math.max(Math.abs(o),Math.abs(a)),h=o/l,u=a/l,c=e[0],f=e[1];for(let t=0;t<=l;t++){let t=Math.round(c),e=Math.round(f);if(t>=0&&e>=0&&t<this.width&&e<this.height)if(1===this.bitDepth)this.setBitXY(t,e);else{let i=(t+e*this.width)*this.channels;for(let t=0;t<n;t++)this.data[i+t]=r[t]}c+=h,f+=u}}return this}function qb(t,e={}){let r=Object.assign({},e);this.checkProcessable("paintPolylines",{bitDepth:[8,16]});let i=Tb(Object.assign({},e,{numberColors:t.length}));for(let n=0;n<t.length;n++)r.color=i[n%i.length],this.paintPolyline(t[n],r);return this}function Gb(t,e={}){let{color:r=[this.maxValue,0,0],filled:i=!1}=e;this.checkProcessable("paintPoints",{bitDepth:[1,8,16]}),e.closed=!0;let n=Hb(t);if(!1===i)return this.paintPolyline(t,e);{let i=Array(this.height);for(let t=0;t<this.height;t++){i[t]=[];for(let e=0;e<this.width;e++)i[t].push(0)}for(let t=0;t<n.length;t++){const e=Wb(n[t],n[(t+1)%n.length]);for(let t=0;t<this.height;t++)for(let r=0;r<this.width;r++)Kb(r,t,e,this.height)&&(i[t][r]=0===i[t][r]?1:0)}for(let t=0;t<this.height;t++)for(let e=0;e<this.width;e++)if(1===i[t][e])if(1===this.bitDepth)this.setBitXY(e,t);else{let i=Math.min(this.channels,r.length),n=(e+t*this.width)*this.channels;for(let t=0;t<i;t++)this.data[n+t]=r[t]}return this.paintPolyline(t,e)}}function Hb(t){let e=[];for(let r=0;r<t.length;r++)t[r][0]===t[(r+1)%t.length][0]&&t[r][1]===t[(r+1)%t.length][1]||t[r][0]===t[(r-1+t.length)%t.length][0]&&t[r][1]===t[(r-1+t.length)%t.length][1]||t[(r+1)%t.length][0]===t[(r-1+t.length)%t.length][0]&&t[(r-1+t.length)%t.length][1]===t[(r+1)%t.length][1]||e.push(t[r]);return e}function Wb(t,e){if(t[0]===e[0])return{a:0,b:t[0],vertical:!0};{const r=(e[1]-t[1])/(e[0]-t[0]),i=t[1]-r*t[0];return{a:r,b:i,vertical:!1}}}function Kb(t,e,r,i){if(!0===r.vertical)return r.b<=t;if(0===r.a)return!1;{const n=(e-r.b)/r.a;return n<t&&n>=0&&n<=i}}function Qb(t,e={}){let r=Object.assign({},e);this.checkProcessable("paintPolygons",{bitDepth:[8,16]});let i=Tb(Object.assign({},e,{numberColors:t.length}));for(let n=0;n<t.length;n++)r.color=i[n%i.length],this.paintPolygon(t[n],r);return this}function Zb(t={}){let{maxSlots:e=256,channel:r,useAlpha:i=!0}=t;if(this.checkProcessable("getHistogram",{bitDepth:[1,8,16]}),void 0===r){if(this.components>1)throw new RangeError("You need to define the channel for an image that contains more than one channel");r=0}return ty.call(this,r,{useAlpha:i,maxSlots:e})}function Jb(t={}){const{maxSlots:e=256,useAlpha:r=!0}=t;this.checkProcessable("getHistograms",{bitDepth:[8,16]});let i=new Array(r?this.components:this.channels);for(let n=0;n<i.length;n++)i[n]=ty.call(this,n,{useAlpha:r,maxSlots:e});return i}function ty(t,e){let{useAlpha:r,maxSlots:i}=e;if(1===this.bitDepth){let t=[0,0];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let i=this.getBitXY(e,r);0===i?t[0]+=1:1===i&&(t[1]+=1)}return t}let n=Math.log2(i);if(!xm()(n))throw new RangeError("maxSlots must be a power of 2, for example: 64, 256, 1024");let s=0;this.bitDepth>n&&(s=this.bitDepth-n);let o=this.data,a=Nm()(Math.pow(2,Math.min(this.bitDepth,n)),0);if(r&&this.alpha){let e=this.channels-t-1;for(let r=t;r<o.length;r+=this.channels)a[o[r]>>s]+=o[r+e]/this.maxValue}else for(let l=t;l<o.length;l+=this.channels)a[o[l]>>s]++;return a}function ey(t={}){let{useAlpha:e=!0,nbSlots:r=512}=t;this.checkProcessable("getColorHistogram",{bitDepth:[8,16],components:[3]});let i=Math.log(r)/Math.log(8);if(i!==Math.floor(i))throw new RangeError("nbSlots must be a power of 8. Usually 8, 64, 512 or 4096");let n=this.bitDepth-i,s=this.data,o=Nm()(Math.pow(8,i),0),a=Math.pow(2,2*i),l=Math.pow(2,i);for(let h=0;h<s.length;h+=this.channels){let t=(s[h]>>n)*a+(s[h+1]>>n)*l+(s[h+2]>>n);e&&this.alpha?o[t]+=s[h+this.channels-1]/this.maxValue:o[t]++}return o}function ry(){this.checkProcessable("min",{bitDepth:[8,16,32]});let t=Nm()(this.channels,1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)this.data[e+r]<t[r]&&(t[r]=this.data[e+r]);return t}function iy(){this.checkProcessable("max",{bitDepth:[8,16,32]});let t=Nm()(this.channels,-1/0);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)this.data[e+r]>t[r]&&(t[r]=this.data[e+r]);return t}function ny(){this.checkProcessable("sum",{bitDepth:[8,16]});let t=Nm()(this.channels,0);for(let e=0;e<this.data.length;e+=this.channels)for(let r=0;r<this.channels;r++)t[r]+=this.data[e+r];return t}function sy(t=0,e=0){this.checkProcessable("getMoment",{bitDepth:[1]});let r=0;for(let i=0;i<this.width;i++)for(let n=0;n<this.height;n++)1===this.getBitXY(i,n)&&(r+=i**t*n**e);return r}function oy(t={}){let{mask:e,region:r=3,removeClosePoints:i=0,invert:n=!1,maxEquals:s=2}=t,o=this;this.checkProcessable("localMaxima",{bitDepth:[8,16],components:1}),r*=4;let a=n?0:1,l=[1,0,-1,0,1,1,-1,-1,2,0,-2,0,2,2,-2,-2],h=[0,1,0,-1,1,-1,1,-1,0,2,0,-2,2,-2,2,-2],u=r<=8?1:2,c=[];for(let f=u;f<o.height-u;f++)for(let t=u;t<o.width-u;t++){if(e&&e.getBitXY(t,f)!==a)continue;let i=0,u=0,d=o.data[t+f*o.width];for(let e=0;e<r;e++)n?o.data[t+l[e]+(f+h[e])*o.width]>d&&i++:o.data[t+l[e]+(f+h[e])*o.width]<d&&i++,o.data[t+l[e]+(f+h[e])*o.width]===d&&u++;i+u===r&&u<=s&&c.push([t,f])}if(i>0)for(let f=0;f<c.length;f++)for(let t=f+1;t<c.length;t++)Math.sqrt(Math.pow(c[f][0]-c[t][0],2)+Math.pow(c[f][1]-c[t][1],2))<i&&(c[f][0]=c[f][0]+c[t][0]>>1,c[f][1]=c[f][1]+c[t][1]>>1,c.splice(t,1),t--);return c}function ay(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let r=0;r<t.length;r++){let i=t[r];e[r]=Ep(i)}return e}function ly(){let t=this.getHistograms({maxSlots:this.maxValue+1}),e=new Array(t.length);for(let r=0;r<t.length;r++){let i=t[r];e[r]=Mp(i)}return e}function hy(){this.checkProcessable("points",{bitDepth:[1]});const t=[];for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)1===this.getBitXY(e,r)&&t.push([e,r]);return t}function uy(){this.checkProcessable("extendedPoints",{bitDepth:[1]});const t=[];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++)if(1===this.getBitXY(r,e)){t.push([r,e]),1!==this.getBitXY(r+1,e)?(t.push([r+1,e]),t.push([r+1,e+1]),1!==this.getBitXY(r,e+1)&&t.push([r,e+1])):1!==this.getBitXY(r,e+1)&&(t.push([r,e+1]),t.push([r+1,e+1]));while(r<this.width-2&&1===this.getBitXY(r+1,e)&&1===this.getBitXY(r+2,e))r++}return t}function cy(t,e={}){if(this===t)return[0,0];let r=[0,0],i=this;while(i){if(i===t)return r;i.position&&(r[0]+=i.position[0],r[1]+=i.position[1]),i=i.parent}return!!e.defaultFurther&&r}function fy(t={}){let{alpha:e=1}=t;this.checkProcessable("countAlphaPixels",{bitDepth:[8,16],alpha:1});let r=0;if(void 0!==e){for(let t=this.components;t<this.data.length;t+=this.channels)this.data[t]===e&&r++;return r}return this.size}function dy(t,e={}){const{sorted:r}=e;r||(t=t.slice().sort(my));const i=t.length,n=new Array(2*i);let s=0;for(let a=0;a<i;a++){const e=t[a];while(s>=2&&py(n[s-2],n[s-1],e)<=0)s--;n[s++]=e}const o=s+1;for(let a=i-2;a>=0;a--){const e=t[a];while(s>=o&&py(n[s-2],n[s-1],e)<=0)s--;n[s++]=e}return n.slice(0,s-1)}function py(t,e,r){return(e[1]-t[1])*(r[0]-t[0])-(e[0]-t[0])*(r[1]-t[1])}function my(t,e){return t[0]===e[0]?t[1]-e[1]:t[0]-e[0]}function gy(){return dy(this.extendedPoints,{sorted:!1})}function wy(t){for(let e=0;e<t.length;e++)t[e][0]=Math.round(t[e][0]),t[e][1]=Math.round(t[e][1]);return t}function by(t,e){return[t[0]-e[0],t[1]-e[1]]}function yy(t){let e=Math.sqrt(t[0]**2+t[1]**2);return[t[0]/e,t[1]/e]}function vy(t,e,r){void 0===r&&(r=new Array(e.length));let i=Math.cos(t),n=Math.sin(t);for(let s=0;s<r.length;++s)r[s]=[i*e[s][0]-n*e[s][1],n*e[s][0]+i*e[s][1]];return r}function xy(t){let e=0;for(let r=0;r<t.length;r++){let i=t[r][0],n=t[r][1],s=t[r===t.length-1?0:r+1][0],o=t[r===t.length-1?0:r+1][1];e+=Math.sqrt((s-i)**2+(o-n)**2)}return e}function ky(t){let e=0;for(let r=0;r<t.length;r++){let i=t[r][0],n=t[r===t.length-1?0:r+1][1],s=t[r===t.length-1?0:r+1][0],o=t[r][1];e+=i*n*.5,e-=s*o*.5}return Math.abs(e)}function _y(t){let e=1/0,r=1/0,i=-1/0,n=-1/0;for(let s=0;s<t.length;s++)t[s][0]<e&&(e=t[s][0]),t[s][0]>i&&(i=t[s][0]),t[s][1]<r&&(r=t[s][1]),t[s][1]>n&&(n=t[s][1]);return[[e,r],[i,n]]}function My(t,e){void 0===e&&(e=new Array(t.length).fill(0).map((()=>[])));let r=_y(t),i=r[0][0],n=r[0][1];for(let s=0;s<t.length;s++)e[s][0]=t[s][0]-i,e[s][1]=t[s][1]-n;return e}function Ey(t={}){const{originalPoints:e=gy.call(this)}=t;if(0===e.length)return[];if(1===e.length)return[e[0],e[0],e[0],e[0]];const r=new Array(e.length);let i,n=1/0,s=0;for(let o=0;o<r.length;o++){let t=Sy(e[o],e[(o+1)%r.length]);vy(-t,e,r);let a=r[o][0],l=r[o][1],h=r[(o+1)%r.length][0],u=r[(o+1)%r.length][1],c=!0,f=0,d=0,p=0;for(let e=0;e<r.length;e++){let t=r[e][0],i=r[e][1],n=(t-a)/(h-a);!0===c?(c=!1,f=n,d=n):(n<f&&(f=n),n>d&&(d=n));let s=(-(h-a)*i+h*l-u*a)/(h-a);Math.abs(s)>Math.abs(p)&&(p=s)}let m=[a+f*(h-a),l],g=[a+d*(h-a),l],w=Math.abs(p*(f-d)*(h-a));w<n&&(s=t,n=w,i=[m,g,[g[0],g[1]-p],[m[0],m[1]-p]])}return vy(s,i,i),i}function Sy(t,e){let r=by(e,t),i=yy(r),n=Math.acos(i[0]);return i[1]<0?-n:n}function Ay(t){let e={inPlace:!0};t.extendMethod("invert",tm),t.extendMethod("abs",Qp),t.extendMethod("level",zm,e),t.extendMethod("add",Ym,e),t.extendMethod("subtract",qm,e),t.extendMethod("subtractImage",Gm),t.extendMethod("multiply",Wm,e),t.extendMethod("divide",Km,e),t.extendMethod("hypotenuse",Hm),t.extendMethod("background",ig),t.extendMethod("flipX",im),t.extendMethod("flipY",nm),t.extendMethod("blurFilter",sm),t.extendMethod("medianFilter",fm),t.extendMethod("gaussianFilter",dm),t.extendMethod("sobelFilter",Bm),t.extendMethod("gradientFilter",Fm),t.extendMethod("scharrFilter",Um),t.extendMethod("dilate",ng),t.extendMethod("erode",hg),t.extendMethod("open",pg),t.extendMethod("close",mg),t.extendMethod("topHat",gg),t.extendMethod("blackHat",wg),t.extendMethod("morphologicalGradient",bg),t.extendMethod("warpingFourPoints",Eg),t.extendMethod("crop",Sg),t.extendMethod("cropAlpha",Lg),t.extendMethod("resize",$g).extendMethod("scale",$g),t.extendMethod("hsv",Vg),t.extendMethod("hsl",Yg),t.extendMethod("cmyk",qg),t.extendMethod("rgba8",Gg),t.extendMethod("grey",Kg).extendMethod("gray",Kg),t.extendMethod("mask",Mw),t.extendMethod("pad",Sw),t.extendMethod("colorDepth",Aw),t.extendMethod("setBorder",Ow,e),t.extendMethod("rotate",Pw),t.extendMethod("rotateLeft",Tw),t.extendMethod("rotateRight",Fw),t.extendMethod("insert",Uw),t.extendMethod("getRow",Hw),t.extendMethod("getColumn",Ww),t.extendMethod("getMatrix",Kw),t.extendMethod("setMatrix",Qw),t.extendMethod("getPixelsArray",Zw),t.extendMethod("getIntersection",Jw),t.extendMethod("getClosestCommonParent",rb),t.extendMethod("getThreshold",kw),t.extendMethod("split",Nw),t.extendMethod("getChannel",zw),t.extendMethod("combineChannels",jw),t.extendMethod("setChannel",$w),t.extendMethod("getSimilarity",Vw),t.extendMethod("getPixelsGrid",Yw),t.extendMethod("getBestMatch",Gw),t.extendMethod("cannyEdge",ub),t.extendMethod("convolution",Tm),t.extendMethod("extract",cb),t.extendMethod("floodFill",pb),t.extendMethod("paintLabels",Fb,e),t.extendMethod("paintMasks",Bb,e),t.extendMethod("paintPoints",Vb,e),t.extendMethod("paintPolyline",Yb,e),t.extendMethod("paintPolylines",qb,e),t.extendMethod("paintPolygon",Gb,e),t.extendMethod("paintPolygons",Qb,e),t.extendMethod("countAlphaPixels",fy),t.extendMethod("monotoneChainConvexHull",gy),t.extendMethod("minimalBoundingRectangle",Ey),t.extendMethod("getHistogram",Zb).extendProperty("histogram",Zb),t.extendMethod("getHistograms",Jb).extendProperty("histograms",Jb),t.extendMethod("getColorHistogram",ey).extendProperty("colorHistogram",ey),t.extendMethod("getMin",ry).extendProperty("min",ry),t.extendMethod("getMax",iy).extendProperty("max",iy),t.extendMethod("getSum",ny).extendProperty("sum",ny),t.extendMethod("getMoment",sy).extendProperty("moment",sy),t.extendMethod("getLocalMaxima",oy),t.extendMethod("getMedian",ly).extendProperty("median",ly),t.extendMethod("getMean",ay).extendProperty("mean",ay),t.extendMethod("getPoints",hy).extendProperty("points",hy),t.extendMethod("getExtendedPoints",uy).extendProperty("extendedPoints",uy),t.extendMethod("getRelativePosition",cy)}var Cy=r(24514),Ly=r.n(Cy);function Iy(t,e=""){let r=e.split(".");for(let i of r){if(void 0===t[i])return;t=t[i]}return t}var Dy=r(3778),Ry=r.n(Dy);function Py(t={}){const{originalPoints:e=gy.call(this)}=t;if(0===e.length)return{min:0,max:0,minLine:[],maxLine:[],aspectRatio:1};if(1===e.length)return{min:1,max:1,minLine:[e[0],e[0]],maxLine:[e[0],e[0]],aspectRatio:1};const r=new Array(e.length);let i=1/0,n=0,s=[];for(let h=0;h<e.length;h++){let t=Ty(e[h],e[(h+1)%e.length]);vy(-t,e,r);let o=0,a=[];for(let i=0;i<e.length;i++){let t=Math.abs(r[h][1]-r[i][1]);t>o&&(o=t,a=[],a.push([r[i][0],r[h][1]],[r[i][0],r[i][1]]))}o<i&&(i=o,n=t,s=a)}vy(n,s,s);let o=0,a=[],l=0;for(let h=0;h<e.length-1;h++)for(let t=h+1;t<e.length;t++){let r=(e[h][0]-e[t][0])**2+(e[h][1]-e[t][1])**2;r>l&&(l=r,o=Math.sqrt(r),a=[e[h],e[t]])}return{min:i,minLine:s,max:o,maxLine:a,aspectRatio:i/o}}function Ty(t,e){let r=by(e,t),i=yy(r),n=Math.acos(i[0]);return i[1]<0?-n:n}class Fy{constructor(t,e){this.map=t,this.id=e,this.minX=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.meanX=0,this.meanY=0,this.surface=0,this.computed={}}getMask(t={}){const{scale:e=1,kind:r=""}=t;let i;switch(r){case"contour":i=this.contourMask;break;case"box":i=this.boxMask;break;case"filled":i=this.filledMask;break;case"center":i=this.centerMask;break;case"mbr":i=this.mbrFilledMask;break;case"hull":i=this.convexHullFilledMask;break;case"hullContour":i=this.convexHullMask;break;case"mbrContour":i=this.mbrMask;break;case"feret":i=this.feretMask;break;default:i=this.mask}return e<1&&(i=i.resize({factor:e}),i.parent=this.mask.parent,i.position[0]+=this.minX,i.position[1]+=this.minY),i}get mean(){throw new Error("Roi mean not implemented yet")}get center(){return this.computed.center||(this.computed.center=[this.width/2|0,this.height/2|0]),this.computed.center}get ratio(){return this.width/this.height}get width(){return this.maxX-this.minX+1}get height(){return this.maxY-this.minY+1}_computExternalIDs(){let t=this.borderIDs,e=this.borderLengths;this.computed.externalIDs=[],this.computed.externalLengths=[];let r=this.internalIDs;for(let i=0;i<t.length;i++)r.includes(t[i])||(this.computed.externalIDs.push(t[i]),this.computed.externalLengths.push(e[i]))}get externalIDs(){return this.computed.externalIDs||this._computExternalIDs(),this.computed.externalIDs}get externalLengths(){return this.computed.externalLengths||this._computExternalIDs(),this.computed.externalLengths}_computeBorderIDs(){let t=By(this);this.computed.borderIDs=t.ids,this.computed.borderLengths=t.lengths}get borderIDs(){return this.computed.borderIDs||this._computeBorderIDs(),this.computed.borderIDs}get borderLengths(){return this.computed.borderLengths||this._computeBorderIDs(),this.computed.borderLengths}get boxIDs(){return this.computed.boxIDs||(this.computed.boxIDs=Uy(this)),this.computed.boxIDs}get internalIDs(){return this.computed.internalIDs||(this.computed.internalIDs=$y(this)),this.computed.internalIDs}get box(){return this.computed.box||(this.computed.box=Oy(this)),this.computed.box}get external(){return this.computed.external||(this.computed.external=jy(this)),this.computed.external}get holesInfo(){return this.computed.holesInfo||(this.computed.holesInfo=Xy(this)),this.computed.holesInfo}get border(){return this.computed.border||(this.computed.border=Ny(this)),this.computed.border}get contourMask(){if(!this.computed.contourMask){let t=new pv(this.width,this.height,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)this.map.data[e+this.minX+(r+this.minY)*this.map.width]===this.id&&(e>0&&e<this.width-1&&r>0&&r<this.height-1&&this.map.data[e-1+this.minX+(r+this.minY)*this.map.width]===this.id&&this.map.data[e+1+this.minX+(r+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(r-1+this.minY)*this.map.width]===this.id&&this.map.data[e+this.minX+(r+1+this.minY)*this.map.width]===this.id||t.setBitXY(e,r));this.computed.contourMask=t}return this.computed.contourMask}get boxMask(){if(!this.computed.boxMask){let t=new pv(this.width,this.height,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)t.setBitXY(e,0),t.setBitXY(e,this.height-1);for(let e=0;e<this.height;e++)t.setBitXY(0,e),t.setBitXY(this.width-1,e);this.computed.boxMask=t}return this.computed.boxMask}get mask(){if(!this.computed.mask){let t=new pv(this.width,this.height,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++)this.map.data[e+this.minX+(r+this.minY)*this.map.width]===this.id&&t.setBitXY(e,r);this.computed.mask=t}return this.computed.mask}get filledMask(){if(!this.computed.filledMask){let t=new pv(this.width,this.height,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent});for(let e=0;e<this.width;e++)for(let r=0;r<this.height;r++){let i=e+this.minX+(r+this.minY)*this.map.width;this.internalIDs.includes(this.map.data[i])&&t.setBitXY(e,r)}this.computed.filledMask=t}return this.computed.filledMask}get centerMask(){if(!this.computed.centerMask){let t=new zb({kind:"smallCross"}).getMask();t.parent=this.map.parent,t.position=[this.minX+this.center[0]-1,this.minY+this.center[1]-1],this.computed.centerMask=t}return this.computed.centerMask}get convexHull(){if(!this.computed.convexHull){const t=[];for(let r=0;r<this.width;r++)for(let e=0;e<this.height;e++)this.map.data[r+this.minX+(e+this.minY)*this.map.width]===this.id&&(r>0&&r<this.width-1&&e>0&&e<this.height-1&&this.map.data[r-1+this.minX+(e+this.minY)*this.map.width]===this.id&&this.map.data[r+1+this.minX+(e+this.minY)*this.map.width]===this.id&&this.map.data[r+this.minX+(e-1+this.minY)*this.map.width]===this.id&&this.map.data[r+this.minX+(e+1+this.minY)*this.map.width]===this.id||(t.push([r,e]),t.push([r+1,e]),t.push([r,e+1]),t.push([r+1,e+1])));const e=dy(t);this.computed.convexHull={polyline:e,surface:ky(e),perimeter:xy(e)}}return this.computed.convexHull}get convexHullMask(){if(!this.computed.convexHullMask){const t=this.convexHull,e=new pv(this.width+1,this.height+1,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent});e.paintPolyline(t.polyline,{closed:!0}),this.computed.convexHullMask=e}return this.computed.convexHullMask}get convexHullFilledMask(){if(!this.computed.convexHullFilledMask){const t=this.convexHull,e=new pv(this.width,this.height,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent});for(let r=0;r<this.width;r++)for(let i=0;i<this.height;i++)1!==Ry()(t.polyline,[r,i])&&e.setBitXY(r,i);this.computed.convexHullFilledMask=e}return this.computed.convexHullFilledMask}get mbr(){if(!this.computed.mbr){let t=Ey({originalPoints:this.convexHull.polyline});if(0===t.length)this.computed.mbr={width:0,height:0,surface:0,perimeter:0,rectangle:t};else{let e=t[0],r=t[1],i=t[2],n=Math.sqrt((e[0]-r[0])**2+(e[1]-r[1])**2),s=Math.sqrt((i[0]-r[0])**2+(i[1]-r[1])**2);this.computed.mbr={width:n,height:s,elongation:1-n/s,aspectRatio:n/s,surface:n*s,perimeter:2*(n+s),rectangle:t}}}return this.computed.mbr}get fillRatio(){return this.surface/(this.surface+this.holesInfo.surface)}get feretDiameters(){return this.computed.feretDiameters||(this.computed.feretDiameters=Py({originalPoints:this.convexHull.polyline})),this.computed.feretDiameters}get eqpc(){return this.computed.eqpc||(this.computed.eqpc=2*Math.sqrt(this.surface/Math.PI)),this.computed.eqpc}get perimeterInfo(){return this.computed.perimeterInfo||(this.computed.perimeterInfo=zy(this)),this.computed.perimeterInfo}get perimeter(){let t=this.perimeterInfo,e=2-Math.sqrt(2);return t.one+2*t.two+3*t.three+4*t.four-e*(t.two+2*t.three+t.four)}get ped(){return this.computed.ped||(this.computed.ped=this.perimeter/Math.PI),this.computed.ped}get feretMask(){if(!this.computed.feretMask){const t=new pv(this.width+1,this.height+1,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent});t.paintPolyline(this.feretDiameters.minLine),t.paintPolyline(this.feretDiameters.maxLine),this.computed.feretMask=t}return this.computed.feretMask}get mbrMask(){if(!this.computed.mbrMask){let t=wy(this.mbr.rectangle);if(t.length>0){const e=_y(t),r=new pv(e[1][0]-e[0][0]+1,e[1][1]-e[0][1]+1,{kind:fd,position:[this.minX+e[0][0],this.minY+e[0][1]],parent:this.map.parent});t=My(t),r.paintPolyline(t,{closed:!0}),this.computed.mbrMask=r}else this.computed.mbrMask=new pv(1,1,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent})}return this.computed.mbrMask}get mbrFilledMask(){if(!this.computed.mbrFilledMask){const t=new pv(this.width,this.height,{kind:fd,position:[this.minX,this.minY],parent:this.map.parent}),e=this.mask.minimalBoundingRectangle();for(let r=0;r<this.width;r++)for(let i=0;i<this.height;i++)1!==Ry()(e,[r,i])&&t.setBitXY(r,i);this.computed.mbrFilledMask=t}return this.computed.mbrFilledMask}get points(){if(!this.computed.points){let t=[];for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let i=(e+this.minY)*this.map.width+r+this.minX;this.map.data[i]===this.id&&t.push([r,e])}this.computed.points=t}return this.computed.points}get maxLengthPoints(){if(!this.computed.maxLengthPoints){let t,e=0;const r=this.points;for(let i=0;i<r.length;i++)for(let n=i+1;n<r.length;n++){let s=Math.pow(r[i][0]-r[n][0],2)+Math.pow(r[i][1]-r[n][1],2);s>=e&&(e=s,t=[r[i],r[n]])}this.computed.maxLengthPoints=t}return this.computed.maxLengthPoints}get maxLength(){if(!this.computed.maxLength){let t=Math.sqrt(Math.pow(this.maxLengthPoints[0][0]-this.maxLengthPoints[1][0],2)+Math.pow(this.maxLengthPoints[0][1]-this.maxLengthPoints[1][1],2));this.computed.maxLength=t}return this.computed.maxLength}get roundness(){return 4*this.surface/(Math.PI*this.feretDiameters.max**2)}get sphericity(){return 2*Math.sqrt(this.surface*Math.PI)/this.perimeter}get solidity(){return this.surface/this.convexHull.surface}get angle(){if(!this.computed.angle){let t=this.maxLengthPoints,e=180*-Math.atan2(t[0][1]-t[1][1],t[0][0]-t[1][0])/Math.PI;this.computed.angle=e}return this.computed.angle}toJSON(){return{id:this.id,minX:this.minX,maxX:this.maxX,minY:this.minY,maxY:this.maxY,meanX:this.meanX,meanY:this.meanY,height:this.height,width:this.width,surface:this.surface,mbrWidth:this.mbr.width,mbrHeight:this.mbr.height,mbrSurface:this.mbr.surface,eqpc:this.eqpc,ped:this.ped,feretDiameterMin:this.feretDiameters.min,feretDiameterMax:this.feretDiameters.max,aspectRatio:this.feretDiameters.aspectRatio,fillRatio:this.fillRatio,sphericity:this.sphericity,roundness:this.roundness,solidity:this.solidity,perimeter:this.perimeter}}}function By(t){let e=t.map,r=e.data,i=new Set,n=new Map,s=new Set,o=[1,0,-1,0],a=[0,1,0,-1];for(let u=t.minX;u<=t.maxX;u++)for(let l=t.minY;l<=t.maxY;l++){let h=u+l*e.width;if(r[h]===t.id)for(let c=0;c<4;c++){let h=u+o[c],f=l+a[c];if(h>=0&&f>=0&&h<e.width&&f<e.height){let o=h+f*e.width;if(r[o]!==t.id&&!s.has(o)){s.add(o),i.add(r[o]);let t=n.get(r[o]);t?n.set(r[o],++t):n.set(r[o],1)}}}}let l=Array.from(i),h=l.map((function(t){return n.get(t)}));return{ids:l,lengths:h}}function Uy(t){let e=new Set,r=t.map,i=r.data;for(let n of[0,t.height-1])for(let s=0;s<t.width;s++){let o=(n+t.minY)*r.width+s+t.minX;if(s-t.minX>0&&i[o]===t.id&&i[o-1]!==t.id){let t=i[o-1];e.add(t)}if(r.width-s-t.minX>1&&i[o]===t.id&&i[o+1]!==t.id){let t=i[o+1];e.add(t)}}for(let n of[0,t.width-1])for(let s=0;s<t.height;s++){let o=(s+t.minY)*r.width+n+t.minX;if(s-t.minY>0&&i[o]===t.id&&i[o-r.width]!==t.id){let t=i[o-r.width];e.add(t)}if(r.height-s-t.minY>1&&i[o]===t.id&&i[o+r.width]!==t.id){let t=i[o+r.width];e.add(t)}}return Array.from(e)}function Oy(t){let e=0,r=t.map,i=r.data,n=[0];t.height>1&&(n[1]=t.height-1);for(let o of n)for(let n=1;n<t.width-1;n++){let s=(o+t.minY)*r.width+n+t.minX;i[s]===t.id&&e++}let s=[0];t.width>1&&(s[1]=t.width-1);for(let o of s)for(let n=0;n<t.height;n++){let s=(n+t.minY)*r.width+o+t.minX;i[s]===t.id&&e++}return e}function Ny(t){let e=0,r=t.map,i=r.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*r.width+n+t.minX;i[o]===t.id&&(i[o-1]===t.id&&i[o+1]===t.id&&i[o-r.width]===t.id&&i[o+r.width]===t.id||e++)}return e+t.box}function zy(t){let e=t.map,r=e.data,i=0,n=0,s=0,o=0;for(let a=0;a<t.width;a++)for(let l=0;l<t.height;l++){let h=(l+t.minY)*e.width+a+t.minX;if(r[h]===t.id){let u=0;switch((0===a||t.externalIDs.includes(r[h-1]))&&u++,(a===t.width-1||t.externalIDs.includes(r[h+1]))&&u++,(0===l||t.externalIDs.includes(r[h-e.width]))&&u++,(l===t.height-1||t.externalIDs.includes(r[h+e.width]))&&u++,u){case 1:i++;break;case 2:n++;break;case 3:s++;break;case 4:o++;break;default:}}}return{one:i,two:n,three:s,four:o}}function jy(t){let e=0,r=t.map,i=r.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*r.width+n+t.minX;i[o]===t.id&&(t.externalIDs.includes(i[o-1])||t.externalIDs.includes(i[o+1])||t.externalIDs.includes(i[o-r.width])||t.externalIDs.includes(i[o+r.width]))&&e++}return e+t.box}function Xy(t){let e=0,r=t.map.width,i=t.map.data;for(let n=1;n<t.width-1;n++)for(let s=1;s<t.height-1;s++){let o=(s+t.minY)*r+n+t.minX;t.internalIDs.includes(i[o])&&i[o]!==t.id&&e++}return{number:t.internalIDs.length-1,surface:e}}function $y(t){let e=[t.id],r=t.map,i=r.data;if(t.height>2)for(let s=0;s<t.width;s++){let n=t.minY*r.width+s+t.minX;if(e.includes(i[n])){let s=i[n+r.width];e.includes(s)||t.boxIDs.includes(s)||e.push(s)}}let n=new Array(4);for(let s=1;s<t.width-1;s++)for(let o=1;o<t.height-1;o++){let a=(o+t.minY)*r.width+s+t.minX;if(e.includes(i[a])){n[0]=i[a-1],n[1]=i[a+1],n[2]=i[a-r.width],n[3]=i[a+r.width];for(let r=0;r<4;r++){let i=n[r];e.includes(i)||t.boxIDs.includes(i)||e.push(i)}}}return e}class Vy{constructor(t,e){this.roiMap=t,this.options=e,this.roi=this.createRoi()}createRoi(){let t=this.roiMap.data,e={};this.roiMap.positive=0,this.roiMap.negative=0;for(let o=0;o<t.length;o++)t[o]&&!e[t[o]]&&(e[t[o]]=!0,t[o]>0?this.roiMap.positive++:this.roiMap.negative++);let r={};for(let o in e)r[o]=new Fy(this.roiMap,1*o);let i=this.roiMap.width,n=this.roiMap.height;for(let o=0;o<n;o++)for(let e=0;e<i;e++){let n=o*i+e;if(0!==t[n]){const i=t[n],s=r[i];e<s.minX&&(s.minX=e),e>s.maxX&&(s.maxX=e),o<s.minY&&(s.minY=o),o>s.maxY&&(s.maxY=o),s.meanX+=e,s.meanY+=o,s.surface++}}let s=[];for(let o in e)r[o].meanX/=r[o].surface,r[o].meanY/=r[o].surface,s.push(r[o]);return s}}function Yy(t){let e=t.data,r=[1,0,-1,0],i=[0,1,0,-1],n=t.minMax,s=-n.min,o=n.max+s,a=[];for(let h=0;h<=o;h++)a.push(Object.create(null));for(let h=0;h<t.width;h++)for(let n=0;n<t.height;n++){let o=h+n*t.width,l=e[o];if(0!==l){let o=Object.create(null),u=!1;for(let c=0;c<4;c++){let f=h+r[c],d=n+i[c];if(f>=0&&d>=0&&f<t.width&&d<t.height){let r=e[f+d*t.width];l!==r&&(u=!0,0!==r&&void 0===o[r]&&(o[r]=!0,a[r+s][l]?a[r+s][l]++:a[r+s][l]=1))}else u=!0}u&&(a[l+s][l]?a[l+s][l]++:a[l+s][l]=1)}}let l={};for(let h=0;h<a.length;h++)Object.keys(a[h]).length>0&&(l[h-s]=a[h]);return l}function qy(t={}){const{algorithm:e="commonBorderLength",minCommonBorderLength:r=5,maxCommonBorderLength:i=100,minCommonBorderRatio:n=.3,maxCommonBorderRatio:s=1}=t;let o=function(t,e,n){return t[n]>=r&&t[n]<=i};"function"===typeof e&&(o=e),"commonborderratio"===e.toLowerCase()&&(o=function(t,e,r){let i=Math.min(t[r]/t[e],1);return i>=n&&i<=s});const a=this,l=a.commonBorderLength;let h={},u={};for(let g of Object.keys(l)){let t=l[g],e=Object.keys(t);for(let r of e)if(r!==g&&o(t,g,r)){let t=r;u[r]&&(t=u[r]);let e=g;if(u[g]&&(e=u[g]),Number(t)!==e){let r=Math.min(t,e),i=Math.max(t,e);if(h[r]||(h[r]={}),h[r][i]=!0,u[i]=r,h[i]){for(let t of Object.keys(h[i]))h[r][t]=!0,u[t]=r;delete h[i]}}}}let c=a.minMax,f=-c.min,d=c.max+f,p=new Array(d+1).fill(0);for(let g of Object.keys(u))p[Number(g)+f]=u[g];let m=a.data;for(let g=0;g<m.length;g++){let t=m[g];if(0!==t){let e=p[t+f];0!==e&&(m[g]=e)}}return a.computed={},a}class Gy{constructor(t,e){this.parent=t,this.width=t.width,this.height=t.height,this.data=e,this.negative=0,this.positive=0}get total(){return this.negative+this.positive}get minMax(){let t=Number.MAX_SAFE_INTEGER,e=Number.MIN_SAFE_INTEGER;for(let r=0;r<this.data.length;r++)this.data[r]<t&&(t=this.data[r]),this.data[r]>e&&(e=this.data[r]);return{min:t,max:e}}get commonBorderLength(){return Yy(this)}mergeRoi(t={}){return qy.call(this,t)}mergeRois(t){const e=t[0],r=t.slice(1);for(let i=0;i<this.data.length;i++)r.includes(this.data[i])&&(this.data[i]=e)}rowsInfo(){let t=new Array(this.height),e=0;for(let r=0;r<this.data.length;r+=this.width){let i={row:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=i;let n={},s={},o=[],a=this.data[r],l=0;for(let t=r;t<r+this.width;t++){let e=this.data[t];a!==e&&(a=e,o.push(l),l=0),l++,e>0?(i.positivePixel++,n[e]||(n[e]=!0)):e<0?(i.negativePixel++,s[e]||(s[e]=!0)):i.zeroPixel++}o.push(l),i.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],i.positiveRoiIDs=Object.keys(n),i.negativeRoiIDs=Object.keys(s),i.positiveRoi=i.positiveRoiIDs.length,i.negativeRoi=i.negativeRoiIDs.length}return t}colsInfo(){let t=new Array(this.width),e=0;for(let r=0;r<this.width;r++){let i={col:e,positivePixel:0,negativePixel:0,zeroPixel:0,positiveRoi:0,negativeRoi:0,medianChange:0};t[e++]=i;let n={},s={},o=[],a=this.data[r],l=0;for(let t=r;t<r+this.data.length;t+=this.width){let e=this.data[t];a!==e&&(a=e,o.push(l),l=0),l++,e>0?(i.positivePixel++,n[e]||(n[e]=!0)):e<0?(i.negativePixel++,s[e]||(s[e]=!0)):i.zeroPixel++}o.push(l),i.medianChange=o.sort(((t,e)=>t-e))[Math.floor(o.length/2)],i.positiveRoiIDs=Object.keys(n),i.negativeRoiIDs=Object.keys(s),i.positiveRoi=i.positiveRoiIDs.length,i.negativeRoi=i.negativeRoiIDs.length}return t}}function Hy(t,e={}){const{allowCorners:r=!1}=e,i=65535;let n=new Int16Array(t.size),s=0,o=0,a=new Uint16Array(i+1),l=new Uint16Array(i+1);for(let u=0;u<t.width;u++)for(let e=0;e<t.height;e++)0===n[e*t.width+u]&&h(u,e);function h(e,h){let u=0,c=0,f=t.getBitXY(e,h),d=f?++s:--o;if(s>32767||o<-32768)throw new Error("Too many regions of interest");a[0]=e,l[0]=h;while(u<=c){let e=a[u&i],s=l[u&i];if(n[s*t.width+e]=d,e>0&&0===n[s*t.width+e-1]&&t.getBitXY(e-1,s)===f&&(c++,a[c&i]=e-1,l[c&i]=s,n[s*t.width+e-1]=-32768),s>0&&0===n[(s-1)*t.width+e]&&t.getBitXY(e,s-1)===f&&(c++,a[c&i]=e,l[c&i]=s-1,n[(s-1)*t.width+e]=-32768),e<t.width-1&&0===n[s*t.width+e+1]&&t.getBitXY(e+1,s)===f&&(c++,a[c&i]=e+1,l[c&i]=s,n[s*t.width+e+1]=-32768),s<t.height-1&&0===n[(s+1)*t.width+e]&&t.getBitXY(e,s+1)===f&&(c++,a[c&i]=e,l[c&i]=s+1,n[(s+1)*t.width+e]=-32768),r&&(e>0&&s>0&&0===n[(s-1)*t.width+e-1]&&t.getBitXY(e-1,s-1)===f&&(c++,a[c&i]=e-1,l[c&i]=s-1,n[(s-1)*t.width+e-1]=-32768),e<t.width-1&&s>0&&0===n[(s-1)*t.width+e+1]&&t.getBitXY(e+1,s-1)===f&&(c++,a[c&i]=e+1,l[c&i]=s-1,n[(s-1)*t.width+e+1]=-32768),e>0&&s<t.height-1&&0===n[(s+1)*t.width+e-1]&&t.getBitXY(e-1,s+1)===f&&(c++,a[c&i]=e-1,l[c&i]=s+1,n[(s+1)*t.width+e-1]=-32768),e<t.width-1&&s<t.height-1&&0===n[(s+1)*t.width+e+1]&&t.getBitXY(e+1,s+1)===f&&(c++,a[c&i]=e+1,l[c&i]=s+1,n[(s+1)*t.width+e+1]=-32768)),u++,c-u>i)throw new Error("analyseMask can not finish, the array to manage internal data is not big enough.You could improve mask by changing MAX_ARRAY")}}return new Gy(t,n)}var Wy=r(52743),Ky=r.n(Wy);const Qy=[-1,0],Zy=[0,-1],Jy=[null,null],tv=[-1,-1,0,1],ev=[0,-1,-1,-1],rv=[null,null,null,null];function iv(t,e={}){const{allowCorners:r=!1}=e;let i,n,s,o=4;if(r&&(o=8),8===o)i=tv,n=ev,s=rv;else{if(4!==o)throw new RangeError(`unsupported neighbours count: ${o}`);i=Qy,n=Zy,s=Jy}const a=t.size,l=t.width,h=t.height,u=new Array(a),c=new Uint32Array(a),f=new(Ky());let d=1;for(let p=0;p<h;p++)for(let e=0;e<l;e++){const r=e+p*l;if(t.getBit(r)){let t=null;for(let r=0;r<s.length;r++){const o=e+i[r],a=p+n[r];if(o>=0&&a>=0&&o<l&&a<h){const e=o+a*l;let i=u[e];i?(s[r]=i,(!t||s[r].value<t.value)&&(t=s[r])):s[r]=null}}if(t){u[r]=t;for(let e=0;e<s.length;e++)s[e]&&s[e]!==t&&f.union(t,s[e])}else u[r]=f.add(d++)}}for(let p=0;p<h;p++)for(let e=0;e<l;e++){const r=e+p*l;t.getBit(r)&&(c[r]=f.find(u[r]).value)}return new Gy(t,c)}function nv(t={}){let{allowCorner:e=!0,onlyTop:r=!1,invert:i=!1}=t,n=this;n.checkProcessable("fromMaxima",{components:[1]});const s=1,o=2;let a=0,l=0,h=new Int16Array(n.size),u=new Int8Array(n.size),c=new Float32Array(n.size),f=1048575,d=new Uint16Array(f+1),p=new Uint16Array(f+1),m=0,g=0,w=new Uint16Array(f+1),b=new Uint16Array(f+1),y=0,v=0;x(n,{maxima:!i});while(m<g){let t=d[m&f],e=p[m&f];_(t,e,o),m++}return new Gy(n,h);function x({maxima:t=!0}){for(let r=1;r<n.height-1;r++)for(let i=1;i<n.width-1;i++){let o=i+r*n.width;if(0===u[o]){let u=t?n.data[o]:-n.data[i+r*n.width];if(n.data[r*n.width+i-1]>u)continue;if(n.data[r*n.width+i+1]>u)continue;if(n.data[(r-1)*n.width+i]>u)continue;if(n.data[(r+1)*n.width+i]>u)continue;if(e){if(n.data[(r-1)*n.width+i-1]>u)continue;if(n.data[(r-1)*n.width+i+1]>u)continue;if(n.data[(r+1)*n.width+i-1]>u)continue;if(n.data[(r+1)*n.width+i+1]>u)continue}h[o]=t?++a:--l;let c=k(i,r,s);c||(t?--a:++l)}}}function k(t,e){let r=g;y=0,v=1,w[0]=t,b[0]=e;let i=!0;while(y<v){let t=w[y&f],e=b[y&f];i&=_(t,e,s),y++}if(!i){for(let t=0;t<v;t++){let e=w[t&f],r=b[t&f],i=r*n.width+e;h[i]=0}g=r}return i}function _(t,e,i){let a=h[e*n.width+t],l=n.data[e*n.width+t];for(let m=e-1;m<=e+1;m++)for(let e=t-1;e<=t+1;e++){let t=m*n.width+e;if(0===u[t])switch(u[t]=1,c[t]=n.data[t]-l,i){case s:if(0===c[t]){if(0===e||0===m||e===n.width-1||m===n.height-1)return!1;h[t]=a,w[v&f]=e,b[v&f]=m,v++}else{if(c[t]>0)return!1;r||(h[t]=a,d[g&f]=e,p[g&f]=m,g++)}break;case o:c[t]<=0&&(h[t]=a,d[g&f]=e,p[g&f]=m,g++);break;default:throw new Error("unreachable")}}return!0}}function sv(t,e={}){let r=new zb(e),i=new Int16Array(this.size),n=0,s=r.getPoints();for(let o=0;o<t.length;o++){n++;let e=t[o][0],r=t[o][1];for(let t=0;t<s.length;t++){let o=s[t][0],a=s[t][1];e+o>=0&&r+a>=0&&e+o<this.width&&r+a<this.height&&(i[e+o+(r+a)*this.width]=n)}}return new Gy(this,i)}var ov=r(80061),av=r.n(ov);const lv=[1,0,-1,0,1,1,-1,-1],hv=[0,1,0,-1,1,-1,1,-1];function uv(t={}){let{points:e,mask:r,image:i,fillMaxValue:n=this.maxValue,invert:s=!1}=t,o=i||this;o.checkProcessable("fromWaterShed",{bitDepth:[8,16],components:1}),s=!s,e||(e=o.getLocalMaxima({invert:s,mask:r}));let a=s?0:1,l=new Int16Array(o.size),h=o.width,u=o.height,c=new(av())({comparator:(t,e)=>t[2]-e[2],strategy:av().BinaryHeapStrategy});for(let f=0;f<e.length;f++){let t=e[f][0]+e[f][1]*h;l[t]=f+1;let r=o.data[t];(s&&r<=n||!s&&r>=n)&&c.queue([e[f][0],e[f][1],r])}while(c.length>0){let t=c.dequeue(),e=t[0]+t[1]*h;for(let i=0;i<4;i++){let f=t[0]+lv[i],d=t[1]+hv[i];if(f>=0&&d>=0&&f<h&&d<u){let u=f+d*h;if(!r||r.getBit(u)===a){let r=o.data[u];(s&&r<=n||!s&&r>=n)&&0===l[u]&&(l[u]=l[e],c.queue([t[0]+lv[i],t[1]+hv[i],r]))}}}}return new Gy(o,l)}class cv{constructor(t,e={}){this._image=t,this._options=e,this._options.label||(this._options.label="default"),this._layers={},this._painted=null}fromMaxima(t={}){let e=Object.assign({},this._options,t),r=nv.call(this._image,t);this._layers[e.label]=new Vy(r,e)}fromPoints(t,e={}){let r=Object.assign({},this._options,e),i=sv.call(this._image,t,e);return this._layers[r.label]=new Vy(i,r),this}putMap(t,e={}){let r=new Gy(this._image,t),i=Object.assign({},this._options,e);return this._layers[i.label]=new Vy(r,i),this}fromWaterShed(t={}){let e=Object.assign({},this._options,t),r=uv.call(this._image,t);this._layers[e.label]=new Vy(r,e)}fromMask(t,e={}){let r=Object.assign({},this._options,e),i=Hy.call(this._image,t,e);return this._layers[r.label]=new Vy(i,r),this}fromMaskConnectedComponentLabelingAlgorithm(t,e={}){let r=Object.assign({},this._options,e),i=iv.call(this._image,t,e);return this._layers[r.label]=new Vy(i,r),this}getMap(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap}rowsInfo(t={}){return this.getMap(t).rowsInfo()}colsInfo(t={}){return this.getMap(t).rowsInfo()}getRoiIds(t={}){let e=this.getRois(t);if(e){let t=new Array(e.length);for(let r=0;r<e.length;r++)t[r]=e[r].id;return t}throw new Error("ROIs not found")}getRois(t={}){let{label:e=this._options.label,positive:r=!0,negative:i=!0,minSurface:n=0,maxSurface:s=Number.POSITIVE_INFINITY,minWidth:o=0,maxWidth:a=Number.POSITIVE_INFINITY,minHeight:l=0,maxHeight:h=Number.POSITIVE_INFINITY,minRatio:u=0,maxRatio:c=Number.POSITIVE_INFINITY}=t;if(!this._layers[e])throw new Error(`this Roi layer (${e}) does not exist`);const f=this._layers[e].roi,d=[];for(const p of f)(p.id<0&&i||p.id>0&&r)&&p.surface>=n&&p.surface<=s&&p.width>=o&&p.width<=a&&p.height>=l&&p.height<=h&&p.ratio>=u&&p.ratio<=c&&d.push(p);return d}getRoi(t,e={}){const{label:r=this._options.label}=e;if(!this._layers[r])throw new Error(`this Roi layer (${r}) does not exist`);const i=this._layers[r].roi.find((e=>e.id===t));if(!i)throw new Error(`found no Roi with id ${t}`);return i}getMasks(t={}){let e=this.getRois(t),r=new Array(e.length);for(let i=0;i<e.length;i++)r[i]=e[i].getMask(t);return r}getAnalysisMasks(t={}){const{analysisProperty:e}=t;let r=`${e}Mask`,i=this.getRois(t);return 0!==i.length&&i[0][r]?i.map((t=>t[r])):[]}getData(t={}){let e=Object.assign({},this._options,t);return this._assertLayerWithLabel(e.label),this._layers[e.label].roiMap.data}paint(t={}){let{labelProperty:e,analysisProperty:r}=t;this._painted||(this._painted=this._image.rgba8());let i=this.getMasks(t);if(e){const r=this.getRois(t);t.labels=r.map((t=>Iy(t,e)));const i=Math.max(...t.labels);let n=!1,s=!1;if(e.includes("surface")?n=!0:/(?:perimeter|min|max|external|width|height|length)/.test(e)&&(s=!0),isFinite(i)){let e="";if("pixel"!==t.unit&&t.pixelSize&&(s||n)){e=n?`${t.unit}^2`:t.unit;let r=n?"m^2":"m",i=n?t.pixelSize**2:t.pixelSize;const s=Ly().swiftConverter(r,e);t.labels=t.labels.map((t=>s(i*t)))}t.labels=i>50?t.labels.map((t=>Math.round(t)+e)):i>10?t.labels.map((t=>t.toFixed(1)+e)):t.labels.map((t=>t.toFixed(2)+e))}t.labelsPosition=r.map((t=>[t.meanX,t.meanY]))}if(this._painted.paintMasks(i,t),r){let e=this.getAnalysisMasks(t);this._painted.paintMasks(e,{color:t.analysisColor,alpha:t.analysisAlpha})}return this._painted}getMask(t={}){let e=new pv(this._image.width,this._image.height,{kind:"BINARY"}),r=this.getMasks(t);for(let i=0;i<r.length;i++){let t=r[i];for(let r=0;r<t.width;r++)for(let i=0;i<t.height;i++)t.getBitXY(r,i)&&e.setBitXY(r+t.position[0],i+t.position[1])}return e}resetPainted(t={}){const{image:e}=t;this._painted=e?this.image.rgba8():this._image.rgba8()}mergeRoi(t={}){const e=this.getMap(t);return e.mergeRoi(t),this.putMap(e.data,t),this}mergeRois(t,e={}){if(!Array.isArray(t)||t.some((t=>!Number.isInteger(t))))throw new Error("Roi ids must be an array of integers");if(t.length<2)throw new Error("Roi ids must have at least two elements");if(new Set(t).size!==t.length)throw new Error("Roi ids must be all different");t.forEach((t=>this.getRoi(t)));const r=this.getMap(e);return r.mergeRois(t),this.putMap(r.data,e),this}findCorrespondingRoi(t,e={}){let r=this.getRois(e),i=[];for(let n=0;n<r.length;n++){let e=r[n],s=e.minX,o=e.minY,a=e.points,l=Math.sign(e.id),h=fv(s,o,a,t,l);i.push(h)}return i}_assertLayerWithLabel(t){if(!this._layers[t])throw new Error(`no layer with label ${t}`)}}function fv(t,e,r,i,n){let s={id:[],surface:[],roiSurfaceCovered:[],same:0,opposite:0,total:0};for(let o=0;o<r.length;o++){let n=r[o],a=n[0],l=n[1],h=a+t+(l+e)*i.width,u=i.data[h];(u>0||u<0)&&(s.id.includes(u)?s.surface[s.id.indexOf(u)]+=1:(s.id.push(u),s.surface.push(1)))}for(let o=0;o<s.id.length;o++){let t=Math.sign(s.id[o]);t===n?s.same+=s.surface[o]:s.opposite+=s.surface[o],s.roiSurfaceCovered[o]=s.surface[o]/r.length}return s.total=s.opposite+s.same,s}const dv=Object.prototype.toString;class pv{constructor(t,e,r,i){if(1===arguments.length?(i=t,({width:t,height:e,data:r}=i)):r&&!r.length&&(i=r,({data:r}=i)),void 0===t&&(t=1),void 0===e&&(e=1),void 0===i&&(i={}),"object"!==typeof i||null===i)throw new TypeError("options must be an object");if(!Number.isInteger(t)||t<=0)throw new RangeError("width must be a positive integer");if(!Number.isInteger(e)||e<=0)throw new RangeError("height must be a positive integer");const{kind:n=gd}=i;if("string"!==typeof n)throw new TypeError("kind must be a string");const s=vd(n),o=Object.assign({},i);for(const p in s)void 0===o[p]&&(o[p]=s[p]);kd(o);const{components:a,bitDepth:l,colorModel:h}=o,u=o.alpha+0,c=t*e,f=a+u,d=32===l?Number.MAX_VALUE:2**l-1;if(void 0===r)r=Md(c,a,u,f,l,d);else{const t=_d(c,f,l);if(r.length!==t)throw new RangeError(`incorrect data size: ${r.length}. Should be ${t}`)}this.width=t,this.height=e,this.data=r,this.size=c,this.components=a,this.alpha=u,this.bitDepth=l,this.maxValue=d,this.colorModel=h,this.channels=f,this.meta=i.meta||{},Object.defineProperty(this,"parent",{enumerable:!1,writable:!0,configurable:!0,value:i.parent||null}),this.position=i.position||[0,0],this.computed=null,this.sizes=[this.width,this.height],this.multiplierX=this.channels,this.multiplierY=this.channels*this.width,this.isClamped=this.bitDepth<32,this.borderSizes=[0,0]}get[Symbol.toStringTag](){return"IJSImage"}static isImage(t){return"[object IJSImage]"===dv.call(t)}static fromCanvas(t){const e=t.getContext("2d"),r=e.getImageData(0,0,t.width,t.height);return new pv(r.width,r.height,r.data)}static createFrom(t,e){const r=Hp(t);return Object.assign(r,{parent:t,position:[0,0]},e),new pv(r)}getRoiManager(t){return new cv(this,t)}clone(){const t=this.data.slice();return new pv(this.width,this.height,t,this)}apply(t){for(let e=0;e<this.height;e++)for(let r=0;r<this.width;r++){let i=(e*this.width+r)*this.channels;t.call(this,i)}}}Gp(pv),zs(pv),Gf(pv),pv.prototype.checkProcessable=js,pv.prototype.getRGBAData=nd,pv.load=Bp,pv.extendMethod=Qf,pv.extendProperty=Zf,Ay(pv);var mv=r(94125),gv=r.n(mv);const wv={regression:{kernelType:"polynomial",kernelOptions:{degree:2,constant:1}},threshold:.02,roi:{minSurface:100,positive:!1},sampling:20,include:[]};function bv(t,e,r){e=Object.assign({},wv,e);const i=this.manager;return Array.isArray(t)?Promise.all(t.map((function(t){const n=yv(i,t,e);return"function"===typeof r&&n.then(r),n}))):yv(i,t,e)}function yv(t,e,r){return t.post("data",[e,r]).then((function(t){for(let e in t)t[e]=new pv(t[e]);return t}))}function vv(){worker.on("data",(function(t,e,r){e=new IJS(e);const i={},n=[],s=e.grey(),o=s.sobelFilter();d("sobel",o);const a=o.level().mask({threshold:r.threshold});d("mask",a);const l=o.getRoiManager();l.fromMask(a);const h=l.getMask(r.roi);d("realMask",h);const u=s.getPixelsGrid({sampling:r.sampling,mask:h}),c=e.getBackground(u.xyS,u.zS,r.regression);d("background",c);const f=e.subtract(c);function d(t,e){r.include.includes(t)&&(i[t]=e,n.push(e.data.buffer))}i.result=f,n.push(f.data.buffer),t(i,n)}))}const xv={run:bv,work:vv};var kv=xv;function _v(t){t.extendMethod("background",kv)}class Mv{constructor(){this._url=null,this._deps=[null]}checkUrl(){if(null===this._url)throw new Error("image worker must be initialized with an URL")}get url(){return this._url}set url(t){if("string"!==typeof t)throw new TypeError("worker URL must be a string");this._url=t,this._deps[0]=t}static extendMethod(t,e){let r,i,n={};function s(...t){return r||(this.checkUrl(),i=this.url,r=new(gv())(e.work,{deps:i}),n.manager=r),e.run.call(n,...t)}s.reset=function(){r&&(r.terminate(),r=new(gv())(e.work,{deps:i}),n.manager=r)},Mv.prototype[t]=s}}_v(Mv);new Mv;var Ev=r(9964),Sv=r(77823),Av=r(73288),Cv=r(63084),Lv={emits:["select-file-trigger","close"],props:{Mode:String,AllowFile:Array,CallbackFunc:String,Client:String,Space:Array},data(){const t=xs.A.get("session"),e=t.current,r=(0,Yn.lq)(),i=new ms.S3({forcePathStyle:!1,endpoint:e.s3EndpointDefault,region:e.s3Region,ResponseContentEncoding:"utf-8",credentials:{accessKeyId:e.s3Key,secretAccessKey:e.s3Secret}});return{uploadControllers:new Map,showStreamMenu:!1,layout:"grid",hostkey:this.$Key,searchQuery:"",files:(0,kn.Kh)([]),fileList:[],folderPath:"",prefix:"",objCount:"",S3:i,PageName:r.meta.title,PageIcon:r.meta.icon,showModal:!1,activeBlock:!1,createFolderModal:!1,RenameFolderModal:!1,showFileDetail:!1,showFilePreview:!1,uploadPanel:!1,renameTriggerObj:"",renameTriggerId:"",oldname:"",viewFilename:"",viewFilesize:"",viewFilecover:"",viewFilecreate:"",viewFileurl:"",viewFileDuration:"",viewFileThumbnail:"",modalContent:"",selectFile:void 0,schoolSession:e,session:xs.A.get("session"),configs:xs.A.get("configs"),limitOptions:[1,10,50,100,200,500,1e3,2e3,3e3,4e3],totalPages:0,totalItems:0,dragging:!1,draggedItem:"",dropTarget:"",selectItem:"",selectItemData:"",hasSelected:!1,fileListing:[],summaryFileSize:0,space:5e3,capturedThumbnail:null,limitItem:50,currentPage:1,debounceTimer:null,error:!1,errorText:"",isResizeModalOpen:!1,selectedFileType:"image/webp",selectedImageQuality:.8,selectedQuality:null,showConvertOptions:!1,dropdownOpen:!1,selectedResizeItem:"",selectedResizeId:"",replaceExistingFile:!1,isModalVisible:!1,fileName:"",fileUrl:"",isBatchResizing:!1,batchProgress:0,totalBatchFiles:0,processedFiles:0,fileTypeFilter:"all",showMobileSidebar:!1}},components:{CreateFolder:Rn,RenameFolder:Vn,VideoPlayer:Bs},methods:{toggleDropdown(){this.dropdownOpen=!this.dropdownOpen},selectQuality(t){this.selectedQuality=t,this.dropdownOpen=!1},toggleStreamMenu(){this.showStreamMenu=!this.showStreamMenu},openModal(){this.isModalVisible=!0,this.fileName="",this.fileUrl=""},closeModal(){this.isModalVisible=!1,this.fileName="",this.fileUrl="",this.stopVideoPlayback()},async submitFile(){if(this.fileName&&this.fileUrl){const e={name:this.fileName,original:this.fileUrl,path:this.fileUrl,size:0,mimetype:"media",type:"application/octet-stream"};try{await this.addFile(e),await this.listFile(),this.closeModal()}catch(t){alert("Failed to add streaming file. Please try again."),console.error(t)}}else alert("Please fill in all fields.")},toggleLayout(){this.layout="grid"===this.layout?"list":"grid"},formatDuration(t){const e=parseFloat(t);if(isNaN(e)||e<=0)return"00:00";const r=Math.floor(e/60),i=Math.floor(e%60),n=r.toString().padStart(2,"0"),s=i.toString().padStart(2,"0");return`${n}:${s}`},handleDragStart(t){this.dragging=!0,this.draggedItem=t,Cv.A.log("Dragging started:",this.draggedItem)},handleDragEnd(){this.dragging=!1,this.draggedItem=""},getFileType(t){return Ev.A.getFileType(t,"short")},getNewFileExtension(t){const e=t.split(".");return e.length>1?e[e.length-1]:"default"},calculateDiskUsagePercentage(t){const e=1024*this.space*1024,r=t/e*100,i=Math.min(r,100);return i.toFixed(2)},async handleDrop(t){try{this.dropTarget=t,Cv.A.log("Dropped on:",this.dropTarget),await this.moveFile(this.draggedItem,this.dropTarget)}catch(e){console.error("Error handling drop:",e)}},getFileName(t){const e=t.lastIndexOf(".");return-1===e?t:t.substring(0,e)},getFileExtension(t){const e=t.lastIndexOf(".");return-1===e?"":t.substring(e)},async resizeImageAndReplace(t){try{const e=this.schoolSession.s3Endpoint+t,r=await pv.load(e),i=t.split("/"),n=i.pop(),s=i.join("/")+"/folder_original/"+n,o=await this.S3.send(new bs.s({Bucket:this.schoolSession.s3Bucket,CopySource:this.schoolSession.s3Bucket+"/"+t,Key:s,ACL:"public-read"}));Cv.A.log("Moved original image to folder_original:",o);const a=r.resize({width:1980}),l=await a.toBlob("image/png",1),h=t,u=await this.S3.send(new qn.w({Bucket:this.schoolSession.s3Bucket,Key:h,Body:l,ACL:"public-read"}));Cv.A.log("Resized and replaced image:",u),this.listFile()}catch(e){Cv.A.log("Error resizing and replacing image:",e)}},async batchResizeImages(){try{const e=this.fileListing.filter((t=>{const e=t.name.split(".").pop().toLowerCase();return["jpg","jpeg","png","gif"].includes(e)}));if(0===e.length)return void(0,Sv.A)({type:"info",message:"ไม่พบไฟล์รูปภาพที่จะปรับขนาด"});this.isBatchResizing=!0,this.totalBatchFiles=e.length,this.processedFiles=0,this.batchProgress=0,this.toast=(0,Sv.A)({type:"pending",message:`กำลังปรับขนาดรูปภาพทั้งหมด ${this.totalBatchFiles} ไฟล์...`});for(const r of e)try{const t=(new Date).getTime(),e=await fetch("https://api.apyhub.com/processor/image/metadata/file-urls",{method:"POST",headers:{"Content-Type":"application/json","apy-token":"APY02grbaFd83fKSDc8QtNTdld6dgFG4YDna2AIZYh4QGsE1jPsLQDBwuyM77R21Fq7BsSMHAH"},body:JSON.stringify({url:this.schoolSession.s3Endpoint+r.path})}),i=await e.json();if(!i.data)throw new Error("Failed to get image metadata");const n=i.data.ImageWidth,s=i.data.ImageHeight,o=1920;let a=n,l=s;if(n>o){const t=o/n;a=o,l=Math.round(s*t)}let h=this.schoolSession.s3Endpoint+r.path;if(n>o){const e=await fetch(`https://api.apyhub.com/processor/image/resize/file-urls?output=resized-${t}&width=${a}&height=${l}&auto_orientation=false&preserve_format=true`,{method:"POST",headers:{"Content-Type":"application/json","apy-token":"APY02grbaFd83fKSDc8QtNTdld6dgFG4YDna2AIZYh4QGsE1jPsLQDBwuyM77R21Fq7BsSMHAH"},body:JSON.stringify({url:h})}),r=await e.json();if(!r.data)throw new Error("Resize API did not return expected data");h=r.data}const u=Math.round(100*this.selectedImageQuality),c=await fetch(h),f=await c.blob(),d=new FormData;d.append("image",f,"image.jpg");const p=await fetch(`https://api.apyhub.com/processor/image/compress/file/url?output=final-${t}&compression_percentage=${u}&preserve_format=true`,{method:"POST",headers:{"apy-token":"APY02grbaFd83fKSDc8QtNTdld6dgFG4YDna2AIZYh4QGsE1jPsLQDBwuyM77R21Fq7BsSMHAH"},body:d}),m=await p.json();if(!m.data)throw new Error("Compress API did not return expected data");const g=await fetch(m.data),w=await g.blob(),b=new ps({client:this.S3,params:{Bucket:this.schoolSession.s3Bucket,Key:r.path,Body:w,ACL:"public-read",ContentType:w.type}});await b.done(),await this.resizeFile(r._id,w.size),this.processedFiles++,this.batchProgress=this.processedFiles/this.totalBatchFiles*100}catch(t){console.error(`Error processing image ${r.name}:`,t),(0,Sv.A)({type:"error",message:`เกิดข้อผิดพลาดในการประมวลผลรูป ${r.name}`})}await this.listFile(),this.toast.hide(`ปรับขนาดรูปภาพเสร็จสิ้น ${this.processedFiles} จาก ${this.totalBatchFiles} ไฟล์`,"success")}catch(t){console.error("Batch resize error:",t),this.toast.hide("เกิดข้อผิดพลาดในการประมวลผลรูปภาพ","error")}finally{this.isBatchResizing=!1}},async handleResizeImage(){await this.resizeImage({resize:{enabled:!0,maxWidth:1920},compress:{enabled:!0,quality:this.selectedImageQuality||.9},prompt:{enabled:!1,title:"ยืนยันการปรับแต่งรูปภาพ",message:"การดำเนินการนี้จะแทนที่ไฟล์เดิม คุณต้องการดำเนินการต่อหรือไม่?"}})},async resizeOption(t,e){this.fileToResize={path:t,id:e},this.isResizeModalOpen=!0},async resizeImage(t={resize:{enabled:!0,maxWidth:1920},compress:{enabled:!0,quality:.8},prompt:{enabled:!0,title:"ยืนยันการปรับแต่งรูปภาพ",message:"คุณต้องการดำเนินการต่อหรือไม่?"}}){try{if(t.prompt?.enabled)return new Promise((e=>{Av.A.confirm({title:t.prompt.title,message:t.prompt.message,confirm:async()=>{await this.processImage(t),e()},cancel:()=>{this.isResizeModalOpen=!1,e()}})}));await this.processImage(t)}catch(e){console.error("Error in resizeImage:",e),this.toast.hide("เกิดข้อผิดพลาดในการประมวลผลรูปภาพ","error")}},async processImage(t){try{this.toast=(0,Sv.A)({type:"pending",message:"กำลังปรับขนาดรูปภาพ..."});const e=(new Date).getTime();let r=this.schoolSession.s3Endpoint+this.fileToResize.path,i=null;const n=await fetch("https://api.apyhub.com/processor/image/metadata/file-urls",{method:"POST",headers:{"Content-Type":"application/json","apy-token":"APY02grbaFd83fKSDc8QtNTdld6dgFG4YDna2AIZYh4QGsE1jPsLQDBwuyM77R21Fq7BsSMHAH"},body:JSON.stringify({url:r})}),s=await n.json();if(!s.data)throw new Error("Failed to get image metadata");const o=s.data.ImageWidth,a=s.data.ImageHeight,l=t.resize.maxWidth;let h=o,u=a;if(o>l){const t=l/o;h=l,u=Math.round(a*t)}if(o<=l&&t.resize.enabled&&this.toast.hide("รูปภาพมีขนาดเล็กกว่า "+l+"px อยู่แล้ว จะทำการบีบอัดเท่านั้น","info"),o>l&&t.resize.enabled){const t=await fetch(`https://api.apyhub.com/processor/image/resize/file-urls?output=resized-${e}&width=${h}&height=${u}&auto_orientation=false&preserve_format=true`,{method:"POST",headers:{"Content-Type":"application/json","apy-token":"APY02grbaFd83fKSDc8QtNTdld6dgFG4YDna2AIZYh4QGsE1jPsLQDBwuyM77R21Fq7BsSMHAH"},body:JSON.stringify({url:r})}),i=await t.json();if(!i.data)throw new Error("Resize API did not return expected data");r=i.data}if(t.compress?.enabled){const i=Math.round(100*t.compress.quality),n=await fetch(r),s=await n.blob(),o=new FormData;o.append("image",s,"image.jpg");const a=await fetch(`https://api.apyhub.com/processor/image/compress/file/url?output=final-${e}&compression_percentage=${i}&preserve_format=true`,{method:"POST",headers:{"apy-token":"APY02grbaFd83fKSDc8QtNTdld6dgFG4YDna2AIZYh4QGsE1jPsLQDBwuyM77R21Fq7BsSMHAH"},body:o}),l=await a.json();if(!l.data)throw new Error("Compress API did not return expected data");r=l.data}if(t.resize.enabled||t.compress?.enabled){const t=await fetch(r);i=await t.blob();const e=new ps({client:this.S3,params:{Bucket:this.schoolSession.s3Bucket,Key:this.fileToResize.path,Body:i,ACL:"public-read",ContentType:i.type}});await e.done(),await this.resizeFile(this.fileToResize.id,i.size)}const c=o>l&&t.resize.enabled?`(${o}x${a} -> ${h}x${u})`:"(ขนาดคงเดิม)",f=t.compress?.enabled?`คุณภาพ: ${Math.round(100*t.compress.quality)}%`:"",d=[t.resize.enabled?"ปรับขนาด":"",t.compress?.enabled?"บีบอัด":""].filter(Boolean).join("และ");this.toast.hide(`${d}รูปภาพเสร็จแล้ว ${c} ${f}`,"success"),this.isResizeModalOpen=!1,await this.listFile()}catch(e){console.error("Error processing image:",e),this.toast.hide("เกิดข้อผิดพลาดในการประมวลผลรูปภาพ","error")}},async createThumbnail(t,e){try{const r=t,i=await pv.load(r),n=i.resize({width:200}),s=await n.toBlob("image/jpeg",.2),o=await new Promise((t=>{const e=new FileReader;e.onloadend=()=>{t(e.result)},e.readAsDataURL(s)}));return await this.thumbnailFile(e,o),o}catch(r){return Cv.A.log("Error resizing image:",r),null}},async captureThumbnail(t,e){try{const r=document.createElement("video");r.src=t,r.crossOrigin="anonymous",await r.load(),r.width=640,r.height=360;const i=document.createElement("canvas");i.width=r.width,i.height=r.height;const n=i.getContext("2d");await new Promise((t=>{r.addEventListener("canplay",t)})),r.play();const s=r.duration;await new Promise((t=>setTimeout(t,5e3))),n.drawImage(r,0,0,i.width,i.height),r.pause();const o=i.toDataURL("image/jpeg");this.capturedThumbnail=o,Cv.A.log("Thumbnail Data URL:",o),Cv.A.log("Video Duration:",s),await this.thumbnailFile(e,o,s)}catch(r){Cv.A.log("Error capturing thumbnail:",r)}},async restoreOriginalImage(t){try{const e=t.replace(this.schoolSession.s3Endpoint,""),r=e.split("/"),i=r.pop(),n=r.join("/")+"/folder_original/"+i,s=await this.S3.send(new bs.s({Bucket:this.schoolSession.s3Bucket,CopySource:this.schoolSession.s3Bucket+"/"+n,Key:e,ACL:"public-read"}));Cv.A.log("Restored original image:",s);const o=await this.S3.send(new ys.k({Bucket:this.schoolSession.s3Bucket,Key:n}));Cv.A.log("Deleted original image from folder_original:",o),this.listFile()}catch(e){Cv.A.log("Error restoring original image:",e)}},isAllowedFile(t){const e=t.split(".").pop().toLowerCase();return this.AllowFile.includes(e)},videoStreaming(){const t=this;var e=t.videoContent;const r=this.$refs.videoStreaming;let i=e.split(".").pop();Cv.A.log("tage url",e),Cv.A.log("tage video",r),Cv.A.log("extension video",i);const n={},s=new(ws())(r,n);s.on("timeupdate",(t=>{const e=t.detail.plyr;Cv.A.log(e)}))},formatDate(t){if(!t)return"-";try{const e=new Date(t);return isNaN(e.getTime())?"-":new Intl.DateTimeFormat("th-TH",{dateStyle:"long"}).format(e)}catch(e){return console.warn("Error formatting date:",t,e),"-"}},onDoubleClick(t){const e=this.fileListing.find((e=>e.name===t));if(e)if(console.log("selectedItem",e),"folder"===e.type);else{const t=e.name.split(".").pop();this.viewFilesize=e.size,this.viewFilename=e.name,this.viewFilecover=e.cover,this.viewFilecreate=e.createdAt||e.create||null,this.viewFileurl=e.path,this.viewFileDuration=e.duration,this.viewFileThumbnail=e.thumbnail,this.viewFileextension=t;const r=this.viewFileurl.split(".").pop();["jpg","jpeg","png","gif"].includes(r)?(this.selectedFile=this.viewFileurl,this.modalContent="image",this.showModal=!0):["mp4","ogg","webm"].includes(r)?(console.log(e?.stream),e?.stream&&"ready"!=e?.stream?.streamStatus&&this.pollStreamStatus(this.selectItem,e?.stream?.streamId),this.selectedFile=this.viewFileurl,this.modalContent="video",this.showModal=!0):["pdf"].includes(r)?(this.selectedFile=this.viewFileurl,this.modalContent="pdf",this.showModal=!0):(this.error=!0,this.errorText="ไม่ได้สามารถแสดงตัวอย่างไฟล์ประเภทนี้ได้")}},isImage(t){return null!=t.match(/\.(jpeg|jpg|gif|png)$/)},async listFile(){try{const t=xs.A.get("session");this.fileList=[],this.prefix=t.prefix;let e=[this.session.current._id?{owner:this.session.current._id,parent:this.prefix}:{owner:this.configs.siteID,parent:this.prefix}];const r=[{$match:{$and:e}},{$facet:{totalCount:[{$count:"count"}],folders:[{$match:{mimetype:"folder"}},{$lookup:{from:"storage",let:{folder_path:"$path",owner_id:"$owner"},pipeline:[{$match:{$expr:{$and:[{$eq:["$parent","$$folder_path"]},{$eq:["$owner","$$owner_id"]},{$ne:["$mimetype","folder"]}]}}},{$group:{_id:"$parent",totalSize:{$sum:{$ifNull:["$size",0]}},fileCount:{$sum:1}}},{$project:{_id:0,size:"$totalSize",count:"$fileCount"}}],as:"folderStats"}},{$project:{_id:1,original:1,path:1,name:1,type:1,duration:1,mimetype:1,spaceId:1,createdAt:1,stream:1,transcode:1,size:{$ifNull:[{$arrayElemAt:["$folderStats.size",0]},0]},count:{$ifNull:[{$arrayElemAt:["$folderStats.count",0]},0]}}}],files:[{$match:{mimetype:{$ne:"folder"}}},{$project:{_id:1,original:1,path:1,name:1,type:1,duration:1,mimetype:1,spaceId:1,createdAt:1,stream:1,transcode:1,size:{$ifNull:["$size",0]}}}]}}],i={pipeline:r},{data:n}=await this.$Request.POST("storage/aggregate",i,this.hostkey),s=n[0].folders,o=n[0].files;s.sort(((t,e)=>t.name.localeCompare(e.name,void 0,{numeric:!0,sensitivity:"base"}))),o.sort(((t,e)=>t.name.localeCompare(e.name,void 0,{numeric:!0,sensitivity:"base"}))),this.fileListing=s.concat(o),this.folderPath=this.prefix,""!=this.folderPath&&void 0!=this.folderPath?this.folderPath=this.folderPath.split("/"):this.folderPath="";const a=await this.usageSpace();this.summaryFileSize=a,this.unselectItem()}catch(t){Cv.A.log(t)}},async usageSpace(){try{const t=[{$match:{owner:this.session.current._id||this.configs.siteID}},{$group:{_id:null,totalSize:{$sum:"$size"}}}],e={pipeline:t},{data:r}=await this.$Request.POST("storage/aggregate",e,this.hostkey);return r[0].totalSize}catch(t){Cv.A.log(t)}},async addFile(t){try{this.toast=(0,Sv.A)({type:"pending",message:"กำลังเพิ่มไฟล์"+t.name});const e={data:{owner:this.session.current._id||this.configs.siteID,original:t.original,path:t.path,parent:this.prefix,name:t.name,size:t.size,type:t.mimetype,mimetype:t.type,spaceId:this.session.current.spaceId||this.configs.spaceId},options:{}},{data:r}=await this.$Request.POST("storage/",e,this.hostkey);this.toast.hide("เพิ่มเสร็จแล้ว.","success",300,(()=>r))}catch(e){Cv.A.log(e)}},async assignSpace(t){try{const e={data:{spaceId:this.session.current.spaceId||this.configs.spaceId},options:{}},{status:r}=await this.$Request.PUT(`storage/${t}`,e,this.hostkey);200===r&&await this.listFile()}catch(e){Cv.A.log(e)}},async renameFile(t,e){try{const r={data:{name:e},options:{}},{status:i}=await this.$Request.PUT(`storage/${t}`,r,this.hostkey);200===i&&await this.listFile()}catch(r){Cv.A.log(r)}},async resizeFile(t,e){try{const r={data:{size:e},options:{}},{status:i}=await this.$Request.PUT(`storage/${t}`,r,this.hostkey);200===i&&await this.listFile()}catch(r){Cv.A.log(r)}},async thumbnailFile(t,e,r){try{const i={data:{thumbnail:e,duration:r},options:{}},{status:n}=await this.$Request.PUT(`storage/${t}`,i,this.hostkey);200===n&&await this.listFile()}catch(i){Cv.A.log(i)}},async moveFile(t,e){try{const r={data:{parent:e},options:{}},{status:i}=await this.$Request.PUT(`storage/${t}`,r,this.hostkey);200===i&&await this.listFile()}catch(r){Cv.A.log(r)}},async deleteDocument(t){try{this.toast=(0,Sv.A)({type:"pending",message:"กำลังลบ.."});const{status:e}=await this.$Request.DELETE(`storage/${t}`,null,this.hostkey);200===e&&this.toast.hide("ลบเสร็จแล้ว.","success",300,(async()=>{await this.listFile()}))}catch(e){Cv.A.log(e)}},async renderFileBrowser(){if(xs.A.get("session","login"))try{const e=xs.A.get("session");let r=[];this.rawfileList="",this.fileList=[],this.prefix=e.prefix,await this.listFile();const i=await this.S3.send(new vs.W({Bucket:this.schoolSession.s3Bucket,Prefix:this.prefix}));if(Cv.A.log("Success",i.Contents),void 0!=i.Contents&&null!=i.Contents&&""!=i.Contents){for(let t=0;t<i.Contents.length;t++)r.push(i.Contents[t].Key);this.rawfileList=r.join(),this.objCount=i.Contents.length,Cv.A.log("RAW",this.rawfileList);for(let e=0;e<i.Contents.length;e++){let r,n,s;if(r=""!=this.prefix&&void 0!=this.prefix?i.Contents[e].Key.replace(this.prefix+"/",""):i.Contents[e].Key,n=i.Contents[e].Size,s=i.Contents[e].LastModified,Cv.A.log("contentObj",r),r.includes("/")){var t=r.split("/");const e=t.filter((t=>null!=t&&""!=t));Cv.A.log("length",e.length),Cv.A.log("contentObj",r),1==e.length&&(""!=this.prefix&&void 0!=this.prefix?this.fileList.push({title:r.replace("/",""),prefix:this.prefix+"/"+r.replace("/",""),count:this.countInnerObj(this.rawfileList,r),size:n,create:s,isFolder:!0}):this.fileList.push({title:r.replace("/",""),prefix:r.replace("/",""),count:this.countInnerObj(this.rawfileList,r),size:n,create:s,isFolder:!0}))}else if(r.trim().length){let t,e,i,o=r.replace("/","").substring(r.replace("/","").lastIndexOf(".")+1);"jpg"==o||"jpeg"==o||"JPG"==o||"JPEG"==o||"png"==o||"PNG"==o||"gif"==o||"GIF"==o?(t="image",i="",e=""!=this.prefix&&void 0!=this.prefix?this.schoolSession.s3Endpoint+this.prefix+"/"+r.replace("/",""):this.schoolSession.s3Endpoint+r.replace("/","")):"mp4"==o||"doc"==o||"xls"==o||"pdf"==o?("doc"==o&&(i="file-word"),"xls"==o&&(i="file-spreadsheet"),"pdf"==o&&(i="file-pdf"),"mp4"==o&&(i="file-video"),t="document",e=""):(t="document",e="",i="file"),""!=this.prefix&&void 0!=this.prefix?this.fileList.push({title:r.replace("/",""),prefix:this.prefix+"/"+r.replace("/",""),size:n,type:t,cover:e,icon:i,create:s,isFolder:!1}):this.fileList.push({title:r.replace("/",""),prefix:r.replace("/",""),type:t,icon:i,cover:e,size:n,create:s,isFolder:!1})}}this.fileList.sort((function(t,e){const r=parseInt(t.title,10),i=parseInt(e.title,10);return e.isFolder-t.isFolder||r-i})),this.folderPath=this.prefix,""!=this.folderPath&&void 0!=this.folderPath?this.folderPath=this.folderPath.split("/"):this.folderPath="",Cv.A.log("File List",this.fileList),Cv.A.log("Folder Path",this.folderPath),Cv.A.log("Object Count",this.objCount)}}catch(gl){Cv.A.log("Error",gl)}},unselectItem(){this.selectItem="",this.selectItemData="",this.hasSelected=!1},openViewFile(t){var e=this.fileListing.findIndex((e=>e.name==t));Cv.A.log("item",t+"/"+e),Cv.A.log(this.fileListing[e]),this.selectItem=this.fileListing[e]._id,this.selectItemData=this.fileListing[e],this.hasSelected=!0},openFolder(t){const e=t&&""!==t.trim()?t.trim():"",r={prefix:e};xs.A.update("session",r),this.listFile()},closeViewFile(){this.showFileDetail=!1,this.stopVideoPlayback()},stopVideoPlayback(){const t=this.$refs.videoStreaming;t&&!t.paused&&(t.pause(),t.currentTime=0),this.$refs.videoPlayer&&this.$refs.videoPlayer.pause&&this.$refs.videoPlayer.pause()},countInnerObj(t,e){return t.split(e).length-1},formatBytes(t){var e=1024,r=3,i=e,n=e*e,s=e*e*e;return t<i?t+" Bytes":t<n?(t/i).toFixed(r)+" KB":t<s?(t/n).toFixed(r)+" MB":(t/s).toFixed(r)+" GB"},openCreateFolder(){this.createFolderModal=!0},createFolderTrigger(t){this.createFolderModal=t},async createFolder(t){const e=t.foldername,r=this.fileListing.some((t=>"folder"===t.mimetype&&t.name===e));if(r)return this.error=!0,void(this.errorText=`มีโฟลเดรอ์ '${e}' ในระบบแล้ว.`);let i;i=""!=this.folderPath&&void 0!=this.folderPath?this.prefix+"/"+t.foldername:t.foldername,await this.addFile({parent:this.prefix,path:i,name:t.foldername,size:null,type:"folder"}),this.createFolderModal=!1,this.listFile()},async countFolder(t){try{const e=await this.S3.send(new vs.W({Bucket:this.schoolSession.s3Bucket,Prefix:t}));return Cv.A.log("Success",e),e.Contents.length}catch(e){Cv.A.log(Error)}},openRenameFolder(t,e,r){this.renameTriggerObj=t,this.renameTriggerId=r,this.oldname=e;let i=e.split(".");i.length>1&&i.pop(),this.oldname=i.join(""),this.RenameFolderModal=!0},RenameFolderTrigger(t){this.RenameFolderModal=t},async RenameFolder(t){Cv.A.log("payload",t);const e=t.originalname.split(".");let r=t.foldername;e.length>1&&(r+="."+e.pop()),await this.renameFile(t.originalid,r),this.RenameFolderModal=!1,await this.listFile()},stringToBytes(t){const e=t.length,r=new Uint8Array(e);for(let i=0;i<e;i++){const e=t.charCodeAt(i),n=e>255?32:e;r[i]=n}return r},async deleteFolder(t,e,r){if(r>0)return this.error=!0,this.errorText="ไม่สามารถลบโฟลเดอร์ที่มีไฟล์ภายในได้",void Av.A.prompt({title:"เกิดข้อผิดพลาด",message:"ไม่สามารถลบโฟลเดอร์ที่มีไฟล์ภายในได้ !",confirm:async()=>{},cancel:()=>{}});Av.A.confirm({title:"ต้องการลบโฟลเดอร์นี้?",message:"หลังจากลบแล้วจะไม่สามารถกู้คืนข้อมูลนี้ได้อีก !",confirm:async()=>{try{await this.deleteDocument(e)}catch(t){Cv.A.log(t)}},cancel:()=>{}})},async deleteFile(t,e,r){Av.A.confirm({title:"ต้องการลบไฟล์นี้?",message:"หลังจากลบแล้วจะไม่สามารถกู้คืนข้อมูลนี้ได้อีก !",confirm:async()=>{try{Cv.A.log("file",r),await this.S3.send(new ys.k({Bucket:this.schoolSession.s3Bucket,Key:r})),await this.deleteDocument(e),this.listFile(),this.closeViewFile(),this.showModal=!1}catch(t){Cv.A.log(t)}},cancel:()=>{}})},getFullPath(t){var e=this.folderPath.indexOf(t);return"0"==e?t:this.folderPath.slice(0,e).join("/")+"/"+t},openUploadBox(){this.uploadPanel=!0},closeUploadBox(){this.uploadPanel=!1,this.files=[]},addFiles(){this.$refs.files.click()},slugify(t){t=t.replace(/^\s+|\s+$/g,""),t=t.toLowerCase();for(var e="àáãäâèéëêìíïîòóöôùúüûñç·/_,:;",r="aaaaaeeeeiiiioooouuuunc------",i=0,n=e.length;i<n;i++)t=t.replace(new RegExp(e.charAt(i),"g"),r.charAt(i));return t=t.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),t},async streamFile(t,e){console.log(t,e,this.selectItem);try{const r={url:t,meta:{name:e}},i=await fetch("https://gateway.cloudrestfulapi.com/vdo/copy",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)}),n=await i.json();if(!n.success)throw new Error("Streaming request failed.");Cv.A.log("Stream Response:",n);const{uid:s,thumbnail:o,playback:a,status:l}=n;await this.updateFileStreamingData(this.selectItem,{streamId:s,streamThumbnail:o,streamPlayback:a,streamStatus:l}),Cv.A.log("File updated with streaming data."),this.toast=(0,Sv.A)({type:"success",message:"Streaming request successful!"}),this.pollStreamStatus(this.selectItem,s),this.toast.hide()}catch(r){console.error("Error in streaming request:",r),(0,Sv.A)({type:"error",message:"Failed to start streaming."})}},async updateFileStreamingData(t,e){try{const r={data:{stream:{streamId:e.streamId,streamThumbnail:e.streamThumbnail,streamPlayback:e.streamPlayback,streamStatus:e.streamStatus}},options:{}},{status:i}=await this.$Request.PUT(`storage/${t}`,r,this.hostkey);200===i&&await this.listFile()}catch(r){Cv.A.log(r)}},async pollStreamStatus(t,e,r=10,i=3e4){let n=0;const s=async()=>{if(console.log("checkStatus"),n>=r)Cv.A.log("Max retries reached for stream status check.");else{n++;try{const r=await fetch(`https://gateway.cloudrestfulapi.com/vdo/stream/${e}`,{method:"GET",headers:{"Content-Type":"application/json"}});if(!r.ok)throw new Error("Failed to fetch stream status.");const i=await r.json();if(console.log("checkStatus",i.status),"ready"!=this.selectItemData.stream.streamStatus){console.log("Update");const e={streamId:i.uid,streamThumbnail:i.thumbnail,streamPlayback:i.playback,streamStatus:i.status};return await this.updateFileStreamingData(t,e),await this.listFile(),void Cv.A.log("Stream status updated successfully.")}}catch(o){Cv.A.log("Error fetching stream status:",o)}setTimeout(s,i)}};s()},async deleteStream(t,e){try{const r=confirm("Are you sure you want to delete this stream?");if(!r)return;const i=await fetch(`https://gateway.cloudrestfulapi.com/vdo/stream/${t}`,{method:"DELETE",headers:{"Content-Type":"application/json"}});if(!i.ok)throw new Error("Failed to delete stream.");await this.removeStreamData(e),this.showStreamMenu=!1,alert("Stream deleted successfully.")}catch(r){console.error("Error deleting stream:",r),alert("Failed to delete stream. Please try again.")}},async removeStreamData(t){try{const e={data:{stream:null},options:{}},{status:r}=await this.$Request.PUT(`storage/${t}`,e,this.hostkey);200===r?(await this.listFile(),console.log("Stream data removed successfully.")):console.error("Failed to remove stream data.")}catch(e){console.error("Error removing stream data:",e)}},async submitFiles(){try{if(!this.files.length)throw new Error("กรุณาเลือกไฟล์ที่ต้องการอัพโหลด");const e=new Date,r=e.getFullYear().toString(),i=(e.getMonth()+1).toString().padStart(2,"0");for(let s=0;s<this.files.length;s++){const e=this.files[s];if(e&&0!==e.size){try{const t=e.name.split("."),n=t.pop(),s=(new Date).getTime(),o=String(s),a=`${r}/${i}/`;e.status="uploading",e.progress=0,this.$forceUpdate();const l=new ps({client:this.S3,params:{Bucket:this.schoolSession.s3Bucket,Key:`${a}${o}.${n}`,Body:e,ACL:"public-read",ContentType:e.type},queueSize:4,partSize:5242880,leavePartsOnError:!1});if(this.uploadControllers.set(e.name,l),l.on("httpUploadProgress",(t=>{if("cancelled"===e.status)return;const r=t.loaded||0,i=t.total||e.size,n=Math.round(100*r/i);e.progress=n,this.$forceUpdate(),Cv.A.log(`Upload Progress for ${e.name}: ${n}%`)})),await l.done(),this.uploadControllers.delete(e.name),"cancelled"===e.status)continue;e.status="success",e.progress=100,e.original=`${a}${o}.${n}`;const h={data:{owner:this.session.current._id||this.configs.siteID,original:e.original,path:this.schoolSession.s3Endpoint+e.original,parent:this.prefix,name:e.name,size:e.size,type:this.getFileType(e.type),mimetype:e.type,spaceId:this.session.current.spaceId||this.configs.spaceId},options:{}},u=await this.$Request.POST("storage/",h,this.hostkey);e.type.startsWith("image/")?(await this.createThumbnail(this.schoolSession.s3Endpoint+e.original,u.data._id),this.fileToResize={path:e.original,id:u.data._id}):e.type.startsWith("video/")&&await this.captureThumbnail(this.schoolSession.s3Endpoint+e.original,u.data._id)}catch(t){"AbortError"===t.name?(e.status="cancelled",Cv.A.log(`Upload cancelled for file: ${e.name}`)):(console.error(`Upload Failed for file: ${e.name}`,t),e.status="error",e.progress=0,this.error=!0,this.errorText=`อัพโหลดไฟล์ ${e.name} ไม่สำเร็จ: ${t.message}`),this.uploadControllers.delete(e.name)}this.$forceUpdate()}else console.error(`Error: File is unreadable or empty - ${e?.name||"Unknown file"}`),e.status="error"}const n=this.files.filter((t=>"success"===t.status));n.length>0&&await this.listFile(),this.files=this.files.filter((t=>"pending"===t.status)),0===this.files.length&&(this.uploadPanel=!1),n.length}catch(t){console.error("Submit Files Error:",t),this.toast.hide(t.message,"error"),this.error=!0,this.errorText=t.message}},async cancelUpload(t){const e=this.uploadControllers.get(t);if(e)try{await e.abort(),this.uploadControllers.delete(t);const r=this.files.find((e=>e.name===t));r&&(r.status="cancelled",r.progress=0),this.$forceUpdate()}catch(r){Cv.A.log(`Error cancelling upload for ${t}:`,r)}},handleFilesUpload(){let t=this.$refs.files.files;for(var e=0;e<t.length;e++)t[e].status="pending",this.files.push(t[e]),Cv.A.log("Uploaded file name:",t[e].name);Cv.A.log(this.files)},removeFile(t){this.files.splice(t,1)},selectFileFunc(t,e,r){let i=t.path?t.path:t,n=i.split(".").pop(),s=this.AllowFile,o=this.CallbackFunc,a=s.find((t=>t==n));const l=t.duration||e,h=t.thumbnail||r;if(console.log("found",n),void 0!==a){const t={file:i,duration:l,thumbnail:h,callback:o};Cv.A.log("triggerData",t),this.$emit("select-file-trigger",t),console.log("select-file-trigger",t)}else Cv.A.log("Callback",o)},onContextMenu(t,e,r,i,n){this.selectItem=i,t.preventDefault(),this.$contextmenu({zIndex:99999,x:t.x,y:t.y,items:[{label:e,icon:"fa fa-folder",divided:!0},{label:"เปลี่ยนชื่อโฟลเดอร์",icon:"fa fa-pencil",onClick:()=>(Cv.A.log("Rename",e,i),this.openRenameFolder(e,r,i))},{label:"Assign Space",icon:"fa fa-key",onClick:()=>(Cv.A.log("Rename",e,i),this.assignSpace(i))},{label:"ลบโฟลเดอร์",icon:"fa fa-trash",onClick:()=>(Cv.A.log("Delete",e),this.deleteFolder(e,i,n))}]})},onContextDesktopMenu(t){t.preventDefault(),this.$contextmenu({zIndex:99999,x:t.x,y:t.y,items:[{label:"รีเฟรซ",icon:"fa fa-refresh",onClick:()=>(Cv.A.log("New Upload"),this.listFile())},{label:"อัพโหลดไฟล์ใหม่",icon:"fa fa-upload",onClick:()=>(Cv.A.log("New Upload"),this.openUploadBox())},{label:"สร้างโฟลเดอร์",icon:"fa fa-folder",onClick:()=>(Cv.A.log("New Folder"),this.openCreateFolder())}]})},onFileContextMenu(t,e,r,i,n){Cv.A.log(n),this.selectItem=i,t.preventDefault();const s=[{label:e,icon:"fa fa-file",divided:!0},{label:"เปลี่ยนชื่อ",icon:"fa fa-pencil",onClick:()=>{Cv.A.log("Rename",e,i),this.openRenameFolder(e,r,i)}},{label:"Assign Space",icon:"fa fa-key",onClick:()=>(Cv.A.log("Rename",e,i),this.assignSpace(i))}];s.push({label:"ย่อขนาดรูป",icon:"fa fa-crop",onClick:()=>{Cv.A.log("Select",n),this.resizeOption(n,i)}}),s.push({label:"สร้างรูปหน้าปกวีดีโอ",icon:"fa fa-video",onClick:()=>{Cv.A.log("Video",this.schoolSession.s3Endpoint+n),this.captureThumbnail(this.schoolSession.s3Endpoint+n,i)}}),s.push({label:"ลบไฟล์",icon:"fa fa-trash",onClick:()=>{Cv.A.log("Delete",n),this.deleteFile(e,i,n)}}),this.$contextmenu({zIndex:99999,x:t.x,y:t.y,items:s})},async convertVideo(t){const e=new FormData;e.append("url",t.path),e.append("quality",this.selectedQuality),e.append("site","fti.academy"),e.append("storage",t._id);try{const t=await fetch("https://media.cloudrestfulapi.com/convert",{method:"POST",body:e});if(!t.ok)throw new Error("Failed to convert video");const r=await t.json();console.log("Conversion result:",r)}catch(r){console.error("Error converting video:",r)}},getDocumentIcon(t){const e={pdf:"file-pdf",doc:"file-word",docx:"file-word",xls:"file-excel",xlsx:"file-excel",ppt:"file-powerpoint",pptx:"file-powerpoint",zip:"file-archive",rar:"file-archive","7z":"file-archive",txt:"file-alt",csv:"file-csv",js:"file-code",html:"file-code",htm:"file-code",css:"file-code",xml:"file-code",json:"file-code"};return e[t.toLowerCase()]||"file"},getDocumentIconColor(t){const e={pdf:"text-red-500",doc:"text-blue-500",docx:"text-blue-500",xls:"text-green-500",xlsx:"text-green-500",ppt:"text-purple-500",pptx:"text-purple-500",zip:"text-yellow-500",rar:"text-yellow-500","7z":"text-yellow-500",txt:"text-gray-500",csv:"text-gray-700",js:"text-orange-500",html:"text-orange-500",htm:"text-orange-500",css:"text-blue-400",xml:"text-cyan-500",json:"text-green-400"};return e[t.toLowerCase()]||"text-gray-400"},processPause(){Cv.A.log("Video paused")},toggleMobileSidebar(){this.showMobileSidebar=!this.showMobileSidebar},filterByType(t){this.fileTypeFilter=t},getFilterLabel(t){const e={all:"ไฟล์ทั้งหมด",folder:"โฟลเดอร์",image:"รูปภาพ",media:"วิดีโอ",document:"เอกสาร"};return e[t]||"ไฟล์ทั้งหมด"},getFilterCount(t){return"all"===t?this.fileListing.length:"folder"===t?this.fileListing.filter((t=>"folder"===t.mimetype)).length:this.fileListing.filter((e=>e.type===t)).length},async copyToClipboard(t){try{await navigator.clipboard.writeText(t),(0,Sv.A)({type:"success",message:"คัดลอกลิงก์เรียบร้อยแล้ว"})}catch(e){const r=document.createElement("textarea");r.value=t,document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),(0,Sv.A)({type:"success",message:"คัดลอกลิงก์เรียบร้อยแล้ว"})}}},computed:{imageSource(){let t=this.selectFile.thumbnail||this.selectFile.path;return t},sectionHeight(){const t=window.innerHeight,e=.6,r=t*e+"px";return r},filteredFileList(){const t=this.searchQuery.trim().toLowerCase();return t?this.fileListing.filter((e=>e.name.toLowerCase().includes(t))):this.fileListing},computedDimensions(){return this.viewFileDimensions},dragItemClass(){return this.dragging?"dragging":""},filteredQualities(){return["420p","720p","1080p","1920p"]},displayedFiles(){let t=this.filteredFileList;return"all"!==this.fileTypeFilter&&(t="folder"===this.fileTypeFilter?t.filter((t=>"folder"===t.mimetype)):t.filter((t=>t.type===this.fileTypeFilter))),t}},async mounted(){try{await this.listFile()}catch(t){Cv.A.log(Error)}}},Iv=r(64621);const Dv=(0,Iv.A)(Lv,[["render",xn],["__scopeId","data-v-5f658059"]]);var Rv=Dv},12954:function(t,e){(function(t){"use strict";var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="undefined"!==typeof Uint8Array?Uint8Array:Array,i="+".charCodeAt(0),n="/".charCodeAt(0),s="0".charCodeAt(0),o="a".charCodeAt(0),a="A".charCodeAt(0),l="-".charCodeAt(0),h="_".charCodeAt(0);function u(t){var e=t.charCodeAt(0);return e===i||e===l?62:e===n||e===h?63:e<s?-1:e<s+10?e-s+26+26:e<a+26?e-a:e<o+26?e-o+26:void 0}function c(t){var e,i,n,s,o,a;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var l=t.length;o="="===t.charAt(l-2)?2:"="===t.charAt(l-1)?1:0,a=new r(3*t.length/4-o),n=o>0?t.length-4:t.length;var h=0;function c(t){a[h++]=t}for(e=0,i=0;e<n;e+=4,i+=3)s=u(t.charAt(e))<<18|u(t.charAt(e+1))<<12|u(t.charAt(e+2))<<6|u(t.charAt(e+3)),c((16711680&s)>>16),c((65280&s)>>8),c(255&s);return 2===o?(s=u(t.charAt(e))<<2|u(t.charAt(e+1))>>4,c(255&s)):1===o&&(s=u(t.charAt(e))<<10|u(t.charAt(e+1))<<4|u(t.charAt(e+2))>>2,c(s>>8&255),c(255&s)),a}function f(t){var r,i,n,s=t.length%3,o="";function a(t){return e.charAt(t)}function l(t){return a(t>>18&63)+a(t>>12&63)+a(t>>6&63)+a(63&t)}for(r=0,n=t.length-s;r<n;r+=3)i=(t[r]<<16)+(t[r+1]<<8)+t[r+2],o+=l(i);switch(s){case 1:i=t[t.length-1],o+=a(i>>2),o+=a(i<<4&63),o+="==";break;case 2:i=(t[t.length-2]<<8)+t[t.length-1],o+=a(i>>10),o+=a(i>>4&63),o+=a(i<<2&63),o+="=";break;default:break}return o}t.toByteArray=c,t.fromByteArray=f})(e)},48287:function(t,e,r){"use strict";
/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var i=r(37692),n=r(251),s="function"===typeof Symbol&&"function"===typeof Symbol["for"]?Symbol["for"]("nodejs.util.inspect.custom"):null;e.Buffer=h,e.SlowBuffer=v,e.INSPECT_MAX_BYTES=50;var o=2147483647;function a(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),42===t.foo()}catch(r){return!1}}function l(t){if(t>o)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,h.prototype),e}function h(t,e,r){if("number"===typeof t){if("string"===typeof e)throw new TypeError('The "string" argument must be of type string. Received type number');return d(t)}return u(t,e,r)}function u(t,e,r){if("string"===typeof t)return p(t,e);if(ArrayBuffer.isView(t))return g(t);if(null==t)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Q(t,ArrayBuffer)||t&&Q(t.buffer,ArrayBuffer))return w(t,e,r);if("undefined"!==typeof SharedArrayBuffer&&(Q(t,SharedArrayBuffer)||t&&Q(t.buffer,SharedArrayBuffer)))return w(t,e,r);if("number"===typeof t)throw new TypeError('The "value" argument must not be of type number. Received type number');var i=t.valueOf&&t.valueOf();if(null!=i&&i!==t)return h.from(i,e,r);var n=b(t);if(n)return n;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof t[Symbol.toPrimitive])return h.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}function c(t){if("number"!==typeof t)throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function f(t,e,r){return c(t),t<=0?l(t):void 0!==e?"string"===typeof r?l(t).fill(e,r):l(t).fill(e):l(t)}function d(t){return c(t),l(t<0?0:0|y(t))}function p(t,e){if("string"===typeof e&&""!==e||(e="utf8"),!h.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=0|x(t,e),i=l(r),n=i.write(t,e);return n!==r&&(i=i.slice(0,n)),i}function m(t){for(var e=t.length<0?0:0|y(t.length),r=l(e),i=0;i<e;i+=1)r[i]=255&t[i];return r}function g(t){if(Q(t,Uint8Array)){var e=new Uint8Array(t);return w(e.buffer,e.byteOffset,e.byteLength)}return m(t)}function w(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var i;return i=void 0===e&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,e):new Uint8Array(t,e,r),Object.setPrototypeOf(i,h.prototype),i}function b(t){if(h.isBuffer(t)){var e=0|y(t.length),r=l(e);return 0===r.length||t.copy(r,0,0,e),r}return void 0!==t.length?"number"!==typeof t.length||Z(t.length)?l(0):m(t):"Buffer"===t.type&&Array.isArray(t.data)?m(t.data):void 0}function y(t){if(t>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|t}function v(t){return+t!=t&&(t=0),h.alloc(+t)}function x(t,e){if(h.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Q(t,ArrayBuffer))return t.byteLength;if("string"!==typeof t)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,i=arguments.length>2&&!0===arguments[2];if(!i&&0===r)return 0;for(var n=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return W(t).length;default:if(n)return i?-1:q(t).length;e=(""+e).toLowerCase(),n=!0}}function k(t,e,r){var i=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,e>>>=0,r<=e)return"";t||(t="utf8");while(1)switch(t){case"hex":return U(this,e,r);case"utf8":case"utf-8":return R(this,e,r);case"ascii":return F(this,e,r);case"latin1":case"binary":return B(this,e,r);case"base64":return D(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,r);default:if(i)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),i=!0}}function _(t,e,r){var i=t[e];t[e]=t[r],t[r]=i}function M(t,e,r,i,n){if(0===t.length)return-1;if("string"===typeof r?(i=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,Z(r)&&(r=n?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(n)return-1;r=t.length-1}else if(r<0){if(!n)return-1;r=0}if("string"===typeof e&&(e=h.from(e,i)),h.isBuffer(e))return 0===e.length?-1:E(t,e,r,i,n);if("number"===typeof e)return e&=255,"function"===typeof Uint8Array.prototype.indexOf?n?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):E(t,[e],r,i,n);throw new TypeError("val must be string, number or Buffer")}function E(t,e,r,i,n){var s,o=1,a=t.length,l=e.length;if(void 0!==i&&(i=String(i).toLowerCase(),"ucs2"===i||"ucs-2"===i||"utf16le"===i||"utf-16le"===i)){if(t.length<2||e.length<2)return-1;o=2,a/=2,l/=2,r/=2}function h(t,e){return 1===o?t[e]:t.readUInt16BE(e*o)}if(n){var u=-1;for(s=r;s<a;s++)if(h(t,s)===h(e,-1===u?0:s-u)){if(-1===u&&(u=s),s-u+1===l)return u*o}else-1!==u&&(s-=s-u),u=-1}else for(r+l>a&&(r=a-l),s=r;s>=0;s--){for(var c=!0,f=0;f<l;f++)if(h(t,s+f)!==h(e,f)){c=!1;break}if(c)return s}return-1}function S(t,e,r,i){r=Number(r)||0;var n=t.length-r;i?(i=Number(i),i>n&&(i=n)):i=n;var s=e.length;i>s/2&&(i=s/2);for(var o=0;o<i;++o){var a=parseInt(e.substr(2*o,2),16);if(Z(a))return o;t[r+o]=a}return o}function A(t,e,r,i){return K(q(e,t.length-r),t,r,i)}function C(t,e,r,i){return K(G(e),t,r,i)}function L(t,e,r,i){return K(W(e),t,r,i)}function I(t,e,r,i){return K(H(e,t.length-r),t,r,i)}function D(t,e,r){return 0===e&&r===t.length?i.fromByteArray(t):i.fromByteArray(t.slice(e,r))}function R(t,e,r){r=Math.min(t.length,r);var i=[],n=e;while(n<r){var s,o,a,l,h=t[n],u=null,c=h>239?4:h>223?3:h>191?2:1;if(n+c<=r)switch(c){case 1:h<128&&(u=h);break;case 2:s=t[n+1],128===(192&s)&&(l=(31&h)<<6|63&s,l>127&&(u=l));break;case 3:s=t[n+1],o=t[n+2],128===(192&s)&&128===(192&o)&&(l=(15&h)<<12|(63&s)<<6|63&o,l>2047&&(l<55296||l>57343)&&(u=l));break;case 4:s=t[n+1],o=t[n+2],a=t[n+3],128===(192&s)&&128===(192&o)&&128===(192&a)&&(l=(15&h)<<18|(63&s)<<12|(63&o)<<6|63&a,l>65535&&l<1114112&&(u=l))}null===u?(u=65533,c=1):u>65535&&(u-=65536,i.push(u>>>10&1023|55296),u=56320|1023&u),i.push(u),n+=c}return T(i)}e.kMaxLength=o,h.TYPED_ARRAY_SUPPORT=a(),h.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(h.prototype,"parent",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.buffer}}),Object.defineProperty(h.prototype,"offset",{enumerable:!0,get:function(){if(h.isBuffer(this))return this.byteOffset}}),h.poolSize=8192,h.from=function(t,e,r){return u(t,e,r)},Object.setPrototypeOf(h.prototype,Uint8Array.prototype),Object.setPrototypeOf(h,Uint8Array),h.alloc=function(t,e,r){return f(t,e,r)},h.allocUnsafe=function(t){return d(t)},h.allocUnsafeSlow=function(t){return d(t)},h.isBuffer=function(t){return null!=t&&!0===t._isBuffer&&t!==h.prototype},h.compare=function(t,e){if(Q(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),Q(e,Uint8Array)&&(e=h.from(e,e.offset,e.byteLength)),!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(t===e)return 0;for(var r=t.length,i=e.length,n=0,s=Math.min(r,i);n<s;++n)if(t[n]!==e[n]){r=t[n],i=e[n];break}return r<i?-1:i<r?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!Array.isArray(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var r;if(void 0===e)for(e=0,r=0;r<t.length;++r)e+=t[r].length;var i=h.allocUnsafe(e),n=0;for(r=0;r<t.length;++r){var s=t[r];if(Q(s,Uint8Array))n+s.length>i.length?h.from(s).copy(i,n):Uint8Array.prototype.set.call(i,s,n);else{if(!h.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(i,n)}n+=s.length}return i},h.byteLength=x,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)_(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)_(this,e,e+3),_(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)_(this,e,e+7),_(this,e+1,e+6),_(this,e+2,e+5),_(this,e+3,e+4);return this},h.prototype.toString=function(){var t=this.length;return 0===t?"":0===arguments.length?R(this,0,t):k.apply(this,arguments)},h.prototype.toLocaleString=h.prototype.toString,h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",r=e.INSPECT_MAX_BYTES;return t=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(t+=" ... "),"<Buffer "+t+">"},s&&(h.prototype[s]=h.prototype.inspect),h.prototype.compare=function(t,e,r,i,n){if(Q(t,Uint8Array)&&(t=h.from(t,t.offset,t.byteLength)),!h.isBuffer(t))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof t);if(void 0===e&&(e=0),void 0===r&&(r=t?t.length:0),void 0===i&&(i=0),void 0===n&&(n=this.length),e<0||r>t.length||i<0||n>this.length)throw new RangeError("out of range index");if(i>=n&&e>=r)return 0;if(i>=n)return-1;if(e>=r)return 1;if(e>>>=0,r>>>=0,i>>>=0,n>>>=0,this===t)return 0;for(var s=n-i,o=r-e,a=Math.min(s,o),l=this.slice(i,n),u=t.slice(e,r),c=0;c<a;++c)if(l[c]!==u[c]){s=l[c],o=u[c];break}return s<o?-1:o<s?1:0},h.prototype.includes=function(t,e,r){return-1!==this.indexOf(t,e,r)},h.prototype.indexOf=function(t,e,r){return M(this,t,e,r,!0)},h.prototype.lastIndexOf=function(t,e,r){return M(this,t,e,r,!1)},h.prototype.write=function(t,e,r,i){if(void 0===e)i="utf8",r=this.length,e=0;else if(void 0===r&&"string"===typeof e)i=e,r=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e>>>=0,isFinite(r)?(r>>>=0,void 0===i&&(i="utf8")):(i=r,r=void 0)}var n=this.length-e;if((void 0===r||r>n)&&(r=n),t.length>0&&(r<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return S(this,t,e,r);case"utf8":case"utf-8":return A(this,t,e,r);case"ascii":case"latin1":case"binary":return C(this,t,e,r);case"base64":return L(this,t,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return I(this,t,e,r);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function T(t){var e=t.length;if(e<=P)return String.fromCharCode.apply(String,t);var r="",i=0;while(i<e)r+=String.fromCharCode.apply(String,t.slice(i,i+=P));return r}function F(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(127&t[n]);return i}function B(t,e,r){var i="";r=Math.min(t.length,r);for(var n=e;n<r;++n)i+=String.fromCharCode(t[n]);return i}function U(t,e,r){var i=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>i)&&(r=i);for(var n="",s=e;s<r;++s)n+=J[t[s]];return n}function O(t,e,r){for(var i=t.slice(e,r),n="",s=0;s<i.length-1;s+=2)n+=String.fromCharCode(i[s]+256*i[s+1]);return n}function N(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}function z(t,e,r,i,n,s){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>n||e<s)throw new RangeError('"value" argument is out of bounds');if(r+i>t.length)throw new RangeError("Index out of range")}function j(t,e,r,i,n,s){if(r+i>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function X(t,e,r,i,s){return e=+e,r>>>=0,s||j(t,e,r,4,34028234663852886e22,-34028234663852886e22),n.write(t,e,r,i,23,4),r+4}function $(t,e,r,i,s){return e=+e,r>>>=0,s||j(t,e,r,8,17976931348623157e292,-17976931348623157e292),n.write(t,e,r,i,52,8),r+8}h.prototype.slice=function(t,e){var r=this.length;t=~~t,e=void 0===e?r:~~e,t<0?(t+=r,t<0&&(t=0)):t>r&&(t=r),e<0?(e+=r,e<0&&(e=0)):e>r&&(e=r),e<t&&(e=t);var i=this.subarray(t,e);return Object.setPrototypeOf(i,h.prototype),i},h.prototype.readUintLE=h.prototype.readUIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);var i=this[t],n=1,s=0;while(++s<e&&(n*=256))i+=this[t+s]*n;return i},h.prototype.readUintBE=h.prototype.readUIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);var i=this[t+--e],n=1;while(e>0&&(n*=256))i+=this[t+--e]*n;return i},h.prototype.readUint8=h.prototype.readUInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),this[t]},h.prototype.readUint16LE=h.prototype.readUInt16LE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUint16BE=h.prototype.readUInt16BE=function(t,e){return t>>>=0,e||N(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUint32LE=h.prototype.readUInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUint32BE=h.prototype.readUInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);var i=this[t],n=1,s=0;while(++s<e&&(n*=256))i+=this[t+s]*n;return n*=128,i>=n&&(i-=Math.pow(2,8*e)),i},h.prototype.readIntBE=function(t,e,r){t>>>=0,e>>>=0,r||N(t,e,this.length);var i=e,n=1,s=this[t+--i];while(i>0&&(n*=256))s+=this[t+--i]*n;return n*=128,s>=n&&(s-=Math.pow(2,8*e)),s},h.prototype.readInt8=function(t,e){return t>>>=0,e||N(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){t>>>=0,e||N(t,2,this.length);var r=this[t]|this[t+1]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt16BE=function(t,e){t>>>=0,e||N(t,2,this.length);var r=this[t+1]|this[t]<<8;return 32768&r?4294901760|r:r},h.prototype.readInt32LE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return t>>>=0,e||N(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return t>>>=0,e||N(t,4,this.length),n.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return t>>>=0,e||N(t,4,this.length),n.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return t>>>=0,e||N(t,8,this.length),n.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return t>>>=0,e||N(t,8,this.length),n.read(this,t,!1,52,8)},h.prototype.writeUintLE=h.prototype.writeUIntLE=function(t,e,r,i){if(t=+t,e>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;z(this,t,e,r,n,0)}var s=1,o=0;this[e]=255&t;while(++o<r&&(s*=256))this[e+o]=t/s&255;return e+r},h.prototype.writeUintBE=h.prototype.writeUIntBE=function(t,e,r,i){if(t=+t,e>>>=0,r>>>=0,!i){var n=Math.pow(2,8*r)-1;z(this,t,e,r,n,0)}var s=r-1,o=1;this[e+s]=255&t;while(--s>=0&&(o*=256))this[e+s]=t/o&255;return e+r},h.prototype.writeUint8=h.prototype.writeUInt8=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,1,255,0),this[e]=255&t,e+1},h.prototype.writeUint16LE=h.prototype.writeUInt16LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,65535,0),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeUint16BE=h.prototype.writeUInt16BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,65535,0),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeUint32LE=h.prototype.writeUInt32LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,4294967295,0),this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t,e+4},h.prototype.writeUint32BE=h.prototype.writeUInt32BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,4294967295,0),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeIntLE=function(t,e,r,i){if(t=+t,e>>>=0,!i){var n=Math.pow(2,8*r-1);z(this,t,e,r,n-1,-n)}var s=0,o=1,a=0;this[e]=255&t;while(++s<r&&(o*=256))t<0&&0===a&&0!==this[e+s-1]&&(a=1),this[e+s]=(t/o|0)-a&255;return e+r},h.prototype.writeIntBE=function(t,e,r,i){if(t=+t,e>>>=0,!i){var n=Math.pow(2,8*r-1);z(this,t,e,r,n-1,-n)}var s=r-1,o=1,a=0;this[e+s]=255&t;while(--s>=0&&(o*=256))t<0&&0===a&&0!==this[e+s+1]&&(a=1),this[e+s]=(t/o|0)-a&255;return e+r},h.prototype.writeInt8=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,1,127,-128),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,32767,-32768),this[e]=255&t,this[e+1]=t>>>8,e+2},h.prototype.writeInt16BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,2,32767,-32768),this[e]=t>>>8,this[e+1]=255&t,e+2},h.prototype.writeInt32LE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,2147483647,-2147483648),this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24,e+4},h.prototype.writeInt32BE=function(t,e,r){return t=+t,e>>>=0,r||z(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t,e+4},h.prototype.writeFloatLE=function(t,e,r){return X(this,t,e,!0,r)},h.prototype.writeFloatBE=function(t,e,r){return X(this,t,e,!1,r)},h.prototype.writeDoubleLE=function(t,e,r){return $(this,t,e,!0,r)},h.prototype.writeDoubleBE=function(t,e,r){return $(this,t,e,!1,r)},h.prototype.copy=function(t,e,r,i){if(!h.isBuffer(t))throw new TypeError("argument should be a Buffer");if(r||(r=0),i||0===i||(i=this.length),e>=t.length&&(e=t.length),e||(e=0),i>0&&i<r&&(i=r),i===r)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),t.length-e<i-r&&(i=t.length-e+r);var n=i-r;return this===t&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(e,r,i):Uint8Array.prototype.set.call(t,this.subarray(r,i),e),n},h.prototype.fill=function(t,e,r,i){if("string"===typeof t){if("string"===typeof e?(i=e,e=0,r=this.length):"string"===typeof r&&(i=r,r=this.length),void 0!==i&&"string"!==typeof i)throw new TypeError("encoding must be a string");if("string"===typeof i&&!h.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(1===t.length){var n=t.charCodeAt(0);("utf8"===i&&n<128||"latin1"===i)&&(t=n)}}else"number"===typeof t?t&=255:"boolean"===typeof t&&(t=Number(t));if(e<0||this.length<e||this.length<r)throw new RangeError("Out of range index");if(r<=e)return this;var s;if(e>>>=0,r=void 0===r?this.length:r>>>0,t||(t=0),"number"===typeof t)for(s=e;s<r;++s)this[s]=t;else{var o=h.isBuffer(t)?t:h.from(t,i),a=o.length;if(0===a)throw new TypeError('The value "'+t+'" is invalid for argument "value"');for(s=0;s<r-e;++s)this[s+e]=o[s%a]}return this};var V=/[^+/0-9A-Za-z-_]/g;function Y(t){if(t=t.split("=")[0],t=t.trim().replace(V,""),t.length<2)return"";while(t.length%4!==0)t+="=";return t}function q(t,e){var r;e=e||1/0;for(var i=t.length,n=null,s=[],o=0;o<i;++o){if(r=t.charCodeAt(o),r>55295&&r<57344){if(!n){if(r>56319){(e-=3)>-1&&s.push(239,191,189);continue}if(o+1===i){(e-=3)>-1&&s.push(239,191,189);continue}n=r;continue}if(r<56320){(e-=3)>-1&&s.push(239,191,189),n=r;continue}r=65536+(n-55296<<10|r-56320)}else n&&(e-=3)>-1&&s.push(239,191,189);if(n=null,r<128){if((e-=1)<0)break;s.push(r)}else if(r<2048){if((e-=2)<0)break;s.push(r>>6|192,63&r|128)}else if(r<65536){if((e-=3)<0)break;s.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;s.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return s}function G(t){for(var e=[],r=0;r<t.length;++r)e.push(255&t.charCodeAt(r));return e}function H(t,e){for(var r,i,n,s=[],o=0;o<t.length;++o){if((e-=2)<0)break;r=t.charCodeAt(o),i=r>>8,n=r%256,s.push(n),s.push(i)}return s}function W(t){return i.toByteArray(Y(t))}function K(t,e,r,i){for(var n=0;n<i;++n){if(n+r>=e.length||n>=t.length)break;e[n+r]=t[n]}return n}function Q(t,e){return t instanceof e||null!=t&&null!=t.constructor&&null!=t.constructor.name&&t.constructor.name===e.name}function Z(t){return t!==t}var J=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var i=16*r,n=0;n<16;++n)e[i+n]=t[r]+t[n];return e}()},37692:function(t,e){"use strict";e.byteLength=h,e.toByteArray=c,e.fromByteArray=p;for(var r=[],i=[],n="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,a=s.length;o<a;++o)r[o]=s[o],i[s.charCodeAt(o)]=o;function l(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");-1===r&&(r=e);var i=r===e?0:4-r%4;return[r,i]}function h(t){var e=l(t),r=e[0],i=e[1];return 3*(r+i)/4-i}function u(t,e,r){return 3*(e+r)/4-r}function c(t){var e,r,s=l(t),o=s[0],a=s[1],h=new n(u(t,o,a)),c=0,f=a>0?o-4:o;for(r=0;r<f;r+=4)e=i[t.charCodeAt(r)]<<18|i[t.charCodeAt(r+1)]<<12|i[t.charCodeAt(r+2)]<<6|i[t.charCodeAt(r+3)],h[c++]=e>>16&255,h[c++]=e>>8&255,h[c++]=255&e;return 2===a&&(e=i[t.charCodeAt(r)]<<2|i[t.charCodeAt(r+1)]>>4,h[c++]=255&e),1===a&&(e=i[t.charCodeAt(r)]<<10|i[t.charCodeAt(r+1)]<<4|i[t.charCodeAt(r+2)]>>2,h[c++]=e>>8&255,h[c++]=255&e),h}function f(t){return r[t>>18&63]+r[t>>12&63]+r[t>>6&63]+r[63&t]}function d(t,e,r){for(var i,n=[],s=e;s<r;s+=3)i=(t[s]<<16&16711680)+(t[s+1]<<8&65280)+(255&t[s+2]),n.push(f(i));return n.join("")}function p(t){for(var e,i=t.length,n=i%3,s=[],o=16383,a=0,l=i-n;a<l;a+=o)s.push(d(t,a,a+o>l?l:a+o));return 1===n?(e=t[i-1],s.push(r[e>>2]+r[e<<4&63]+"==")):2===n&&(e=(t[i-2]<<8)+t[i-1],s.push(r[e>>10]+r[e>>4&63]+r[e<<2&63]+"=")),s.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},37007:function(t){"use strict";var e,r="object"===typeof Reflect?Reflect:null,i=r&&"function"===typeof r.apply?r.apply:function(t,e,r){return Function.prototype.apply.call(t,e,r)};function n(t){console&&console.warn&&console.warn(t)}e=r&&"function"===typeof r.ownKeys?r.ownKeys:Object.getOwnPropertySymbols?function(t){return Object.getOwnPropertyNames(t).concat(Object.getOwnPropertySymbols(t))}:function(t){return Object.getOwnPropertyNames(t)};var s=Number.isNaN||function(t){return t!==t};function o(){o.init.call(this)}t.exports=o,t.exports.once=b,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function l(t){if("function"!==typeof t)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}function h(t){return void 0===t._maxListeners?o.defaultMaxListeners:t._maxListeners}function u(t,e,r,i){var s,o,a;if(l(r),o=t._events,void 0===o?(o=t._events=Object.create(null),t._eventsCount=0):(void 0!==o.newListener&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),a=o[e]),void 0===a)a=o[e]=r,++t._eventsCount;else if("function"===typeof a?a=o[e]=i?[r,a]:[a,r]:i?a.unshift(r):a.push(r),s=h(t),s>0&&a.length>s&&!a.warned){a.warned=!0;var u=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");u.name="MaxListenersExceededWarning",u.emitter=t,u.type=e,u.count=a.length,n(u)}return t}function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function f(t,e,r){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},n=c.bind(i);return n.listener=r,i.wrapFn=n,n}function d(t,e,r){var i=t._events;if(void 0===i)return[];var n=i[e];return void 0===n?[]:"function"===typeof n?r?[n.listener||n]:[n]:r?w(n):m(n,n.length)}function p(t){var e=this._events;if(void 0!==e){var r=e[t];if("function"===typeof r)return 1;if(void 0!==r)return r.length}return 0}function m(t,e){for(var r=new Array(e),i=0;i<e;++i)r[i]=t[i];return r}function g(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function w(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function b(t,e){return new Promise((function(r,i){function n(r){t.removeListener(e,s),i(r)}function s(){"function"===typeof t.removeListener&&t.removeListener("error",n),r([].slice.call(arguments))}v(t,e,s,{once:!0}),"error"!==e&&y(t,n,{once:!0})}))}function y(t,e,r){"function"===typeof t.on&&v(t,"error",e,r)}function v(t,e,r,i){if("function"===typeof t.on)i.once?t.once(e,r):t.on(e,r);else{if("function"!==typeof t.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t);t.addEventListener(e,(function n(s){i.once&&t.removeEventListener(e,n),r(s)}))}}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");a=t}}),o.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(t){if("number"!==typeof t||t<0||s(t))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+t+".");return this._maxListeners=t,this},o.prototype.getMaxListeners=function(){return h(this)},o.prototype.emit=function(t){for(var e=[],r=1;r<arguments.length;r++)e.push(arguments[r]);var n="error"===t,s=this._events;if(void 0!==s)n=n&&void 0===s.error;else if(!n)return!1;if(n){var o;if(e.length>0&&(o=e[0]),o instanceof Error)throw o;var a=new Error("Unhandled error."+(o?" ("+o.message+")":""));throw a.context=o,a}var l=s[t];if(void 0===l)return!1;if("function"===typeof l)i(l,this,e);else{var h=l.length,u=m(l,h);for(r=0;r<h;++r)i(u[r],this,e)}return!0},o.prototype.addListener=function(t,e){return u(this,t,e,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(t,e){return u(this,t,e,!0)},o.prototype.once=function(t,e){return l(e),this.on(t,f(this,t,e)),this},o.prototype.prependOnceListener=function(t,e){return l(e),this.prependListener(t,f(this,t,e)),this},o.prototype.removeListener=function(t,e){var r,i,n,s,o;if(l(e),i=this._events,void 0===i)return this;if(r=i[t],void 0===r)return this;if(r===e||r.listener===e)0===--this._eventsCount?this._events=Object.create(null):(delete i[t],i.removeListener&&this.emit("removeListener",t,r.listener||e));else if("function"!==typeof r){for(n=-1,s=r.length-1;s>=0;s--)if(r[s]===e||r[s].listener===e){o=r[s].listener,n=s;break}if(n<0)return this;0===n?r.shift():g(r,n),1===r.length&&(i[t]=r[0]),void 0!==i.removeListener&&this.emit("removeListener",t,o||e)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(t){var e,r,i;if(r=this._events,void 0===r)return this;if(void 0===r.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==r[t]&&(0===--this._eventsCount?this._events=Object.create(null):delete r[t]),this;if(0===arguments.length){var n,s=Object.keys(r);for(i=0;i<s.length;++i)n=s[i],"removeListener"!==n&&this.removeAllListeners(n);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(e=r[t],"function"===typeof e)this.removeListener(t,e);else if(void 0!==e)for(i=e.length-1;i>=0;i--)this.removeListener(t,e[i]);return this},o.prototype.listeners=function(t){return d(this,t,!0)},o.prototype.rawListeners=function(t){return d(this,t,!1)},o.listenerCount=function(t,e){return"function"===typeof t.listenerCount?t.listenerCount(e):p.call(t,e)},o.prototype.listenerCount=p,o.prototype.eventNames=function(){return this._eventsCount>0?e(this._events):[]}},82743:function(t,e,r){"use strict";const{IOBuffer:i}=r(18851),n=r(41581),s=[];for(let a=0;a<=8;a++)s.push(255<<a);class o extends i{constructor(t){if(1!==t.bitDepth)throw new Error("Only bitDepth of 1 is supported");if(!t.height||!t.width)throw new Error("ImageData width and height are required");super(t.data),this.width=t.width,this.height=t.height,this.bitDepth=t.bitDepth,this.channels=t.channels,this.components=t.components}encode(){this.encoded=new i,this.encoded.skip(14),this.writeBitmapV5Header(),this.writeColorTable();const t=this.encoded.offset;return this.writePixelArray(),this.encoded.rewind(),this.writeBitmapFileHeader(t),this.encoded.toArray()}writePixelArray(){let t=this.encoded;const e=4*Math.floor((this.bitDepth*this.width+31)/32),r=Math.ceil(this.bitDepth*this.width/8),i=e-r,n=this.bitDepth*this.width%8,o=0===n?0:8-n,a=e*this.height;let l,h,u=0,c=0,f=8;t.mark(),h=this.readUint8();for(let d=this.height-1;d>=0;d--){const a=0===d;t.reset(),t.skip(d*e);for(let e=0;e<r;e++){const d=e===r-1;c<=o&&d?(t.writeByte(h<<c),0!==o&&o!==c||a||(l=h,h=this.readByte())):0===c?(l=h,h=this.readUint8(),t.writeByte(l)):(l=h,h=this.readUint8(),t.writeByte(l<<c&s[c]|h>>f)),d&&(u+=n||0,t.skip(i),c=u%8,f=8-c)}}e>r&&(t.reset(),t.skip(a-1),t.writeUint8(0))}writeColorTable(){this.encoded.writeUint32(0).writeUint32(16777215)}writeBitmapFileHeader(t){this.encoded.writeChars("BM").writeInt32(this.encoded.lastWrittenByte).writeUint16(0).writeUint16(0).writeUint32(t)}writeBitmapV5Header(){const t=4*Math.floor((this.bitDepth*this.width+31)/32),e=t*this.height;this.encoded.writeUint32(124).writeInt32(this.width).writeInt32(this.height).writeUint16(1).writeUint16(this.bitDepth).writeUint32(n.BITMAPV5HEADER.Compression.BI_RGB).writeUint32(e).writeInt32(0).writeInt32(0).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(Math.pow(2,this.bitDepth)).writeUint32(4278190080).writeUint32(16711680).writeUint32(65280).writeUint32(255).writeUint32(n.BITMAPV5HEADER.LogicalColorSpace.LCS_sRGB).skip(36).skip(12).writeUint32(n.BITMAPV5HEADER.GamutMappingIntent.LCS_GM_IMAGES).skip(12)}}t.exports=o},41581:function(t){"use strict";t.exports={BITMAPV5HEADER:{LogicalColorSpace:{LCS_CALIBRATED_RGB:0,LCS_sRGB:1934772034,LCS_WINDOWS_COLOR_SPACE:1466527264},Compression:{BI_RGB:0,BI_RLE8:1,BI_RLE4:2,BI_BITFIELDS:3,BI_JPEG:4,BI_PNG:5,BI_CMYK:11,BI_CMYKRLE8:12,BI_CMYKRLE4:13},GamutMappingIntent:{LCS_GM_ABS_COLORIMETRIC:8,LCS_GM_BUSINESS:1,LCS_GM_GRAPHICS:2,LCS_GM_IMAGES:4}}}},41176:function(t,e,r){"use strict";const i=r(82743);e.l=function(t){const e=new i(t);return e.encode()}},546:function(t){"use strict";const e=8192,r=[];class i{constructor(t,r){r=r||{},void 0===t&&(t=e),"number"===typeof t&&(t=new ArrayBuffer(t));let i=t.byteLength;const n=r.offset?r.offset>>>0:0;t.buffer&&(i=t.byteLength-n,t=t.byteLength!==t.buffer.byteLength?t.buffer.slice(t.byteOffset+n,t.byteOffset+t.byteLength):n?t.buffer.slice(n):t.buffer),this.buffer=t,this.length=i,this.byteLength=i,this.byteOffset=0,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer),this._increment=i||e,this._mark=0}available(t){return void 0===t&&(t=1),this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){this.littleEndian=!0}isBigEndian(){return!this.littleEndian}setBigEndian(){this.littleEndian=!1}skip(t){void 0===t&&(t=1),this.offset+=t}seek(t){this.offset=t}mark(){this._mark=this.offset}reset(){this.offset=this._mark}rewind(){this.offset=0}ensureAvailable(t){if(void 0===t&&(t=1),!this.available(t)){const t=this._increment+this._increment;this._increment=t;const e=this.length+t,r=new Uint8Array(e);r.set(new Uint8Array(this.buffer)),this.buffer=r.buffer,this.length=e,this._data=new DataView(this.buffer)}}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t){void 0===t&&(t=1);for(var e=new Uint8Array(t),r=0;r<t;r++)e[r]=this.readByte();return e}readInt16(){var t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){var t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){var t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){var t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){var t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){var t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t){void 0===t&&(t=1),r.length=t;for(var e=0;e<t;e++)r[e]=this.readChar();return r.join("")}writeBoolean(t){this.writeUint8(t?255:0)}writeInt8(t){this.ensureAvailable(1),this._data.setInt8(this.offset++,t)}writeUint8(t){this.ensureAvailable(1),this._data.setUint8(this.offset++,t)}writeByte(t){this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(var e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e])}writeInt16(t){this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2}writeUint16(t){this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2}writeInt32(t){this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4}writeUint32(t){this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat32(t){this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4}writeFloat64(t){this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8}writeChar(t){this.writeUint8(t.charCodeAt(0))}writeChars(t){for(var e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e))}toArray(){return new Uint8Array(this.buffer,0,this.offset)}}t.exports=i},88070:function(t,e,r){"use strict";const i=r(42207);t.exports=function(t,e){const r=new i(t,e);return r.decode(e)}},98203:function(t,e,r){"use strict";const i={standard:r(13653),exif:r(47730),gps:r(88598)};class n{constructor(t){if(!t)throw new Error("missing kind");this.data=null,this.fields=new Map,this.kind=t,this._map=null}get(t){if("number"===typeof t)return this.fields.get(t);if("string"===typeof t)return this.fields.get(i[this.kind].tagsByName[t]);throw new Error("expected a number or string")}get map(){if(!this._map){this._map={};const e=i[this.kind].tagsById;for(var t of this.fields.keys())e[t]&&(this._map[e[t]]=this.fields.get(t))}return this._map}}t.exports=n},87254:function(t,e){"use strict";var r=new Map([[1,[1,i]],[2,[1,n]],[3,[2,s]],[4,[4,o]],[5,[8,a]],[6,[1,l]],[7,[1,i]],[8,[2,h]],[9,[4,u]],[10,[8,c]],[11,[4,f]],[12,[8,d]]]);function i(t,e){if(1===e)return t.readUint8();for(var r=new Uint8Array(e),i=0;i<e;i++)r[i]=t.readUint8();return r}function n(t,e){for(var r=[],i="",n=0;n<e;n++){var s=String.fromCharCode(t.readUint8());"\0"===s?(r.push(i),i=""):i+=s}return 1===r.length?r[0]:r}function s(t,e){if(1===e)return t.readUint16();for(var r=new Uint16Array(e),i=0;i<e;i++)r[i]=t.readUint16();return r}function o(t,e){if(1===e)return t.readUint32();for(var r=new Uint32Array(e),i=0;i<e;i++)r[i]=t.readUint32();return r}function a(t,e){if(1===e)return t.readUint32()/t.readUint32();for(var r=new Array(e),i=0;i<e;i++)r[i]=t.readUint32()/t.readUint32();return r}function l(t,e){if(1===e)return t.readInt8();for(var r=new Int8Array(e),i=0;i<e;i++)r[i]=t.readInt8();return r}function h(t,e){if(1===e)return t.readInt16();for(var r=new Int16Array(e),i=0;i<e;i++)r[i]=t.readInt16();return r}function u(t,e){if(1===e)return t.readInt32();for(var r=new Int32Array(e),i=0;i<e;i++)r[i]=t.readInt32();return r}function c(t,e){if(1===e)return t.readInt32()/t.readInt32();for(var r=new Array(e),i=0;i<e;i++)r[i]=t.readInt32()/t.readInt32();return r}function f(t,e){if(1===e)return t.readFloat32();for(var r=new Float32Array(e),i=0;i<e;i++)r[i]=t.readFloat32();return r}function d(t,e){if(1===e)return t.readFloat64();for(var r=new Float64Array(e),i=0;i<e;i++)r[i]=t.readFloat64();return r}e.getByteLength=function(t,e){return r.get(t)[0]*e},e.readData=function(t,e,i){return r.get(e)[1](t,i)}},24762:function(t,e,r){"use strict";e.decode=r(88070)},47730:function(t){"use strict";const e={33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",34864:"SensitivityType",34865:"StandardOutputSensitivity",34866:"RecommendedExposureIndex",34867:"ISOSpeed",34868:"ISOSpeedLatitudeyyy",34869:"ISOSpeedLatitudezzz",36864:"ExifVersion",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBiasValue",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37386:"FocalLength",37396:"SubjectArea",37500:"MakerNote",37510:"UserComment",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",40964:"RelatedSoundFile",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRatio",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",42016:"ImageUniqueID",42032:"CameraOwnerName",42033:"BodySerialNumber",42034:"LensSpecification",42035:"LensMake",42036:"LensModel",42037:"LensSerialNumber",42240:"Gamma"},r={};for(var i in e)r[e[i]]=i;t.exports={tagsById:e,tagsByName:r}},88598:function(t){"use strict";const e={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential",31:"GPSHPositioningError"},r={};for(var i in e)r[e[i]]=i;t.exports={tagsById:e,tagsByName:r}},13653:function(t){"use strict";const e={254:"NewSubfileType",255:"SubfileType",256:"ImageWidth",257:"ImageLength",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",263:"Threshholding",264:"CellWidth",265:"CellLength",266:"FillOrder",270:"ImageDescription",271:"Make",272:"Model",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",280:"MinSampleValue",281:"MaxSampleValue",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",288:"FreeOffsets",289:"FreeByteCounts",290:"GrayResponseUnit",291:"GrayResponseCurve",296:"ResolutionUnit",305:"Software",306:"DateTime",315:"Artist",316:"HostComputer",320:"ColorMap",338:"ExtraSamples",33432:"Copyright",269:"DocumentName",285:"PageName",286:"XPosition",287:"YPosition",292:"T4Options",293:"T6Options",297:"PageNumber",301:"TransferFunction",317:"Predictor",318:"WhitePoint",319:"PrimaryChromaticities",321:"HalftoneHints",322:"TileWidth",323:"TileLength",324:"TileOffsets",325:"TileByteCounts",326:"BadFaxLines",327:"CleanFaxData",328:"ConsecutiveBadFaxLines",330:"SubIFDs",332:"InkSet",333:"InkNames",334:"NumberOfInks",336:"DotRange",337:"TargetPrinter",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",342:"TransferRange",343:"ClipPath",344:"XClipPathUnits",345:"YClipPathUnits",346:"Indexed",347:"JPEGTables",351:"OPIProxy",400:"GlobalParametersIFD",401:"ProfileType",402:"FaxProfile",403:"CodingMethods",404:"VersionYear",405:"ModeNumber",433:"Decode",434:"DefaultImageColor",512:"JPEGProc",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",515:"JPEGRestartInterval",517:"JPEGLosslessPredictors",518:"JPEGPointTransforms",519:"JPEGQTables",520:"JPEGDCTables",521:"JPEGACTables",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite",559:"StripRowCounts",700:"XMP",32781:"ImageID",34732:"ImageLayer",32932:"WangAnnotatio",33445:"MDFileTag",33446:"MDScalePixel",33447:"MDColorTable",33448:"MDLabName",33449:"MDSampleInfo",33450:"MDPrepDate",33451:"MDPrepTime",33452:"MDFileUnits",33550:"ModelPixelScaleTag",33723:"IPTC",33918:"INGRPacketDataTag",33919:"INGRFlagRegisters",33920:"IrasBTransformationMatrix",33922:"ModelTiepointTag",34264:"ModelTransformationTag",34377:"Photoshop",34665:"ExifIFD",34675:"ICCProfile",34735:"GeoKeyDirectoryTag",34736:"GeoDoubleParamsTag",34737:"GeoAsciiParamsTag",34853:"GPSIFD",34908:"HylaFAXFaxRecvParams",34909:"HylaFAXFaxSubAddress",34910:"HylaFAXFaxRecvTime",37724:"ImageSourceData",40965:"InteroperabilityIFD",42112:"GDAL_METADATA",42113:"GDAL_NODATA",50215:"OceScanjobDescription",50216:"OceApplicationSelector",50217:"OceIdentificationNumber",50218:"OceImageLogicCharacteristics",50706:"DNGVersion",50707:"DNGBackwardVersion",50708:"UniqueCameraModel",50709:"LocalizedCameraModel",50710:"CFAPlaneColor",50711:"CFALayout",50712:"LinearizationTable",50713:"BlackLevelRepeatDim",50714:"BlackLevel",50715:"BlackLevelDeltaH",50716:"BlackLevelDeltaV",50717:"WhiteLevel",50718:"DefaultScale",50719:"DefaultCropOrigin",50720:"DefaultCropSize",50721:"ColorMatrix1",50722:"ColorMatrix2",50723:"CameraCalibration1",50724:"CameraCalibration2",50725:"ReductionMatrix1",50726:"ReductionMatrix2",50727:"AnalogBalance",50728:"AsShotNeutral",50729:"AsShotWhiteXY",50730:"BaselineExposure",50731:"BaselineNoise",50732:"BaselineSharpness",50733:"BayerGreenSplit",50734:"LinearResponseLimit",50735:"CameraSerialNumber",50736:"LensInfo",50737:"ChromaBlurRadius",50738:"AntiAliasStrength",50740:"DNGPrivateData",50741:"MakerNoteSafety",50778:"CalibrationIlluminant1",50779:"CalibrationIlluminant2",50780:"BestQualityScale",50784:"AliasLayerMetadata"},r={};for(var i in e)r[e[i]]=i;t.exports={tagsById:e,tagsByName:r}},42207:function(t,e,r){"use strict";const i=r(546),n=r(98203),s=r(70762),o=r(87254),a={ignoreImageData:!1,onlyFirst:!1};class l extends i{constructor(t,e){super(t,e),this._nextIFD=0}decode(t){t=Object.assign({},a,t);const e=[];this.decodeHeader();while(this._nextIFD)if(e.push(this.decodeIFD(t)),t.onlyFirst)return e[0];return e}decodeHeader(){let t=this.readUint16();if(18761===t)this.setLittleEndian();else{if(19789!==t)throw new Error("invalid byte order: 0x"+t.toString(16));this.setBigEndian()}if(t=this.readUint16(),42!==t)throw new Error("not a TIFF file");this._nextIFD=this.readUint32()}decodeIFD(t){var e;this.seek(this._nextIFD),e=t.kind?new n(t.kind):new s;const r=this.readUint16();for(var i=0;i<r;i++)this.decodeIFDEntry(e);return t.ignoreImageData||this.decodeImageData(e),this._nextIFD=this.readUint32(),e}decodeIFDEntry(t){const e=this.offset,r=this.readUint16(),i=this.readUint16(),n=this.readUint32();if(i<1||i>12)return void this.skip(4);const s=o.getByteLength(i,n);s>4&&this.seek(this.readUint32());const a=o.readData(this,i,n);if(t.fields.set(r,a),34665===r||34853===r){let e,i=this.offset;34665===r?e="exif":34853===r&&(e="gps"),this._nextIFD=a,t[e]=this.decodeIFD({kind:e,ignoreImageData:!0}),this.offset=i}this.seek(e),this.skip(12)}decodeImageData(t){const e=t.orientation;switch(e&&1!==e&&d("orientation",e),t.type){case 1:case 2:this.readStripData(t);break;default:d("image type",t.type);break}}readStripData(t){const e=t.width,r=t.height,i=p(t.bitsPerSample),n=t.sampleFormat;let s=e*r;const o=h(s,1,i,n),a=t.compression,l=t.rowsPerStrip,m=l*e,g=t.stripOffsets,w=t.stripByteCounts;for(var b=0,y=0;y<g.length;y++){var v=this.getStripData(a,g[y],w[y]),x=s>m?m:s;s-=x,8===i?b=u(o,v,b,x):16===i?b=c(o,v,b,x,this.isLittleEndian()):32===i&&3===n?b=f(o,v,b,x,this.isLittleEndian()):d("bitDepth",i)}t.data=o}getStripData(t,e,r){switch(t){case 1:return new DataView(this.buffer,e,r);case 2:case 32773:return d("Compression",t);default:throw new Error("invalid compression: "+t)}}}function h(t,e,r,i){return 8===r?new Uint8Array(t*e):16===r?new Uint16Array(t*e):32===r&&3===i?new Float32Array(t*e):d("bit depth / sample format",r+" / "+i)}function u(t,e,r,i){for(var n=0;n<i;n++)t[r++]=e.getUint8(n);return r}function c(t,e,r,i,n){for(var s=0;s<2*i;s+=2)t[r++]=e.getUint16(s,n);return r}function f(t,e,r,i,n){for(var s=0;s<4*i;s+=4)t[r++]=e.getFloat32(s,n);return r}function d(t,e){throw new Error("Unsupported "+t+": "+e)}function p(t){if(t.length){const r=t;t=r[0];for(var e=0;e<r.length;e++)r[e]!==t&&d("bit depth",r)}return t}t.exports=l},70762:function(t,e,r){"use strict";const i=r(98203),n=/^(\d{4}):(\d{2}):(\d{2}) (\d{2}):(\d{2}):(\d{2})$/;class s extends i{constructor(){super("standard")}get size(){return this.width*this.height}get width(){return this.imageWidth}get height(){return this.imageLength}get components(){return this.samplesPerPixel}get date(){var t=new Date,e=n.exec(this.dateTime);return t.setFullYear(e[1],e[2]-1,e[3]),t.setHours(e[4],e[5],e[6]),t}get newSubfileType(){return this.get(254)}get imageWidth(){return this.get(256)}get imageLength(){return this.get(257)}get bitsPerSample(){return this.get(258)}get compression(){return this.get(259)||1}get type(){return this.get(262)}get fillOrder(){return this.get(266)||1}get documentName(){return this.get(269)}get imageDescription(){return this.get(270)}get stripOffsets(){return o(this.get(273))}get orientation(){return this.get(274)}get samplesPerPixel(){return this.get(277)}get rowsPerStrip(){return this.get(278)}get stripByteCounts(){return o(this.get(279))}get minSampleValue(){return this.get(280)||0}get maxSampleValue(){return this.get(281)||Math.pow(2,this.bitsPerSample)-1}get xResolution(){return this.get(282)}get yResolution(){return this.get(283)}get planarConfiguration(){return this.get(284)||1}get resolutionUnit(){return this.get(296)||2}get dateTime(){return this.get(306)}get predictor(){return this.get(317)||1}get sampleFormat(){return this.get(339)||1}get sMinSampleValue(){return this.get(340)||this.minSampleValue}get sMaxSampleValue(){return this.get(341)||this.maxSampleValue}}function o(t){return"number"===typeof t?[t]:t}t.exports=s},26135:function(t,e,r){"use strict";const i=r(546),n=r(24762);function s(t){const e=new i(t),r={};e.setBigEndian();const s=e.readUint16();if(65496!==s)throw new Error("SOI marker not found. Not a valid JPEG file");const o=e.readUint16();if(65505===o){e.readUint16();const t=e.readBytes(6);if(69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]&&0===t[4]&&0===t[5]){const t=n.decode(e,{onlyFirst:!0,ignoreImageData:!0,offset:e.offset});r.exif=t}}return r}t.exports=s},93773:function(t,e,r){"use strict";e.decode=r(26135)},55531:function(t){(function(){function e(t,e,r){this.next=r,r&&(r.prev=this),this.prev=e,e&&(e.next=this),this.data=t}function r(){if(!(this instanceof r))return new r;this._head=null,this._tail=null,this.length=0}r.prototype={push:function(t){this._tail=new e(t,this._tail,null),this._head||(this._head=this._tail),this.length++},pop:function(){if(0!==this.length){var t=this._tail;return this._tail=t.prev,t.prev&&(t.prev=this._tail.next=null),this.length--,1===this.length?this._head=this._tail:0===this.length&&(this._head=this._tail=null),t.data}},unshift:function(t){this._head=new e(t,null,this._head),this._tail||(this._tail=this._head),this.length++},shift:function(){if(0!==this.length){var t=this._head;return this._head=t.next,t.next&&(t.next=this._head.prev=null),this.length--,1===this.length?this._tail=this._head:0===this.length&&(this._head=this._tail=null),t.data}},item:function(t){t<0&&(t=this.length+t);var e=this._head;while(t-- >0&&e)e=e.next;return e?e.data:void 0},slice:function(t,e){if(t||(t=0),e||(e=this.length),e<0&&(e=this.length+e),t<0&&(t=this.length+t),e===t)return[];if(e<t)throw new Error("invalid offset: "+t+","+e+" (length="+this.length+")");var r=e-t,i=new Array(r),n=0,s=this._head;while(t-- >0&&s)s=s.next;while(n<r&&s)i[n++]=s.data,s=s.next;return i},drop:function(){r.call(this)},forEach:function(t,e){var r=this._head,i=0,n=this.length;while(i<n&&r)t.call(e||this,r.data,i,this),r=r.next,i++},map:function(t,e){var i=new r;return this.forEach((function(r,n,s){i.push(t.call(e||s,r,n,s))})),i},filter:function(t,e){var i=new r;return this.forEach((function(r,n,s){t.call(e||s,r,n,s)&&i.push(r)})),i},reduce:function(t,e,r){var i=0,n=this._head,s=this.length;e||(i=1,e=n&&n.data,n=n&&n.next);while(i<s&&n)e=t.call(r||this,e,n.data,this),i++,n=n.next;return e}},t.exports=r})()},9304:function(t){"use strict";function e(t){if(this.size=0|t,this.size<=1||0!==(this.size&this.size-1))throw new Error("FFT size must be a power of two and bigger than 1");this._csize=t<<1;for(var e=new Array(2*this.size),r=0;r<e.length;r+=2){const t=Math.PI*r/this.size;e[r]=Math.cos(t),e[r+1]=-Math.sin(t)}this.table=e;for(var i=0,n=1;this.size>n;n<<=1)i++;this._width=i%2===0?i-1:i,this._bitrev=new Array(1<<this._width);for(var s=0;s<this._bitrev.length;s++){this._bitrev[s]=0;for(var o=0;o<this._width;o+=2){var a=this._width-o-2;this._bitrev[s]|=(s>>>o&3)<<a}}this._out=null,this._data=null,this._inv=0}t.exports=e,e.prototype.fromComplexArray=function(t,e){for(var r=e||new Array(t.length>>>1),i=0;i<t.length;i+=2)r[i>>>1]=t[i];return r},e.prototype.createComplexArray=function(){const t=new Array(this._csize);for(var e=0;e<t.length;e++)t[e]=0;return t},e.prototype.toComplexArray=function(t,e){for(var r=e||this.createComplexArray(),i=0;i<r.length;i+=2)r[i]=t[i>>>1],r[i+1]=0;return r},e.prototype.completeSpectrum=function(t){for(var e=this._csize,r=e>>>1,i=2;i<r;i+=2)t[e-i]=t[i],t[e-i+1]=-t[i+1]},e.prototype.transform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._transform4(),this._out=null,this._data=null},e.prototype.realTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=0,this._realTransform4(),this._out=null,this._data=null},e.prototype.inverseTransform=function(t,e){if(t===e)throw new Error("Input and output buffers must be different");this._out=t,this._data=e,this._inv=1,this._transform4();for(var r=0;r<t.length;r++)t[r]/=this.size;this._out=null,this._data=null},e.prototype._transform4=function(){var t,e,r=this._out,i=this._csize,n=this._width,s=1<<n,o=i/s<<1,a=this._bitrev;if(4===o)for(t=0,e=0;t<i;t+=o,e++){const r=a[e];this._singleTransform2(t,r,s)}else for(t=0,e=0;t<i;t+=o,e++){const r=a[e];this._singleTransform4(t,r,s)}var l=this._inv?-1:1,h=this.table;for(s>>=2;s>=2;s>>=2){o=i/s<<1;var u=o>>>2;for(t=0;t<i;t+=o)for(var c=t+u,f=t,d=0;f<c;f+=2,d+=s){const t=f,e=t+u,i=e+u,n=i+u,s=r[t],o=r[t+1],a=r[e],c=r[e+1],p=r[i],m=r[i+1],g=r[n],w=r[n+1],b=s,y=o,v=h[d],x=l*h[d+1],k=a*v-c*x,_=a*x+c*v,M=h[2*d],E=l*h[2*d+1],S=p*M-m*E,A=p*E+m*M,C=h[3*d],L=l*h[3*d+1],I=g*C-w*L,D=g*L+w*C,R=b+S,P=y+A,T=b-S,F=y-A,B=k+I,U=_+D,O=l*(k-I),N=l*(_-D),z=R+B,j=P+U,X=R-B,$=P-U,V=T+N,Y=F-O,q=T-N,G=F+O;r[t]=z,r[t+1]=j,r[e]=V,r[e+1]=Y,r[i]=X,r[i+1]=$,r[n]=q,r[n+1]=G}}},e.prototype._singleTransform2=function(t,e,r){const i=this._out,n=this._data,s=n[e],o=n[e+1],a=n[e+r],l=n[e+r+1],h=s+a,u=o+l,c=s-a,f=o-l;i[t]=h,i[t+1]=u,i[t+2]=c,i[t+3]=f},e.prototype._singleTransform4=function(t,e,r){const i=this._out,n=this._data,s=this._inv?-1:1,o=2*r,a=3*r,l=n[e],h=n[e+1],u=n[e+r],c=n[e+r+1],f=n[e+o],d=n[e+o+1],p=n[e+a],m=n[e+a+1],g=l+f,w=h+d,b=l-f,y=h-d,v=u+p,x=c+m,k=s*(u-p),_=s*(c-m),M=g+v,E=w+x,S=b+_,A=y-k,C=g-v,L=w-x,I=b-_,D=y+k;i[t]=M,i[t+1]=E,i[t+2]=S,i[t+3]=A,i[t+4]=C,i[t+5]=L,i[t+6]=I,i[t+7]=D},e.prototype._realTransform4=function(){var t,e,r=this._out,i=this._csize,n=this._width,s=1<<n,o=i/s<<1,a=this._bitrev;if(4===o)for(t=0,e=0;t<i;t+=o,e++){const r=a[e];this._singleRealTransform2(t,r>>>1,s>>>1)}else for(t=0,e=0;t<i;t+=o,e++){const r=a[e];this._singleRealTransform4(t,r>>>1,s>>>1)}var l=this._inv?-1:1,h=this.table;for(s>>=2;s>=2;s>>=2){o=i/s<<1;var u=o>>>1,c=u>>>1,f=c>>>1;for(t=0;t<i;t+=o)for(var d=0,p=0;d<=f;d+=2,p+=s){var m=t+d,g=m+c,w=g+c,b=w+c,y=r[m],v=r[m+1],x=r[g],k=r[g+1],_=r[w],M=r[w+1],E=r[b],S=r[b+1],A=y,C=v,L=h[p],I=l*h[p+1],D=x*L-k*I,R=x*I+k*L,P=h[2*p],T=l*h[2*p+1],F=_*P-M*T,B=_*T+M*P,U=h[3*p],O=l*h[3*p+1],N=E*U-S*O,z=E*O+S*U,j=A+F,X=C+B,$=A-F,V=C-B,Y=D+N,q=R+z,G=l*(D-N),H=l*(R-z),W=j+Y,K=X+q,Q=$+H,Z=V-G;if(r[m]=W,r[m+1]=K,r[g]=Q,r[g+1]=Z,0!==d){if(d!==f){var J=$,tt=-V,et=j,rt=-X,it=-l*H,nt=-l*G,st=-l*q,ot=-l*Y,at=J+it,lt=tt+nt,ht=et+ot,ut=rt-st,ct=t+c-d,ft=t+u-d;r[ct]=at,r[ct+1]=lt,r[ft]=ht,r[ft+1]=ut}}else{var dt=j-Y,pt=X-q;r[w]=dt,r[w+1]=pt}}}},e.prototype._singleRealTransform2=function(t,e,r){const i=this._out,n=this._data,s=n[e],o=n[e+r],a=s+o,l=s-o;i[t]=a,i[t+1]=0,i[t+2]=l,i[t+3]=0},e.prototype._singleRealTransform4=function(t,e,r){const i=this._out,n=this._data,s=this._inv?-1:1,o=2*r,a=3*r,l=n[e],h=n[e+r],u=n[e+o],c=n[e+a],f=l+u,d=l-u,p=h+c,m=s*(h-c),g=f+p,w=d,b=-m,y=f-p,v=d,x=m;i[t]=g,i[t+1]=0,i[t+2]=w,i[t+3]=b,i[t+4]=y,i[t+5]=0,i[t+6]=v,i[t+7]=x}},53846:function(module){"use strict";const toBytes=t=>[...t].map((t=>t.charCodeAt(0))),xpiZipFilename=toBytes("META-INF/mozilla.rsa"),oxmlContentTypes=toBytes("[Content_Types].xml"),oxmlRels=toBytes("_rels/.rels");function readUInt64LE(t,e=0){let r=t[e],i=1,n=0;while(++n<8)i*=256,r+=t[e+n]*i;return r}const fileType=t=>{if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||Buffer.isBuffer(t)))throw new TypeError(`Expected the \`input\` argument to be of type \`Uint8Array\` or \`Buffer\` or \`ArrayBuffer\`, got \`${typeof t}\``);const e=t instanceof Uint8Array?t:new Uint8Array(t);if(!(e&&e.length>1))return null;const r=(t,r)=>{r=Object.assign({offset:0},r);for(let i=0;i<t.length;i++)if(r.mask){if(t[i]!==(r.mask[i]&e[i+r.offset]))return!1}else if(t[i]!==e[i+r.offset])return!1;return!0},i=(t,e)=>r(toBytes(t),e);if(r([255,216,255]))return{ext:"jpg",mime:"image/jpeg"};if(r([137,80,78,71,13,10,26,10]))return{ext:"png",mime:"image/png"};if(r([71,73,70]))return{ext:"gif",mime:"image/gif"};if(r([87,69,66,80],{offset:8}))return{ext:"webp",mime:"image/webp"};if(r([70,76,73,70]))return{ext:"flif",mime:"image/flif"};if((r([73,73,42,0])||r([77,77,0,42]))&&r([67,82],{offset:8}))return{ext:"cr2",mime:"image/x-canon-cr2"};if(r([73,73,42,0])||r([77,77,0,42]))return{ext:"tif",mime:"image/tiff"};if(r([66,77]))return{ext:"bmp",mime:"image/bmp"};if(r([73,73,188]))return{ext:"jxr",mime:"image/vnd.ms-photo"};if(r([56,66,80,83]))return{ext:"psd",mime:"image/vnd.adobe.photoshop"};if(r([80,75,3,4])){if(r([109,105,109,101,116,121,112,101,97,112,112,108,105,99,97,116,105,111,110,47,101,112,117,98,43,122,105,112],{offset:30}))return{ext:"epub",mime:"application/epub+zip"};if(r(xpiZipFilename,{offset:30}))return{ext:"xpi",mime:"application/x-xpinstall"};if(i("mimetypeapplication/vnd.oasis.opendocument.text",{offset:30}))return{ext:"odt",mime:"application/vnd.oasis.opendocument.text"};if(i("mimetypeapplication/vnd.oasis.opendocument.spreadsheet",{offset:30}))return{ext:"ods",mime:"application/vnd.oasis.opendocument.spreadsheet"};if(i("mimetypeapplication/vnd.oasis.opendocument.presentation",{offset:30}))return{ext:"odp",mime:"application/vnd.oasis.opendocument.presentation"};const t=(t,e=0)=>t.findIndex(((t,r,i)=>r>=e&&80===i[r]&&75===i[r+1]&&3===i[r+2]&&4===i[r+3]));let n=0,s=!1,o=null;do{const a=n+30;if(s||(s=r(oxmlContentTypes,{offset:a})||r(oxmlRels,{offset:a})),o||(i("word/",{offset:a})?o={ext:"docx",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"}:i("ppt/",{offset:a})?o={ext:"pptx",mime:"application/vnd.openxmlformats-officedocument.presentationml.presentation"}:i("xl/",{offset:a})&&(o={ext:"xlsx",mime:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})),s&&o)return o;n=t(e,a)}while(n>=0);if(o)return o}if(r([80,75])&&(3===e[2]||5===e[2]||7===e[2])&&(4===e[3]||6===e[3]||8===e[3]))return{ext:"zip",mime:"application/zip"};if(r([117,115,116,97,114],{offset:257}))return{ext:"tar",mime:"application/x-tar"};if(r([82,97,114,33,26,7])&&(0===e[6]||1===e[6]))return{ext:"rar",mime:"application/x-rar-compressed"};if(r([31,139,8]))return{ext:"gz",mime:"application/gzip"};if(r([66,90,104]))return{ext:"bz2",mime:"application/x-bzip2"};if(r([55,122,188,175,39,28]))return{ext:"7z",mime:"application/x-7z-compressed"};if(r([120,1]))return{ext:"dmg",mime:"application/x-apple-diskimage"};if(r([51,103,112,53])||r([0,0,0])&&r([102,116,121,112],{offset:4})&&(r([109,112,52,49],{offset:8})||r([109,112,52,50],{offset:8})||r([105,115,111,109],{offset:8})||r([105,115,111,50],{offset:8})||r([109,109,112,52],{offset:8})||r([77,52,86],{offset:8})||r([100,97,115,104],{offset:8})))return{ext:"mp4",mime:"video/mp4"};if(r([77,84,104,100]))return{ext:"mid",mime:"audio/midi"};if(r([26,69,223,163])){const t=e.subarray(4,4100),r=t.findIndex(((t,e,r)=>66===r[e]&&130===r[e+1]));if(-1!==r){const e=r+3,i=r=>[...r].every(((r,i)=>t[e+i]===r.charCodeAt(0)));if(i("matroska"))return{ext:"mkv",mime:"video/x-matroska"};if(i("webm"))return{ext:"webm",mime:"video/webm"}}}if(r([0,0,0,20,102,116,121,112,113,116,32,32])||r([102,114,101,101],{offset:4})||r([102,116,121,112,113,116,32,32],{offset:4})||r([109,100,97,116],{offset:4})||r([109,111,111,118],{offset:4})||r([119,105,100,101],{offset:4}))return{ext:"mov",mime:"video/quicktime"};if(r([82,73,70,70])){if(r([65,86,73],{offset:8}))return{ext:"avi",mime:"video/vnd.avi"};if(r([87,65,86,69],{offset:8}))return{ext:"wav",mime:"audio/vnd.wave"};if(r([81,76,67,77],{offset:8}))return{ext:"qcp",mime:"audio/qcelp"}}if(r([48,38,178,117,142,102,207,17,166,217])){let t=30;do{const i=readUInt64LE(e,t+16);if(r([145,7,220,183,183,169,207,17,142,230,0,192,12,32,83,101],{offset:t})){if(r([64,158,105,248,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wma",mime:"audio/x-ms-wma"};if(r([192,239,25,188,77,91,207,17,168,253,0,128,95,92,68,43],{offset:t+24}))return{ext:"wmv",mime:"video/x-ms-asf"};break}t+=i}while(t+24<=e.length);return{ext:"asf",mime:"application/vnd.ms-asf"}}if(r([0,0,1,186])||r([0,0,1,179]))return{ext:"mpg",mime:"video/mpeg"};if(r([102,116,121,112,51,103],{offset:4}))return{ext:"3gp",mime:"video/3gpp"};for(let n=0;n<2&&n<e.length-16;n++){if(r([73,68,51],{offset:n})||r([255,226],{offset:n,mask:[255,226]}))return{ext:"mp3",mime:"audio/mpeg"};if(r([255,228],{offset:n,mask:[255,228]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([255,248],{offset:n,mask:[255,252]}))return{ext:"mp2",mime:"audio/mpeg"};if(r([255,240],{offset:n,mask:[255,252]}))return{ext:"mp4",mime:"audio/mpeg"}}if(r([102,116,121,112,77,52,65],{offset:4}))return{ext:"m4a",mime:"audio/mp4"};if(r([79,112,117,115,72,101,97,100],{offset:28}))return{ext:"opus",mime:"audio/opus"};if(r([79,103,103,83]))return r([128,116,104,101,111,114,97],{offset:28})?{ext:"ogv",mime:"video/ogg"}:r([1,118,105,100,101,111,0],{offset:28})?{ext:"ogm",mime:"video/ogg"}:r([127,70,76,65,67],{offset:28})?{ext:"oga",mime:"audio/ogg"}:r([83,112,101,101,120,32,32],{offset:28})?{ext:"spx",mime:"audio/ogg"}:r([1,118,111,114,98,105,115],{offset:28})?{ext:"ogg",mime:"audio/ogg"}:{ext:"ogx",mime:"application/ogg"};if(r([102,76,97,67]))return{ext:"flac",mime:"audio/x-flac"};if(r([77,65,67,32]))return{ext:"ape",mime:"audio/ape"};if(r([119,118,112,107]))return{ext:"wv",mime:"audio/wavpack"};if(r([35,33,65,77,82,10]))return{ext:"amr",mime:"audio/amr"};if(r([37,80,68,70]))return{ext:"pdf",mime:"application/pdf"};if(r([77,90]))return{ext:"exe",mime:"application/x-msdownload"};if((67===e[0]||70===e[0])&&r([87,83],{offset:1}))return{ext:"swf",mime:"application/x-shockwave-flash"};if(r([123,92,114,116,102]))return{ext:"rtf",mime:"application/rtf"};if(r([0,97,115,109]))return{ext:"wasm",mime:"application/wasm"};if(r([119,79,70,70])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:"woff",mime:"font/woff"};if(r([119,79,70,50])&&(r([0,1,0,0],{offset:4})||r([79,84,84,79],{offset:4})))return{ext:"woff2",mime:"font/woff2"};if(r([76,80],{offset:34})&&(r([0,0,1],{offset:8})||r([1,0,2],{offset:8})||r([2,0,2],{offset:8})))return{ext:"eot",mime:"application/vnd.ms-fontobject"};if(r([0,1,0,0,0]))return{ext:"ttf",mime:"font/ttf"};if(r([79,84,84,79,0]))return{ext:"otf",mime:"font/otf"};if(r([0,0,1,0]))return{ext:"ico",mime:"image/x-icon"};if(r([0,0,2,0]))return{ext:"cur",mime:"image/x-icon"};if(r([70,76,86,1]))return{ext:"flv",mime:"video/x-flv"};if(r([37,33]))return{ext:"ps",mime:"application/postscript"};if(r([253,55,122,88,90,0]))return{ext:"xz",mime:"application/x-xz"};if(r([83,81,76,105]))return{ext:"sqlite",mime:"application/x-sqlite3"};if(r([78,69,83,26]))return{ext:"nes",mime:"application/x-nintendo-nes-rom"};if(r([67,114,50,52]))return{ext:"crx",mime:"application/x-google-chrome-extension"};if(r([77,83,67,70])||r([73,83,99,40]))return{ext:"cab",mime:"application/vnd.ms-cab-compressed"};if(r([33,60,97,114,99,104,62,10,100,101,98,105,97,110,45,98,105,110,97,114,121]))return{ext:"deb",mime:"application/x-deb"};if(r([33,60,97,114,99,104,62]))return{ext:"ar",mime:"application/x-unix-archive"};if(r([237,171,238,219]))return{ext:"rpm",mime:"application/x-rpm"};if(r([31,160])||r([31,157]))return{ext:"Z",mime:"application/x-compress"};if(r([76,90,73,80]))return{ext:"lz",mime:"application/x-lzip"};if(r([208,207,17,224,161,177,26,225]))return{ext:"msi",mime:"application/x-msi"};if(r([6,14,43,52,2,5,1,1,13,1,2,1,1,2]))return{ext:"mxf",mime:"application/mxf"};if(r([71],{offset:4})&&(r([71],{offset:192})||r([71],{offset:196})))return{ext:"mts",mime:"video/mp2t"};if(r([66,76,69,78,68,69,82]))return{ext:"blend",mime:"application/x-blender"};if(r([66,80,71,251]))return{ext:"bpg",mime:"image/bpg"};if(r([0,0,0,12,106,80,32,32,13,10,135,10])){if(r([106,112,50,32],{offset:20}))return{ext:"jp2",mime:"image/jp2"};if(r([106,112,120,32],{offset:20}))return{ext:"jpx",mime:"image/jpx"};if(r([106,112,109,32],{offset:20}))return{ext:"jpm",mime:"image/jpm"};if(r([109,106,112,50],{offset:20}))return{ext:"mj2",mime:"image/mj2"}}if(r([70,79,82,77]))return{ext:"aif",mime:"audio/aiff"};if(i("<?xml "))return{ext:"xml",mime:"application/xml"};if(r([66,79,79,75,77,79,66,73],{offset:60}))return{ext:"mobi",mime:"application/x-mobipocket-ebook"};if(r([102,116,121,112],{offset:4})){if(r([109,105,102,49],{offset:8}))return{ext:"heic",mime:"image/heif"};if(r([109,115,102,49],{offset:8}))return{ext:"heic",mime:"image/heif-sequence"};if(r([104,101,105,99],{offset:8})||r([104,101,105,120],{offset:8}))return{ext:"heic",mime:"image/heic"};if(r([104,101,118,99],{offset:8})||r([104,101,118,120],{offset:8}))return{ext:"heic",mime:"image/heic-sequence"}}return r([171,75,84,88,32,49,49,187,13,10,26,10])?{ext:"ktx",mime:"image/ktx"}:r([68,73,67,77],{offset:128})?{ext:"dcm",mime:"application/dicom"}:r([77,80,43])||r([77,80,67,75])?{ext:"mpc",mime:"audio/x-musepack"}:r([66,69,71,73,78,58])?{ext:"ics",mime:"text/calendar"}:r([103,108,84,70,2,0,0,0])?{ext:"glb",mime:"model/gltf-binary"}:r([212,195,178,161])||r([161,178,195,212])?{ext:"pcap",mime:"application/vnd.tcpdump.pcap"}:null};module.exports=fileType,module.exports["default"]=fileType,Object.defineProperty(fileType,"minimumBytes",{value:4100}),module.exports.stream=readableStream=>new Promise(((resolve,reject)=>{const stream=eval("require")("stream");readableStream.once("readable",(()=>{const t=new stream.PassThrough,e=readableStream.read(module.exports.minimumBytes)||readableStream.read();try{t.fileType=fileType(e)}catch(r){reject(r)}readableStream.unshift(e),stream.pipeline?resolve(stream.pipeline(readableStream,t,(()=>{}))):resolve(readableStream.pipe(t))}))}))},82334:function(t,e,r){var i=Object.prototype.hasOwnProperty;t.exports=e=function(t,e){return i.call(e,t)},e.version=r(77753).version},251:function(t,e){
/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */
e.read=function(t,e,r,i,n){var s,o,a=8*n-i-1,l=(1<<a)-1,h=l>>1,u=-7,c=r?n-1:0,f=r?-1:1,d=t[e+c];for(c+=f,s=d&(1<<-u)-1,d>>=-u,u+=a;u>0;s=256*s+t[e+c],c+=f,u-=8);for(o=s&(1<<-u)-1,s>>=-u,u+=i;u>0;o=256*o+t[e+c],c+=f,u-=8);if(0===s)s=1-h;else{if(s===l)return o?NaN:1/0*(d?-1:1);o+=Math.pow(2,i),s-=h}return(d?-1:1)*o*Math.pow(2,s-i)},e.write=function(t,e,r,i,n,s){var o,a,l,h=8*s-n-1,u=(1<<h)-1,c=u>>1,f=23===n?Math.pow(2,-24)-Math.pow(2,-77):0,d=i?0:s-1,p=i?1:-1,m=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,o=u):(o=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-o))<1&&(o--,l*=2),e+=o+c>=1?f/l:f*Math.pow(2,1-c),e*l>=2&&(o++,l/=2),o+c>=u?(a=0,o=u):o+c>=1?(a=(e*l-1)*Math.pow(2,n),o+=c):(a=e*Math.pow(2,c-1)*Math.pow(2,n),o=0));n>=8;t[r+d]=255&a,d+=p,a/=256,n-=8);for(o=o<<n|a,h+=n;h>0;t[r+d]=255&o,d+=p,o/=256,h-=8);t[r+d-p]|=128*m}},66277:function(t,e,r){"use strict";const i=r(53846),n=new Set(["jpg","png","gif","webp","flif","cr2","tif","bmp","jxr","psd","ico","bpg","jp2","jpm","jpx","heic","cur","dcm"]),s=t=>{const e=i(t);return n.has(e&&e.ext)?e:null};t.exports=s,t.exports["default"]=s,Object.defineProperty(s,"minimumBytes",{value:i.minimumBytes})},56698:function(t){"function"===typeof Object.create?t.exports=function(t,e){e&&(t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(t,e){if(e){t.super_=e;var r=function(){};r.prototype=e.prototype,t.prototype=new r,t.prototype.constructor=t}}},18851:function(t,e,r){"use strict";r.r(e),r.d(e,{IOBuffer:function(){return h}});r(81620);function i(t,e="utf8"){const r=new TextDecoder(e);return r.decode(t)}const n=new TextEncoder;function s(t){return n.encode(t)}const o=8192,a=(()=>{const t=new Uint8Array(4),e=new Uint32Array(t.buffer);return!((e[0]=1)&t[0])})(),l={int8:globalThis.Int8Array,uint8:globalThis.Uint8Array,int16:globalThis.Int16Array,uint16:globalThis.Uint16Array,int32:globalThis.Int32Array,uint32:globalThis.Uint32Array,uint64:globalThis.BigUint64Array,int64:globalThis.BigInt64Array,float32:globalThis.Float32Array,float64:globalThis.Float64Array};class h{constructor(t=o,e={}){let r=!1;"number"===typeof t?t=new ArrayBuffer(t):(r=!0,this.lastWrittenByte=t.byteLength);const i=e.offset?e.offset>>>0:0,n=t.byteLength-i;let s=i;(ArrayBuffer.isView(t)||t instanceof h)&&(t.byteLength!==t.buffer.byteLength&&(s=t.byteOffset+i),t=t.buffer),this.lastWrittenByte=r?n:0,this.buffer=t,this.length=n,this.byteLength=n,this.byteOffset=s,this.offset=0,this.littleEndian=!0,this._data=new DataView(this.buffer,s,n),this._mark=0,this._marks=[]}available(t=1){return this.offset+t<=this.length}isLittleEndian(){return this.littleEndian}setLittleEndian(){return this.littleEndian=!0,this}isBigEndian(){return!this.littleEndian}setBigEndian(){return this.littleEndian=!1,this}skip(t=1){return this.offset+=t,this}back(t=1){return this.offset-=t,this}seek(t){return this.offset=t,this}mark(){return this._mark=this.offset,this}reset(){return this.offset=this._mark,this}pushMark(){return this._marks.push(this.offset),this}popMark(){const t=this._marks.pop();if(void 0===t)throw new Error("Mark stack empty");return this.seek(t),this}rewind(){return this.offset=0,this}ensureAvailable(t=1){if(!this.available(t)){const e=this.offset+t,r=2*e,i=new Uint8Array(r);i.set(new Uint8Array(this.buffer)),this.buffer=i.buffer,this.length=this.byteLength=r,this._data=new DataView(this.buffer)}return this}readBoolean(){return 0!==this.readUint8()}readInt8(){return this._data.getInt8(this.offset++)}readUint8(){return this._data.getUint8(this.offset++)}readByte(){return this.readUint8()}readBytes(t=1){return this.readArray(t,"uint8")}readArray(t,e){const r=l[e].BYTES_PER_ELEMENT*t,i=this.byteOffset+this.offset,n=this.buffer.slice(i,i+r);if(this.littleEndian===a&&"uint8"!==e&&"int8"!==e){const t=new Uint8Array(this.buffer.slice(i,i+r));t.reverse();const n=new l[e](t.buffer);return this.offset+=r,n.reverse(),n}const s=new l[e](n);return this.offset+=r,s}readInt16(){const t=this._data.getInt16(this.offset,this.littleEndian);return this.offset+=2,t}readUint16(){const t=this._data.getUint16(this.offset,this.littleEndian);return this.offset+=2,t}readInt32(){const t=this._data.getInt32(this.offset,this.littleEndian);return this.offset+=4,t}readUint32(){const t=this._data.getUint32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat32(){const t=this._data.getFloat32(this.offset,this.littleEndian);return this.offset+=4,t}readFloat64(){const t=this._data.getFloat64(this.offset,this.littleEndian);return this.offset+=8,t}readBigInt64(){const t=this._data.getBigInt64(this.offset,this.littleEndian);return this.offset+=8,t}readBigUint64(){const t=this._data.getBigUint64(this.offset,this.littleEndian);return this.offset+=8,t}readChar(){return String.fromCharCode(this.readInt8())}readChars(t=1){let e="";for(let r=0;r<t;r++)e+=this.readChar();return e}readUtf8(t=1){return i(this.readBytes(t))}decodeText(t=1,e="utf-8"){return i(this.readBytes(t),e)}writeBoolean(t){return this.writeUint8(t?255:0),this}writeInt8(t){return this.ensureAvailable(1),this._data.setInt8(this.offset++,t),this._updateLastWrittenByte(),this}writeUint8(t){return this.ensureAvailable(1),this._data.setUint8(this.offset++,t),this._updateLastWrittenByte(),this}writeByte(t){return this.writeUint8(t)}writeBytes(t){this.ensureAvailable(t.length);for(let e=0;e<t.length;e++)this._data.setUint8(this.offset++,t[e]);return this._updateLastWrittenByte(),this}writeInt16(t){return this.ensureAvailable(2),this._data.setInt16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeUint16(t){return this.ensureAvailable(2),this._data.setUint16(this.offset,t,this.littleEndian),this.offset+=2,this._updateLastWrittenByte(),this}writeInt32(t){return this.ensureAvailable(4),this._data.setInt32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeUint32(t){return this.ensureAvailable(4),this._data.setUint32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat32(t){return this.ensureAvailable(4),this._data.setFloat32(this.offset,t,this.littleEndian),this.offset+=4,this._updateLastWrittenByte(),this}writeFloat64(t){return this.ensureAvailable(8),this._data.setFloat64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigInt64(t){return this.ensureAvailable(8),this._data.setBigInt64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeBigUint64(t){return this.ensureAvailable(8),this._data.setBigUint64(this.offset,t,this.littleEndian),this.offset+=8,this._updateLastWrittenByte(),this}writeChar(t){return this.writeUint8(t.charCodeAt(0))}writeChars(t){for(let e=0;e<t.length;e++)this.writeUint8(t.charCodeAt(e));return this}writeUtf8(t){return this.writeBytes(s(t))}toArray(){return new Uint8Array(this.buffer,this.byteOffset,this.lastWrittenByte)}_updateLastWrittenByte(){this.offset>this.lastWrittenByte&&(this.lastWrittenByte=this.offset)}}},81620:function(){"use strict";(function(t){if(t["TextEncoder"]&&t["TextDecoder"])return!1;function e(t="utf-8"){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextEncoder': The encoding label provided ('${t}') is invalid.`)}function r(t="utf-8",e={fatal:!1}){if("utf-8"!==t)throw new RangeError(`Failed to construct 'TextDecoder': The encoding label provided ('${t}') is invalid.`);if(e.fatal)throw new Error("Failed to construct 'TextDecoder': the 'fatal' option is unsupported.")}Object.defineProperty(e.prototype,"encoding",{value:"utf-8"}),e.prototype.encode=function(t,e={stream:!1}){if(e.stream)throw new Error("Failed to encode: the 'stream' option is unsupported.");let r=0;const i=t.length;let n=0,s=Math.max(32,i+(i>>1)+7),o=new Uint8Array(s>>3<<3);while(r<i){let e=t.charCodeAt(r++);if(e>=55296&&e<=56319){if(r<i){const i=t.charCodeAt(r);56320===(64512&i)&&(++r,e=((1023&e)<<10)+(1023&i)+65536)}if(e>=55296&&e<=56319)continue}if(n+4>o.length){s+=8,s*=1+r/t.length*2,s=s>>3<<3;const e=new Uint8Array(s);e.set(o),o=e}if(0!==(4294967168&e)){if(0===(4294965248&e))o[n++]=e>>6&31|192;else if(0===(4294901760&e))o[n++]=e>>12&15|224,o[n++]=e>>6&63|128;else{if(0!==(4292870144&e))continue;o[n++]=e>>18&7|240,o[n++]=e>>12&63|128,o[n++]=e>>6&63|128}o[n++]=63&e|128}else o[n++]=e}return o.slice(0,n)},Object.defineProperty(r.prototype,"encoding",{value:"utf-8"}),Object.defineProperty(r.prototype,"fatal",{value:!1}),Object.defineProperty(r.prototype,"ignoreBOM",{value:!1}),r.prototype.decode=function(t,e={stream:!1}){if(e["stream"])throw new Error("Failed to decode: the 'stream' option is unsupported.");const r=new Uint8Array(t);let i=0;const n=r.length,s=[];while(i<n){const t=r[i++];if(0===t)break;if(0===(128&t))s.push(t);else if(192===(224&t)){const e=63&r[i++];s.push((31&t)<<6|e)}else if(224===(240&t)){const e=63&r[i++],n=63&r[i++];s.push((31&t)<<12|e<<6|n)}else if(240===(248&t)){const e=63&r[i++],n=63&r[i++],o=63&r[i++];let a=(7&t)<<18|e<<12|n<<6|o;a>65535&&(a-=65536,s.push(a>>>10&1023|55296),a=56320|1023&a),s.push(a)}}return String.fromCharCode.apply(null,s)},t["TextEncoder"]=e,t["TextDecoder"]=r})("undefined"!==typeof window?window:"undefined"!==typeof self?self:this)},70788:function(t,e,r){"use strict";r.r(e),r.d(e,{isAnyArray:function(){return n}});const i=Object.prototype.toString;function n(t){const e=i.call(t);return e.endsWith("Array]")&&!e.includes("Big")}},96623:function(t){"use strict";var e=Object.prototype.toString;t.exports=function(t){return"Array"===e.call(t).substr(-6,5)}},77163:function(t){"use strict";t.exports=Number.isFinite||function(t){return!("number"!==typeof t||t!==t||t===1/0||t===-1/0)}},32742:function(t,e,r){var i=r(77163);t.exports=Number.isInteger||function(t){return"number"===typeof t&&i(t)&&Math.floor(t)===t}},15609:function(t,e,r){var i=r(52521),n=r(83877);t.exports={encode:i,decode:n}},83877:function(t){var e=function(){"use strict";var t=new Int32Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]),e=4017,r=799,i=3406,n=2276,s=1567,o=3784,a=5793,l=2896;function h(){}function u(t,e){var r,i,n=0,s=[],o=16;while(o>0&&!t[o-1])o--;s.push({children:[],index:0});var a,l=s[0];for(r=0;r<o;r++){for(i=0;i<t[r];i++){l=s.pop(),l.children[l.index]=e[n];while(l.index>0){if(0===s.length)throw new Error("Could not recreate Huffman Table");l=s.pop()}l.index++,s.push(l);while(s.length<=r)s.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a;n++}r+1<o&&(s.push(a={children:[],index:0}),l.children[l.index]=a.children,l=a)}return s[0].children}function c(e,r,i,n,s,o,a,l,h,u){i.precision,i.samplesPerLine,i.scanLines;var c=i.mcusPerLine,f=i.progressive,d=(i.maxH,i.maxV,r),p=0,m=0;function g(){if(m>0)return m--,p>>m&1;if(p=e[r++],255==p){var t=e[r++];if(t)throw new Error("unexpected marker: "+(p<<8|t).toString(16))}return m=7,p>>>7}function w(t){var e,r=t;while(null!==(e=g())){if(r=r[e],"number"===typeof r)return r;if("object"!==typeof r)throw new Error("invalid huffman sequence")}return null}function b(t){var e=0;while(t>0){var r=g();if(null===r)return;e=e<<1|r,t--}return e}function y(t){var e=b(t);return e>=1<<t-1?e:e+(-1<<t)+1}function v(e,r){var i=w(e.huffmanTableDC),n=0===i?0:y(i);r[0]=e.pred+=n;var s=1;while(s<64){var o=w(e.huffmanTableAC),a=15&o,l=o>>4;if(0!==a){s+=l;var h=t[s];r[h]=y(a),s++}else{if(l<15)break;s+=16}}}function x(t,e){var r=w(t.huffmanTableDC),i=0===r?0:y(r)<<h;e[0]=t.pred+=i}function k(t,e){e[0]|=g()<<h}var _=0;function M(e,r){if(_>0)_--;else{var i=o,n=a;while(i<=n){var s=w(e.huffmanTableAC),l=15&s,u=s>>4;if(0!==l){i+=u;var c=t[i];r[c]=y(l)*(1<<h),i++}else{if(u<15){_=b(u)+(1<<u)-1;break}i+=16}}}}var E,S=0;function A(e,r){var i=o,n=a,s=0;while(i<=n){var l=t[i],u=r[l]<0?-1:1;switch(S){case 0:var c=w(e.huffmanTableAC),f=15&c;s=c>>4;if(0===f)s<15?(_=b(s)+(1<<s),S=4):(s=16,S=1);else{if(1!==f)throw new Error("invalid ACn encoding");E=y(f),S=s?2:3}continue;case 1:case 2:r[l]?r[l]+=(g()<<h)*u:(s--,0===s&&(S=2==S?3:0));break;case 3:r[l]?r[l]+=(g()<<h)*u:(r[l]=E<<h,S=0);break;case 4:r[l]&&(r[l]+=(g()<<h)*u);break}i++}4===S&&(_--,0===_&&(S=0))}function C(t,e,r,i,n){var s=r/c|0,o=r%c,a=s*t.v+i,l=o*t.h+n;void 0===t.blocks[a]&&u.tolerantDecoding||e(t,t.blocks[a][l])}function L(t,e,r){var i=r/t.blocksPerLine|0,n=r%t.blocksPerLine;void 0===t.blocks[i]&&u.tolerantDecoding||e(t,t.blocks[i][n])}var I,D,R,P,T,F,B=n.length;F=f?0===o?0===l?x:k:0===l?M:A:v;var U,O,N,z,j=0;O=1==B?n[0].blocksPerLine*n[0].blocksPerColumn:c*i.mcusPerColumn,s||(s=O);while(j<O){for(D=0;D<B;D++)n[D].pred=0;if(_=0,1==B)for(I=n[0],T=0;T<s;T++)L(I,F,j),j++;else for(T=0;T<s;T++){for(D=0;D<B;D++)for(I=n[D],N=I.h,z=I.v,R=0;R<z;R++)for(P=0;P<N;P++)C(I,F,j,R,P);if(j++,j===O)break}if(j===O)do{if(255===e[r]&&0!==e[r+1])break;r+=1}while(r<e.length-2);if(m=0,U=e[r]<<8|e[r+1],U<65280)throw new Error("marker was not found");if(!(U>=65488&&U<=65495))break;r+=2}return r-d}function f(t,h){var u,c,f=[],d=h.blocksPerLine,p=h.blocksPerColumn,m=d<<3,w=new Int32Array(64),b=new Uint8Array(64);function y(t,u,c){var f,d,p,m,g,w,b,y,v,x,k=h.quantizationTable,_=c;for(x=0;x<64;x++)_[x]=t[x]*k[x];for(x=0;x<8;++x){var M=8*x;0!=_[1+M]||0!=_[2+M]||0!=_[3+M]||0!=_[4+M]||0!=_[5+M]||0!=_[6+M]||0!=_[7+M]?(f=a*_[0+M]+128>>8,d=a*_[4+M]+128>>8,p=_[2+M],m=_[6+M],g=l*(_[1+M]-_[7+M])+128>>8,y=l*(_[1+M]+_[7+M])+128>>8,w=_[3+M]<<4,b=_[5+M]<<4,v=f-d+1>>1,f=f+d+1>>1,d=v,v=p*o+m*s+128>>8,p=p*s-m*o+128>>8,m=v,v=g-b+1>>1,g=g+b+1>>1,b=v,v=y+w+1>>1,w=y-w+1>>1,y=v,v=f-m+1>>1,f=f+m+1>>1,m=v,v=d-p+1>>1,d=d+p+1>>1,p=v,v=g*n+y*i+2048>>12,g=g*i-y*n+2048>>12,y=v,v=w*r+b*e+2048>>12,w=w*e-b*r+2048>>12,b=v,_[0+M]=f+y,_[7+M]=f-y,_[1+M]=d+b,_[6+M]=d-b,_[2+M]=p+w,_[5+M]=p-w,_[3+M]=m+g,_[4+M]=m-g):(v=a*_[0+M]+512>>10,_[0+M]=v,_[1+M]=v,_[2+M]=v,_[3+M]=v,_[4+M]=v,_[5+M]=v,_[6+M]=v,_[7+M]=v)}for(x=0;x<8;++x){var E=x;0!=_[8+E]||0!=_[16+E]||0!=_[24+E]||0!=_[32+E]||0!=_[40+E]||0!=_[48+E]||0!=_[56+E]?(f=a*_[0+E]+2048>>12,d=a*_[32+E]+2048>>12,p=_[16+E],m=_[48+E],g=l*(_[8+E]-_[56+E])+2048>>12,y=l*(_[8+E]+_[56+E])+2048>>12,w=_[24+E],b=_[40+E],v=f-d+1>>1,f=f+d+1>>1,d=v,v=p*o+m*s+2048>>12,p=p*s-m*o+2048>>12,m=v,v=g-b+1>>1,g=g+b+1>>1,b=v,v=y+w+1>>1,w=y-w+1>>1,y=v,v=f-m+1>>1,f=f+m+1>>1,m=v,v=d-p+1>>1,d=d+p+1>>1,p=v,v=g*n+y*i+2048>>12,g=g*i-y*n+2048>>12,y=v,v=w*r+b*e+2048>>12,w=w*e-b*r+2048>>12,b=v,_[0+E]=f+y,_[56+E]=f-y,_[8+E]=d+b,_[48+E]=d-b,_[16+E]=p+w,_[40+E]=p-w,_[24+E]=m+g,_[32+E]=m-g):(v=a*c[x+0]+8192>>14,_[0+E]=v,_[8+E]=v,_[16+E]=v,_[24+E]=v,_[32+E]=v,_[40+E]=v,_[48+E]=v,_[56+E]=v)}for(x=0;x<64;++x){var S=128+(_[x]+8>>4);u[x]=S<0?0:S>255?255:S}}g(m*p*8);for(var v=0;v<p;v++){var x=v<<3;for(u=0;u<8;u++)f.push(new Uint8Array(m));for(var k=0;k<d;k++){y(h.blocks[v][k],b,w);var _=0,M=k<<3;for(c=0;c<8;c++){var E=f[x+c];for(u=0;u<8;u++)E[M+u]=b[_++]}}}return f}function d(t){return t<0?0:t>255?255:t}h.prototype={load:function(t){var e=new XMLHttpRequest;e.open("GET",t,!0),e.responseType="arraybuffer",e.onload=function(){var t=new Uint8Array(e.response||e.mozResponseArrayBuffer);this.parse(t),this.onload&&this.onload()}.bind(this),e.send(null)},parse:function(e){var r=1e3*this.opts.maxResolutionInMP*1e3,i=0;e.length;function n(){var t=e[i]<<8|e[i+1];return i+=2,t}function s(){var t=n(),r=e.subarray(i,i+t-2);return i+=r.length,r}function o(t){var e,r,i=1,n=1;for(r in t.components)t.components.hasOwnProperty(r)&&(e=t.components[r],i<e.h&&(i=e.h),n<e.v&&(n=e.v));var s=Math.ceil(t.samplesPerLine/8/i),o=Math.ceil(t.scanLines/8/n);for(r in t.components)if(t.components.hasOwnProperty(r)){e=t.components[r];var a=Math.ceil(Math.ceil(t.samplesPerLine/8)*e.h/i),l=Math.ceil(Math.ceil(t.scanLines/8)*e.v/n),h=s*e.h,u=o*e.v,c=u*h,f=[];g(256*c);for(var d=0;d<u;d++){for(var p=[],m=0;m<h;m++)p.push(new Int32Array(64));f.push(p)}e.blocksPerLine=a,e.blocksPerColumn=l,e.blocks=f}t.maxH=i,t.maxV=n,t.mcusPerLine=s,t.mcusPerColumn=o}var a,l,h=null,d=null,p=[],m=[],w=[],b=[],y=n(),v=-1;if(this.comments=[],65496!=y)throw new Error("SOI not found");y=n();while(65497!=y){switch(y){case 65280:break;case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var x=s();if(65534===y){var k=String.fromCharCode.apply(null,x);this.comments.push(k)}65504===y&&74===x[0]&&70===x[1]&&73===x[2]&&70===x[3]&&0===x[4]&&(h={version:{major:x[5],minor:x[6]},densityUnits:x[7],xDensity:x[8]<<8|x[9],yDensity:x[10]<<8|x[11],thumbWidth:x[12],thumbHeight:x[13],thumbData:x.subarray(14,14+3*x[12]*x[13])}),65505===y&&69===x[0]&&120===x[1]&&105===x[2]&&102===x[3]&&0===x[4]&&(this.exifBuffer=x.subarray(5,x.length)),65518===y&&65===x[0]&&100===x[1]&&111===x[2]&&98===x[3]&&101===x[4]&&0===x[5]&&(d={version:x[6],flags0:x[7]<<8|x[8],flags1:x[9]<<8|x[10],transformCode:x[11]});break;case 65499:var _=n(),M=_+i-2;while(i<M){var E=e[i++];g(256);var S=new Int32Array(64);if(E>>4===0)for(W=0;W<64;W++){var A=t[W];S[A]=e[i++]}else{if(E>>4!==1)throw new Error("DQT: invalid table spec");for(W=0;W<64;W++){A=t[W];S[A]=n()}}p[15&E]=S}break;case 65472:case 65473:case 65474:n(),a={},a.extended=65473===y,a.progressive=65474===y,a.precision=e[i++],a.scanLines=n(),a.samplesPerLine=n(),a.components={},a.componentsOrder=[];var C=a.scanLines*a.samplesPerLine;if(C>r){var L=Math.ceil((C-r)/1e6);throw new Error(`maxResolutionInMP limit exceeded by ${L}MP`)}var I,D=e[i++];for(G=0;G<D;G++){I=e[i];var R=e[i+1]>>4,P=15&e[i+1],T=e[i+2];if(R<=0||P<=0)throw new Error("Invalid sampling factor, expected values above 0");a.componentsOrder.push(I),a.components[I]={h:R,v:P,quantizationIdx:T},i+=3}o(a),m.push(a);break;case 65476:var F=n();for(G=2;G<F;){var B=e[i++],U=new Uint8Array(16),O=0;for(W=0;W<16;W++,i++)O+=U[W]=e[i];g(16+O);var N=new Uint8Array(O);for(W=0;W<O;W++,i++)N[W]=e[i];G+=17+O,(B>>4===0?b:w)[15&B]=u(U,N)}break;case 65501:n(),l=n();break;case 65500:n(),n();break;case 65498:n();var z=e[i++],j=[];for(G=0;G<z;G++){K=a.components[e[i++]];var X=e[i++];K.huffmanTableDC=b[X>>4],K.huffmanTableAC=w[15&X],j.push(K)}var $=e[i++],V=e[i++],Y=e[i++],q=c(e,i,a,j,l,$,V,Y>>4,15&Y,this.opts);i+=q;break;case 65535:255!==e[i]&&i--;break;default:if(255==e[i-3]&&e[i-2]>=192&&e[i-2]<=254){i-=3;break}if(224===y||225==y){if(-1!==v)throw new Error(`first unknown JPEG marker at offset ${v.toString(16)}, second unknown JPEG marker ${y.toString(16)} at offset ${(i-1).toString(16)}`);v=i-1;const t=n();if(255===e[i+t-2]){i+=t-2;break}}throw new Error("unknown JPEG marker "+y.toString(16))}y=n()}if(1!=m.length)throw new Error("only single frame JPEGs supported");for(var G=0;G<m.length;G++){var H=m[G].components;for(var W in H)H[W].quantizationTable=p[H[W].quantizationIdx],delete H[W].quantizationIdx}this.width=a.samplesPerLine,this.height=a.scanLines,this.jfif=h,this.adobe=d,this.components=[];for(G=0;G<a.componentsOrder.length;G++){var K=a.components[a.componentsOrder[G]];this.components.push({lines:f(a,K),scaleX:K.h/a.maxH,scaleY:K.v/a.maxV})}},getData:function(t,e){var r,i,n,s,o,a,l,h,u,c,f,p,m,w,b,y,v,x,k,_,M,E=this.width/t,S=this.height/e,A=0,C=t*e*this.components.length;g(C);var L=new Uint8Array(C);switch(this.components.length){case 1:for(r=this.components[0],c=0;c<e;c++)for(o=r.lines[0|c*r.scaleY*S],u=0;u<t;u++)f=o[0|u*r.scaleX*E],L[A++]=f;break;case 2:for(r=this.components[0],i=this.components[1],c=0;c<e;c++)for(o=r.lines[0|c*r.scaleY*S],a=i.lines[0|c*i.scaleY*S],u=0;u<t;u++)f=o[0|u*r.scaleX*E],L[A++]=f,f=a[0|u*i.scaleX*E],L[A++]=f;break;case 3:for(M=!0,this.adobe&&this.adobe.transformCode?M=!0:"undefined"!==typeof this.opts.colorTransform&&(M=!!this.opts.colorTransform),r=this.components[0],i=this.components[1],n=this.components[2],c=0;c<e;c++)for(o=r.lines[0|c*r.scaleY*S],a=i.lines[0|c*i.scaleY*S],l=n.lines[0|c*n.scaleY*S],u=0;u<t;u++)M?(f=o[0|u*r.scaleX*E],p=a[0|u*i.scaleX*E],m=l[0|u*n.scaleX*E],x=d(f+1.402*(m-128)),k=d(f-.3441363*(p-128)-.71413636*(m-128)),_=d(f+1.772*(p-128))):(x=o[0|u*r.scaleX*E],k=a[0|u*i.scaleX*E],_=l[0|u*n.scaleX*E]),L[A++]=x,L[A++]=k,L[A++]=_;break;case 4:if(!this.adobe)throw new Error("Unsupported color mode (4 components)");for(M=!1,this.adobe&&this.adobe.transformCode?M=!0:"undefined"!==typeof this.opts.colorTransform&&(M=!!this.opts.colorTransform),r=this.components[0],i=this.components[1],n=this.components[2],s=this.components[3],c=0;c<e;c++)for(o=r.lines[0|c*r.scaleY*S],a=i.lines[0|c*i.scaleY*S],l=n.lines[0|c*n.scaleY*S],h=s.lines[0|c*s.scaleY*S],u=0;u<t;u++)M?(f=o[0|u*r.scaleX*E],p=a[0|u*i.scaleX*E],m=l[0|u*n.scaleX*E],w=h[0|u*s.scaleX*E],b=255-d(f+1.402*(m-128)),y=255-d(f-.3441363*(p-128)-.71413636*(m-128)),v=255-d(f+1.772*(p-128))):(b=o[0|u*r.scaleX*E],y=a[0|u*i.scaleX*E],v=l[0|u*n.scaleX*E],w=h[0|u*s.scaleX*E]),L[A++]=255-b,L[A++]=255-y,L[A++]=255-v,L[A++]=255-w;break;default:throw new Error("Unsupported color mode")}return L},copyToImageData:function(t,e){var r,i,n,s,o,a,l,h,u,c=t.width,f=t.height,p=t.data,m=this.getData(c,f),g=0,w=0;switch(this.components.length){case 1:for(i=0;i<f;i++)for(r=0;r<c;r++)n=m[g++],p[w++]=n,p[w++]=n,p[w++]=n,e&&(p[w++]=255);break;case 3:for(i=0;i<f;i++)for(r=0;r<c;r++)l=m[g++],h=m[g++],u=m[g++],p[w++]=l,p[w++]=h,p[w++]=u,e&&(p[w++]=255);break;case 4:for(i=0;i<f;i++)for(r=0;r<c;r++)o=m[g++],a=m[g++],n=m[g++],s=m[g++],l=255-d(o*(1-s/255)+s),h=255-d(a*(1-s/255)+s),u=255-d(n*(1-s/255)+s),p[w++]=l,p[w++]=h,p[w++]=u,e&&(p[w++]=255);break;default:throw new Error("Unsupported color mode")}}};var p=0,m=0;function g(t=0){var e=p+t;if(e>m){var r=Math.ceil((e-m)/1024/1024);throw new Error(`maxMemoryUsageInMB limit exceeded by at least ${r}MB`)}p=e}return h.resetMaxMemoryUsage=function(t){p=0,m=t},h.getBytesAllocated=function(){return p},h.requestMemoryAllocation=g,h}();function r(t,r={}){var i={colorTransform:void 0,useTArray:!1,formatAsRGBA:!0,tolerantDecoding:!0,maxResolutionInMP:100,maxMemoryUsageInMB:512},n={...i,...r},s=new Uint8Array(t),o=new e;o.opts=n,e.resetMaxMemoryUsage(1024*n.maxMemoryUsageInMB*1024),o.parse(s);var a=n.formatAsRGBA?4:3,l=o.width*o.height*a;try{e.requestMemoryAllocation(l);var h={width:o.width,height:o.height,exifBuffer:o.exifBuffer,data:n.useTArray?new Uint8Array(l):Buffer.alloc(l)};o.comments.length>0&&(h["comments"]=o.comments)}catch(u){if(u instanceof RangeError)throw new Error("Could not allocate enough memory for the image. Required: "+l);if(u instanceof ReferenceError&&"Buffer is not defined"===u.message)throw new Error("Buffer is not globally defined in this environment. Consider setting useTArray to true");throw u}return o.copyToImageData(h,n.formatAsRGBA),h}t.exports=r},52521:function(t){function e(t){Math.round;var e,r,i,n,s,o=Math.floor,a=new Array(64),l=new Array(64),h=new Array(64),u=new Array(64),c=new Array(65535),f=new Array(65535),d=new Array(64),p=new Array(64),m=[],g=0,w=7,b=new Array(64),y=new Array(64),v=new Array(64),x=new Array(256),k=new Array(2048),_=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],M=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],E=[0,1,2,3,4,5,6,7,8,9,10,11],S=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],A=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],C=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],L=[0,1,2,3,4,5,6,7,8,9,10,11],I=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],D=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];function R(t){for(var e=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],r=0;r<64;r++){var i=o((e[r]*t+50)/100);i<1?i=1:i>255&&(i=255),a[_[r]]=i}for(var n=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],s=0;s<64;s++){var c=o((n[s]*t+50)/100);c<1?c=1:c>255&&(c=255),l[_[s]]=c}for(var f=[1,1.387039845,1.306562965,1.175875602,1,.785694958,.5411961,.275899379],d=0,p=0;p<8;p++)for(var m=0;m<8;m++)h[d]=1/(a[_[d]]*f[p]*f[m]*8),u[d]=1/(l[_[d]]*f[p]*f[m]*8),d++}function P(t,e){for(var r=0,i=0,n=new Array,s=1;s<=16;s++){for(var o=1;o<=t[s];o++)n[e[i]]=[],n[e[i]][0]=r,n[e[i]][1]=s,i++,r++;r*=2}return n}function T(){e=P(M,E),r=P(C,L),i=P(S,A),n=P(I,D)}function F(){for(var t=1,e=2,r=1;r<=15;r++){for(var i=t;i<e;i++)f[32767+i]=r,c[32767+i]=[],c[32767+i][1]=r,c[32767+i][0]=i;for(var n=-(e-1);n<=-t;n++)f[32767+n]=r,c[32767+n]=[],c[32767+n][1]=r,c[32767+n][0]=e-1+n;t<<=1,e<<=1}}function B(){for(var t=0;t<256;t++)k[t]=19595*t,k[t+256|0]=38470*t,k[t+512|0]=7471*t+32768,k[t+768|0]=-11059*t,k[t+1024|0]=-21709*t,k[t+1280|0]=32768*t+8421375,k[t+1536|0]=-27439*t,k[t+1792|0]=-5329*t}function U(t){var e=t[0],r=t[1]-1;while(r>=0)e&1<<r&&(g|=1<<w),r--,w--,w<0&&(255==g?(O(255),O(0)):O(g),w=7,g=0)}function O(t){m.push(t)}function N(t){O(t>>8&255),O(255&t)}function z(t,e){var r,i,n,s,o,a,l,h,u,c,f=0,p=8,m=64;for(u=0;u<p;++u){r=t[f],i=t[f+1],n=t[f+2],s=t[f+3],o=t[f+4],a=t[f+5],l=t[f+6],h=t[f+7];var g=r+h,w=r-h,b=i+l,y=i-l,v=n+a,x=n-a,k=s+o,_=s-o,M=g+k,E=g-k,S=b+v,A=b-v;t[f]=M+S,t[f+4]=M-S;var C=.707106781*(A+E);t[f+2]=E+C,t[f+6]=E-C,M=_+x,S=x+y,A=y+w;var L=.382683433*(M-A),I=.5411961*M+L,D=1.306562965*A+L,R=.707106781*S,P=w+R,T=w-R;t[f+5]=T+I,t[f+3]=T-I,t[f+1]=P+D,t[f+7]=P-D,f+=8}for(f=0,u=0;u<p;++u){r=t[f],i=t[f+8],n=t[f+16],s=t[f+24],o=t[f+32],a=t[f+40],l=t[f+48],h=t[f+56];var F=r+h,B=r-h,U=i+l,O=i-l,N=n+a,z=n-a,j=s+o,X=s-o,$=F+j,V=F-j,Y=U+N,q=U-N;t[f]=$+Y,t[f+32]=$-Y;var G=.707106781*(q+V);t[f+16]=V+G,t[f+48]=V-G,$=X+z,Y=z+O,q=O+B;var H=.382683433*($-q),W=.5411961*$+H,K=1.306562965*q+H,Q=.707106781*Y,Z=B+Q,J=B-Q;t[f+40]=J+W,t[f+24]=J-W,t[f+8]=Z+K,t[f+56]=Z-K,f++}for(u=0;u<m;++u)c=t[u]*e[u],d[u]=c>0?c+.5|0:c-.5|0;return d}function j(){N(65504),N(16),O(74),O(70),O(73),O(70),O(0),O(1),O(1),O(0),N(1),N(1),O(0),O(0)}function X(t){if(t){N(65505),69===t[0]&&120===t[1]&&105===t[2]&&102===t[3]?N(t.length+2):(N(t.length+5+2),O(69),O(120),O(105),O(102),O(0));for(var e=0;e<t.length;e++)O(t[e])}}function $(t,e){N(65472),N(17),O(8),N(e),N(t),O(3),O(1),O(17),O(0),O(2),O(17),O(1),O(3),O(17),O(1)}function V(){N(65499),N(132),O(0);for(var t=0;t<64;t++)O(a[t]);O(1);for(var e=0;e<64;e++)O(l[e])}function Y(){N(65476),N(418),O(0);for(var t=0;t<16;t++)O(M[t+1]);for(var e=0;e<=11;e++)O(E[e]);O(16);for(var r=0;r<16;r++)O(S[r+1]);for(var i=0;i<=161;i++)O(A[i]);O(1);for(var n=0;n<16;n++)O(C[n+1]);for(var s=0;s<=11;s++)O(L[s]);O(17);for(var o=0;o<16;o++)O(I[o+1]);for(var a=0;a<=161;a++)O(D[a])}function q(t){"undefined"!==typeof t&&t.constructor===Array&&t.forEach((t=>{if("string"===typeof t){N(65534);var e,r=t.length;for(N(r+2),e=0;e<r;e++)O(t.charCodeAt(e))}}))}function G(){N(65498),N(12),O(3),O(1),O(0),O(2),O(17),O(3),O(17),O(0),O(63),O(0)}function H(t,e,r,i,n){for(var s,o=n[0],a=n[240],l=16,h=63,u=64,d=z(t,e),m=0;m<u;++m)p[_[m]]=d[m];var g=p[0]-r;r=p[0],0==g?U(i[0]):(s=32767+g,U(i[f[s]]),U(c[s]));for(var w=63;w>0&&0==p[w];w--);if(0==w)return U(o),r;var b,y=1;while(y<=w){for(var v=y;0==p[y]&&y<=w;++y);var x=y-v;if(x>=l){b=x>>4;for(var k=1;k<=b;++k)U(a);x&=15}s=32767+p[y],U(n[(x<<4)+f[s]]),U(c[s]),y++}return w!=h&&U(o),r}function W(){for(var t=String.fromCharCode,e=0;e<256;e++)x[e]=t(e)}function K(t){if(t<=0&&(t=1),t>100&&(t=100),s!=t){var e=0;e=t<50?Math.floor(5e3/t):Math.floor(200-2*t),R(e),s=t}}function Q(){var e=(new Date).getTime();t||(t=50),W(),T(),F(),B(),K(t);(new Date).getTime()}this.encode=function(t,s){(new Date).getTime();s&&K(s),m=new Array,g=0,w=7,N(65496),j(),q(t.comments),X(t.exifBuffer),V(),$(t.width,t.height),Y(),G();var o=0,a=0,l=0;g=0,w=7,this.encode.displayName="_encode_";var c,f,d,p,x,_,M,E,S,A=t.data,C=t.width,L=t.height,I=4*C,D=0;while(D<L){c=0;while(c<I){for(x=I*D+c,_=x,M=-1,E=0,S=0;S<64;S++)E=S>>3,M=4*(7&S),_=x+E*I+M,D+E>=L&&(_-=I*(D+1+E-L)),c+M>=I&&(_-=c+M-I+4),f=A[_++],d=A[_++],p=A[_++],b[S]=(k[f]+k[d+256|0]+k[p+512|0]>>16)-128,y[S]=(k[f+768|0]+k[d+1024|0]+k[p+1280|0]>>16)-128,v[S]=(k[f+1280|0]+k[d+1536|0]+k[p+1792|0]>>16)-128;o=H(b,h,o,e,i),a=H(y,u,a,r,n),l=H(v,u,l,r,n),c+=32}D+=8}if(w>=0){var R=[];R[1]=w+1,R[0]=(1<<w+1)-1,U(R)}return N(65497),Buffer.from(m)},Q()}function r(t,r){"undefined"===typeof r&&(r=50);var i=new e(r),n=i.encode(t,r);return{data:n,width:t.width,height:t.height}}t.exports=r},80061:function(t){(function(e){t.exports=e()})((function(){return function t(e,r,i){function n(o,a){if(!r[o]){if(!e[o]){var l=void 0;if(!a&&l)return require(o,!0);if(s)return s(o,!0);var h=new Error("Cannot find module '"+o+"'");throw h.code="MODULE_NOT_FOUND",h}var u=r[o]={exports:{}};e[o][0].call(u.exports,(function(t){var r=e[o][1][t];return n(r||t)}),u,u.exports,t,e,r,i)}return r[o].exports}for(var s=void 0,o=0;o<i.length;o++)n(i[o]);return n}({1:[function(t,e,r){var i,n,s,o,a,l=function(t,e){for(var r in e)h.call(e,r)&&(t[r]=e[r]);function i(){this.constructor=t}return i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype,t},h={}.hasOwnProperty;i=t("./PriorityQueue/AbstractPriorityQueue"),n=t("./PriorityQueue/ArrayStrategy"),o=t("./PriorityQueue/BinaryHeapStrategy"),s=t("./PriorityQueue/BHeapStrategy"),a=function(t){function e(t){t||(t={}),t.strategy||(t.strategy=o),t.comparator||(t.comparator=function(t,e){return(t||0)-(e||0)}),e.__super__.constructor.call(this,t)}return l(e,t),e}(i),a.ArrayStrategy=n,a.BinaryHeapStrategy=o,a.BHeapStrategy=s,e.exports=a},{"./PriorityQueue/AbstractPriorityQueue":2,"./PriorityQueue/ArrayStrategy":3,"./PriorityQueue/BHeapStrategy":4,"./PriorityQueue/BinaryHeapStrategy":5}],2:[function(t,e,r){e.exports=function(){function t(t){var e;if(null==(null!=t?t.strategy:void 0))throw"Must pass options.strategy, a strategy";if(null==(null!=t?t.comparator:void 0))throw"Must pass options.comparator, a comparator";this.priv=new t.strategy(t),this.length=(null!=t&&null!=(e=t.initialValues)?e.length:void 0)||0}return t.prototype.queue=function(t){this.length++,this.priv.queue(t)},t.prototype.dequeue=function(t){if(!this.length)throw"Empty queue";return this.length--,this.priv.dequeue()},t.prototype.peek=function(t){if(!this.length)throw"Empty queue";return this.priv.peek()},t.prototype.clear=function(){return this.length=0,this.priv.clear()},t}()},{}],3:[function(t,e,r){var i;i=function(t,e,r){var i,n,s;n=0,i=t.length;while(n<i)s=n+i>>>1,r(t[s],e)>=0?n=s+1:i=s;return n},e.exports=function(){function t(t){var e;this.options=t,this.comparator=this.options.comparator,this.data=(null!=(e=this.options.initialValues)?e.slice(0):void 0)||[],this.data.sort(this.comparator).reverse()}return t.prototype.queue=function(t){var e;e=i(this.data,t,this.comparator),this.data.splice(e,0,t)},t.prototype.dequeue=function(){return this.data.pop()},t.prototype.peek=function(){return this.data[this.data.length-1]},t.prototype.clear=function(){this.data.length=0},t}()},{}],4:[function(t,e,r){e.exports=function(){function t(t){var e,r,i,n,s,o,a,l;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.pageSize=(null!=t?t.pageSize:void 0)||512,this.length=0,a=0;while(1<<a<this.pageSize)a+=1;if(1<<a!==this.pageSize)throw"pageSize must be a power of two";for(this._shift=a,this._emptyMemoryPageTemplate=e=[],r=0,s=this.pageSize;0<=s?r<s:r>s;0<=s?++r:--r)e.push(null);if(this._memory=[],this._mask=this.pageSize-1,t.initialValues)for(o=t.initialValues,i=0,n=o.length;i<n;i++)l=o[i],this.queue(l)}return t.prototype.queue=function(t){this.length+=1,this._write(this.length,t),this._bubbleUp(this.length,t)},t.prototype.dequeue=function(){var t,e;return t=this._read(1),e=this._read(this.length),this.length-=1,this.length>0&&(this._write(1,e),this._bubbleDown(1,e)),t},t.prototype.peek=function(){return this._read(1)},t.prototype.clear=function(){this.length=0,this._memory.length=0},t.prototype._write=function(t,e){var r;r=t>>this._shift;while(r>=this._memory.length)this._memory.push(this._emptyMemoryPageTemplate.slice(0));return this._memory[r][t&this._mask]=e},t.prototype._read=function(t){return this._memory[t>>this._shift][t&this._mask]},t.prototype._bubbleUp=function(t,e){var r,i,n,s;r=this.comparator;while(t>1){if(i=t&this._mask,t<this.pageSize||i>3?n=t&~this._mask|i>>1:i<2?(n=t-this.pageSize>>this._shift,n+=n&~(this._mask>>1),n|=this.pageSize>>1):n=t-2,s=this._read(n),r(s,e)<0)break;this._write(n,e),this._write(t,s),t=n}},t.prototype._bubbleDown=function(t,e){var r,i,n,s,o;o=this.comparator;while(t<this.length)if(t>this._mask&&!(t&this._mask-1)?r=i=t+2:t&this.pageSize>>1?(r=(t&~this._mask)>>1,r|=t&this._mask>>1,r=r+1<<this._shift,i=r+1):(r=t+(t&this._mask),i=r+1),r!==i&&i<=this.length)if(n=this._read(r),s=this._read(i),o(n,e)<0&&o(n,s)<=0)this._write(r,e),this._write(t,n),t=r;else{if(!(o(s,e)<0))break;this._write(i,e),this._write(t,s),t=i}else{if(!(r<=this.length))break;if(n=this._read(r),!(o(n,e)<0))break;this._write(r,e),this._write(t,n),t=r}},t}()},{}],5:[function(t,e,r){e.exports=function(){function t(t){var e;this.comparator=(null!=t?t.comparator:void 0)||function(t,e){return t-e},this.length=0,this.data=(null!=(e=t.initialValues)?e.slice(0):void 0)||[],this._heapify()}return t.prototype._heapify=function(){var t,e,r;if(this.data.length>0)for(t=e=1,r=this.data.length;1<=r?e<r:e>r;t=1<=r?++e:--e)this._bubbleUp(t)},t.prototype.queue=function(t){this.data.push(t),this._bubbleUp(this.data.length-1)},t.prototype.dequeue=function(){var t,e;return e=this.data[0],t=this.data.pop(),this.data.length>0&&(this.data[0]=t,this._bubbleDown(0)),e},t.prototype.peek=function(){return this.data[0]},t.prototype.clear=function(){this.length=0,this.data.length=0},t.prototype._bubbleUp=function(t){var e,r;while(t>0){if(e=t-1>>>1,!(this.comparator(this.data[t],this.data[e])<0))break;r=this.data[e],this.data[e]=this.data[t],this.data[t]=r,t=e}},t.prototype._bubbleDown=function(t){var e,r,i,n,s;e=this.data.length-1;while(1){if(r=1+(t<<1),n=r+1,i=t,r<=e&&this.comparator(this.data[r],this.data[i])<0&&(i=r),n<=e&&this.comparator(this.data[n],this.data[i])<0&&(i=n),i===t)break;s=this.data[i],this.data[i]=this.data[t],this.data[t]=s,t=i}},t}()},{}]},{},[1])(1)}))},24514:function(t){(function(e,r){t.exports=r()})(0,(function(){"use strict";function t(t){return"string"===typeof t||t instanceof String}var e=Number.isFinite||window.isFinite;function r(t){return e(t)}function i(t){return t}function n(t){var e={};return t.filter((function(t){return!e.hasOwnProperty(t)&&(e[t]=!0)}))}function s(t,e){if(e.length!==t.length)return!1;for(var r=0;r<t.length;r++){if(e[r].compareArray&&!e[r].compareArray(t[r]))return!1;if(e[r]!==t[r])return!1}return!0}function o(t,e){Object.keys(e).forEach((function(r){t[r]=e[r]}))}function a(){for(var t=1,e=0,r=0;r<arguments.length;r++){var i=arguments[r];e+=u(i),t*=i}return 0!==e?h(t,e):t}function l(t,e){if(0===e)throw new Error("Divide by zero");var r=Math.pow(10,u(e)),i=r/(r*e);return a(t,i)}function h(t,e){return Math.round(t*Math.pow(10,e))/Math.pow(10,e)}function u(t){if(!isFinite(t))return 0;var e=0;while(t%1!==0)t*=10,e++;return e}function c(){var t;if(!this)return t=Object.create(c.prototype),c.apply(t,arguments),t;t=Error.apply(this,arguments),this.name="QtyError",this.message=t.message,this.stack=t.stack}function f(t,e){throw new c("Incompatible units: "+t+" and "+e)}c.prototype=Object.create(Error.prototype,{constructor:{value:c}});var d={"<googol>":[["googol"],1e100,"prefix"],"<kibi>":[["Ki","Kibi","kibi"],Math.pow(2,10),"prefix"],"<mebi>":[["Mi","Mebi","mebi"],Math.pow(2,20),"prefix"],"<gibi>":[["Gi","Gibi","gibi"],Math.pow(2,30),"prefix"],"<tebi>":[["Ti","Tebi","tebi"],Math.pow(2,40),"prefix"],"<pebi>":[["Pi","Pebi","pebi"],Math.pow(2,50),"prefix"],"<exi>":[["Ei","Exi","exi"],Math.pow(2,60),"prefix"],"<zebi>":[["Zi","Zebi","zebi"],Math.pow(2,70),"prefix"],"<yebi>":[["Yi","Yebi","yebi"],Math.pow(2,80),"prefix"],"<yotta>":[["Y","Yotta","yotta"],1e24,"prefix"],"<zetta>":[["Z","Zetta","zetta"],1e21,"prefix"],"<exa>":[["E","Exa","exa"],1e18,"prefix"],"<peta>":[["P","Peta","peta"],1e15,"prefix"],"<tera>":[["T","Tera","tera"],1e12,"prefix"],"<giga>":[["G","Giga","giga"],1e9,"prefix"],"<mega>":[["M","Mega","mega"],1e6,"prefix"],"<kilo>":[["k","kilo"],1e3,"prefix"],"<hecto>":[["h","Hecto","hecto"],100,"prefix"],"<deca>":[["da","Deca","deca","deka"],10,"prefix"],"<deci>":[["d","Deci","deci"],.1,"prefix"],"<centi>":[["c","Centi","centi"],.01,"prefix"],"<milli>":[["m","Milli","milli"],.001,"prefix"],"<micro>":[["u","μ","µ","Micro","mc","micro"],1e-6,"prefix"],"<nano>":[["n","Nano","nano"],1e-9,"prefix"],"<pico>":[["p","Pico","pico"],1e-12,"prefix"],"<femto>":[["f","Femto","femto"],1e-15,"prefix"],"<atto>":[["a","Atto","atto"],1e-18,"prefix"],"<zepto>":[["z","Zepto","zepto"],1e-21,"prefix"],"<yocto>":[["y","Yocto","yocto"],1e-24,"prefix"],"<1>":[["1","<1>"],1,""],"<meter>":[["m","meter","meters","metre","metres"],1,"length",["<meter>"]],"<inch>":[["in","inch","inches",'"'],.0254,"length",["<meter>"]],"<foot>":[["ft","foot","feet","'"],.3048,"length",["<meter>"]],"<yard>":[["yd","yard","yards"],.9144,"length",["<meter>"]],"<mile>":[["mi","mile","miles"],1609.344,"length",["<meter>"]],"<naut-mile>":[["nmi","naut-mile"],1852,"length",["<meter>"]],"<league>":[["league","leagues"],4828,"length",["<meter>"]],"<furlong>":[["furlong","furlongs"],201.2,"length",["<meter>"]],"<rod>":[["rd","rod","rods"],5.029,"length",["<meter>"]],"<mil>":[["mil","mils"],254e-7,"length",["<meter>"]],"<angstrom>":[["ang","angstrom","angstroms"],1e-10,"length",["<meter>"]],"<fathom>":[["fathom","fathoms"],1.829,"length",["<meter>"]],"<pica>":[["pica","picas"],.00423333333,"length",["<meter>"]],"<point>":[["pt","point","points"],.000352777778,"length",["<meter>"]],"<redshift>":[["z","red-shift","redshift"],1302773e20,"length",["<meter>"]],"<AU>":[["AU","astronomical-unit"],1495979e5,"length",["<meter>"]],"<light-second>":[["ls","light-second"],299792500,"length",["<meter>"]],"<light-minute>":[["lmin","light-minute"],1798755e4,"length",["<meter>"]],"<light-year>":[["ly","light-year"],9460528e9,"length",["<meter>"]],"<parsec>":[["pc","parsec","parsecs"],3085678e10,"length",["<meter>"]],"<datamile>":[["DM","datamile"],1828.8,"length",["<meter>"]],"<kilogram>":[["kg","kilogram","kilograms"],1,"mass",["<kilogram>"]],"<AMU>":[["u","AMU","amu"],1660538921e-36,"mass",["<kilogram>"]],"<dalton>":[["Da","Dalton","Daltons","dalton","daltons"],1660538921e-36,"mass",["<kilogram>"]],"<slug>":[["slug","slugs"],14.5939029,"mass",["<kilogram>"]],"<short-ton>":[["tn","ton","short-ton"],907.18474,"mass",["<kilogram>"]],"<metric-ton>":[["t","tonne","metric-ton"],1e3,"mass",["<kilogram>"]],"<carat>":[["ct","carat","carats"],2e-4,"mass",["<kilogram>"]],"<pound>":[["lbs","lb","pound","pounds","#"],.45359237,"mass",["<kilogram>"]],"<ounce>":[["oz","ounce","ounces"],.0283495231,"mass",["<kilogram>"]],"<gram>":[["g","gram","grams","gramme","grammes"],.001,"mass",["<kilogram>"]],"<grain>":[["grain","grains","gr"],6479891e-11,"mass",["<kilogram>"]],"<dram>":[["dram","drams","dr"],.0017718452,"mass",["<kilogram>"]],"<stone>":[["stone","stones","st"],6.35029318,"mass",["<kilogram>"]],"<hectare>":[["hectare"],1e4,"area",["<meter>","<meter>"]],"<acre>":[["acre","acres"],4046.85642,"area",["<meter>","<meter>"]],"<sqft>":[["sqft"],1,"area",["<foot>","<foot>"]],"<liter>":[["l","L","liter","liters","litre","litres"],.001,"volume",["<meter>","<meter>","<meter>"]],"<gallon>":[["gal","gallon","gallons"],.0037854118,"volume",["<meter>","<meter>","<meter>"]],"<gallon-imp>":[["galimp","gallon-imp","gallons-imp"],.00454609,"volume",["<meter>","<meter>","<meter>"]],"<quart>":[["qt","quart","quarts"],.00094635295,"volume",["<meter>","<meter>","<meter>"]],"<pint>":[["pt","pint","pints"],.000473176475,"volume",["<meter>","<meter>","<meter>"]],"<pint-imp>":[["ptimp","pint-imp","pints-imp"],.00056826125,"volume",["<meter>","<meter>","<meter>"]],"<cup>":[["cu","cup","cups"],.000236588238,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce>":[["floz","fluid-ounce","fluid-ounces"],295735297e-13,"volume",["<meter>","<meter>","<meter>"]],"<fluid-ounce-imp>":[["flozimp","floz-imp","fluid-ounce-imp","fluid-ounces-imp"],284130625e-13,"volume",["<meter>","<meter>","<meter>"]],"<tablespoon>":[["tb","tbsp","tbs","tablespoon","tablespoons"],147867648e-13,"volume",["<meter>","<meter>","<meter>"]],"<teaspoon>":[["tsp","teaspoon","teaspoons"],492892161e-14,"volume",["<meter>","<meter>","<meter>"]],"<bushel>":[["bu","bsh","bushel","bushels"],.035239072,"volume",["<meter>","<meter>","<meter>"]],"<oilbarrel>":[["bbl","oilbarrel","oilbarrels","oil-barrel","oil-barrels"],.158987294928,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel>":[["bl","bl-us","beerbarrel","beerbarrels","beer-barrel","beer-barrels"],.1173477658,"volume",["<meter>","<meter>","<meter>"]],"<beerbarrel-imp>":[["blimp","bl-imp","beerbarrel-imp","beerbarrels-imp","beer-barrel-imp","beer-barrels-imp"],.16365924,"volume",["<meter>","<meter>","<meter>"]],"<kph>":[["kph"],.277777778,"speed",["<meter>"],["<second>"]],"<mph>":[["mph"],.44704,"speed",["<meter>"],["<second>"]],"<knot>":[["kt","kn","kts","knot","knots"],.514444444,"speed",["<meter>"],["<second>"]],"<fps>":[["fps"],.3048,"speed",["<meter>"],["<second>"]],"<gee>":[["gee"],9.80665,"acceleration",["<meter>"],["<second>","<second>"]],"<Gal>":[["Gal"],.01,"acceleration",["<meter>"],["<second>","<second>"]],"<kelvin>":[["degK","kelvin"],1,"temperature",["<kelvin>"]],"<celsius>":[["degC","celsius","celsius","centigrade"],1,"temperature",["<kelvin>"]],"<fahrenheit>":[["degF","fahrenheit"],5/9,"temperature",["<kelvin>"]],"<rankine>":[["degR","rankine"],5/9,"temperature",["<kelvin>"]],"<temp-K>":[["tempK","temp-K"],1,"temperature",["<temp-K>"]],"<temp-C>":[["tempC","temp-C"],1,"temperature",["<temp-K>"]],"<temp-F>":[["tempF","temp-F"],5/9,"temperature",["<temp-K>"]],"<temp-R>":[["tempR","temp-R"],5/9,"temperature",["<temp-K>"]],"<second>":[["s","sec","secs","second","seconds"],1,"time",["<second>"]],"<minute>":[["min","mins","minute","minutes"],60,"time",["<second>"]],"<hour>":[["h","hr","hrs","hour","hours"],3600,"time",["<second>"]],"<day>":[["d","day","days"],86400,"time",["<second>"]],"<week>":[["wk","week","weeks"],604800,"time",["<second>"]],"<fortnight>":[["fortnight","fortnights"],1209600,"time",["<second>"]],"<year>":[["y","yr","year","years","annum"],31556926,"time",["<second>"]],"<decade>":[["decade","decades"],315569260,"time",["<second>"]],"<century>":[["century","centuries"],3155692600,"time",["<second>"]],"<pascal>":[["Pa","pascal","Pascal"],1,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<bar>":[["bar","bars"],1e5,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<mmHg>":[["mmHg"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inHg>":[["inHg"],3386.3881472,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<torr>":[["torr"],133.322368,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<atm>":[["atm","ATM","atmosphere","atmospheres"],101325,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<psi>":[["psi"],6894.76,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<cmh2o>":[["cmH2O","cmh2o"],98.0638,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<inh2o>":[["inH2O","inh2o"],249.082052,"pressure",["<kilogram>"],["<meter>","<second>","<second>"]],"<poise>":[["P","poise"],.1,"viscosity",["<kilogram>"],["<meter>","<second>"]],"<stokes>":[["St","stokes"],1e-4,"viscosity",["<meter>","<meter>"],["<second>"]],"<mole>":[["mol","mole"],1,"substance",["<mole>"]],"<molar>":[["M","molar"],1e3,"molar_concentration",["<mole>"],["<meter>","<meter>","<meter>"]],"<wtpercent>":[["wt%","wtpercent"],10,"molar_concentration",["<kilogram>"],["<meter>","<meter>","<meter>"]],"<katal>":[["kat","katal","Katal"],1,"activity",["<mole>"],["<second>"]],"<unit>":[["U","enzUnit","unit"],16667e-19,"activity",["<mole>"],["<second>"]],"<farad>":[["F","farad","Farad"],1,"capacitance",["<second>","<second>","<second>","<second>","<ampere>","<ampere>"],["<meter>","<meter>","<kilogram>"]],"<coulomb>":[["C","coulomb","Coulomb"],1,"charge",["<ampere>","<second>"]],"<Ah>":[["Ah"],3600,"charge",["<ampere>","<second>"]],"<ampere>":[["A","Ampere","ampere","amp","amps"],1,"current",["<ampere>"]],"<siemens>":[["S","Siemens","siemens"],1,"conductance",["<second>","<second>","<second>","<ampere>","<ampere>"],["<kilogram>","<meter>","<meter>"]],"<henry>":[["H","Henry","henry"],1,"inductance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>","<ampere>"]],"<volt>":[["V","Volt","volt","volts"],1,"potential",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>"]],"<ohm>":[["Ohm","ohm","Ω","Ω"],1,"resistance",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<second>","<ampere>","<ampere>"]],"<weber>":[["Wb","weber","webers"],1,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<tesla>":[["T","tesla","teslas"],1,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<gauss>":[["G","gauss"],1e-4,"magnetism",["<kilogram>"],["<second>","<second>","<ampere>"]],"<maxwell>":[["Mx","maxwell","maxwells"],1e-8,"magnetism",["<meter>","<meter>","<kilogram>"],["<second>","<second>","<ampere>"]],"<oersted>":[["Oe","oersted","oersteds"],250/Math.PI,"magnetism",["<ampere>"],["<meter>"]],"<joule>":[["J","joule","Joule","joules","Joules"],1,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<erg>":[["erg","ergs"],1e-7,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<btu>":[["BTU","btu","BTUs"],1055.056,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<calorie>":[["cal","calorie","calories"],4.184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Calorie>":[["Cal","Calorie","Calories"],4184,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<therm-US>":[["th","therm","therms","Therm","therm-US"],105480400,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<Wh>":[["Wh"],3600,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<electronvolt>":[["eV","electronvolt","electronvolts"],1602176634e-28,"energy",["<meter>","<meter>","<kilogram>"],["<second>","<second>"]],"<newton>":[["N","Newton","newton"],1,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<dyne>":[["dyn","dyne"],1e-5,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<pound-force>":[["lbf","pound-force"],4.448222,"force",["<kilogram>","<meter>"],["<second>","<second>"]],"<hertz>":[["Hz","hertz","Hertz"],1,"frequency",["<1>"],["<second>"]],"<radian>":[["rad","radian","radians"],1,"angle",["<radian>"]],"<degree>":[["deg","degree","degrees"],Math.PI/180,"angle",["<radian>"]],"<arcminute>":[["arcmin","arcminute","arcminutes"],Math.PI/10800,"angle",["<radian>"]],"<arcsecond>":[["arcsec","arcsecond","arcseconds"],Math.PI/648e3,"angle",["<radian>"]],"<gradian>":[["gon","grad","gradian","grads"],Math.PI/200,"angle",["<radian>"]],"<steradian>":[["sr","steradian","steradians"],1,"solid_angle",["<steradian>"]],"<rotation>":[["rotation"],2*Math.PI,"angle",["<radian>"]],"<rpm>":[["rpm"],2*Math.PI/60,"angular_velocity",["<radian>"],["<second>"]],"<byte>":[["B","byte","bytes"],1,"information",["<byte>"]],"<bit>":[["b","bit","bits"],.125,"information",["<byte>"]],"<Bps>":[["Bps"],1,"information_rate",["<byte>"],["<second>"]],"<bps>":[["bps"],.125,"information_rate",["<byte>"],["<second>"]],"<dollar>":[["USD","dollar"],1,"currency",["<dollar>"]],"<cents>":[["cents"],.01,"currency",["<dollar>"]],"<candela>":[["cd","candela"],1,"luminosity",["<candela>"]],"<lumen>":[["lm","lumen"],1,"luminous_power",["<candela>","<steradian>"]],"<lux>":[["lux"],1,"illuminance",["<candela>","<steradian>"],["<meter>","<meter>"]],"<watt>":[["W","watt","watts"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere>":[["VA","volt-ampere"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<volt-ampere-reactive>":[["var","Var","VAr","VAR","volt-ampere-reactive"],1,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<horsepower>":[["hp","horsepower"],745.699872,"power",["<kilogram>","<meter>","<meter>"],["<second>","<second>","<second>"]],"<gray>":[["Gy","gray","grays"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<roentgen>":[["R","roentgen"],.00933,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<sievert>":[["Sv","sievert","sieverts"],1,"radiation",["<meter>","<meter>"],["<second>","<second>"]],"<becquerel>":[["Bq","becquerel","becquerels"],1,"radiation",["<1>"],["<second>"]],"<curie>":[["Ci","curie","curies"],37e9,"radiation",["<1>"],["<second>"]],"<cpm>":[["cpm"],1/60,"rate",["<count>"],["<second>"]],"<dpm>":[["dpm"],1/60,"rate",["<count>"],["<second>"]],"<bpm>":[["bpm"],1/60,"rate",["<count>"],["<second>"]],"<dot>":[["dot","dots"],1,"resolution",["<each>"]],"<pixel>":[["pixel","px"],1,"resolution",["<each>"]],"<ppi>":[["ppi"],1,"resolution",["<pixel>"],["<inch>"]],"<dpi>":[["dpi"],1,"typography",["<dot>"],["<inch>"]],"<cell>":[["cells","cell"],1,"counting",["<each>"]],"<each>":[["each"],1,"counting",["<each>"]],"<count>":[["count"],1,"counting",["<each>"]],"<base-pair>":[["bp","base-pair"],1,"counting",["<each>"]],"<nucleotide>":[["nt","nucleotide"],1,"counting",["<each>"]],"<molecule>":[["molecule","molecules"],1,"counting",["<1>"]],"<dozen>":[["doz","dz","dozen"],12,"prefix_only",["<each>"]],"<percent>":[["%","percent"],.01,"prefix_only",["<1>"]],"<ppm>":[["ppm"],1e-6,"prefix_only",["<1>"]],"<ppb>":[["ppb"],1e-9,"prefix_only",["<1>"]],"<ppt>":[["ppt"],1e-12,"prefix_only",["<1>"]],"<ppq>":[["ppq"],1e-15,"prefix_only",["<1>"]],"<gross>":[["gr","gross"],144,"prefix_only",["<dozen>","<dozen>"]],"<decibel>":[["dB","decibel","decibels"],1,"logarithmic",["<decibel>"]]},p=["<meter>","<kilogram>","<second>","<mole>","<ampere>","<radian>","<kelvin>","<temp-K>","<byte>","<dollar>","<candela>","<each>","<steradian>","<decibel>"],m="<1>",g=[m];function w(t,e){var i=e[1],n=e[3]||[],s=e[4]||[];if(!r(i))throw new c(t+": Invalid unit definition. 'scalar' must be a number");n.forEach((function(e){if(void 0===d[e])throw new c(t+": Invalid unit definition. Unit "+e+" in 'numerator' is not recognized")})),s.forEach((function(e){if(void 0===d[e])throw new c(t+": Invalid unit definition. Unit "+e+" in 'denominator' is not recognized")}))}var b={},y={},v={},x={},k={};for(var _ in d)if(d.hasOwnProperty(_)){var M=d[_];if("prefix"===M[2]){b[_]=M[1];for(var E=0;E<M[0].length;E++)y[M[0][E]]=_}else{w(_,M),v[_]={scalar:M[1],numerator:M[3],denominator:M[4]};for(var S=0;S<M[0].length;S++)x[M[0][S]]=_}k[_]=M[0][0]}function A(t){var e,r=[],i=Object.keys(d);if("undefined"===typeof t)for(e=0;e<i.length;e++)-1===["","prefix"].indexOf(d[i[e]][2])&&r.push(i[e].substr(1,i[e].length-2));else{if(-1===this.getKinds().indexOf(t))throw new c("Kind not recognized");for(e=0;e<i.length;e++)d[i[e]][2]===t&&r.push(i[e].substr(1,i[e].length-2))}return r.sort((function(t,e){return t.toLowerCase()<e.toLowerCase()?-1:t.toLowerCase()>e.toLowerCase()?1:0}))}function C(t){if(!x[t])throw new c("Unit not recognized");return d[x[t]][0]}var L=["length","time","temperature","mass","current","substance","luminosity","currency","information","angle"];function I(){if(this.signature)return this.signature;for(var t=D.call(this),e=0;e<t.length;e++)t[e]*=Math.pow(20,e);return t.reduce((function(t,e){return t+e}),0)}function D(){if(!this.isBase())return D.call(this.toBase());for(var t,e,r=new Array(L.length),i=0;i<r.length;i++)r[i]=0;for(var n=0;n<this.numerator.length;n++)(t=d[this.numerator[n]])&&(e=L.indexOf(t[2]),e>=0&&(r[e]=r[e]+1));for(var s=0;s<this.denominator.length;s++)(t=d[this.denominator[s]])&&(e=L.indexOf(t[2]),e>=0&&(r[e]=r[e]-1));return r}var R="[+-]",P="\\d+",T=R+"?"+P,F="\\."+P,B="(?:"+P+"(?:"+F+")?)|(?:"+F+")",U="[Ee]"+T,O="(?:"+B+")(?:"+U+")?",N=R+"?\\s*"+O,z="("+N+")?\\s*([^/]*)(?:/(.+))?",j=new RegExp("^"+z+"$"),X="\\^|\\*{2}",$="[01234]",V=new RegExp("([^ \\*\\d]+?)(?:"+X+")?(-?"+$+"(?![a-zA-Z]))"),Y=new RegExp("([^ \\*\\d]+?)(?:"+X+")?("+$+"(?![a-zA-Z]))");function q(e){t(e)||(e=e.toString()),e=e.trim();var r=j.exec(e);if(!r)throw new c(e+": Quantity not recognized");var i=r[1];i?(i=i.replace(/\s/g,""),this.scalar=parseFloat(i)):this.scalar=1;var n,s,o,a=r[2],l=r[3];while(r=V.exec(a)){if(n=parseFloat(r[2]),isNaN(n))throw new c("Unit exponent is not a number");if(0===n&&!Q.test(r[1]))throw new c("Unit not recognized");s=r[1]+" ",o="";for(var h=0;h<Math.abs(n);h++)o+=s;n>=0?a=a.replace(r[0],o):(l=l?l+o:o,a=a.replace(r[0],""))}while(r=Y.exec(l)){if(n=parseFloat(r[2]),isNaN(n))throw new c("Unit exponent is not a number");if(0===n&&!Q.test(r[1]))throw new c("Unit not recognized");s=r[1]+" ",o="";for(var u=0;u<n;u++)o+=s;l=l.replace(r[0],o)}a&&(this.numerator=tt(a.trim())),l&&(this.denominator=tt(l.trim()))}var G=Object.keys(y).sort((function(t,e){return e.length-t.length})).join("|"),H=Object.keys(x).sort((function(t,e){return e.length-t.length})).join("|"),W="\\b|$",K="("+G+")??("+H+")(?:"+W+")",Q=new RegExp("^\\s*("+K+"[\\s\\*]*)+$"),Z=new RegExp(K,"g"),J={};function tt(t){var e=J[t];if(e)return e;var r,i=[];if(!Q.test(t))throw new c("Unit not recognized");while(r=Z.exec(t))i.push(r.slice(1));return i=i.map((function(t){return y[t[0]]?[y[t[0]],x[t[1]]]:[x[t[1]]]})),i=i.reduce((function(t,e){return t.concat(e)}),[]),i=i.filter((function(t){return t})),J[t]=i,i}function et(e){if(!t(e))throw new c("Argument should be a string");try{return this(e)}catch(r){return null}}function rt(t){return t instanceof it}function it(t,e){if(nt.apply(null,arguments),!rt(this))return new it(t,e);if(this.scalar=null,this.baseScalar=null,this.signature=null,this._conversionCache={},this.numerator=g,this.denominator=g,st(t)?(this.scalar=t.scalar,this.numerator=t.numerator&&0!==t.numerator.length?t.numerator:g,this.denominator=t.denominator&&0!==t.denominator.length?t.denominator:g):e?(q.call(this,e),this.scalar=t):q.call(this,t),this.denominator.join("*").indexOf("temp")>=0)throw new c("Cannot divide with temperatures");if(this.numerator.join("*").indexOf("temp")>=0){if(this.numerator.length>1)throw new c("Cannot multiply by temperatures");if(!s(this.denominator,g))throw new c("Cannot divide with temperatures")}if(this.initValue=t,ot.call(this),this.isTemperature()&&this.baseScalar<0)throw new c("Temperatures must not be less than absolute zero")}function nt(e,i){if(i){if(!r(e)||!t(i))throw new c("Only number accepted as initialization value when units are explicitly provided")}else if(!(t(e)||r(e)||rt(e)||st(e)))throw new c("Only string, number or quantity accepted as single initialization value")}function st(t){return t&&"object"===typeof t&&t.hasOwnProperty("scalar")}function ot(){if(this.baseScalar)return this.baseScalar;if(this.isBase())this.baseScalar=this.scalar,this.signature=I.call(this);else{var t=this.toBase();this.baseScalar=t.scalar,this.signature=t.signature}}it.prototype={constructor:it};var at={"-312078":"elastance","-312058":"resistance","-312038":"inductance","-152058":"potential","-152040":"magnetism","-152038":"magnetism","-7997":"specific_volume","-79":"snap","-59":"jolt","-39":"acceleration","-38":"radiation","-20":"frequency","-19":"speed","-18":"viscosity","-17":"volumetric_flow","-1":"wavenumber",0:"unitless",1:"length",2:"area",3:"volume",20:"time",400:"temperature",7941:"yank",7942:"power",7959:"pressure",7961:"force",7962:"energy",7979:"viscosity",7981:"momentum",7982:"angular_momentum",7997:"density",7998:"area_density",8e3:"mass",152020:"radiation_exposure",159999:"magnetism",16e4:"current",160020:"charge",312058:"conductance",312078:"capacitance",3199980:"activity",3199997:"molar_concentration",32e5:"substance",63999998:"illuminance",64e6:"luminous_power",128e7:"currency",25599999980:"information_rate",256e8:"information",511999999980:"angular_velocity",512e9:"angle"};function lt(){return n(Object.keys(at).map((function(t){return at[t]})))}function ht(t,e){var r=t.units(),i=e.to(r),n=it(ft(r));return it({scalar:t.scalar-i.scalar,numerator:n.numerator,denominator:n.denominator})}function ut(t,e){var r=e.to(ft(t.units()));return it({scalar:t.scalar-r.scalar,numerator:t.numerator,denominator:t.denominator})}function ct(t,e){var r=e.to(ft(t.units()));return it({scalar:t.scalar+r.scalar,numerator:t.numerator,denominator:t.denominator})}function ft(t){if("tempK"===t)return"degK";if("tempC"===t)return"degC";if("tempF"===t)return"degF";if("tempR"===t)return"degR";throw new c("Unknown type for temp conversion from: "+t)}function dt(t,e){var r,i=pt(t),n=e.units();if("degK"===n)r=i.scalar;else if("degC"===n)r=i.scalar;else if("degF"===n)r=9*i.scalar/5;else{if("degR"!==n)throw new c("Unknown type for degree conversion to: "+n);r=9*i.scalar/5}return it({scalar:r,numerator:e.numerator,denominator:e.denominator})}function pt(t){var e,r=t.units();if(r.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===r)e=t.scalar;else if("tempC"===r)e=t.scalar;else if("tempF"===r)e=5*t.scalar/9;else{if("tempR"!==r)throw new c("Unknown type for temp conversion from: "+r);e=5*t.scalar/9}return it({scalar:e,numerator:["<kelvin>"],denominator:g})}function mt(t,e){var r,i=e.units();if("tempK"===i)r=t.baseScalar;else if("tempC"===i)r=t.baseScalar-273.15;else if("tempF"===i)r=9*t.baseScalar/5-459.67;else{if("tempR"!==i)throw new c("Unknown type for temp conversion to: "+i);r=9*t.baseScalar/5}return it({scalar:r,numerator:e.numerator,denominator:e.denominator})}function gt(t){var e,r=t.units();if(r.match(/(deg)[CFRK]/))e=t.baseScalar;else if("tempK"===r)e=t.scalar;else if("tempC"===r)e=t.scalar+273.15;else if("tempF"===r)e=5*(t.scalar+459.67)/9;else{if("tempR"!==r)throw new c("Unknown type for temp conversion from: "+r);e=5*t.scalar/9}return it({scalar:e,numerator:["<temp-K>"],denominator:g})}function wt(t,e){var r,n=it(t),s=it(e);return n.eq(s)?i:(r=n.isTemperature()?function(t){return n.mul(t).to(s).scalar}:function(t){return t*n.baseScalar/s.baseScalar},function(t){var e,i,n;if(Array.isArray(t)){for(i=t.length,n=[],e=0;e<i;e++)n.push(r(t[e]));return n}return r(t)})}it.prototype.kind=function(){return at[this.signature.toString()]},o(it.prototype,{isDegrees:function(){return(null===this.signature||400===this.signature)&&1===this.numerator.length&&s(this.denominator,g)&&(this.numerator[0].match(/<temp-[CFRK]>/)||this.numerator[0].match(/<(kelvin|celsius|rankine|fahrenheit)>/))},isTemperature:function(){return this.isDegrees()&&this.numerator[0].match(/<temp-[CFRK]>/)}}),o(it.prototype,{to:function(e){var r,i;if(void 0===e||null===e)return this;if(!t(e))return this.to(e.units());if(r=this._conversionCache[e],r)return r;if(i=it(e),i.units()===this.units())return this;if(this.isCompatible(i))if(i.isTemperature())i=mt(this,i);else if(i.isDegrees())i=dt(this,i);else{var n=l(this.baseScalar,i.baseScalar);i=it({scalar:n,numerator:i.numerator,denominator:i.denominator})}else this.isInverse(i)?i=this.inverse().to(e):f(this.units(),i.units());return this._conversionCache[e]=i,i},toBase:function(){if(this.isBase())return this;if(this.isTemperature())return gt(this);var t=bt[this.units()];return t||(t=yt(this.numerator,this.denominator),bt[this.units()]=t),t.mul(this.scalar)},toFloat:function(){if(this.isUnitless())return this.scalar;throw new c("Can't convert to Float unless unitless.  Use Unit#scalar")},toPrec:function(e){if(t(e)&&(e=it(e)),r(e)&&(e=it(e+" "+this.units())),this.isUnitless()?e.isUnitless()||f(this.units(),e.units()):e=e.to(this.units()),0===e.scalar)throw new c("Divide by zero");var i=a(Math.round(this.scalar/e.scalar),e.scalar);return it(i+this.units())}});var bt={};function yt(t,e){for(var r,i=[],n=[],s=1,o=0;o<t.length;o++)r=t[o],b[r]?s=a(s,b[r]):v[r]&&(s*=v[r].scalar,v[r].numerator&&i.push(v[r].numerator),v[r].denominator&&n.push(v[r].denominator));for(var l=0;l<e.length;l++)r=e[l],b[r]?s/=b[r]:v[r]&&(s/=v[r].scalar,v[r].numerator&&n.push(v[r].numerator),v[r].denominator&&i.push(v[r].denominator));return i=i.reduce((function(t,e){return t.concat(e)}),[]),n=n.reduce((function(t,e){return t.concat(e)}),[]),it({scalar:s,numerator:i,denominator:n})}function vt(t,e,r,i){function n(t){return t!==m}t=t.filter(n),r=r.filter(n),e=e.filter(n),i=i.filter(n);var s={};function o(t,e){for(var r,i,n,o=0;o<t.length;o++)if(b[t[o]]?(r=t[o+1],i=t[o],n=b[i],o++):(r=t[o],i=null,n=1),r&&r!==m)if(s[r]){s[r][0]+=e;var a=s[r][2]?b[s[r][2]]:1;s[r][1===e?3:4]*=l(n,a)}else s[r]=[e,r,i,1,1]}o(t,1),o(e,-1),o(r,1),o(i,-1);var a=[],h=[],u=1;for(var c in s)if(s.hasOwnProperty(c)){var f,d=s[c];if(d[0]>0)for(f=0;f<d[0];f++)a.push(null===d[2]?d[1]:[d[2],d[1]]);else if(d[0]<0)for(f=0;f<-d[0];f++)h.push(null===d[2]?d[1]:[d[2],d[1]]);u*=l(d[3],d[4])}return 0===a.length&&(a=g),0===h.length&&(h=g),a=a.reduce((function(t,e){return t.concat(e)}),[]),h=h.reduce((function(t,e){return t.concat(e)}),[]),[a,h,u]}function xt(){}function kt(t,e){return(t+" "+e).trim()}it.parse=et,it.getUnits=A,it.getAliases=C,it.mulSafe=a,it.divSafe=l,it.getKinds=lt,it.swiftConverter=wt,it.Error=c,o(it.prototype,{add:function(e){if(t(e)&&(e=it(e)),this.isCompatible(e)||f(this.units(),e.units()),this.isTemperature()&&e.isTemperature())throw new c("Cannot add two temperatures");return this.isTemperature()?ct(this,e):e.isTemperature()?ct(e,this):it({scalar:this.scalar+e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},sub:function(e){if(t(e)&&(e=it(e)),this.isCompatible(e)||f(this.units(),e.units()),this.isTemperature()&&e.isTemperature())return ht(this,e);if(this.isTemperature())return ut(this,e);if(e.isTemperature())throw new c("Cannot subtract a temperature from a differential degree unit");return it({scalar:this.scalar-e.to(this).scalar,numerator:this.numerator,denominator:this.denominator})},mul:function(e){if(r(e))return it({scalar:a(this.scalar,e),numerator:this.numerator,denominator:this.denominator});if(t(e)&&(e=it(e)),(this.isTemperature()||e.isTemperature())&&!this.isUnitless()&&!e.isUnitless())throw new c("Cannot multiply by temperatures");var i=this,n=e;i.isCompatible(n)&&400!==i.signature&&(n=n.to(i));var s=vt(i.numerator,i.denominator,n.numerator,n.denominator);return it({scalar:a(i.scalar,n.scalar,s[2]),numerator:s[0],denominator:s[1]})},div:function(e){if(r(e)){if(0===e)throw new c("Divide by zero");return it({scalar:this.scalar/e,numerator:this.numerator,denominator:this.denominator})}if(t(e)&&(e=it(e)),0===e.scalar)throw new c("Divide by zero");if(e.isTemperature())throw new c("Cannot divide with temperatures");if(this.isTemperature()&&!e.isUnitless())throw new c("Cannot divide with temperatures");var i=this,n=e;i.isCompatible(n)&&400!==i.signature&&(n=n.to(i));var s=vt(i.numerator,i.denominator,n.denominator,n.numerator);return it({scalar:a(i.scalar,s[2])/n.scalar,numerator:s[0],denominator:s[1]})},inverse:function(){if(this.isTemperature())throw new c("Cannot divide with temperatures");if(0===this.scalar)throw new c("Divide by zero");return it({scalar:1/this.scalar,numerator:this.denominator,denominator:this.numerator})}}),o(it.prototype,{eq:function(t){return 0===this.compareTo(t)},lt:function(t){return-1===this.compareTo(t)},lte:function(t){return this.eq(t)||this.lt(t)},gt:function(t){return 1===this.compareTo(t)},gte:function(t){return this.eq(t)||this.gt(t)},compareTo:function(e){return t(e)?this.compareTo(it(e)):(this.isCompatible(e)||f(this.units(),e.units()),this.baseScalar<e.baseScalar?-1:this.baseScalar===e.baseScalar?0:this.baseScalar>e.baseScalar?1:void 0)},same:function(t){return this.scalar===t.scalar&&this.units()===t.units()}}),o(it.prototype,{isUnitless:function(){return[this.numerator,this.denominator].every((function(t){return s(t,g)}))},isCompatible:function(e){return t(e)?this.isCompatible(it(e)):!!rt(e)&&(void 0!==e.signature&&this.signature===e.signature)},isInverse:function(t){return this.inverse().isCompatible(t)},isBase:function(){return void 0!==this._isBase?this._isBase:this.isDegrees()&&this.numerator[0].match(/<(kelvin|temp-K)>/)?(this._isBase=!0,this._isBase):(this.numerator.concat(this.denominator).forEach((function(t){t!==m&&-1===p.indexOf(t)&&(this._isBase=!1)}),this),!1===this._isBase||(this._isBase=!0),this._isBase)}}),xt.prototype.get=function(t){return arguments.length>1&&(t=Array.apply(null,arguments)),t.reduce((function(e,r,i){if(e){var n=e[r];return i===t.length-1?n?n.data:void 0:n}}),this)},xt.prototype.set=function(t,e){return arguments.length>2&&(t=Array.prototype.slice.call(arguments,0,-1),e=arguments[arguments.length-1]),t.reduce((function(r,i,n){var s=r[i];return void 0===s&&(s=r[i]={}),n===t.length-1?(s.data=e,e):s}),this)},it.formatter=kt,o(it.prototype,{units:function(){if(void 0!==this._units)return this._units;var t=s(this.numerator,g),e=s(this.denominator,g);if(t&&e)return this._units="",this._units;var r=Mt(this.numerator),i=Mt(this.denominator);return this._units=r+(e?"":"/"+i),this._units},toString:function(e,i){var n;if(r(e))n=this.units(),i=e;else if(t(e))n=e;else if(rt(e))return this.toPrec(e).toString(i);var s=this.to(n),o=void 0!==i?h(s.scalar,i):s.scalar;return s=(o+" "+s.units()).trim(),s},format:function(t,e){1===arguments.length&&"function"===typeof t&&(e=t,t=void 0),e=e||it.formatter;var r=this.to(t);return e.call(this,r.scalar,r.units())}});var _t=new xt;function Mt(t){var e=_t.get(t);if(e)return e;var r=s(t,g);return e=r?"1":St(Et(t)).join("*"),_t.set(t,e),e}function Et(t){for(var e,r,i=[],n=0;n<t.length;n++)e=t[n],r=t[n+1],b[e]?(i.push(k[e]+k[r]),n++):i.push(k[e]);return i}function St(t){var e=t.reduce((function(t,e){var r=t[e];return r||t.push(r=t[e]=[e,0]),r[1]++,t}),[]);return e.map((function(t){return t[0]+(t[1]>1?t[1]:"")}))}return it.version="1.8.0",it}))},41587:function(t){(function(){function e(t){for(var e=0,n=t.length-1,s=void 0,o=void 0,a=void 0,l=i(e,n);1;){if(n<=e)return t[l];if(n==e+1)return t[e]>t[n]&&r(t,e,n),t[l];for(s=i(e,n),t[s]>t[n]&&r(t,s,n),t[e]>t[n]&&r(t,e,n),t[s]>t[e]&&r(t,s,e),r(t,s,e+1),o=e+1,a=n;1;){do{o++}while(t[e]>t[o]);do{a--}while(t[a]>t[e]);if(a<o)break;r(t,o,a)}r(t,e,a),a<=l&&(e=o),a>=l&&(n=a-1)}}var r=function(t,e,r){var i;return i=[t[r],t[e]],t[e]=i[0],t[r]=i[1],i},i=function(t,e){return~~((t+e)/2)};t.exports?t.exports=e:window.median=e})()},55826:function(t,e,r){"use strict";r.r(e),r.d(e,{default:function(){return o}});var i=r(70788);function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,s=e.toIndex,o=void 0===s?t.length:s;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],l=n+1;l<o;l++)t[l]>a&&(a=t[l]);return a}function s(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");var r=e.fromIndex,n=void 0===r?0:r,s=e.toIndex,o=void 0===s?t.length:s;if(n<0||n>=t.length||!Number.isInteger(n))throw new Error("fromIndex must be a positive integer smaller than length");if(o<=n||o>t.length||!Number.isInteger(o))throw new Error("toIndex must be an integer greater than fromIndex and at most equal to length");for(var a=t[n],l=n+1;l<o;l++)t[l]<a&&(a=t[l]);return a}function o(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!(0,i.isAnyArray)(t))throw new TypeError("input must be an array");if(0===t.length)throw new TypeError("input must not be empty");if(void 0!==r.output){if(!(0,i.isAnyArray)(r.output))throw new TypeError("output option must be an array if specified");e=r.output}else e=new Array(t.length);var o=s(t),a=n(t);if(o===a)throw new RangeError("minimum and maximum input values are equal. Cannot rescale a constant array");var l=r.min,h=void 0===l?r.autoMinMax?o:0:l,u=r.max,c=void 0===u?r.autoMinMax?a:1:u;if(h>=c)throw new RangeError("min option must be smaller than max option");for(var f=(c-h)/(a-o),d=0;d<t.length;d++)e[d]=(t[d]-o)*f+h;return e}},52743:function(t){"use strict";class e{constructor(){this.nodes=new Map}add(t){var e=this.nodes.get(t);return e||(e=new r(t),this.nodes.set(t,e)),e}union(t,e){const r=this.find(t),i=this.find(e);r!==i&&(r.rank<i.rank?r.parent=i:r.rank>i.rank?i.parent=r:(i.parent=r,r.rank++))}find(t){var e=t;while(null!==e.parent)e=e.parent;var r=t;while(null!==r.parent){var i=r;r=r.parent,i.parent=e}return e}connected(t,e){return this.find(t)===this.find(e)}}function r(t){this.value=t,this.parent=null,this.rank=0}t.exports=e},96694:function(t,e,r){"use strict";function i(t,e){let r=0;for(let i=0;i<t.length;i++)r+=(t[i]-e[i])*(t[i]-e[i]);return r}function n(t,e){return Math.sqrt(i(t,e))}r.r(e),r.d(e,{euclidean:function(){return n},squaredEuclidean:function(){return i}})},74423:function(t,e,r){"use strict";var i=r(15665),n={DEBUG:!1,ifft2DArray:function(t,e,r){var n=new Array(e*r),s=e/2,o=2*(r-1);i.init(s);for(var a={re:new Array(s),im:new Array(s)},l=0;l<r;l++){for(var h=s-1;h>=0;h--)a.re[h]=t[2*h*r+l],a.im[h]=t[(2*h+1)*r+l];i.bt(a.re,a.im);for(h=s-1;h>=0;h--)n[2*h*r+l]=a.re[h],n[(2*h+1)*r+l]=a.im[h]}var u=new Array(s*o);i.init(o);var c={re:new Array(o),im:new Array(o)},f=o*s;for(h=0;h<e;h+=2){c.re[0]=n[h*r],c.im[0]=n[(h+1)*r];for(l=1;l<r;l++)c.re[l]=n[h*r+l],c.im[l]=n[(h+1)*r+l],c.re[o-l]=n[h*r+l],c.im[o-l]=-n[(h+1)*r+l];i.bt(c.re,c.im);var d=h/2*o;for(l=o-1;l>=0;l--)u[d+l]=c.re[l]/f}return u},fft2DArray:function(t,e,r,n){Object.assign({},{inplace:!0});var s=r/2+1,o=2*e,a=new Array(o*s);i.init(r);for(var l,h,u,c,f,d={re:new Array(r),im:new Array(r)},p={re:new Array(r),im:new Array(r)},m={re:new Array(r),im:new Array(r)},g=0;g<e/2;g++){l=2*g*r,d.re=t.slice(l,l+r),l=(2*g+1)*r,d.im=t.slice(l,l+r),i.fft1d(d.re,d.im),this.reconstructTwoRealFFT(d,p,m),h=4*g*s,u=(4*g+1)*s,c=(4*g+2)*s,f=(4*g+3)*s;for(var w=s-1;w>=0;w--)a[h+w]=p.re[w],a[u+w]=p.im[w],a[c+w]=m.re[w],a[f+w]=m.im[w]}p=null,m=null;var b=new Array(o*s);i.init(e);for(var y={re:new Array(e),im:new Array(e)},v=s-1;v>=0;v--){for(g=e-1;g>=0;g--)y.re[g]=a[2*g*s+v],y.im[g]=a[(2*g+1)*s+v],isNaN(y.re[g])&&(y.re[g]=0),isNaN(y.im[g])&&(y.im[g]=0);i.fft1d(y.re,y.im);for(g=e-1;g>=0;g--)b[2*g*s+v]=y.re[g],b[(2*g+1)*s+v]=y.im[g]}return b},reconstructTwoRealFFT:function(t,e,r){var i,n,s,o,a,l=t.re.length;e.re[0]=t.re[0],e.im[0]=0,r.re[0]=t.im[0],r.im[0]=0;for(var h=l/2;h>0;h--)a=l-h,i=.5*(t.re[h]-t.re[a]),n=.5*(t.re[h]+t.re[a]),s=.5*(t.im[h]-t.im[a]),o=.5*(t.im[h]+t.im[a]),e.re[h]=n,e.im[h]=s,e.re[a]=n,e.im[a]=-s,r.re[h]=o,r.im[h]=-i,r.re[a]=o,r.im[a]=i},convolute2DI:function(t,e,r,i){for(var n,s,o=0;o<r/2;o++)for(var a=0;a<i;a++)n=t[2*o*i+a]*e[2*o*i+a]-t[(2*o+1)*i+a]*e[(2*o+1)*i+a],s=t[2*o*i+a]*e[(2*o+1)*i+a]+t[(2*o+1)*i+a]*e[2*o*i+a],t[2*o*i+a]=n,t[(2*o+1)*i+a]=s},convolute:function(t,e,r,i,n){for(var s=new Array(i*r),o=0;o<r*i;o++)s[o]=t[o];s=this.fft2DArray(s,r,i);var a,l,h=e.length,u=e[0].length,c=new Array(i*r);for(o=0;o<i*r;o++)c[o]=0;for(var f=Math.floor((h-1)/2),d=Math.floor((u-1)/2),p=0;p<h;p++){a=(p-f+r)%r;for(var m=0;m<u;m++)l=(m-d+i)%i,c[a*i+l]=e[p][m]}c=this.fft2DArray(c,r,i);var g=2*r,w=i/2+1;return this.convolute2DI(s,c,g,w),this.ifft2DArray(s,g,w)},toRadix2:function(t,e,r){var i,n,s,o,a=r,l=e;if(0===r||0!==(r&r-1)){a=0;while(r>>++a!=0);a=1<<a}if(0===e||0!==(e&e-1)){l=0;while(e>>++l!=0);l=1<<l}if(l==e&&a==r)return{data:t,rows:e,cols:r};var h=new Array(l*a),u=Math.floor((l-e)/2)-e,c=Math.floor((a-r)/2)-r;for(i=0;i<l;i++)for(s=i*a,o=(i-u)%e*r,n=0;n<a;n++)h[s+n]=t[o+(n-c)%r];return{data:h,rows:l,cols:a}},crop:function(t,e,r,i,n,s){if(e==i&&r==n)return t;Object.assign({},s);var o,a,l,h,u=new Array(n*i),c=Math.floor((e-i)/2),f=Math.floor((r-n)/2);for(l=0;l<i;l++)for(o=l*n,a=(l+c)*r,h=0;h<n;h++)u[o+h]=t[a+(h+f)];return u}};t.exports=n},15665:function(t,e){(function(){var t;t=e;var r={release:"0.3.0",date:"2013-03"};t.toString=function(){return"version "+r.release+", released "+r.date};for(var i=0,n=null,s=null,o={init:function(t){if(0===t||0!==(t&t-1))throw new Error("init: radix-2 required");i=t,o._initArray(),o._makeBitReversalTable(),o._makeCosSinTable()},fft1d:function(t,e){o.fft(t,e,1)},ifft1d:function(t,e){var r=1/i;o.fft(t,e,-1);for(var n=0;n<i;n++)t[n]*=r,e[n]*=r},bt1d:function(t,e){o.fft(t,e,-1)},fft2d:function(t,e){for(var r=[],n=[],s=0,a=0;a<i;a++){s=a*i;for(var l=0;l<i;l++)r[l]=t[l+s],n[l]=e[l+s];o.fft1d(r,n);for(var h=0;h<i;h++)t[h+s]=r[h],e[h+s]=n[h]}for(var u=0;u<i;u++){for(var c=0;c<i;c++)s=u+c*i,r[c]=t[s],n[c]=e[s];o.fft1d(r,n);for(var f=0;f<i;f++)s=u+f*i,t[s]=r[f],e[s]=n[f]}},ifft2d:function(t,e){for(var r=[],n=[],s=0,a=0;a<i;a++){s=a*i;for(var l=0;l<i;l++)r[l]=t[l+s],n[l]=e[l+s];o.ifft1d(r,n);for(var h=0;h<i;h++)t[h+s]=r[h],e[h+s]=n[h]}for(var u=0;u<i;u++){for(var c=0;c<i;c++)s=u+c*i,r[c]=t[s],n[c]=e[s];o.ifft1d(r,n);for(var f=0;f<i;f++)s=u+f*i,t[s]=r[f],e[s]=n[f]}},fft:function(t,e,r){for(var o,a,l,h,u,c,f,d,p,m=i>>2,g=0;g<i;g++)h=n[g],g<h&&(u=t[g],t[g]=t[h],t[h]=u,u=e[g],e[g]=e[h],e[h]=u);for(var w=1;w<i;w<<=1){a=0,o=i/(w<<1);for(var b=0;b<w;b++){c=s[a+m],f=r*s[a];for(var y=b;y<i;y+=w<<1)l=y+w,d=c*t[l]+f*e[l],p=c*e[l]-f*t[l],t[l]=t[y]-d,t[y]+=d,e[l]=e[y]-p,e[y]+=p;a+=o}}},_initArray:function(){n="undefined"!==typeof Uint32Array?new Uint32Array(i):[],s="undefined"!==typeof Float64Array?new Float64Array(1.25*i):[]},_paddingZero:function(){},_makeBitReversalTable:function(){var t=0,e=0,r=0;n[0]=0;while(++t<i){r=i>>1;while(r<=e)e-=r,r>>=1;e+=r,n[t]=e}},_makeCosSinTable:function(){var t=i>>1,e=i>>2,r=i>>3,n=t+e,o=Math.sin(Math.PI/i),a=2*o*o,l=Math.sqrt(a*(2-a)),h=s[e]=1,u=s[0]=0;o=2*a;for(var c=1;c<r;c++)h-=a,a+=o*h,u+=l,l-=o*u,s[c]=u,s[e-c]=h;0!==r&&(s[r]=Math.sqrt(.5));for(var f=0;f<e;f++)s[t-f]=s[f];for(var d=0;d<n;d++)s[d+t]=-s[d]}},a=["init","fft1d","ifft1d","fft2d","ifft2d"],l=0;l<a.length;l++)t[a[l]]=o[a[l]];return t.bt=o.bt1d,t.fft=o.fft1d,t.ifft=o.ifft1d,t}).call(this)},98796:function(t,e,r){"use strict";e.FFTUtils=r(74423),r(15665)},57877:function(t,e,r){"use strict";const{squaredEuclidean:i}=r(96694),n={sigma:1};class s{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const r=i(t,e);return Math.exp(-r/this.divisor)}}t.exports=s},84975:function(t){"use strict";const e={degree:1,constant:1,scale:1};class r{constructor(t){t=Object.assign({},e,t),this.degree=t.degree,this.constant=t.constant,this.scale=t.scale}compute(t,e){for(var r=0,i=0;i<t.length;i++)r+=t[i]*e[i];return Math.pow(this.scale*r+this.constant,this.degree)}}t.exports=r},82477:function(t){"use strict";const e={alpha:.01,constant:-Math.E};class r{constructor(t){t=Object.assign({},e,t),this.alpha=t.alpha,this.constant=t.constant}compute(t,e){for(var r=0,i=0;i<t.length;i++)r+=t[i]*e[i];return Math.tanh(this.alpha*r+this.constant)}}t.exports=r},25426:function(t,e,r){"use strict";const{Matrix:i,MatrixTransposeView:n}=r(10673),s=r(57877),o=r(84975),a=r(82477),l=r(72617),h=r(95937),u=r(81011),c=r(93948),f=r(94513),d=r(46911),p=r(90483),m={gaussian:s,rbf:s,polynomial:o,poly:o,anova:l,cauchy:h,exponential:u,histogram:c,min:c,laplacian:f,multiquadratic:d,rational:p,sigmoid:a,mlp:a};class g{constructor(t,e){if(this.kernelType=t,"linear"!==t)if("string"===typeof t){t=t.toLowerCase();var r=m[t];if(!r)throw new Error(`unsupported kernel type: ${t}`);this.kernelFunction=new r(e)}else{if("object"!==typeof t||"function"!==typeof t.compute)throw new TypeError("first argument must be a valid kernel type or instance");this.kernelFunction=t}}compute(t,e){if(t=i.checkMatrix(t),e=void 0===e?t:i.checkMatrix(e),"linear"===this.kernelType)return t.mmul(new n(e));const r=new i(t.rows,e.rows);if(t===e)for(let i=0;i<t.rows;i++)for(let e=i;e<t.rows;e++){const n=this.kernelFunction.compute(t.getRow(i),t.getRow(e));r.set(i,e,n),r.set(e,i,n)}else for(let i=0;i<t.rows;i++)for(let n=0;n<e.rows;n++)r.set(i,n,this.kernelFunction.compute(t.getRow(i),e.getRow(n)));return r}}t.exports=g},72617:function(t){"use strict";const e={sigma:1,degree:1};class r{constructor(t){t=Object.assign({},e,t),this.sigma=t.sigma,this.degree=t.degree}compute(t,e){for(var r=0,i=Math.min(t.length,e.length),n=1;n<=i;++n)r+=Math.pow(Math.exp(-this.sigma*Math.pow(Math.pow(t[n-1],n)-Math.pow(e[n-1],n),2)),this.degree);return r}}t.exports=r},95937:function(t,e,r){"use strict";const{squaredEuclidean:i}=r(96694),n={sigma:1};class s{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma}compute(t,e){return 1/(1+i(t,e)/(this.sigma*this.sigma))}}t.exports=s},81011:function(t,e,r){"use strict";const{euclidean:i}=r(96694),n={sigma:1};class s{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma,this.divisor=2*t.sigma*t.sigma}compute(t,e){const r=i(t,e);return Math.exp(-r/this.divisor)}}t.exports=s},93948:function(t){"use strict";class e{compute(t,e){for(var r=Math.min(t.length,e.length),i=0,n=0;n<r;++n)i+=Math.min(t[n],e[n]);return i}}t.exports=e},94513:function(t,e,r){"use strict";const{euclidean:i}=r(96694),n={sigma:1};class s{constructor(t){t=Object.assign({},n,t),this.sigma=t.sigma}compute(t,e){const r=i(t,e);return Math.exp(-r/this.sigma)}}t.exports=s},46911:function(t,e,r){"use strict";const{squaredEuclidean:i}=r(96694),n={constant:1};class s{constructor(t){t=Object.assign({},n,t),this.constant=t.constant}compute(t,e){return Math.sqrt(i(t,e)+this.constant*this.constant)}}t.exports=s},90483:function(t,e,r){"use strict";const{squaredEuclidean:i}=r(96694),n={constant:1};class s{constructor(t){t=Object.assign({},n,t),this.constant=t.constant}compute(t,e){const r=i(t,e);return 1-r/(r+this.constant)}}t.exports=s},99728:function(t,e,r){var i=r(98796).FFTUtils;function n(t,e,r){var n,s,o=a(t),l=o.data,h=Object.assign({normalize:!1,divisor:1,rows:o.rows,cols:o.cols},r);if(!h.rows||!h.cols)throw new Error("Invalid number of rows or columns "+n+" "+s);n=h.rows,s=h.cols;var u,c,f=h.divisor,d=e.length,p=e[0].length;if(h.normalize)for(f=0,u=0;u<d;u++)for(c=0;c<p;c++)f+=e[u][c];if(0===f)throw new RangeError("convolution: The divisor is equal to zero");var m=i.toRadix2(l,n,s),g=i.convolute(m.data,e,m.rows,m.cols);if(g=i.crop(g,m.rows,m.cols,n,s),0!=f&&1!=f)for(u=0;u<g.length;u++)g[u]/=f;return g}function s(t,e,r){var i,n,s=a(t),o=s.data,l=Object.assign({normalize:!1,divisor:1,rows:s.rows,cols:s.cols},r);if(!l.rows||!l.cols)throw new Error("Invalid number of rows or columns "+i+" "+n);i=l.rows,n=l.cols;var h,u,c,f,d,p,m,g,w,b=l.divisor,y=e.length,v=e[0].length;if(l.normalize)for(b=0,h=0;h<y;h++)for(u=0;u<v;u++)b+=e[h][u];if(0===b)throw new RangeError("convolution: The divisor is equal to zero");var x=new Array(i*n),k=Math.floor(y/2),_=Math.floor(v/2);for(f=0;f<i;f++)for(c=0;c<n;c++){for(p=0,u=0;u<y;u++)for(h=0;h<v;h++)m=e[y-u-1][v-h-1],g=(f+u-k+i)%i,w=(c+h-_+n)%n,d=g*n+w,p+=o[d]*m;d=f*n+c,x[d]=p/b}return x}function o(t,e,r){var i=1e3;r&&r.factor&&(i=r.factor);var n,s,o,a,l=new Array(e);i*=-1;var h=(e-1)/2,u=2*t*t;for(n=0;n<e;n++)for(l[n]=new Array(e),a=(n-h)*(n-h),s=0;s<e;s++)o=-((s-h)*(s-h)+a)/u,l[n][s]=Math.round(i*(1+o)*Math.exp(o));return l}function a(t){var e,r,i=t;if("number"!=typeof t[0]){e=t.length,r=t[0].length,i=new Array(e*r);for(var n=0;n<e;n++)for(var s=0;s<r;s++)i[n*r+s]=t[n][s]}else{var o=Math.sqrt(t.length);Number.isInteger(o)&&(e=o,r=o)}return{data:i,rows:e,cols:r}}t.exports={fft:n,direct:s,kernelFactory:{LoG:o},matrix2Array:a}},10673:function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=r(70788),n=r(55826);const s=" ".repeat(2),o=" ".repeat(4);function a(){return l(this)}function l(t,e={}){const{maxRows:r=15,maxColumns:i=10,maxNumSize:n=8,padMinus:a="auto"}=e;return`${t.constructor.name} {\n${s}[\n${o}${h(t,r,i,n,a)}\n${s}]\n${s}rows: ${t.rows}\n${s}columns: ${t.columns}\n}`}function h(t,e,r,i,n){const{rows:s,columns:a}=t,l=Math.min(s,e),h=Math.min(a,r),c=[];if("auto"===n){n=!1;t:for(let e=0;e<l;e++)for(let r=0;r<h;r++)if(t.get(e,r)<0){n=!0;break t}}for(let o=0;o<l;o++){let e=[];for(let r=0;r<h;r++)e.push(u(t.get(o,r),i,n));c.push(`${e.join(" ")}`)}return h!==a&&(c[c.length-1]+=` ... ${a-r} more columns`),l!==s&&c.push(`... ${s-e} more rows`),c.join(`\n${o}`)}function u(t,e,r){return(t>=0&&r?` ${c(t,e-1)}`:c(t,e)).padEnd(e)}function c(t,e){let r=t.toString();if(r.length<=e)return r;let i=t.toFixed(e);if(i.length>e&&(i=t.toFixed(Math.max(0,e-(i.length-e)))),i.length<=e&&!i.startsWith("0.000")&&!i.startsWith("-0.000"))return i;let n=t.toExponential(e);return n.length>e&&(n=t.toExponential(Math.max(0,e-(n.length-e)))),n.slice(0)}function f(t,e){t.prototype.add=function(t){return"number"===typeof t?this.addS(t):this.addM(t)},t.prototype.addS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t);return this},t.prototype.addM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t.get(e,r));return this},t.add=function(t,r){const i=new e(t);return i.add(r)},t.prototype.sub=function(t){return"number"===typeof t?this.subS(t):this.subM(t)},t.prototype.subS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t);return this},t.prototype.subM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t.get(e,r));return this},t.sub=function(t,r){const i=new e(t);return i.sub(r)},t.prototype.subtract=t.prototype.sub,t.prototype.subtractS=t.prototype.subS,t.prototype.subtractM=t.prototype.subM,t.subtract=t.sub,t.prototype.mul=function(t){return"number"===typeof t?this.mulS(t):this.mulM(t)},t.prototype.mulS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t);return this},t.prototype.mulM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t.get(e,r));return this},t.mul=function(t,r){const i=new e(t);return i.mul(r)},t.prototype.multiply=t.prototype.mul,t.prototype.multiplyS=t.prototype.mulS,t.prototype.multiplyM=t.prototype.mulM,t.multiply=t.mul,t.prototype.div=function(t){return"number"===typeof t?this.divS(t):this.divM(t)},t.prototype.divS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t);return this},t.prototype.divM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t.get(e,r));return this},t.div=function(t,r){const i=new e(t);return i.div(r)},t.prototype.divide=t.prototype.div,t.prototype.divideS=t.prototype.divS,t.prototype.divideM=t.prototype.divM,t.divide=t.div,t.prototype.mod=function(t){return"number"===typeof t?this.modS(t):this.modM(t)},t.prototype.modS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t);return this},t.prototype.modM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)%t.get(e,r));return this},t.mod=function(t,r){const i=new e(t);return i.mod(r)},t.prototype.modulus=t.prototype.mod,t.prototype.modulusS=t.prototype.modS,t.prototype.modulusM=t.prototype.modM,t.modulus=t.mod,t.prototype.and=function(t){return"number"===typeof t?this.andS(t):this.andM(t)},t.prototype.andS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t);return this},t.prototype.andM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)&t.get(e,r));return this},t.and=function(t,r){const i=new e(t);return i.and(r)},t.prototype.or=function(t){return"number"===typeof t?this.orS(t):this.orM(t)},t.prototype.orS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t);return this},t.prototype.orM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)|t.get(e,r));return this},t.or=function(t,r){const i=new e(t);return i.or(r)},t.prototype.xor=function(t){return"number"===typeof t?this.xorS(t):this.xorM(t)},t.prototype.xorS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t);return this},t.prototype.xorM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)^t.get(e,r));return this},t.xor=function(t,r){const i=new e(t);return i.xor(r)},t.prototype.leftShift=function(t){return"number"===typeof t?this.leftShiftS(t):this.leftShiftM(t)},t.prototype.leftShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t);return this},t.prototype.leftShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)<<t.get(e,r));return this},t.leftShift=function(t,r){const i=new e(t);return i.leftShift(r)},t.prototype.signPropagatingRightShift=function(t){return"number"===typeof t?this.signPropagatingRightShiftS(t):this.signPropagatingRightShiftM(t)},t.prototype.signPropagatingRightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t);return this},t.prototype.signPropagatingRightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>t.get(e,r));return this},t.signPropagatingRightShift=function(t,r){const i=new e(t);return i.signPropagatingRightShift(r)},t.prototype.rightShift=function(t){return"number"===typeof t?this.rightShiftS(t):this.rightShiftM(t)},t.prototype.rightShiftS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t);return this},t.prototype.rightShiftM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)>>>t.get(e,r));return this},t.rightShift=function(t,r){const i=new e(t);return i.rightShift(r)},t.prototype.zeroFillRightShift=t.prototype.rightShift,t.prototype.zeroFillRightShiftS=t.prototype.rightShiftS,t.prototype.zeroFillRightShiftM=t.prototype.rightShiftM,t.zeroFillRightShift=t.rightShift,t.prototype.not=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,~this.get(t,e));return this},t.not=function(t){const r=new e(t);return r.not()},t.prototype.abs=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.abs(this.get(t,e)));return this},t.abs=function(t){const r=new e(t);return r.abs()},t.prototype.acos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acos(this.get(t,e)));return this},t.acos=function(t){const r=new e(t);return r.acos()},t.prototype.acosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.acosh(this.get(t,e)));return this},t.acosh=function(t){const r=new e(t);return r.acosh()},t.prototype.asin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asin(this.get(t,e)));return this},t.asin=function(t){const r=new e(t);return r.asin()},t.prototype.asinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.asinh(this.get(t,e)));return this},t.asinh=function(t){const r=new e(t);return r.asinh()},t.prototype.atan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atan(this.get(t,e)));return this},t.atan=function(t){const r=new e(t);return r.atan()},t.prototype.atanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.atanh(this.get(t,e)));return this},t.atanh=function(t){const r=new e(t);return r.atanh()},t.prototype.cbrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cbrt(this.get(t,e)));return this},t.cbrt=function(t){const r=new e(t);return r.cbrt()},t.prototype.ceil=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.ceil(this.get(t,e)));return this},t.ceil=function(t){const r=new e(t);return r.ceil()},t.prototype.clz32=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.clz32(this.get(t,e)));return this},t.clz32=function(t){const r=new e(t);return r.clz32()},t.prototype.cos=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cos(this.get(t,e)));return this},t.cos=function(t){const r=new e(t);return r.cos()},t.prototype.cosh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.cosh(this.get(t,e)));return this},t.cosh=function(t){const r=new e(t);return r.cosh()},t.prototype.exp=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.exp(this.get(t,e)));return this},t.exp=function(t){const r=new e(t);return r.exp()},t.prototype.expm1=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.expm1(this.get(t,e)));return this},t.expm1=function(t){const r=new e(t);return r.expm1()},t.prototype.floor=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.floor(this.get(t,e)));return this},t.floor=function(t){const r=new e(t);return r.floor()},t.prototype.fround=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.fround(this.get(t,e)));return this},t.fround=function(t){const r=new e(t);return r.fround()},t.prototype.log=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log(this.get(t,e)));return this},t.log=function(t){const r=new e(t);return r.log()},t.prototype.log1p=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log1p(this.get(t,e)));return this},t.log1p=function(t){const r=new e(t);return r.log1p()},t.prototype.log10=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log10(this.get(t,e)));return this},t.log10=function(t){const r=new e(t);return r.log10()},t.prototype.log2=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.log2(this.get(t,e)));return this},t.log2=function(t){const r=new e(t);return r.log2()},t.prototype.round=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.round(this.get(t,e)));return this},t.round=function(t){const r=new e(t);return r.round()},t.prototype.sign=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sign(this.get(t,e)));return this},t.sign=function(t){const r=new e(t);return r.sign()},t.prototype.sin=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sin(this.get(t,e)));return this},t.sin=function(t){const r=new e(t);return r.sin()},t.prototype.sinh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sinh(this.get(t,e)));return this},t.sinh=function(t){const r=new e(t);return r.sinh()},t.prototype.sqrt=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.sqrt(this.get(t,e)));return this},t.sqrt=function(t){const r=new e(t);return r.sqrt()},t.prototype.tan=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tan(this.get(t,e)));return this},t.tan=function(t){const r=new e(t);return r.tan()},t.prototype.tanh=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.tanh(this.get(t,e)));return this},t.tanh=function(t){const r=new e(t);return r.tanh()},t.prototype.trunc=function(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)this.set(t,e,Math.trunc(this.get(t,e)));return this},t.trunc=function(t){const r=new e(t);return r.trunc()},t.pow=function(t,r){const i=new e(t);return i.pow(r)},t.prototype.pow=function(t){return"number"===typeof t?this.powS(t):this.powM(t)},t.prototype.powS=function(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t);return this},t.prototype.powM=function(t){if(t=e.checkMatrix(t),this.rows!==t.rows||this.columns!==t.columns)throw new RangeError("Matrices dimensions must be equal");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)**t.get(e,r));return this}}function d(t,e,r){let i=r?t.rows:t.rows-1;if(e<0||e>i)throw new RangeError("Row index out of range")}function p(t,e,r){let i=r?t.columns:t.columns-1;if(e<0||e>i)throw new RangeError("Column index out of range")}function m(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.columns)throw new RangeError("vector size must be the same as the number of columns");return e}function g(t,e){if(e.to1DArray&&(e=e.to1DArray()),e.length!==t.rows)throw new RangeError("vector size must be the same as the number of rows");return e}function w(t,e){if(!i.isAnyArray(e))throw new TypeError("row indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.rows)throw new RangeError("row indices are out of range")}function b(t,e){if(!i.isAnyArray(e))throw new TypeError("column indices must be an array");for(let r=0;r<e.length;r++)if(e[r]<0||e[r]>=t.columns)throw new RangeError("column indices are out of range")}function y(t,e,r,i,n){if(5!==arguments.length)throw new RangeError("expected 4 arguments");if(x("startRow",e),x("endRow",r),x("startColumn",i),x("endColumn",n),e>r||i>n||e<0||e>=t.rows||r<0||r>=t.rows||i<0||i>=t.columns||n<0||n>=t.columns)throw new RangeError("Submatrix indices are out of range")}function v(t,e=0){let r=[];for(let i=0;i<t;i++)r.push(e);return r}function x(t,e){if("number"!==typeof e)throw new TypeError(`${t} must be a number`)}function k(t){if(t.isEmpty())throw new Error("Empty matrix has no elements to index")}function _(t){let e=v(t.rows);for(let r=0;r<t.rows;++r)for(let i=0;i<t.columns;++i)e[r]+=t.get(r,i);return e}function M(t){let e=v(t.columns);for(let r=0;r<t.rows;++r)for(let i=0;i<t.columns;++i)e[i]+=t.get(r,i);return e}function E(t){let e=0;for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)e+=t.get(r,i);return e}function S(t){let e=v(t.rows,1);for(let r=0;r<t.rows;++r)for(let i=0;i<t.columns;++i)e[r]*=t.get(r,i);return e}function A(t){let e=v(t.columns,1);for(let r=0;r<t.rows;++r)for(let i=0;i<t.columns;++i)e[i]*=t.get(r,i);return e}function C(t){let e=1;for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)e*=t.get(r,i);return e}function L(t,e,r){const i=t.rows,n=t.columns,s=[];for(let o=0;o<i;o++){let i=0,a=0,l=0;for(let e=0;e<n;e++)l=t.get(o,e)-r[o],i+=l,a+=l*l;e?s.push((a-i*i/n)/(n-1)):s.push((a-i*i/n)/n)}return s}function I(t,e,r){const i=t.rows,n=t.columns,s=[];for(let o=0;o<n;o++){let n=0,a=0,l=0;for(let e=0;e<i;e++)l=t.get(e,o)-r[o],n+=l,a+=l*l;e?s.push((a-n*n/i)/(i-1)):s.push((a-n*n/i)/i)}return s}function D(t,e,r){const i=t.rows,n=t.columns,s=i*n;let o=0,a=0,l=0;for(let h=0;h<i;h++)for(let e=0;e<n;e++)l=t.get(h,e)-r,o+=l,a+=l*l;return e?(a-o*o/s)/(s-1):(a-o*o/s)/s}function R(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)-e[r])}function P(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)-e[i])}function T(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)-e)}function F(t){const e=[];for(let r=0;r<t.rows;r++){let i=0;for(let e=0;e<t.columns;e++)i+=t.get(r,e)**2/(t.columns-1);e.push(Math.sqrt(i))}return e}function B(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)/e[r])}function U(t){const e=[];for(let r=0;r<t.columns;r++){let i=0;for(let e=0;e<t.rows;e++)i+=t.get(e,r)**2/(t.rows-1);e.push(Math.sqrt(i))}return e}function O(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)/e[i])}function N(t){const e=t.size-1;let r=0;for(let i=0;i<t.columns;i++)for(let n=0;n<t.rows;n++)r+=t.get(n,i)**2/e;return Math.sqrt(r)}function z(t,e){for(let r=0;r<t.rows;r++)for(let i=0;i<t.columns;i++)t.set(r,i,t.get(r,i)/e)}class j{static from1DArray(t,e,r){let i=t*e;if(i!==r.length)throw new RangeError("data length does not match given dimensions");let n=new V(t,e);for(let s=0;s<t;s++)for(let t=0;t<e;t++)n.set(s,t,r[s*e+t]);return n}static rowVector(t){let e=new V(1,t.length);for(let r=0;r<t.length;r++)e.set(0,r,t[r]);return e}static columnVector(t){let e=new V(t.length,1);for(let r=0;r<t.length;r++)e.set(r,0,t[r]);return e}static zeros(t,e){return new V(t,e)}static ones(t,e){return new V(t,e).fill(1)}static rand(t,e,r={}){if("object"!==typeof r)throw new TypeError("options must be an object");const{random:i=Math.random}=r;let n=new V(t,e);for(let s=0;s<t;s++)for(let t=0;t<e;t++)n.set(s,t,i());return n}static randInt(t,e,r={}){if("object"!==typeof r)throw new TypeError("options must be an object");const{min:i=0,max:n=1e3,random:s=Math.random}=r;if(!Number.isInteger(i))throw new TypeError("min must be an integer");if(!Number.isInteger(n))throw new TypeError("max must be an integer");if(i>=n)throw new RangeError("min must be smaller than max");let o=n-i,a=new V(t,e);for(let l=0;l<t;l++)for(let t=0;t<e;t++){let e=i+Math.round(s()*o);a.set(l,t,e)}return a}static eye(t,e,r){void 0===e&&(e=t),void 0===r&&(r=1);let i=Math.min(t,e),n=this.zeros(t,e);for(let s=0;s<i;s++)n.set(s,s,r);return n}static diag(t,e,r){let i=t.length;void 0===e&&(e=i),void 0===r&&(r=e);let n=Math.min(i,e,r),s=this.zeros(e,r);for(let o=0;o<n;o++)s.set(o,o,t[o]);return s}static min(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,i=t.columns,n=new V(r,i);for(let s=0;s<r;s++)for(let r=0;r<i;r++)n.set(s,r,Math.min(t.get(s,r),e.get(s,r)));return n}static max(t,e){t=this.checkMatrix(t),e=this.checkMatrix(e);let r=t.rows,i=t.columns,n=new this(r,i);for(let s=0;s<r;s++)for(let r=0;r<i;r++)n.set(s,r,Math.max(t.get(s,r),e.get(s,r)));return n}static checkMatrix(t){return j.isMatrix(t)?t:new V(t)}static isMatrix(t){return null!=t&&"Matrix"===t.klass}get size(){return this.rows*this.columns}apply(t){if("function"!==typeof t)throw new TypeError("callback must be a function");for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.call(this,e,r);return this}to1DArray(){let t=[];for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.push(this.get(e,r));return t}to2DArray(){let t=[];for(let e=0;e<this.rows;e++){t.push([]);for(let r=0;r<this.columns;r++)t[e].push(this.get(e,r))}return t}toJSON(){return this.to2DArray()}isRowVector(){return 1===this.rows}isColumnVector(){return 1===this.columns}isVector(){return 1===this.rows||1===this.columns}isSquare(){return this.rows===this.columns}isEmpty(){return 0===this.rows||0===this.columns}isSymmetric(){if(this.isSquare()){for(let t=0;t<this.rows;t++)for(let e=0;e<=t;e++)if(this.get(t,e)!==this.get(e,t))return!1;return!0}return!1}isDistance(){if(!this.isSymmetric())return!1;for(let t=0;t<this.rows;t++)if(0!==this.get(t,t))return!1;return!0}isEchelonForm(){let t=0,e=0,r=-1,i=!0,n=!1;while(t<this.rows&&i){e=0,n=!1;while(e<this.columns&&!1===n)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(i=!1,n=!0);t++}return i}isReducedEchelonForm(){let t=0,e=0,r=-1,i=!0,n=!1;while(t<this.rows&&i){e=0,n=!1;while(e<this.columns&&!1===n)0===this.get(t,e)?e++:1===this.get(t,e)&&e>r?(n=!0,r=e):(i=!1,n=!0);for(let r=e+1;r<this.rows;r++)0!==this.get(t,r)&&(i=!1);t++}return i}echelonForm(){let t=this.clone(),e=0,r=0;while(e<t.rows&&r<t.columns){let i=e;for(let n=e;n<t.rows;n++)t.get(n,r)>t.get(i,r)&&(i=n);if(0===t.get(i,r))r++;else{t.swapRows(e,i);let n=t.get(e,r);for(let i=r;i<t.columns;i++)t.set(e,i,t.get(e,i)/n);for(let i=e+1;i<t.rows;i++){let n=t.get(i,r)/t.get(e,r);t.set(i,r,0);for(let s=r+1;s<t.columns;s++)t.set(i,s,t.get(i,s)-t.get(e,s)*n)}e++,r++}}return t}reducedEchelonForm(){let t=this.echelonForm(),e=t.columns,r=t.rows,i=r-1;while(i>=0)if(0===t.maxRow(i))i--;else{let n=0,s=!1;while(n<r&&!1===s)1===t.get(i,n)?s=!0:n++;for(let r=0;r<i;r++){let s=t.get(r,n);for(let o=n;o<e;o++){let e=t.get(r,o)-s*t.get(i,o);t.set(r,o,e)}}i--}return t}set(){throw new Error("set method is unimplemented")}get(){throw new Error("get method is unimplemented")}repeat(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{rows:e=1,columns:r=1}=t;if(!Number.isInteger(e)||e<=0)throw new TypeError("rows must be a positive integer");if(!Number.isInteger(r)||r<=0)throw new TypeError("columns must be a positive integer");let i=new V(this.rows*e,this.columns*r);for(let n=0;n<e;n++)for(let t=0;t<r;t++)i.setSubMatrix(this,this.rows*n,this.columns*t);return i}fill(t){for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,t);return this}neg(){return this.mulS(-1)}getRow(t){d(this,t);let e=[];for(let r=0;r<this.columns;r++)e.push(this.get(t,r));return e}getRowVector(t){return V.rowVector(this.getRow(t))}setRow(t,e){d(this,t),e=m(this,e);for(let r=0;r<this.columns;r++)this.set(t,r,e[r]);return this}swapRows(t,e){d(this,t),d(this,e);for(let r=0;r<this.columns;r++){let i=this.get(t,r);this.set(t,r,this.get(e,r)),this.set(e,r,i)}return this}getColumn(t){p(this,t);let e=[];for(let r=0;r<this.rows;r++)e.push(this.get(r,t));return e}getColumnVector(t){return V.columnVector(this.getColumn(t))}setColumn(t,e){p(this,t),e=g(this,e);for(let r=0;r<this.rows;r++)this.set(r,t,e[r]);return this}swapColumns(t,e){p(this,t),p(this,e);for(let r=0;r<this.rows;r++){let i=this.get(r,t);this.set(r,t,this.get(r,e)),this.set(r,e,i)}return this}addRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[r]);return this}subRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[r]);return this}mulRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[r]);return this}divRowVector(t){t=m(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[r]);return this}addColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)+t[e]);return this}subColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)-t[e]);return this}mulColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)*t[e]);return this}divColumnVector(t){t=g(this,t);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.set(e,r,this.get(e,r)/t[e]);return this}mulRow(t,e){d(this,t);for(let r=0;r<this.columns;r++)this.set(t,r,this.get(t,r)*e);return this}mulColumn(t,e){p(this,t);for(let r=0;r<this.rows;r++)this.set(r,t,this.get(r,t)*e);return this}max(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.NEGATIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)>t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}maxIndex(){k(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)>t&&(t=this.get(r,i),e[0]=r,e[1]=i);return e}min(t){if(this.isEmpty())return NaN;switch(t){case"row":{const t=new Array(this.rows).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[e]&&(t[e]=this.get(e,r));return t}case"column":{const t=new Array(this.columns).fill(Number.POSITIVE_INFINITY);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t[r]&&(t[r]=this.get(e,r));return t}case void 0:{let t=this.get(0,0);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)this.get(e,r)<t&&(t=this.get(e,r));return t}default:throw new Error(`invalid option: ${t}`)}}minIndex(){k(this);let t=this.get(0,0),e=[0,0];for(let r=0;r<this.rows;r++)for(let i=0;i<this.columns;i++)this.get(r,i)<t&&(t=this.get(r,i),e[0]=r,e[1]=i);return e}maxRow(t){if(d(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)>e&&(e=this.get(t,r));return e}maxRowIndex(t){d(this,t),k(this);let e=this.get(t,0),r=[t,0];for(let i=1;i<this.columns;i++)this.get(t,i)>e&&(e=this.get(t,i),r[1]=i);return r}minRow(t){if(d(this,t),this.isEmpty())return NaN;let e=this.get(t,0);for(let r=1;r<this.columns;r++)this.get(t,r)<e&&(e=this.get(t,r));return e}minRowIndex(t){d(this,t),k(this);let e=this.get(t,0),r=[t,0];for(let i=1;i<this.columns;i++)this.get(t,i)<e&&(e=this.get(t,i),r[1]=i);return r}maxColumn(t){if(p(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)>e&&(e=this.get(r,t));return e}maxColumnIndex(t){p(this,t),k(this);let e=this.get(0,t),r=[0,t];for(let i=1;i<this.rows;i++)this.get(i,t)>e&&(e=this.get(i,t),r[0]=i);return r}minColumn(t){if(p(this,t),this.isEmpty())return NaN;let e=this.get(0,t);for(let r=1;r<this.rows;r++)this.get(r,t)<e&&(e=this.get(r,t));return e}minColumnIndex(t){p(this,t),k(this);let e=this.get(0,t),r=[0,t];for(let i=1;i<this.rows;i++)this.get(i,t)<e&&(e=this.get(i,t),r[0]=i);return r}diag(){let t=Math.min(this.rows,this.columns),e=[];for(let r=0;r<t;r++)e.push(this.get(r,r));return e}norm(t="frobenius"){switch(t){case"max":return this.max();case"frobenius":return Math.sqrt(this.dot(this));default:throw new RangeError(`unknown norm type: ${t}`)}}cumulativeSum(){let t=0;for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t+=this.get(e,r),this.set(e,r,t);return this}dot(t){j.isMatrix(t)&&(t=t.to1DArray());let e=this.to1DArray();if(e.length!==t.length)throw new RangeError("vectors do not have the same size");let r=0;for(let i=0;i<e.length;i++)r+=e[i]*t[i];return r}mmul(t){t=V.checkMatrix(t);let e=this.rows,r=this.columns,i=t.columns,n=new V(e,i),s=new Float64Array(r);for(let o=0;o<i;o++){for(let e=0;e<r;e++)s[e]=t.get(e,o);for(let t=0;t<e;t++){let e=0;for(let i=0;i<r;i++)e+=this.get(t,i)*s[i];n.set(t,o,e)}}return n}mpow(t){if(!this.isSquare())throw new RangeError("Matrix must be square");if(!Number.isInteger(t)||t<0)throw new RangeError("Exponent must be a non-negative integer");let e=V.eye(this.rows),r=this;for(let i=t;i>1;i/=2)0!==(1&i)&&(e=e.mmul(r)),r=r.mmul(r);return e}strassen2x2(t){t=V.checkMatrix(t);let e=new V(2,2);const r=this.get(0,0),i=t.get(0,0),n=this.get(0,1),s=t.get(0,1),o=this.get(1,0),a=t.get(1,0),l=this.get(1,1),h=t.get(1,1),u=(r+l)*(i+h),c=(o+l)*i,f=r*(s-h),d=l*(a-i),p=(r+n)*h,m=(o-r)*(i+s),g=(n-l)*(a+h),w=u+d-p+g,b=f+p,y=c+d,v=u-c+f+m;return e.set(0,0,w),e.set(0,1,b),e.set(1,0,y),e.set(1,1,v),e}strassen3x3(t){t=V.checkMatrix(t);let e=new V(3,3);const r=this.get(0,0),i=this.get(0,1),n=this.get(0,2),s=this.get(1,0),o=this.get(1,1),a=this.get(1,2),l=this.get(2,0),h=this.get(2,1),u=this.get(2,2),c=t.get(0,0),f=t.get(0,1),d=t.get(0,2),p=t.get(1,0),m=t.get(1,1),g=t.get(1,2),w=t.get(2,0),b=t.get(2,1),y=t.get(2,2),v=(r+i+n-s-o-h-u)*m,x=(r-s)*(-f+m),k=o*(-c+f+p-m-g-w+y),_=(-r+s+o)*(c-f+m),M=(s+o)*(-c+f),E=r*c,S=(-r+l+h)*(c-d+g),A=(-r+l)*(d-g),C=(l+h)*(-c+d),L=(r+i+n-o-a-l-h)*g,I=h*(-c+d+p-m-g-w+b),D=(-n+h+u)*(m+w-b),R=(n-u)*(m-b),P=n*w,T=(h+u)*(-w+b),F=(-n+o+a)*(g+w-y),B=(n-a)*(g-y),U=(o+a)*(-w+y),O=i*p,N=a*b,z=s*d,j=l*f,X=u*y,$=E+P+O,Y=v+_+M+E+D+P+T,q=E+S+C+L+P+F+U,G=x+k+_+E+P+F+B,H=x+_+M+E+N,W=P+F+B+U+z,K=E+S+A+I+D+R+P,Q=D+R+P+T+j,Z=E+S+A+C+X;return e.set(0,0,$),e.set(0,1,Y),e.set(0,2,q),e.set(1,0,G),e.set(1,1,H),e.set(1,2,W),e.set(2,0,K),e.set(2,1,Q),e.set(2,2,Z),e}mmulStrassen(t){t=V.checkMatrix(t);let e=this.clone(),r=e.rows,i=e.columns,n=t.rows,s=t.columns;function o(t,e,r){let i=t.rows,n=t.columns;if(i===e&&n===r)return t;{let i=j.zeros(e,r);return i=i.setSubMatrix(t,0,0),i}}i!==n&&console.warn(`Multiplying ${r} x ${i} and ${n} x ${s} matrix: dimensions do not match.`);let a=Math.max(r,n),l=Math.max(i,s);function h(t,e,r,i){if(r<=512||i<=512)return t.mmul(e);r%2===1&&i%2===1?(t=o(t,r+1,i+1),e=o(e,r+1,i+1)):r%2===1?(t=o(t,r+1,i),e=o(e,r+1,i)):i%2===1&&(t=o(t,r,i+1),e=o(e,r,i+1));let n=parseInt(t.rows/2,10),s=parseInt(t.columns/2,10),a=t.subMatrix(0,n-1,0,s-1),l=e.subMatrix(0,n-1,0,s-1),u=t.subMatrix(0,n-1,s,t.columns-1),c=e.subMatrix(0,n-1,s,e.columns-1),f=t.subMatrix(n,t.rows-1,0,s-1),d=e.subMatrix(n,e.rows-1,0,s-1),p=t.subMatrix(n,t.rows-1,s,t.columns-1),m=e.subMatrix(n,e.rows-1,s,e.columns-1),g=h(j.add(a,p),j.add(l,m),n,s),w=h(j.add(f,p),l,n,s),b=h(a,j.sub(c,m),n,s),y=h(p,j.sub(d,l),n,s),v=h(j.add(a,u),m,n,s),x=h(j.sub(f,a),j.add(l,c),n,s),k=h(j.sub(u,p),j.add(d,m),n,s),_=j.add(g,y);_.sub(v),_.add(k);let M=j.add(b,v),E=j.add(w,y),S=j.sub(g,w);S.add(b),S.add(x);let A=j.zeros(2*_.rows,2*_.columns);return A=A.setSubMatrix(_,0,0),A=A.setSubMatrix(M,_.rows,0),A=A.setSubMatrix(E,0,_.columns),A=A.setSubMatrix(S,_.rows,_.columns),A.subMatrix(0,r-1,0,i-1)}return e=o(e,a,l),t=o(t,a,l),h(e,t,a,l)}scaleRows(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let i=new V(this.rows,this.columns);for(let s=0;s<this.rows;s++){const t=this.getRow(s);t.length>0&&n(t,{min:e,max:r,output:t}),i.setRow(s,t)}return i}scaleColumns(t={}){if("object"!==typeof t)throw new TypeError("options must be an object");const{min:e=0,max:r=1}=t;if(!Number.isFinite(e))throw new TypeError("min must be a number");if(!Number.isFinite(r))throw new TypeError("max must be a number");if(e>=r)throw new RangeError("min must be smaller than max");let i=new V(this.rows,this.columns);for(let s=0;s<this.columns;s++){const t=this.getColumn(s);t.length&&n(t,{min:e,max:r,output:t}),i.setColumn(s,t)}return i}flipRows(){const t=Math.ceil(this.columns/2);for(let e=0;e<this.rows;e++)for(let r=0;r<t;r++){let t=this.get(e,r),i=this.get(e,this.columns-1-r);this.set(e,r,i),this.set(e,this.columns-1-r,t)}return this}flipColumns(){const t=Math.ceil(this.rows/2);for(let e=0;e<this.columns;e++)for(let r=0;r<t;r++){let t=this.get(r,e),i=this.get(this.rows-1-r,e);this.set(r,e,i),this.set(this.rows-1-r,e,t)}return this}kroneckerProduct(t){t=V.checkMatrix(t);let e=this.rows,r=this.columns,i=t.rows,n=t.columns,s=new V(e*i,r*n);for(let o=0;o<e;o++)for(let e=0;e<r;e++)for(let r=0;r<i;r++)for(let a=0;a<n;a++)s.set(i*o+r,n*e+a,this.get(o,e)*t.get(r,a));return s}kroneckerSum(t){if(t=V.checkMatrix(t),!this.isSquare()||!t.isSquare())throw new Error("Kronecker Sum needs two Square Matrices");let e=this.rows,r=t.rows,i=this.kroneckerProduct(V.eye(r,r)),n=V.eye(e,e).kroneckerProduct(t);return i.add(n)}transpose(){let t=new V(this.columns,this.rows);for(let e=0;e<this.rows;e++)for(let r=0;r<this.columns;r++)t.set(r,e,this.get(e,r));return t}sortRows(t=X){for(let e=0;e<this.rows;e++)this.setRow(e,this.getRow(e).sort(t));return this}sortColumns(t=X){for(let e=0;e<this.columns;e++)this.setColumn(e,this.getColumn(e).sort(t));return this}subMatrix(t,e,r,i){y(this,t,e,r,i);let n=new V(e-t+1,i-r+1);for(let s=t;s<=e;s++)for(let e=r;e<=i;e++)n.set(s-t,e-r,this.get(s,e));return n}subMatrixRow(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.columns-1),e>r||e<0||e>=this.columns||r<0||r>=this.columns)throw new RangeError("Argument out of range");let i=new V(t.length,r-e+1);for(let n=0;n<t.length;n++)for(let s=e;s<=r;s++){if(t[n]<0||t[n]>=this.rows)throw new RangeError(`Row index out of range: ${t[n]}`);i.set(n,s-e,this.get(t[n],s))}return i}subMatrixColumn(t,e,r){if(void 0===e&&(e=0),void 0===r&&(r=this.rows-1),e>r||e<0||e>=this.rows||r<0||r>=this.rows)throw new RangeError("Argument out of range");let i=new V(r-e+1,t.length);for(let n=0;n<t.length;n++)for(let s=e;s<=r;s++){if(t[n]<0||t[n]>=this.columns)throw new RangeError(`Column index out of range: ${t[n]}`);i.set(s-e,n,this.get(s,t[n]))}return i}setSubMatrix(t,e,r){if(t=V.checkMatrix(t),t.isEmpty())return this;let i=e+t.rows-1,n=r+t.columns-1;y(this,e,i,r,n);for(let s=0;s<t.rows;s++)for(let i=0;i<t.columns;i++)this.set(e+s,r+i,t.get(s,i));return this}selection(t,e){w(this,t),b(this,e);let r=new V(t.length,e.length);for(let i=0;i<t.length;i++){let n=t[i];for(let t=0;t<e.length;t++){let s=e[t];r.set(i,t,this.get(n,s))}}return r}trace(){let t=Math.min(this.rows,this.columns),e=0;for(let r=0;r<t;r++)e+=this.get(r,r);return e}clone(){return this.constructor.copy(this,new V(this.rows,this.columns))}static copy(t,e){for(const[r,i,n]of t.entries())e.set(r,i,n);return e}sum(t){switch(t){case"row":return _(this);case"column":return M(this);case void 0:return E(this);default:throw new Error(`invalid option: ${t}`)}}product(t){switch(t){case"row":return S(this);case"column":return A(this);case void 0:return C(this);default:throw new Error(`invalid option: ${t}`)}}mean(t){const e=this.sum(t);switch(t){case"row":for(let t=0;t<this.rows;t++)e[t]/=this.columns;return e;case"column":for(let t=0;t<this.columns;t++)e[t]/=this.rows;return e;case void 0:return e/this.size;default:throw new Error(`invalid option: ${t}`)}}variance(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");const{unbiased:r=!0,mean:n=this.mean(t)}=e;if("boolean"!==typeof r)throw new TypeError("unbiased must be a boolean");switch(t){case"row":if(!i.isAnyArray(n))throw new TypeError("mean must be an array");return L(this,r,n);case"column":if(!i.isAnyArray(n))throw new TypeError("mean must be an array");return I(this,r,n);case void 0:if("number"!==typeof n)throw new TypeError("mean must be a number");return D(this,r,n);default:throw new Error(`invalid option: ${t}`)}}standardDeviation(t,e){"object"===typeof t&&(e=t,t=void 0);const r=this.variance(t,e);if(void 0===t)return Math.sqrt(r);for(let i=0;i<r.length;i++)r[i]=Math.sqrt(r[i]);return r}center(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");const{center:r=this.mean(t)}=e;switch(t){case"row":if(!i.isAnyArray(r))throw new TypeError("center must be an array");return R(this,r),this;case"column":if(!i.isAnyArray(r))throw new TypeError("center must be an array");return P(this,r),this;case void 0:if("number"!==typeof r)throw new TypeError("center must be a number");return T(this,r),this;default:throw new Error(`invalid option: ${t}`)}}scale(t,e={}){if("object"===typeof t&&(e=t,t=void 0),"object"!==typeof e)throw new TypeError("options must be an object");let r=e.scale;switch(t){case"row":if(void 0===r)r=F(this);else if(!i.isAnyArray(r))throw new TypeError("scale must be an array");return B(this,r),this;case"column":if(void 0===r)r=U(this);else if(!i.isAnyArray(r))throw new TypeError("scale must be an array");return O(this,r),this;case void 0:if(void 0===r)r=N(this);else if("number"!==typeof r)throw new TypeError("scale must be a number");return z(this,r),this;default:throw new Error(`invalid option: ${t}`)}}toString(t){return l(this,t)}[Symbol.iterator](){return this.entries()}*entries(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield[t,e,this.get(t,e)]}*values(){for(let t=0;t<this.rows;t++)for(let e=0;e<this.columns;e++)yield this.get(t,e)}}function X(t,e){return t-e}function $(t){return t.every((t=>"number"===typeof t))}j.prototype.klass="Matrix","undefined"!==typeof Symbol&&(j.prototype[Symbol.for("nodejs.util.inspect.custom")]=a),j.random=j.rand,j.randomInt=j.randInt,j.diagonal=j.diag,j.prototype.diagonal=j.prototype.diag,j.identity=j.eye,j.prototype.negate=j.prototype.neg,j.prototype.tensorProduct=j.prototype.kroneckerProduct;class V extends j{data;#t(t,e){if(this.data=[],!(Number.isInteger(e)&&e>=0))throw new TypeError("nColumns must be a positive integer");for(let r=0;r<t;r++)this.data.push(new Float64Array(e));this.rows=t,this.columns=e}constructor(t,e){if(super(),V.isMatrix(t))this.#t(t.rows,t.columns),V.copy(t,this);else if(Number.isInteger(t)&&t>=0)this.#t(t,e);else{if(!i.isAnyArray(t))throw new TypeError("First argument must be a positive number or an array");{const r=t;if(t=r.length,e=t?r[0].length:0,"number"!==typeof e)throw new TypeError("Data must be a 2D array with at least one element");this.data=[];for(let i=0;i<t;i++){if(r[i].length!==e)throw new RangeError("Inconsistent array dimensions");if(!$(r[i]))throw new TypeError("Input data contains non-numeric values");this.data.push(Float64Array.from(r[i]))}this.rows=t,this.columns=e}}}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}removeRow(t){return d(this,t),this.data.splice(t,1),this.rows-=1,this}addRow(t,e){return void 0===e&&(e=t,t=this.rows),d(this,t,!0),e=Float64Array.from(m(this,e)),this.data.splice(t,0,e),this.rows+=1,this}removeColumn(t){p(this,t);for(let e=0;e<this.rows;e++){const r=new Float64Array(this.columns-1);for(let i=0;i<t;i++)r[i]=this.data[e][i];for(let i=t+1;i<this.columns;i++)r[i-1]=this.data[e][i];this.data[e]=r}return this.columns-=1,this}addColumn(t,e){"undefined"===typeof e&&(e=t,t=this.columns),p(this,t,!0),e=g(this,e);for(let r=0;r<this.rows;r++){const i=new Float64Array(this.columns+1);let n=0;for(;n<t;n++)i[n]=this.data[r][n];for(i[n++]=e[r];n<this.columns+1;n++)i[n]=this.data[r][n-1];this.data[r]=i}return this.columns+=1,this}}f(j,V);class Y extends j{#e;get size(){return this.#e.size}get rows(){return this.#e.rows}get columns(){return this.#e.columns}get diagonalSize(){return this.rows}static isSymmetricMatrix(t){return V.isMatrix(t)&&"SymmetricMatrix"===t.klassType}static zeros(t){return new this(t)}static ones(t){return new this(t).fill(1)}constructor(t){if(super(),V.isMatrix(t)){if(!t.isSymmetric())throw new TypeError("not symmetric data");this.#e=V.copy(t,new V(t.rows,t.rows))}else if(Number.isInteger(t)&&t>=0)this.#e=new V(t,t);else if(this.#e=new V(t),!this.isSymmetric())throw new TypeError("not symmetric data")}clone(){const t=new Y(this.diagonalSize);for(const[e,r,i]of this.upperRightEntries())t.set(e,r,i);return t}toMatrix(){return new V(this)}get(t,e){return this.#e.get(t,e)}set(t,e,r){return this.#e.set(t,e,r),this.#e.set(e,t,r),this}removeCross(t){return this.#e.removeRow(t),this.#e.removeColumn(t),this}addCross(t,e){void 0===e&&(e=t,t=this.diagonalSize);const r=e.slice();return r.splice(t,1),this.#e.addRow(t,r),this.#e.addColumn(t,e),this}applyMask(t){if(t.length!==this.diagonalSize)throw new RangeError("Mask size do not match with matrix size");const e=[];for(const[r,i]of t.entries())i||e.push(r);e.reverse();for(const r of e)this.removeCross(r);return this}toCompact(){const{diagonalSize:t}=this,e=new Array(t*(t+1)/2);for(let r=0,i=0,n=0;n<e.length;n++)e[n]=this.get(i,r),++r>=t&&(r=++i);return e}static fromCompact(t){const e=t.length,r=(Math.sqrt(8*e+1)-1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a Symmetric Matrix, ${JSON.stringify(t)}`);const i=new Y(r);for(let n=0,s=0,o=0;o<e;o++)i.set(n,s,t[o]),++n>=r&&(n=++s);return i}*upperRightEntries(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield[t,e,r],++e>=this.diagonalSize&&(e=++t)}}*upperRightValues(){for(let t=0,e=0;t<this.diagonalSize;void 0){const r=this.get(t,e);yield r,++e>=this.diagonalSize&&(e=++t)}}}Y.prototype.klassType="SymmetricMatrix";class q extends Y{static isDistanceMatrix(t){return Y.isSymmetricMatrix(t)&&"DistanceMatrix"===t.klassSubType}constructor(t){if(super(t),!this.isDistance())throw new TypeError("Provided arguments do no produce a distance matrix")}set(t,e,r){return t===e&&(r=0),super.set(t,e,r)}addCross(t,e){return void 0===e&&(e=t,t=this.diagonalSize),e=e.slice(),e[t]=0,super.addCross(t,e)}toSymmetricMatrix(){return new Y(this)}clone(){const t=new q(this.diagonalSize);for(const[e,r,i]of this.upperRightEntries())e!==r&&t.set(e,r,i);return t}toCompact(){const{diagonalSize:t}=this,e=(t-1)*t/2,r=new Array(e);for(let i=1,n=0,s=0;s<r.length;s++)r[s]=this.get(n,i),++i>=t&&(i=1+ ++n);return r}static fromCompact(t){const e=t.length;if(0===e)return new this(0);const r=(Math.sqrt(8*e+1)+1)/2;if(!Number.isInteger(r))throw new TypeError(`This array is not a compact representation of a DistanceMatrix, ${JSON.stringify(t)}`);const i=new this(r);for(let n=1,s=0,o=0;o<e;o++)i.set(n,s,t[o]),++n>=r&&(n=1+ ++s);return i}}q.prototype.klassSubType="DistanceMatrix";class G extends j{constructor(t,e,r){super(),this.matrix=t,this.rows=e,this.columns=r}}class H extends G{constructor(t,e){p(t,e),super(t,t.rows,1),this.column=e}set(t,e,r){return this.matrix.set(t,this.column,r),this}get(t){return this.matrix.get(t,this.column)}}class W extends G{constructor(t,e){b(t,e),super(t,t.rows,e.length),this.columnIndices=e}set(t,e,r){return this.matrix.set(t,this.columnIndices[e],r),this}get(t,e){return this.matrix.get(t,this.columnIndices[e])}}class K extends G{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(t,this.columns-e-1,r),this}get(t,e){return this.matrix.get(t,this.columns-e-1)}}class Q extends G{constructor(t){super(t,t.rows,t.columns)}set(t,e,r){return this.matrix.set(this.rows-t-1,e,r),this}get(t,e){return this.matrix.get(this.rows-t-1,e)}}class Z extends G{constructor(t,e){d(t,e),super(t,1,t.columns),this.row=e}set(t,e,r){return this.matrix.set(this.row,e,r),this}get(t,e){return this.matrix.get(this.row,e)}}class J extends G{constructor(t,e){w(t,e),super(t,e.length,t.columns),this.rowIndices=e}set(t,e,r){return this.matrix.set(this.rowIndices[t],e,r),this}get(t,e){return this.matrix.get(this.rowIndices[t],e)}}class tt extends G{constructor(t,e,r){w(t,e),b(t,r),super(t,e.length,r.length),this.rowIndices=e,this.columnIndices=r}set(t,e,r){return this.matrix.set(this.rowIndices[t],this.columnIndices[e],r),this}get(t,e){return this.matrix.get(this.rowIndices[t],this.columnIndices[e])}}class et extends G{constructor(t,e,r,i,n){y(t,e,r,i,n),super(t,r-e+1,n-i+1),this.startRow=e,this.startColumn=i}set(t,e,r){return this.matrix.set(this.startRow+t,this.startColumn+e,r),this}get(t,e){return this.matrix.get(this.startRow+t,this.startColumn+e)}}class rt extends G{constructor(t){super(t,t.columns,t.rows)}set(t,e,r){return this.matrix.set(e,t,r),this}get(t,e){return this.matrix.get(e,t)}}class it extends j{constructor(t,e={}){const{rows:r=1}=e;if(t.length%r!==0)throw new Error("the data length is not divisible by the number of rows");super(),this.rows=r,this.columns=t.length/r,this.data=t}set(t,e,r){let i=this._calculateIndex(t,e);return this.data[i]=r,this}get(t,e){let r=this._calculateIndex(t,e);return this.data[r]}_calculateIndex(t,e){return t*this.columns+e}}class nt extends j{constructor(t){super(),this.data=t,this.rows=t.length,this.columns=t[0].length}set(t,e,r){return this.data[t][e]=r,this}get(t,e){return this.data[t][e]}}function st(t,e){if(i.isAnyArray(t))return t[0]&&i.isAnyArray(t[0])?new nt(t):new it(t,e);throw new Error("the argument is not an array")}class ot{constructor(t){t=nt.checkMatrix(t);let e,r,i,n,s,o,a,l,h,u=t.clone(),c=u.rows,f=u.columns,d=new Float64Array(c),p=1;for(e=0;e<c;e++)d[e]=e;for(l=new Float64Array(c),r=0;r<f;r++){for(e=0;e<c;e++)l[e]=u.get(e,r);for(e=0;e<c;e++){for(h=Math.min(e,r),s=0,i=0;i<h;i++)s+=u.get(e,i)*l[i];l[e]-=s,u.set(e,r,l[e])}for(n=r,e=r+1;e<c;e++)Math.abs(l[e])>Math.abs(l[n])&&(n=e);if(n!==r){for(i=0;i<f;i++)o=u.get(n,i),u.set(n,i,u.get(r,i)),u.set(r,i,o);a=d[n],d[n]=d[r],d[r]=a,p=-p}if(r<c&&0!==u.get(r,r))for(e=r+1;e<c;e++)u.set(e,r,u.get(e,r)/u.get(r,r))}this.LU=u,this.pivotVector=d,this.pivotSign=p}isSingular(){let t=this.LU,e=t.columns;for(let r=0;r<e;r++)if(0===t.get(r,r))return!0;return!1}solve(t){t=V.checkMatrix(t);let e=this.LU,r=e.rows;if(r!==t.rows)throw new Error("Invalid matrix dimensions");if(this.isSingular())throw new Error("LU matrix is singular");let i,n,s,o=t.columns,a=t.subMatrixRow(this.pivotVector,0,o-1),l=e.columns;for(s=0;s<l;s++)for(i=s+1;i<l;i++)for(n=0;n<o;n++)a.set(i,n,a.get(i,n)-a.get(s,n)*e.get(i,s));for(s=l-1;s>=0;s--){for(n=0;n<o;n++)a.set(s,n,a.get(s,n)/e.get(s,s));for(i=0;i<s;i++)for(n=0;n<o;n++)a.set(i,n,a.get(i,n)-a.get(s,n)*e.get(i,s))}return a}get determinant(){let t=this.LU;if(!t.isSquare())throw new Error("Matrix must be square");let e=this.pivotSign,r=t.columns;for(let i=0;i<r;i++)e*=t.get(i,i);return e}get lowerTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,i=new V(e,r);for(let n=0;n<e;n++)for(let e=0;e<r;e++)n>e?i.set(n,e,t.get(n,e)):n===e?i.set(n,e,1):i.set(n,e,0);return i}get upperTriangularMatrix(){let t=this.LU,e=t.rows,r=t.columns,i=new V(e,r);for(let n=0;n<e;n++)for(let e=0;e<r;e++)n<=e?i.set(n,e,t.get(n,e)):i.set(n,e,0);return i}get pivotPermutationVector(){return Array.from(this.pivotVector)}}function at(t,e){let r=0;return Math.abs(t)>Math.abs(e)?(r=e/t,Math.abs(t)*Math.sqrt(1+r*r)):0!==e?(r=t/e,Math.abs(e)*Math.sqrt(1+r*r)):0}class lt{constructor(t){t=nt.checkMatrix(t);let e,r,i,n,s=t.clone(),o=t.rows,a=t.columns,l=new Float64Array(a);for(i=0;i<a;i++){let t=0;for(e=i;e<o;e++)t=at(t,s.get(e,i));if(0!==t){for(s.get(i,i)<0&&(t=-t),e=i;e<o;e++)s.set(e,i,s.get(e,i)/t);for(s.set(i,i,s.get(i,i)+1),r=i+1;r<a;r++){for(n=0,e=i;e<o;e++)n+=s.get(e,i)*s.get(e,r);for(n=-n/s.get(i,i),e=i;e<o;e++)s.set(e,r,s.get(e,r)+n*s.get(e,i))}}l[i]=-t}this.QR=s,this.Rdiag=l}solve(t){t=V.checkMatrix(t);let e=this.QR,r=e.rows;if(t.rows!==r)throw new Error("Matrix row dimensions must agree");if(!this.isFullRank())throw new Error("Matrix is rank deficient");let i,n,s,o,a=t.columns,l=t.clone(),h=e.columns;for(s=0;s<h;s++)for(n=0;n<a;n++){for(o=0,i=s;i<r;i++)o+=e.get(i,s)*l.get(i,n);for(o=-o/e.get(s,s),i=s;i<r;i++)l.set(i,n,l.get(i,n)+o*e.get(i,s))}for(s=h-1;s>=0;s--){for(n=0;n<a;n++)l.set(s,n,l.get(s,n)/this.Rdiag[s]);for(i=0;i<s;i++)for(n=0;n<a;n++)l.set(i,n,l.get(i,n)-l.get(s,n)*e.get(i,s))}return l.subMatrix(0,h-1,0,a-1)}isFullRank(){let t=this.QR.columns;for(let e=0;e<t;e++)if(0===this.Rdiag[e])return!1;return!0}get upperTriangularMatrix(){let t,e,r=this.QR,i=r.columns,n=new V(i,i);for(t=0;t<i;t++)for(e=0;e<i;e++)t<e?n.set(t,e,r.get(t,e)):t===e?n.set(t,e,this.Rdiag[t]):n.set(t,e,0);return n}get orthogonalMatrix(){let t,e,r,i,n=this.QR,s=n.rows,o=n.columns,a=new V(s,o);for(r=o-1;r>=0;r--){for(t=0;t<s;t++)a.set(t,r,0);for(a.set(r,r,1),e=r;e<o;e++)if(0!==n.get(r,r)){for(i=0,t=r;t<s;t++)i+=n.get(t,r)*a.get(t,e);for(i=-i/n.get(r,r),t=r;t<s;t++)a.set(t,e,a.get(t,e)+i*n.get(t,r))}}return a}}class ht{constructor(t,e={}){if(t=nt.checkMatrix(t),t.isEmpty())throw new Error("Matrix must be non-empty");let r=t.rows,i=t.columns;const{computeLeftSingularVectors:n=!0,computeRightSingularVectors:s=!0,autoTranspose:o=!1}=e;let a,l=Boolean(n),h=Boolean(s),u=!1;if(r<i)if(o){a=t.transpose(),r=a.rows,i=a.columns,u=!0;let e=l;l=h,h=e}else a=t.clone(),console.warn("Computing SVD on a matrix with more columns than rows. Consider enabling autoTranspose");else a=t.clone();let c=Math.min(r,i),f=Math.min(r+1,i),d=new Float64Array(f),p=new V(r,c),m=new V(i,i),g=new Float64Array(i),w=new Float64Array(r),b=new Float64Array(f);for(let E=0;E<f;E++)b[E]=E;let y=Math.min(r-1,i),v=Math.max(0,Math.min(i-2,r)),x=Math.max(y,v);for(let E=0;E<x;E++){if(E<y){d[E]=0;for(let t=E;t<r;t++)d[E]=at(d[E],a.get(t,E));if(0!==d[E]){a.get(E,E)<0&&(d[E]=-d[E]);for(let t=E;t<r;t++)a.set(t,E,a.get(t,E)/d[E]);a.set(E,E,a.get(E,E)+1)}d[E]=-d[E]}for(let t=E+1;t<i;t++){if(E<y&&0!==d[E]){let e=0;for(let i=E;i<r;i++)e+=a.get(i,E)*a.get(i,t);e=-e/a.get(E,E);for(let i=E;i<r;i++)a.set(i,t,a.get(i,t)+e*a.get(i,E))}g[t]=a.get(E,t)}if(l&&E<y)for(let t=E;t<r;t++)p.set(t,E,a.get(t,E));if(E<v){g[E]=0;for(let t=E+1;t<i;t++)g[E]=at(g[E],g[t]);if(0!==g[E]){g[E+1]<0&&(g[E]=0-g[E]);for(let t=E+1;t<i;t++)g[t]/=g[E];g[E+1]+=1}if(g[E]=-g[E],E+1<r&&0!==g[E]){for(let t=E+1;t<r;t++)w[t]=0;for(let t=E+1;t<r;t++)for(let e=E+1;e<i;e++)w[t]+=g[e]*a.get(t,e);for(let t=E+1;t<i;t++){let e=-g[t]/g[E+1];for(let i=E+1;i<r;i++)a.set(i,t,a.get(i,t)+e*w[i])}}if(h)for(let t=E+1;t<i;t++)m.set(t,E,g[t])}}let k=Math.min(i,r+1);if(y<i&&(d[y]=a.get(y,y)),r<k&&(d[k-1]=0),v+1<k&&(g[v]=a.get(v,k-1)),g[k-1]=0,l){for(let t=y;t<c;t++){for(let e=0;e<r;e++)p.set(e,t,0);p.set(t,t,1)}for(let t=y-1;t>=0;t--)if(0!==d[t]){for(let e=t+1;e<c;e++){let i=0;for(let n=t;n<r;n++)i+=p.get(n,t)*p.get(n,e);i=-i/p.get(t,t);for(let n=t;n<r;n++)p.set(n,e,p.get(n,e)+i*p.get(n,t))}for(let e=t;e<r;e++)p.set(e,t,-p.get(e,t));p.set(t,t,1+p.get(t,t));for(let e=0;e<t-1;e++)p.set(e,t,0)}else{for(let e=0;e<r;e++)p.set(e,t,0);p.set(t,t,1)}}if(h)for(let E=i-1;E>=0;E--){if(E<v&&0!==g[E])for(let t=E+1;t<i;t++){let e=0;for(let r=E+1;r<i;r++)e+=m.get(r,E)*m.get(r,t);e=-e/m.get(E+1,E);for(let r=E+1;r<i;r++)m.set(r,t,m.get(r,t)+e*m.get(r,E))}for(let t=0;t<i;t++)m.set(t,E,0);m.set(E,E,1)}let _=k-1,M=Number.EPSILON;while(k>0){let t,e;for(t=k-2;t>=-1;t--){if(-1===t)break;const e=Number.MIN_VALUE+M*Math.abs(d[t]+Math.abs(d[t+1]));if(Math.abs(g[t])<=e||Number.isNaN(g[t])){g[t]=0;break}}if(t===k-2)e=4;else{let r;for(r=k-1;r>=t;r--){if(r===t)break;let e=(r!==k?Math.abs(g[r]):0)+(r!==t+1?Math.abs(g[r-1]):0);if(Math.abs(d[r])<=M*e){d[r]=0;break}}r===t?e=3:r===k-1?e=1:(e=2,t=r)}switch(t++,e){case 1:{let e=g[k-2];g[k-2]=0;for(let r=k-2;r>=t;r--){let n=at(d[r],e),s=d[r]/n,o=e/n;if(d[r]=n,r!==t&&(e=-o*g[r-1],g[r-1]=s*g[r-1]),h)for(let t=0;t<i;t++)n=s*m.get(t,r)+o*m.get(t,k-1),m.set(t,k-1,-o*m.get(t,r)+s*m.get(t,k-1)),m.set(t,r,n)}break}case 2:{let e=g[t-1];g[t-1]=0;for(let i=t;i<k;i++){let n=at(d[i],e),s=d[i]/n,o=e/n;if(d[i]=n,e=-o*g[i],g[i]=s*g[i],l)for(let e=0;e<r;e++)n=s*p.get(e,i)+o*p.get(e,t-1),p.set(e,t-1,-o*p.get(e,i)+s*p.get(e,t-1)),p.set(e,i,n)}break}case 3:{const e=Math.max(Math.abs(d[k-1]),Math.abs(d[k-2]),Math.abs(g[k-2]),Math.abs(d[t]),Math.abs(g[t])),n=d[k-1]/e,s=d[k-2]/e,o=g[k-2]/e,a=d[t]/e,u=g[t]/e,c=((s+n)*(s-n)+o*o)/2,f=n*o*(n*o);let w=0;0===c&&0===f||(w=c<0?0-Math.sqrt(c*c+f):Math.sqrt(c*c+f),w=f/(c+w));let b=(a+n)*(a-n)+w,y=a*u;for(let v=t;v<k-1;v++){let e=at(b,y);0===e&&(e=Number.MIN_VALUE);let n=b/e,s=y/e;if(v!==t&&(g[v-1]=e),b=n*d[v]+s*g[v],g[v]=n*g[v]-s*d[v],y=s*d[v+1],d[v+1]=n*d[v+1],h)for(let t=0;t<i;t++)e=n*m.get(t,v)+s*m.get(t,v+1),m.set(t,v+1,-s*m.get(t,v)+n*m.get(t,v+1)),m.set(t,v,e);if(e=at(b,y),0===e&&(e=Number.MIN_VALUE),n=b/e,s=y/e,d[v]=e,b=n*g[v]+s*d[v+1],d[v+1]=-s*g[v]+n*d[v+1],y=s*g[v+1],g[v+1]=n*g[v+1],l&&v<r-1)for(let t=0;t<r;t++)e=n*p.get(t,v)+s*p.get(t,v+1),p.set(t,v+1,-s*p.get(t,v)+n*p.get(t,v+1)),p.set(t,v,e)}g[k-2]=b;break}case 4:if(d[t]<=0&&(d[t]=d[t]<0?-d[t]:0,h))for(let e=0;e<=_;e++)m.set(e,t,-m.get(e,t));while(t<_){if(d[t]>=d[t+1])break;let e=d[t];if(d[t]=d[t+1],d[t+1]=e,h&&t<i-1)for(let r=0;r<i;r++)e=m.get(r,t+1),m.set(r,t+1,m.get(r,t)),m.set(r,t,e);if(l&&t<r-1)for(let i=0;i<r;i++)e=p.get(i,t+1),p.set(i,t+1,p.get(i,t)),p.set(i,t,e);t++}k--;break}}if(u){let t=m;m=p,p=t}this.m=r,this.n=i,this.s=d,this.U=p,this.V=m}solve(t){let e=t,r=this.threshold,i=this.s.length,n=V.zeros(i,i);for(let c=0;c<i;c++)Math.abs(this.s[c])<=r?n.set(c,c,0):n.set(c,c,1/this.s[c]);let s=this.U,o=this.rightSingularVectors,a=o.mmul(n),l=o.rows,h=s.rows,u=V.zeros(l,h);for(let c=0;c<l;c++)for(let t=0;t<h;t++){let e=0;for(let r=0;r<i;r++)e+=a.get(c,r)*s.get(t,r);u.set(c,t,e)}return u.mmul(e)}solveForDiagonal(t){return this.solve(V.diag(t))}inverse(){let t=this.V,e=this.threshold,r=t.rows,i=t.columns,n=new V(r,this.s.length);for(let h=0;h<r;h++)for(let r=0;r<i;r++)Math.abs(this.s[r])>e&&n.set(h,r,t.get(h,r)/this.s[r]);let s=this.U,o=s.rows,a=s.columns,l=new V(r,o);for(let h=0;h<r;h++)for(let t=0;t<o;t++){let e=0;for(let r=0;r<a;r++)e+=n.get(h,r)*s.get(t,r);l.set(h,t,e)}return l}get condition(){return this.s[0]/this.s[Math.min(this.m,this.n)-1]}get norm2(){return this.s[0]}get rank(){let t=Math.max(this.m,this.n)*this.s[0]*Number.EPSILON,e=0,r=this.s;for(let i=0,n=r.length;i<n;i++)r[i]>t&&e++;return e}get diagonal(){return Array.from(this.s)}get threshold(){return Number.EPSILON/2*Math.max(this.m,this.n)*this.s[0]}get leftSingularVectors(){return this.U}get rightSingularVectors(){return this.V}get diagonalMatrix(){return V.diag(this.s)}}function ut(t,e=!1){return t=nt.checkMatrix(t),e?new ht(t).inverse():ct(t,V.eye(t.rows))}function ct(t,e,r=!1){return t=nt.checkMatrix(t),e=nt.checkMatrix(e),r?new ht(t).solve(e):t.isSquare()?new ot(t).solve(e):new lt(t).solve(e)}function ft(t){if(t=V.checkMatrix(t),t.isSquare()){if(0===t.columns)return 1;let e,r,i,n;if(2===t.columns)return e=t.get(0,0),r=t.get(0,1),i=t.get(1,0),n=t.get(1,1),e*n-r*i;if(3===t.columns){let n,s,o;return n=new tt(t,[1,2],[1,2]),s=new tt(t,[1,2],[0,2]),o=new tt(t,[1,2],[0,1]),e=t.get(0,0),r=t.get(0,1),i=t.get(0,2),e*ft(n)-r*ft(s)+i*ft(o)}return new ot(t).determinant}throw Error("determinant can only be calculated for a square matrix")}function dt(t,e){let r=[];for(let i=0;i<t;i++)i!==e&&r.push(i);return r}function pt(t,e,r,i=1e-9,n=1e-9){if(t>n)return new Array(e.rows+1).fill(0);{let t=e.addRow(r,[0]);for(let e=0;e<t.rows;e++)Math.abs(t.get(e,0))<i&&t.set(e,0,0);return t.to1DArray()}}function mt(t,e={}){const{thresholdValue:r=1e-9,thresholdError:i=1e-9}=e;t=V.checkMatrix(t);let n=t.rows,s=new V(n,n);for(let o=0;o<n;o++){let e=V.columnVector(t.getRow(o)),a=t.subMatrixRow(dt(n,o)).transpose(),l=new ht(a),h=l.solve(e),u=V.sub(e,a.mmul(h)).abs().max();s.setRow(o,pt(u,h,o,r,i))}return s}function gt(t,e=Number.EPSILON){if(t=V.checkMatrix(t),t.isEmpty())return t.transpose();let r=new ht(t,{autoTranspose:!0}),i=r.leftSingularVectors,n=r.rightSingularVectors,s=r.diagonal;for(let o=0;o<s.length;o++)Math.abs(s[o])>e?s[o]=1/s[o]:s[o]=0;return n.mmul(V.diag(s).mmul(i.transpose()))}function wt(t,e=t,r={}){t=new V(t);let n=!1;if("object"!==typeof e||V.isMatrix(e)||i.isAnyArray(e)?e=new V(e):(r=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0}=r;s&&(t=t.center("column"),n||(e=e.center("column")));const o=t.transpose().mmul(e);for(let i=0;i<o.rows;i++)for(let e=0;e<o.columns;e++)o.set(i,e,o.get(i,e)*(1/(t.rows-1)));return o}function bt(t,e=t,r={}){t=new V(t);let n=!1;if("object"!==typeof e||V.isMatrix(e)||i.isAnyArray(e)?e=new V(e):(r=e,e=t,n=!0),t.rows!==e.rows)throw new TypeError("Both matrices must have the same number of rows");const{center:s=!0,scale:o=!0}=r;s&&(t.center("column"),n||e.center("column")),o&&(t.scale("column"),n||e.scale("column"));const a=t.standardDeviation("column",{unbiased:!0}),l=n?a:e.standardDeviation("column",{unbiased:!0}),h=t.transpose().mmul(e);for(let i=0;i<h.rows;i++)for(let e=0;e<h.columns;e++)h.set(i,e,h.get(i,e)*(1/(a[i]*l[e]))*(1/(t.rows-1)));return h}class yt{constructor(t,e={}){const{assumeSymmetric:r=!1}=e;if(t=nt.checkMatrix(t),!t.isSquare())throw new Error("Matrix is not a square matrix");if(t.isEmpty())throw new Error("Matrix must be non-empty");let i,n,s=t.columns,o=new V(s,s),a=new Float64Array(s),l=new Float64Array(s),h=t,u=!1;if(u=!!r||t.isSymmetric(),u){for(i=0;i<s;i++)for(n=0;n<s;n++)o.set(i,n,h.get(i,n));vt(s,l,a,o),xt(s,l,a,o)}else{let t=new V(s,s),e=new Float64Array(s);for(n=0;n<s;n++)for(i=0;i<s;i++)t.set(i,n,h.get(i,n));kt(s,t,e,o),_t(s,l,a,o,t)}this.n=s,this.e=l,this.d=a,this.V=o}get realEigenvalues(){return Array.from(this.d)}get imaginaryEigenvalues(){return Array.from(this.e)}get eigenvectorMatrix(){return this.V}get diagonalMatrix(){let t,e,r=this.n,i=this.e,n=this.d,s=new V(r,r);for(t=0;t<r;t++){for(e=0;e<r;e++)s.set(t,e,0);s.set(t,t,n[t]),i[t]>0?s.set(t,t+1,i[t]):i[t]<0&&s.set(t,t-1,i[t])}return s}}function vt(t,e,r,i){let n,s,o,a,l,h,u,c;for(l=0;l<t;l++)r[l]=i.get(t-1,l);for(a=t-1;a>0;a--){for(c=0,o=0,h=0;h<a;h++)c+=Math.abs(r[h]);if(0===c)for(e[a]=r[a-1],l=0;l<a;l++)r[l]=i.get(a-1,l),i.set(a,l,0),i.set(l,a,0);else{for(h=0;h<a;h++)r[h]/=c,o+=r[h]*r[h];for(n=r[a-1],s=Math.sqrt(o),n>0&&(s=-s),e[a]=c*s,o-=n*s,r[a-1]=n-s,l=0;l<a;l++)e[l]=0;for(l=0;l<a;l++){for(n=r[l],i.set(l,a,n),s=e[l]+i.get(l,l)*n,h=l+1;h<=a-1;h++)s+=i.get(h,l)*r[h],e[h]+=i.get(h,l)*n;e[l]=s}for(n=0,l=0;l<a;l++)e[l]/=o,n+=e[l]*r[l];for(u=n/(o+o),l=0;l<a;l++)e[l]-=u*r[l];for(l=0;l<a;l++){for(n=r[l],s=e[l],h=l;h<=a-1;h++)i.set(h,l,i.get(h,l)-(n*e[h]+s*r[h]));r[l]=i.get(a-1,l),i.set(a,l,0)}}r[a]=o}for(a=0;a<t-1;a++){if(i.set(t-1,a,i.get(a,a)),i.set(a,a,1),o=r[a+1],0!==o){for(h=0;h<=a;h++)r[h]=i.get(h,a+1)/o;for(l=0;l<=a;l++){for(s=0,h=0;h<=a;h++)s+=i.get(h,a+1)*i.get(h,l);for(h=0;h<=a;h++)i.set(h,l,i.get(h,l)-s*r[h])}}for(h=0;h<=a;h++)i.set(h,a+1,0)}for(l=0;l<t;l++)r[l]=i.get(t-1,l),i.set(t-1,l,0);i.set(t-1,t-1,1),e[0]=0}function xt(t,e,r,i){let n,s,o,a,l,h,u,c,f,d,p,m,g,w,b,y;for(o=1;o<t;o++)e[o-1]=e[o];e[t-1]=0;let v=0,x=0,k=Number.EPSILON;for(h=0;h<t;h++){x=Math.max(x,Math.abs(r[h])+Math.abs(e[h])),u=h;while(u<t){if(Math.abs(e[u])<=k*x)break;u++}if(u>h)do{for(n=r[h],c=(r[h+1]-n)/(2*e[h]),f=at(c,1),c<0&&(f=-f),r[h]=e[h]/(c+f),r[h+1]=e[h]*(c+f),d=r[h+1],s=n-r[h],o=h+2;o<t;o++)r[o]-=s;for(v+=s,c=r[u],p=1,m=p,g=p,w=e[h+1],b=0,y=0,o=u-1;o>=h;o--)for(g=m,m=p,y=b,n=p*e[o],s=p*c,f=at(c,e[o]),e[o+1]=b*f,b=e[o]/f,p=c/f,c=p*r[o]-b*n,r[o+1]=s+b*(p*n+b*r[o]),l=0;l<t;l++)s=i.get(l,o+1),i.set(l,o+1,b*i.get(l,o)+p*s),i.set(l,o,p*i.get(l,o)-b*s);c=-b*y*g*w*e[h]/d,e[h]=b*c,r[h]=p*c}while(Math.abs(e[h])>k*x);r[h]=r[h]+v,e[h]=0}for(o=0;o<t-1;o++){for(l=o,c=r[o],a=o+1;a<t;a++)r[a]<c&&(l=a,c=r[a]);if(l!==o)for(r[l]=r[o],r[o]=c,a=0;a<t;a++)c=i.get(a,o),i.set(a,o,i.get(a,l)),i.set(a,l,c)}}function kt(t,e,r,i){let n,s,o,a,l,h,u,c=0,f=t-1;for(h=c+1;h<=f-1;h++){for(u=0,a=h;a<=f;a++)u+=Math.abs(e.get(a,h-1));if(0!==u){for(o=0,a=f;a>=h;a--)r[a]=e.get(a,h-1)/u,o+=r[a]*r[a];for(s=Math.sqrt(o),r[h]>0&&(s=-s),o-=r[h]*s,r[h]=r[h]-s,l=h;l<t;l++){for(n=0,a=f;a>=h;a--)n+=r[a]*e.get(a,l);for(n/=o,a=h;a<=f;a++)e.set(a,l,e.get(a,l)-n*r[a])}for(a=0;a<=f;a++){for(n=0,l=f;l>=h;l--)n+=r[l]*e.get(a,l);for(n/=o,l=h;l<=f;l++)e.set(a,l,e.get(a,l)-n*r[l])}r[h]=u*r[h],e.set(h,h-1,u*s)}}for(a=0;a<t;a++)for(l=0;l<t;l++)i.set(a,l,a===l?1:0);for(h=f-1;h>=c+1;h--)if(0!==e.get(h,h-1)){for(a=h+1;a<=f;a++)r[a]=e.get(a,h-1);for(l=h;l<=f;l++){for(s=0,a=h;a<=f;a++)s+=r[a]*i.get(a,l);for(s=s/r[h]/e.get(h,h-1),a=h;a<=f;a++)i.set(a,l,i.get(a,l)+s*r[a])}}}function _t(t,e,r,i,n){let s,o,a,l,h,u,c,f,d,p,m,g,w,b,y,v=t-1,x=0,k=t-1,_=Number.EPSILON,M=0,E=0,S=0,A=0,C=0,L=0,I=0,D=0;for(s=0;s<t;s++)for((s<x||s>k)&&(r[s]=n.get(s,s),e[s]=0),o=Math.max(s-1,0);o<t;o++)E+=Math.abs(n.get(s,o));while(v>=x){l=v;while(l>x){if(L=Math.abs(n.get(l-1,l-1))+Math.abs(n.get(l,l)),0===L&&(L=E),Math.abs(n.get(l,l-1))<_*L)break;l--}if(l===v)n.set(v,v,n.get(v,v)+M),r[v]=n.get(v,v),e[v]=0,v--,D=0;else if(l===v-1){if(c=n.get(v,v-1)*n.get(v-1,v),S=(n.get(v-1,v-1)-n.get(v,v))/2,A=S*S+c,I=Math.sqrt(Math.abs(A)),n.set(v,v,n.get(v,v)+M),n.set(v-1,v-1,n.get(v-1,v-1)+M),f=n.get(v,v),A>=0){for(I=S>=0?S+I:S-I,r[v-1]=f+I,r[v]=r[v-1],0!==I&&(r[v]=f-c/I),e[v-1]=0,e[v]=0,f=n.get(v,v-1),L=Math.abs(f)+Math.abs(I),S=f/L,A=I/L,C=Math.sqrt(S*S+A*A),S/=C,A/=C,o=v-1;o<t;o++)I=n.get(v-1,o),n.set(v-1,o,A*I+S*n.get(v,o)),n.set(v,o,A*n.get(v,o)-S*I);for(s=0;s<=v;s++)I=n.get(s,v-1),n.set(s,v-1,A*I+S*n.get(s,v)),n.set(s,v,A*n.get(s,v)-S*I);for(s=x;s<=k;s++)I=i.get(s,v-1),i.set(s,v-1,A*I+S*i.get(s,v)),i.set(s,v,A*i.get(s,v)-S*I)}else r[v-1]=f+S,r[v]=f+S,e[v-1]=I,e[v]=-I;v-=2,D=0}else{if(f=n.get(v,v),d=0,c=0,l<v&&(d=n.get(v-1,v-1),c=n.get(v,v-1)*n.get(v-1,v)),10===D){for(M+=f,s=x;s<=v;s++)n.set(s,s,n.get(s,s)-f);L=Math.abs(n.get(v,v-1))+Math.abs(n.get(v-1,v-2)),f=d=.75*L,c=-.4375*L*L}if(30===D&&(L=(d-f)/2,L=L*L+c,L>0)){for(L=Math.sqrt(L),d<f&&(L=-L),L=f-c/((d-f)/2+L),s=x;s<=v;s++)n.set(s,s,n.get(s,s)-L);M+=L,f=d=c=.964}D+=1,h=v-2;while(h>=l){if(I=n.get(h,h),C=f-I,L=d-I,S=(C*L-c)/n.get(h+1,h)+n.get(h,h+1),A=n.get(h+1,h+1)-I-C-L,C=n.get(h+2,h+1),L=Math.abs(S)+Math.abs(A)+Math.abs(C),S/=L,A/=L,C/=L,h===l)break;if(Math.abs(n.get(h,h-1))*(Math.abs(A)+Math.abs(C))<_*(Math.abs(S)*(Math.abs(n.get(h-1,h-1))+Math.abs(I)+Math.abs(n.get(h+1,h+1)))))break;h--}for(s=h+2;s<=v;s++)n.set(s,s-2,0),s>h+2&&n.set(s,s-3,0);for(a=h;a<=v-1;a++){if(b=a!==v-1,a!==h&&(S=n.get(a,a-1),A=n.get(a+1,a-1),C=b?n.get(a+2,a-1):0,f=Math.abs(S)+Math.abs(A)+Math.abs(C),0!==f&&(S/=f,A/=f,C/=f)),0===f)break;if(L=Math.sqrt(S*S+A*A+C*C),S<0&&(L=-L),0!==L){for(a!==h?n.set(a,a-1,-L*f):l!==h&&n.set(a,a-1,-n.get(a,a-1)),S+=L,f=S/L,d=A/L,I=C/L,A/=S,C/=S,o=a;o<t;o++)S=n.get(a,o)+A*n.get(a+1,o),b&&(S+=C*n.get(a+2,o),n.set(a+2,o,n.get(a+2,o)-S*I)),n.set(a,o,n.get(a,o)-S*f),n.set(a+1,o,n.get(a+1,o)-S*d);for(s=0;s<=Math.min(v,a+3);s++)S=f*n.get(s,a)+d*n.get(s,a+1),b&&(S+=I*n.get(s,a+2),n.set(s,a+2,n.get(s,a+2)-S*C)),n.set(s,a,n.get(s,a)-S),n.set(s,a+1,n.get(s,a+1)-S*A);for(s=x;s<=k;s++)S=f*i.get(s,a)+d*i.get(s,a+1),b&&(S+=I*i.get(s,a+2),i.set(s,a+2,i.get(s,a+2)-S*C)),i.set(s,a,i.get(s,a)-S),i.set(s,a+1,i.get(s,a+1)-S*A)}}}}if(0!==E){for(v=t-1;v>=0;v--)if(S=r[v],A=e[v],0===A)for(l=v,n.set(v,v,1),s=v-1;s>=0;s--){for(c=n.get(s,s)-S,C=0,o=l;o<=v;o++)C+=n.get(s,o)*n.get(o,v);if(e[s]<0)I=c,L=C;else if(l=s,0===e[s]?n.set(s,v,0!==c?-C/c:-C/(_*E)):(f=n.get(s,s+1),d=n.get(s+1,s),A=(r[s]-S)*(r[s]-S)+e[s]*e[s],u=(f*L-I*C)/A,n.set(s,v,u),n.set(s+1,v,Math.abs(f)>Math.abs(I)?(-C-c*u)/f:(-L-d*u)/I)),u=Math.abs(n.get(s,v)),_*u*u>1)for(o=s;o<=v;o++)n.set(o,v,n.get(o,v)/u)}else if(A<0)for(l=v-1,Math.abs(n.get(v,v-1))>Math.abs(n.get(v-1,v))?(n.set(v-1,v-1,A/n.get(v,v-1)),n.set(v-1,v,-(n.get(v,v)-S)/n.get(v,v-1))):(y=Mt(0,-n.get(v-1,v),n.get(v-1,v-1)-S,A),n.set(v-1,v-1,y[0]),n.set(v-1,v,y[1])),n.set(v,v-1,0),n.set(v,v,1),s=v-2;s>=0;s--){for(p=0,m=0,o=l;o<=v;o++)p+=n.get(s,o)*n.get(o,v-1),m+=n.get(s,o)*n.get(o,v);if(c=n.get(s,s)-S,e[s]<0)I=c,C=p,L=m;else if(l=s,0===e[s]?(y=Mt(-p,-m,c,A),n.set(s,v-1,y[0]),n.set(s,v,y[1])):(f=n.get(s,s+1),d=n.get(s+1,s),g=(r[s]-S)*(r[s]-S)+e[s]*e[s]-A*A,w=2*(r[s]-S)*A,0===g&&0===w&&(g=_*E*(Math.abs(c)+Math.abs(A)+Math.abs(f)+Math.abs(d)+Math.abs(I))),y=Mt(f*C-I*p+A*m,f*L-I*m-A*p,g,w),n.set(s,v-1,y[0]),n.set(s,v,y[1]),Math.abs(f)>Math.abs(I)+Math.abs(A)?(n.set(s+1,v-1,(-p-c*n.get(s,v-1)+A*n.get(s,v))/f),n.set(s+1,v,(-m-c*n.get(s,v)-A*n.get(s,v-1))/f)):(y=Mt(-C-d*n.get(s,v-1),-L-d*n.get(s,v),I,A),n.set(s+1,v-1,y[0]),n.set(s+1,v,y[1]))),u=Math.max(Math.abs(n.get(s,v-1)),Math.abs(n.get(s,v))),_*u*u>1)for(o=s;o<=v;o++)n.set(o,v-1,n.get(o,v-1)/u),n.set(o,v,n.get(o,v)/u)}for(s=0;s<t;s++)if(s<x||s>k)for(o=s;o<t;o++)i.set(s,o,n.get(s,o));for(o=t-1;o>=x;o--)for(s=x;s<=k;s++){for(I=0,a=x;a<=Math.min(o,k);a++)I+=i.get(s,a)*n.get(a,o);i.set(s,o,I)}}}function Mt(t,e,r,i){let n,s;return Math.abs(r)>Math.abs(i)?(n=i/r,s=r+n*i,[(t+n*e)/s,(e-n*t)/s]):(n=r/i,s=i+n*r,[(n*t+e)/s,(n*e-t)/s])}class Et{constructor(t){if(t=nt.checkMatrix(t),!t.isSymmetric())throw new Error("Matrix is not symmetric");let e,r,i,n=t,s=n.rows,o=new V(s,s),a=!0;for(r=0;r<s;r++){let t=0;for(i=0;i<r;i++){let s=0;for(e=0;e<i;e++)s+=o.get(i,e)*o.get(r,e);s=(n.get(r,i)-s)/o.get(i,i),o.set(r,i,s),t+=s*s}for(t=n.get(r,r)-t,a&&=t>0,o.set(r,r,Math.sqrt(Math.max(t,0))),i=r+1;i<s;i++)o.set(r,i,0)}this.L=o,this.positiveDefinite=a}isPositiveDefinite(){return this.positiveDefinite}solve(t){t=nt.checkMatrix(t);let e=this.L,r=e.rows;if(t.rows!==r)throw new Error("Matrix dimensions do not match");if(!1===this.isPositiveDefinite())throw new Error("Matrix is not positive definite");let i,n,s,o=t.columns,a=t.clone();for(s=0;s<r;s++)for(n=0;n<o;n++){for(i=0;i<s;i++)a.set(s,n,a.get(s,n)-a.get(i,n)*e.get(s,i));a.set(s,n,a.get(s,n)/e.get(s,s))}for(s=r-1;s>=0;s--)for(n=0;n<o;n++){for(i=s+1;i<r;i++)a.set(s,n,a.get(s,n)-a.get(i,n)*e.get(i,s));a.set(s,n,a.get(s,n)/e.get(s,s))}return a}get lowerTriangularMatrix(){return this.L}}class St{constructor(t,e={}){t=nt.checkMatrix(t);let{Y:r}=e;const{scaleScores:n=!1,maxIterations:s=1e3,terminationCriteria:o=1e-10}=e;let a;if(r){if(r=i.isAnyArray(r)&&"number"===typeof r[0]?V.columnVector(r):nt.checkMatrix(r),r.rows!==t.rows)throw new Error("Y should have the same number of rows as X");a=r.getColumnVector(0)}else a=t.getColumnVector(0);let l,h,u,c,f=1;for(let i=0;i<s&&f>o;i++)u=t.transpose().mmul(a).div(a.transpose().mmul(a).get(0,0)),u=u.div(u.norm()),l=t.mmul(u).div(u.transpose().mmul(u).get(0,0)),i>0&&(f=l.clone().sub(c).pow(2).sum()),c=l.clone(),r?(h=r.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),h=h.div(h.norm()),a=r.mmul(h).div(h.transpose().mmul(h).get(0,0))):a=l;if(r){let e=t.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0));e=e.div(e.norm());let i=t.clone().sub(l.clone().mmul(e.transpose())),n=a.transpose().mmul(l).div(l.transpose().mmul(l).get(0,0)),s=r.clone().sub(l.clone().mulS(n.get(0,0)).mmul(h.transpose()));this.t=l,this.p=e.transpose(),this.w=u.transpose(),this.q=h,this.u=a,this.s=l.transpose().mmul(l),this.xResidual=i,this.yResidual=s,this.betas=n}else this.w=u.transpose(),this.s=l.transpose().mmul(l).sqrt(),this.t=n?l.clone().div(this.s.get(0,0)):l,this.xResidual=t.sub(l.mmul(u.transpose()))}}e.AbstractMatrix=j,e.CHO=Et,e.CholeskyDecomposition=Et,e.DistanceMatrix=q,e.EVD=yt,e.EigenvalueDecomposition=yt,e.LU=ot,e.LuDecomposition=ot,e.Matrix=V,e.MatrixColumnSelectionView=W,e.MatrixColumnView=H,e.MatrixFlipColumnView=K,e.MatrixFlipRowView=Q,e.MatrixRowSelectionView=J,e.MatrixRowView=Z,e.MatrixSelectionView=tt,e.MatrixSubView=et,e.MatrixTransposeView=rt,e.NIPALS=St,e.Nipals=St,e.QR=lt,e.QrDecomposition=lt,e.SVD=ht,e.SingularValueDecomposition=ht,e.SymmetricMatrix=Y,e.WrapperMatrix1D=it,e.WrapperMatrix2D=nt,e.correlation=bt,e.covariance=wt,e["default"]=V,e.determinant=ft,e.inverse=ut,e.linearDependencies=mt,e.pseudoInverse=gt,e.solve=ct,e.wrap=st},42161:function(t){function e(t,e){t=t||0;for(var r=new Array(t),i=0;i<t;i++)r[i]=e;return r}t.exports=e},48881:function(t){function e(t){return 0===t?1:(t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,t+1)}t.exports=e},86048:function(t){"use strict";function e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var r={};function i(t,i,n){function s(t,e,r){return"string"===typeof i?i:i(t,e,r)}n||(n=Error);var o=function(t){function r(e,r,i){return t.call(this,s(e,r,i))||this}return e(r,t),r}(n);o.prototype.name=n.name,o.prototype.code=t,r[t]=o}function n(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map((function(t){return String(t)})),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:2===r?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}return"of ".concat(e," ").concat(String(t))}function s(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function o(t,e,r){return(void 0===r||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function a(t,e,r){return"number"!==typeof r&&(r=0),!(r+e.length>t.length)&&-1!==t.indexOf(e,r)}i("ERR_INVALID_OPT_VALUE",(function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'}),TypeError),i("ERR_INVALID_ARG_TYPE",(function(t,e,r){var i,l;if("string"===typeof e&&s(e,"not ")?(i="must not be",e=e.replace(/^not /,"")):i="must be",o(t," argument"))l="The ".concat(t," ").concat(i," ").concat(n(e,"type"));else{var h=a(t,".")?"property":"argument";l='The "'.concat(t,'" ').concat(h," ").concat(i," ").concat(n(e,"type"))}return l+=". Received type ".concat(typeof r),l}),TypeError),i("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF"),i("ERR_METHOD_NOT_IMPLEMENTED",(function(t){return"The "+t+" method is not implemented"})),i("ERR_STREAM_PREMATURE_CLOSE","Premature close"),i("ERR_STREAM_DESTROYED",(function(t){return"Cannot call "+t+" after a stream was destroyed"})),i("ERR_MULTIPLE_CALLBACK","Callback called multiple times"),i("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable"),i("ERR_STREAM_WRITE_AFTER_END","write after end"),i("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),i("ERR_UNKNOWN_ENCODING",(function(t){return"Unknown encoding: "+t}),TypeError),i("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event"),t.exports.F=r},25382:function(t,e,r){"use strict";var i=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};t.exports=h;var n=r(45412),s=r(16708);r(56698)(h,n);for(var o=i(s.prototype),a=0;a<o.length;a++){var l=o[a];h.prototype[l]||(h.prototype[l]=s.prototype[l])}function h(t){if(!(this instanceof h))return new h(t);n.call(this,t),s.call(this,t),this.allowHalfOpen=!0,t&&(!1===t.readable&&(this.readable=!1),!1===t.writable&&(this.writable=!1),!1===t.allowHalfOpen&&(this.allowHalfOpen=!1,this.once("end",u)))}function u(){this._writableState.ended||process.nextTick(c,this)}function c(t){t.end()}Object.defineProperty(h.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),Object.defineProperty(h.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(h.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(h.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(t){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}})},63600:function(t,e,r){"use strict";t.exports=n;var i=r(74610);function n(t){if(!(this instanceof n))return new n(t);i.call(this,t)}r(56698)(n,i),n.prototype._transform=function(t,e,r){r(null,t)}},45412:function(t,e,r){"use strict";var i;t.exports=C,C.ReadableState=A;r(37007).EventEmitter;var n=function(t,e){return t.listeners(e).length},s=r(40345),o=r(48287).Buffer,a=("undefined"!==typeof r.g?r.g:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};function l(t){return o.from(t)}function h(t){return o.isBuffer(t)||t instanceof a}var u,c=r(79838);u=c&&c.debuglog?c.debuglog("stream"):function(){};var f,d,p,m=r(80345),g=r(75896),w=r(65291),b=w.getHighWaterMark,y=r(86048).F,v=y.ERR_INVALID_ARG_TYPE,x=y.ERR_STREAM_PUSH_AFTER_EOF,k=y.ERR_METHOD_NOT_IMPLEMENTED,_=y.ERR_STREAM_UNSHIFT_AFTER_END_EVENT;r(56698)(C,s);var M=g.errorOrDestroy,E=["error","close","destroy","pause","resume"];function S(t,e,r){if("function"===typeof t.prependListener)return t.prependListener(e,r);t._events&&t._events[e]?Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]:t.on(e,r)}function A(t,e,n){i=i||r(25382),t=t||{},"boolean"!==typeof n&&(n=e instanceof i),this.objectMode=!!t.objectMode,n&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=b(this,t,"readableHighWaterMark",n),this.buffer=new m,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(f||(f=r(83141).I),this.decoder=new f(t.encoding),this.encoding=t.encoding)}function C(t){if(i=i||r(25382),!(this instanceof C))return new C(t);var e=this instanceof i;this._readableState=new A(t,this,e),this.readable=!0,t&&("function"===typeof t.read&&(this._read=t.read),"function"===typeof t.destroy&&(this._destroy=t.destroy)),s.call(this)}function L(t,e,r,i,n){u("readableAddChunk",e);var s,a=t._readableState;if(null===e)a.reading=!1,F(t,a);else if(n||(s=D(a,e)),s)M(t,s);else if(a.objectMode||e&&e.length>0)if("string"===typeof e||a.objectMode||Object.getPrototypeOf(e)===o.prototype||(e=l(e)),i)a.endEmitted?M(t,new _):I(t,a,e,!0);else if(a.ended)M(t,new x);else{if(a.destroyed)return!1;a.reading=!1,a.decoder&&!r?(e=a.decoder.write(e),a.objectMode||0!==e.length?I(t,a,e,!1):O(t,a)):I(t,a,e,!1)}else i||(a.reading=!1,O(t,a));return!a.ended&&(a.length<a.highWaterMark||0===a.length)}function I(t,e,r,i){e.flowing&&0===e.length&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,i?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&B(t)),O(t,e)}function D(t,e){var r;return h(e)||"string"===typeof e||void 0===e||t.objectMode||(r=new v("chunk",["string","Buffer","Uint8Array"],e)),r}Object.defineProperty(C.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}}),C.prototype.destroy=g.destroy,C.prototype._undestroy=g.undestroy,C.prototype._destroy=function(t,e){e(t)},C.prototype.push=function(t,e){var r,i=this._readableState;return i.objectMode?r=!0:"string"===typeof t&&(e=e||i.defaultEncoding,e!==i.encoding&&(t=o.from(t,e),e=""),r=!0),L(this,t,e,!1,r)},C.prototype.unshift=function(t){return L(this,t,null,!0,!1)},C.prototype.isPaused=function(){return!1===this._readableState.flowing},C.prototype.setEncoding=function(t){f||(f=r(83141).I);var e=new f(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;var i=this._readableState.buffer.head,n="";while(null!==i)n+=e.write(i.data),i=i.next;return this._readableState.buffer.clear(),""!==n&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var R=1073741824;function P(t){return t>=R?t=R:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function T(t,e){return t<=0||0===e.length&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=P(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}function F(t,e){if(u("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?B(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,U(t)))}}function B(t){var e=t._readableState;u("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(u("emitReadable",e.flowing),e.emittedReadable=!0,process.nextTick(U,t))}function U(t){var e=t._readableState;u("emitReadable_",e.destroyed,e.length,e.ended),e.destroyed||!e.length&&!e.ended||(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,Y(t)}function O(t,e){e.readingMore||(e.readingMore=!0,process.nextTick(N,t,e))}function N(t,e){while(!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&0===e.length)){var r=e.length;if(u("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}function z(t){return function(){var e=t._readableState;u("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,0===e.awaitDrain&&n(t,"data")&&(e.flowing=!0,Y(t))}}function j(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function X(t){u("readable nexttick read 0"),t.read(0)}function $(t,e){e.resumeScheduled||(e.resumeScheduled=!0,process.nextTick(V,t,e))}function V(t,e){u("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),Y(t),e.flowing&&!e.reading&&t.read(0)}function Y(t){var e=t._readableState;u("flow",e.flowing);while(e.flowing&&null!==t.read());}function q(t,e){return 0===e.length?null:(e.objectMode?r=e.buffer.shift():!t||t>=e.length?(r=e.decoder?e.buffer.join(""):1===e.buffer.length?e.buffer.first():e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r);var r}function G(t){var e=t._readableState;u("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,process.nextTick(H,e,t))}function H(t,e){if(u("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&0===t.length&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}function W(t,e){for(var r=0,i=t.length;r<i;r++)if(t[r]===e)return r;return-1}C.prototype.read=function(t){u("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(0!==t&&(e.emittedReadable=!1),0===t&&e.needReadable&&((0!==e.highWaterMark?e.length>=e.highWaterMark:e.length>0)||e.ended))return u("read: emitReadable",e.length,e.ended),0===e.length&&e.ended?G(this):B(this),null;if(t=T(t,e),0===t&&e.ended)return 0===e.length&&G(this),null;var i,n=e.needReadable;return u("need readable",n),(0===e.length||e.length-t<e.highWaterMark)&&(n=!0,u("length less than watermark",n)),e.ended||e.reading?(n=!1,u("reading or ended",n)):n&&(u("do read"),e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=T(r,e))),i=t>0?q(t,e):null,null===i?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),0===e.length&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&G(this)),null!==i&&this.emit("data",i),i},C.prototype._read=function(t){M(this,new k("_read()"))},C.prototype.pipe=function(t,e){var r=this,i=this._readableState;switch(i.pipesCount){case 0:i.pipes=t;break;case 1:i.pipes=[i.pipes,t];break;default:i.pipes.push(t);break}i.pipesCount+=1,u("pipe count=%d opts=%j",i.pipesCount,e);var s=(!e||!1!==e.end)&&t!==process.stdout&&t!==process.stderr,o=s?l:w;function a(t,e){u("onunpipe"),t===r&&e&&!1===e.hasUnpiped&&(e.hasUnpiped=!0,f())}function l(){u("onend"),t.end()}i.endEmitted?process.nextTick(o):r.once("end",o),t.on("unpipe",a);var h=z(r);t.on("drain",h);var c=!1;function f(){u("cleanup"),t.removeListener("close",m),t.removeListener("finish",g),t.removeListener("drain",h),t.removeListener("error",p),t.removeListener("unpipe",a),r.removeListener("end",l),r.removeListener("end",w),r.removeListener("data",d),c=!0,!i.awaitDrain||t._writableState&&!t._writableState.needDrain||h()}function d(e){u("ondata");var n=t.write(e);u("dest.write",n),!1===n&&((1===i.pipesCount&&i.pipes===t||i.pipesCount>1&&-1!==W(i.pipes,t))&&!c&&(u("false write response, pause",i.awaitDrain),i.awaitDrain++),r.pause())}function p(e){u("onerror",e),w(),t.removeListener("error",p),0===n(t,"error")&&M(t,e)}function m(){t.removeListener("finish",g),w()}function g(){u("onfinish"),t.removeListener("close",m),w()}function w(){u("unpipe"),r.unpipe(t)}return r.on("data",d),S(t,"error",p),t.once("close",m),t.once("finish",g),t.emit("pipe",r),i.flowing||(u("pipe resume"),r.resume()),t},C.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes||(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r)),this;if(!t){var i=e.pipes,n=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var s=0;s<n;s++)i[s].emit("unpipe",this,{hasUnpiped:!1});return this}var o=W(e.pipes,t);return-1===o||(e.pipes.splice(o,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r)),this},C.prototype.on=function(t,e){var r=s.prototype.on.call(this,t,e),i=this._readableState;return"data"===t?(i.readableListening=this.listenerCount("readable")>0,!1!==i.flowing&&this.resume()):"readable"===t&&(i.endEmitted||i.readableListening||(i.readableListening=i.needReadable=!0,i.flowing=!1,i.emittedReadable=!1,u("on readable",i.length,i.reading),i.length?B(this):i.reading||process.nextTick(X,this))),r},C.prototype.addListener=C.prototype.on,C.prototype.removeListener=function(t,e){var r=s.prototype.removeListener.call(this,t,e);return"readable"===t&&process.nextTick(j,this),r},C.prototype.removeAllListeners=function(t){var e=s.prototype.removeAllListeners.apply(this,arguments);return"readable"!==t&&void 0!==t||process.nextTick(j,this),e},C.prototype.resume=function(){var t=this._readableState;return t.flowing||(u("resume"),t.flowing=!t.readableListening,$(this,t)),t.paused=!1,this},C.prototype.pause=function(){return u("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(u("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this},C.prototype.wrap=function(t){var e=this,r=this._readableState,i=!1;for(var n in t.on("end",(function(){if(u("wrapped end"),r.decoder&&!r.ended){var t=r.decoder.end();t&&t.length&&e.push(t)}e.push(null)})),t.on("data",(function(n){if(u("wrapped data"),r.decoder&&(n=r.decoder.write(n)),(!r.objectMode||null!==n&&void 0!==n)&&(r.objectMode||n&&n.length)){var s=e.push(n);s||(i=!0,t.pause())}})),t)void 0===this[n]&&"function"===typeof t[n]&&(this[n]=function(e){return function(){return t[e].apply(t,arguments)}}(n));for(var s=0;s<E.length;s++)t.on(E[s],this.emit.bind(this,E[s]));return this._read=function(e){u("wrapped _read",e),i&&(i=!1,t.resume())},this},"function"===typeof Symbol&&(C.prototype[Symbol.asyncIterator]=function(){return void 0===d&&(d=r(2955)),d(this)}),Object.defineProperty(C.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}}),Object.defineProperty(C.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}}),Object.defineProperty(C.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}}),C._fromList=q,Object.defineProperty(C.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}}),"function"===typeof Symbol&&(C.from=function(t,e){return void 0===p&&(p=r(55157)),p(C,t,e)})},74610:function(t,e,r){"use strict";t.exports=u;var i=r(86048).F,n=i.ERR_METHOD_NOT_IMPLEMENTED,s=i.ERR_MULTIPLE_CALLBACK,o=i.ERR_TRANSFORM_ALREADY_TRANSFORMING,a=i.ERR_TRANSFORM_WITH_LENGTH_0,l=r(25382);function h(t,e){var r=this._transformState;r.transforming=!1;var i=r.writecb;if(null===i)return this.emit("error",new s);r.writechunk=null,r.writecb=null,null!=e&&this.push(e),i(t);var n=this._readableState;n.reading=!1,(n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}function u(t){if(!(this instanceof u))return new u(t);l.call(this,t),this._transformState={afterTransform:h.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&("function"===typeof t.transform&&(this._transform=t.transform),"function"===typeof t.flush&&(this._flush=t.flush)),this.on("prefinish",c)}function c(){var t=this;"function"!==typeof this._flush||this._readableState.destroyed?f(this,null,null):this._flush((function(e,r){f(t,e,r)}))}function f(t,e,r){if(e)return t.emit("error",e);if(null!=r&&t.push(r),t._writableState.length)throw new a;if(t._transformState.transforming)throw new o;return t.push(null)}r(56698)(u,l),u.prototype.push=function(t,e){return this._transformState.needTransform=!1,l.prototype.push.call(this,t,e)},u.prototype._transform=function(t,e,r){r(new n("_transform()"))},u.prototype._write=function(t,e,r){var i=this._transformState;if(i.writecb=r,i.writechunk=t,i.writeencoding=e,!i.transforming){var n=this._readableState;(i.needTransform||n.needReadable||n.length<n.highWaterMark)&&this._read(n.highWaterMark)}},u.prototype._read=function(t){var e=this._transformState;null===e.writechunk||e.transforming?e.needTransform=!0:(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform))},u.prototype._destroy=function(t,e){l.prototype._destroy.call(this,t,(function(t){e(t)}))}},16708:function(t,e,r){"use strict";function i(t){var e=this;this.next=null,this.entry=null,this.finish=function(){V(e,t)}}var n;t.exports=A,A.WritableState=S;var s={deprecate:r(94643)},o=r(40345),a=r(48287).Buffer,l=("undefined"!==typeof r.g?r.g:"undefined"!==typeof window?window:"undefined"!==typeof self?self:{}).Uint8Array||function(){};function h(t){return a.from(t)}function u(t){return a.isBuffer(t)||t instanceof l}var c,f=r(75896),d=r(65291),p=d.getHighWaterMark,m=r(86048).F,g=m.ERR_INVALID_ARG_TYPE,w=m.ERR_METHOD_NOT_IMPLEMENTED,b=m.ERR_MULTIPLE_CALLBACK,y=m.ERR_STREAM_CANNOT_PIPE,v=m.ERR_STREAM_DESTROYED,x=m.ERR_STREAM_NULL_VALUES,k=m.ERR_STREAM_WRITE_AFTER_END,_=m.ERR_UNKNOWN_ENCODING,M=f.errorOrDestroy;function E(){}function S(t,e,s){n=n||r(25382),t=t||{},"boolean"!==typeof s&&(s=e instanceof n),this.objectMode=!!t.objectMode,s&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=p(this,t,"writableHighWaterMark",s),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var o=!1===t.decodeStrings;this.decodeStrings=!o,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){F(e,t)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!1!==t.emitClose,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new i(this)}function A(t){n=n||r(25382);var e=this instanceof n;if(!e&&!c.call(A,this))return new A(t);this._writableState=new S(t,this,e),this.writable=!0,t&&("function"===typeof t.write&&(this._write=t.write),"function"===typeof t.writev&&(this._writev=t.writev),"function"===typeof t.destroy&&(this._destroy=t.destroy),"function"===typeof t.final&&(this._final=t.final)),o.call(this)}function C(t,e){var r=new k;M(t,r),process.nextTick(e,r)}function L(t,e,r,i){var n;return null===r?n=new x:"string"===typeof r||e.objectMode||(n=new g("chunk",["string","Buffer"],r)),!n||(M(t,n),process.nextTick(i,n),!1)}function I(t,e,r){return t.objectMode||!1===t.decodeStrings||"string"!==typeof e||(e=a.from(e,r)),e}function D(t,e,r,i,n,s){if(!r){var o=I(e,i,n);i!==o&&(r=!0,n="buffer",i=o)}var a=e.objectMode?1:i.length;e.length+=a;var l=e.length<e.highWaterMark;if(l||(e.needDrain=!0),e.writing||e.corked){var h=e.lastBufferedRequest;e.lastBufferedRequest={chunk:i,encoding:n,isBuf:r,callback:s,next:null},h?h.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else R(t,e,!1,a,i,n,s);return l}function R(t,e,r,i,n,s,o){e.writelen=i,e.writecb=o,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new v("write")):r?t._writev(n,e.onwrite):t._write(n,s,e.onwrite),e.sync=!1}function P(t,e,r,i,n){--e.pendingcb,r?(process.nextTick(n,i),process.nextTick(X,t,e),t._writableState.errorEmitted=!0,M(t,i)):(n(i),t._writableState.errorEmitted=!0,M(t,i),X(t,e))}function T(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function F(t,e){var r=t._writableState,i=r.sync,n=r.writecb;if("function"!==typeof n)throw new b;if(T(r),e)P(t,r,i,e,n);else{var s=N(r)||t.destroyed;s||r.corked||r.bufferProcessing||!r.bufferedRequest||O(t,r),i?process.nextTick(B,t,r,s,n):B(t,r,s,n)}}function B(t,e,r,i){r||U(t,e),e.pendingcb--,i(),X(t,e)}function U(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function O(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,s=new Array(n),o=e.corkedRequestsFree;o.entry=r;var a=0,l=!0;while(r)s[a]=r,r.isBuf||(l=!1),r=r.next,a+=1;s.allBuffers=l,R(t,e,!0,e.length,s,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new i(e),e.bufferedRequestCount=0}else{while(r){var h=r.chunk,u=r.encoding,c=r.callback,f=e.objectMode?1:h.length;if(R(t,e,!1,f,h,u,c),r=r.next,e.bufferedRequestCount--,e.writing)break}null===r&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}function N(t){return t.ending&&0===t.length&&null===t.bufferedRequest&&!t.finished&&!t.writing}function z(t,e){t._final((function(r){e.pendingcb--,r&&M(t,r),e.prefinished=!0,t.emit("prefinish"),X(t,e)}))}function j(t,e){e.prefinished||e.finalCalled||("function"!==typeof t._final||e.destroyed?(e.prefinished=!0,t.emit("prefinish")):(e.pendingcb++,e.finalCalled=!0,process.nextTick(z,t,e)))}function X(t,e){var r=N(e);if(r&&(j(t,e),0===e.pendingcb&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var i=t._readableState;(!i||i.autoDestroy&&i.endEmitted)&&t.destroy()}return r}function $(t,e,r){e.ending=!0,X(t,e),r&&(e.finished?process.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function V(t,e,r){var i=t.entry;t.entry=null;while(i){var n=i.callback;e.pendingcb--,n(r),i=i.next}e.corkedRequestsFree.next=t}r(56698)(A,o),S.prototype.getBuffer=function(){var t=this.bufferedRequest,e=[];while(t)e.push(t),t=t.next;return e},function(){try{Object.defineProperty(S.prototype,"buffer",{get:s.deprecate((function(){return this.getBuffer()}),"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(t){}}(),"function"===typeof Symbol&&Symbol.hasInstance&&"function"===typeof Function.prototype[Symbol.hasInstance]?(c=Function.prototype[Symbol.hasInstance],Object.defineProperty(A,Symbol.hasInstance,{value:function(t){return!!c.call(this,t)||this===A&&(t&&t._writableState instanceof S)}})):c=function(t){return t instanceof this},A.prototype.pipe=function(){M(this,new y)},A.prototype.write=function(t,e,r){var i=this._writableState,n=!1,s=!i.objectMode&&u(t);return s&&!a.isBuffer(t)&&(t=h(t)),"function"===typeof e&&(r=e,e=null),s?e="buffer":e||(e=i.defaultEncoding),"function"!==typeof r&&(r=E),i.ending?C(this,r):(s||L(this,i,t,r))&&(i.pendingcb++,n=D(this,i,s,t,e,r)),n},A.prototype.cork=function(){this._writableState.corked++},A.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,t.writing||t.corked||t.bufferProcessing||!t.bufferedRequest||O(this,t))},A.prototype.setDefaultEncoding=function(t){if("string"===typeof t&&(t=t.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((t+"").toLowerCase())>-1))throw new _(t);return this._writableState.defaultEncoding=t,this},Object.defineProperty(A.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}}),Object.defineProperty(A.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}}),A.prototype._write=function(t,e,r){r(new w("_write()"))},A.prototype._writev=null,A.prototype.end=function(t,e,r){var i=this._writableState;return"function"===typeof t?(r=t,t=null,e=null):"function"===typeof e&&(r=e,e=null),null!==t&&void 0!==t&&this.write(t,e),i.corked&&(i.corked=1,this.uncork()),i.ending||$(this,i,r),this},Object.defineProperty(A.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}}),Object.defineProperty(A.prototype,"destroyed",{enumerable:!1,get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}}),A.prototype.destroy=f.destroy,A.prototype._undestroy=f.undestroy,A.prototype._destroy=function(t,e){e(t)}},2955:function(t,e,r){"use strict";var i;function n(t,e,r){return e=s(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t){var e=o(t,"string");return"symbol"===typeof e?e:String(e)}function o(t,e){if("object"!==typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var a=r(86238),l=Symbol("lastResolve"),h=Symbol("lastReject"),u=Symbol("error"),c=Symbol("ended"),f=Symbol("lastPromise"),d=Symbol("handlePromise"),p=Symbol("stream");function m(t,e){return{value:t,done:e}}function g(t){var e=t[l];if(null!==e){var r=t[p].read();null!==r&&(t[f]=null,t[l]=null,t[h]=null,e(m(r,!1)))}}function w(t){process.nextTick(g,t)}function b(t,e){return function(r,i){t.then((function(){e[c]?r(m(void 0,!0)):e[d](r,i)}),i)}}var y=Object.getPrototypeOf((function(){})),v=Object.setPrototypeOf((i={get stream(){return this[p]},next:function(){var t=this,e=this[u];if(null!==e)return Promise.reject(e);if(this[c])return Promise.resolve(m(void 0,!0));if(this[p].destroyed)return new Promise((function(e,r){process.nextTick((function(){t[u]?r(t[u]):e(m(void 0,!0))}))}));var r,i=this[f];if(i)r=new Promise(b(i,this));else{var n=this[p].read();if(null!==n)return Promise.resolve(m(n,!1));r=new Promise(this[d])}return this[f]=r,r}},n(i,Symbol.asyncIterator,(function(){return this})),n(i,"return",(function(){var t=this;return new Promise((function(e,r){t[p].destroy(null,(function(t){t?r(t):e(m(void 0,!0))}))}))})),i),y),x=function(t){var e,r=Object.create(v,(e={},n(e,p,{value:t,writable:!0}),n(e,l,{value:null,writable:!0}),n(e,h,{value:null,writable:!0}),n(e,u,{value:null,writable:!0}),n(e,c,{value:t._readableState.endEmitted,writable:!0}),n(e,d,{value:function(t,e){var i=r[p].read();i?(r[f]=null,r[l]=null,r[h]=null,t(m(i,!1))):(r[l]=t,r[h]=e)},writable:!0}),e));return r[f]=null,a(t,(function(t){if(t&&"ERR_STREAM_PREMATURE_CLOSE"!==t.code){var e=r[h];return null!==e&&(r[f]=null,r[l]=null,r[h]=null,e(t)),void(r[u]=t)}var i=r[l];null!==i&&(r[f]=null,r[l]=null,r[h]=null,i(m(void 0,!0))),r[c]=!0})),t.on("readable",w.bind(null,r)),r};t.exports=x},80345:function(t,e,r){"use strict";function i(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,i)}return r}function n(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?i(Object(r),!0).forEach((function(e){s(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function s(t,e,r){return e=h(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,h(i.key),i)}}function l(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t){var e=u(t,"string");return"symbol"===typeof e?e:String(e)}function u(t,e){if("object"!==typeof t||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,e||"default");if("object"!==typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var c=r(48287),f=c.Buffer,d=r(15340),p=d.inspect,m=p&&p.custom||"inspect";function g(t,e,r){f.prototype.copy.call(t,e,r)}t.exports=function(){function t(){o(this,t),this.head=null,this.tail=null,this.length=0}return l(t,[{key:"push",value:function(t){var e={data:t,next:null};this.length>0?this.tail.next=e:this.head=e,this.tail=e,++this.length}},{key:"unshift",value:function(t){var e={data:t,next:this.head};0===this.length&&(this.tail=e),this.head=e,++this.length}},{key:"shift",value:function(){if(0!==this.length){var t=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,t}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(t){if(0===this.length)return"";var e=this.head,r=""+e.data;while(e=e.next)r+=t+e.data;return r}},{key:"concat",value:function(t){if(0===this.length)return f.alloc(0);var e=f.allocUnsafe(t>>>0),r=this.head,i=0;while(r)g(r.data,e,i),i+=r.data.length,r=r.next;return e}},{key:"consume",value:function(t,e){var r;return t<this.head.data.length?(r=this.head.data.slice(0,t),this.head.data=this.head.data.slice(t)):r=t===this.head.data.length?this.shift():e?this._getString(t):this._getBuffer(t),r}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(t){var e=this.head,r=1,i=e.data;t-=i.length;while(e=e.next){var n=e.data,s=t>n.length?n.length:t;if(s===n.length?i+=n:i+=n.slice(0,t),t-=s,0===t){s===n.length?(++r,e.next?this.head=e.next:this.head=this.tail=null):(this.head=e,e.data=n.slice(s));break}++r}return this.length-=r,i}},{key:"_getBuffer",value:function(t){var e=f.allocUnsafe(t),r=this.head,i=1;r.data.copy(e),t-=r.data.length;while(r=r.next){var n=r.data,s=t>n.length?n.length:t;if(n.copy(e,e.length-t,0,s),t-=s,0===t){s===n.length?(++i,r.next?this.head=r.next:this.head=this.tail=null):(this.head=r,r.data=n.slice(s));break}++i}return this.length-=i,e}},{key:m,value:function(t,e){return p(this,n(n({},e),{},{depth:0,customInspect:!1}))}}]),t}()},75896:function(t){"use strict";function e(t,e){var n=this,o=this._readableState&&this._readableState.destroyed,a=this._writableState&&this._writableState.destroyed;return o||a?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,process.nextTick(s,this,t)):process.nextTick(s,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,(function(t){!e&&t?n._writableState?n._writableState.errorEmitted?process.nextTick(i,n):(n._writableState.errorEmitted=!0,process.nextTick(r,n,t)):process.nextTick(r,n,t):e?(process.nextTick(i,n),e(t)):process.nextTick(i,n)})),this)}function r(t,e){s(t,e),i(t)}function i(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function n(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function s(t,e){t.emit("error",e)}function o(t,e){var r=t._readableState,i=t._writableState;r&&r.autoDestroy||i&&i.autoDestroy?t.destroy(e):t.emit("error",e)}t.exports={destroy:e,undestroy:n,errorOrDestroy:o}},86238:function(t,e,r){"use strict";var i=r(86048).F.ERR_STREAM_PREMATURE_CLOSE;function n(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,i=new Array(r),n=0;n<r;n++)i[n]=arguments[n];t.apply(this,i)}}}function s(){}function o(t){return t.setHeader&&"function"===typeof t.abort}function a(t,e,r){if("function"===typeof e)return a(t,null,e);e||(e={}),r=n(r||s);var l=e.readable||!1!==e.readable&&t.readable,h=e.writable||!1!==e.writable&&t.writable,u=function(){t.writable||f()},c=t._writableState&&t._writableState.finished,f=function(){h=!1,c=!0,l||r.call(t)},d=t._readableState&&t._readableState.endEmitted,p=function(){l=!1,d=!0,h||r.call(t)},m=function(e){r.call(t,e)},g=function(){var e;return l&&!d?(t._readableState&&t._readableState.ended||(e=new i),r.call(t,e)):h&&!c?(t._writableState&&t._writableState.ended||(e=new i),r.call(t,e)):void 0},w=function(){t.req.on("finish",f)};return o(t)?(t.on("complete",f),t.on("abort",g),t.req?w():t.on("request",w)):h&&!t._writableState&&(t.on("end",u),t.on("close",u)),t.on("end",p),t.on("finish",f),!1!==e.error&&t.on("error",m),t.on("close",g),function(){t.removeListener("complete",f),t.removeListener("abort",g),t.removeListener("request",w),t.req&&t.req.removeListener("finish",f),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",f),t.removeListener("end",p),t.removeListener("error",m),t.removeListener("close",g)}}t.exports=a},55157:function(t){t.exports=function(){throw new Error("Readable.from is not available in the browser")}},57758:function(t,e,r){"use strict";var i;function n(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var s=r(86048).F,o=s.ERR_MISSING_ARGS,a=s.ERR_STREAM_DESTROYED;function l(t){if(t)throw t}function h(t){return t.setHeader&&"function"===typeof t.abort}function u(t,e,s,o){o=n(o);var l=!1;t.on("close",(function(){l=!0})),void 0===i&&(i=r(86238)),i(t,{readable:e,writable:s},(function(t){if(t)return o(t);l=!0,o()}));var u=!1;return function(e){if(!l&&!u)return u=!0,h(t)?t.abort():"function"===typeof t.destroy?t.destroy():void o(e||new a("pipe"))}}function c(t){t()}function f(t,e){return t.pipe(e)}function d(t){return t.length?"function"!==typeof t[t.length-1]?l:t.pop():l}function p(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var i,n=d(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new o("streams");var s=e.map((function(t,r){var o=r<e.length-1,a=r>0;return u(t,o,a,(function(t){i||(i=t),t&&s.forEach(c),o||(s.forEach(c),n(i))}))}));return e.reduce(f)}t.exports=p},65291:function(t,e,r){"use strict";var i=r(86048).F.ERR_INVALID_OPT_VALUE;function n(t,e,r){return null!=t.highWaterMark?t.highWaterMark:e?t[r]:null}function s(t,e,r,s){var o=n(e,s,r);if(null!=o){if(!isFinite(o)||Math.floor(o)!==o||o<0){var a=s?r:"highWaterMark";throw new i(a,o)}return Math.floor(o)}return t.objectMode?16:16384}t.exports={getHighWaterMark:s}},40345:function(t,e,r){t.exports=r(37007).EventEmitter},21573:function(t,e,r){"use strict";var i=r(34383),n=r(75951),s=r(93297),o=r(64916),a=5,l=11102230246251565e-32,h=(3+16*l)*l,u=(7+56*l)*l;function c(t,e,r,i){return function(r,n,s){var o=t(t(e(n[1],s[0]),e(-s[1],n[0])),t(e(r[1],n[0]),e(-n[1],r[0]))),a=t(e(r[1],s[0]),e(-s[1],r[0])),l=i(o,a);return l[l.length-1]}}function f(t,e,r,i){return function(n,s,o,a){var l=t(t(r(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(r(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),r(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),t(r(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),a[2])))),h=t(t(r(t(e(o[1],a[0]),e(-a[1],o[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-o[2]),r(t(e(n[1],o[0]),e(-o[1],n[0])),a[2]))),t(r(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),o[2])))),u=i(l,h);return u[u.length-1]}}function d(t,e,r,i){return function(n,s,o,a,l){var h=t(t(t(r(t(r(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(r(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),r(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),s[3]),t(r(t(r(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(r(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),r(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),-o[3]),r(t(r(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(r(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),r(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),a[3]))),t(r(t(r(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(r(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),r(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),-l[3]),t(r(t(r(t(e(a[1],l[0]),e(-l[1],a[0])),s[2]),t(r(t(e(s[1],l[0]),e(-l[1],s[0])),-a[2]),r(t(e(s[1],a[0]),e(-a[1],s[0])),l[2]))),n[3]),r(t(r(t(e(a[1],l[0]),e(-l[1],a[0])),n[2]),t(r(t(e(n[1],l[0]),e(-l[1],n[0])),-a[2]),r(t(e(n[1],a[0]),e(-a[1],n[0])),l[2]))),-s[3])))),t(t(r(t(r(t(e(s[1],l[0]),e(-l[1],s[0])),n[2]),t(r(t(e(n[1],l[0]),e(-l[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),l[2]))),a[3]),t(r(t(r(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),a[2]))),-l[3]),r(t(r(t(e(o[1],a[0]),e(-a[1],o[0])),s[2]),t(r(t(e(s[1],a[0]),e(-a[1],s[0])),-o[2]),r(t(e(s[1],o[0]),e(-o[1],s[0])),a[2]))),n[3]))),t(r(t(r(t(e(o[1],a[0]),e(-a[1],o[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-o[2]),r(t(e(n[1],o[0]),e(-o[1],n[0])),a[2]))),-s[3]),t(r(t(r(t(e(s[1],a[0]),e(-a[1],s[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),a[2]))),o[3]),r(t(r(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),o[2]))),-a[3]))))),u=t(t(t(r(t(r(t(e(a[1],l[0]),e(-l[1],a[0])),o[2]),t(r(t(e(o[1],l[0]),e(-l[1],o[0])),-a[2]),r(t(e(o[1],a[0]),e(-a[1],o[0])),l[2]))),n[3]),r(t(r(t(e(a[1],l[0]),e(-l[1],a[0])),n[2]),t(r(t(e(n[1],l[0]),e(-l[1],n[0])),-a[2]),r(t(e(n[1],a[0]),e(-a[1],n[0])),l[2]))),-o[3])),t(r(t(r(t(e(o[1],l[0]),e(-l[1],o[0])),n[2]),t(r(t(e(n[1],l[0]),e(-l[1],n[0])),-o[2]),r(t(e(n[1],o[0]),e(-o[1],n[0])),l[2]))),a[3]),r(t(r(t(e(o[1],a[0]),e(-a[1],o[0])),n[2]),t(r(t(e(n[1],a[0]),e(-a[1],n[0])),-o[2]),r(t(e(n[1],o[0]),e(-o[1],n[0])),a[2]))),-l[3]))),t(t(r(t(r(t(e(o[1],l[0]),e(-l[1],o[0])),s[2]),t(r(t(e(s[1],l[0]),e(-l[1],s[0])),-o[2]),r(t(e(s[1],o[0]),e(-o[1],s[0])),l[2]))),n[3]),r(t(r(t(e(o[1],l[0]),e(-l[1],o[0])),n[2]),t(r(t(e(n[1],l[0]),e(-l[1],n[0])),-o[2]),r(t(e(n[1],o[0]),e(-o[1],n[0])),l[2]))),-s[3])),t(r(t(r(t(e(s[1],l[0]),e(-l[1],s[0])),n[2]),t(r(t(e(n[1],l[0]),e(-l[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),l[2]))),o[3]),r(t(r(t(e(s[1],o[0]),e(-o[1],s[0])),n[2]),t(r(t(e(n[1],o[0]),e(-o[1],n[0])),-s[2]),r(t(e(n[1],s[0]),e(-s[1],n[0])),o[2]))),-l[3])))),c=i(h,u);return c[c.length-1]}}function p(t){var e=3===t?c:4===t?f:d;return e(n,i,s,o)}var m=p(3),g=p(4),w=[function(){return 0},function(){return 0},function(t,e){return e[0]-t[0]},function(t,e,r){var i,n=(t[1]-r[1])*(e[0]-r[0]),s=(t[0]-r[0])*(e[1]-r[1]),o=n-s;if(n>0){if(s<=0)return o;i=n+s}else{if(!(n<0))return o;if(s>=0)return o;i=-(n+s)}var a=h*i;return o>=a||o<=-a?o:m(t,e,r)},function(t,e,r,i){var n=t[0]-i[0],s=e[0]-i[0],o=r[0]-i[0],a=t[1]-i[1],l=e[1]-i[1],h=r[1]-i[1],c=t[2]-i[2],f=e[2]-i[2],d=r[2]-i[2],p=s*h,m=o*l,w=o*a,b=n*h,y=n*l,v=s*a,x=c*(p-m)+f*(w-b)+d*(y-v),k=(Math.abs(p)+Math.abs(m))*Math.abs(c)+(Math.abs(w)+Math.abs(b))*Math.abs(f)+(Math.abs(y)+Math.abs(v))*Math.abs(d),_=u*k;return x>_||-x>_?x:g(t,e,r,i)}];function b(t){var e=w[t.length];return e||(e=w[t.length]=p(t.length)),e.apply(void 0,t)}function y(t,e,r,i,n,s,o){return function(e,r,a,l,h){switch(arguments.length){case 0:case 1:return 0;case 2:return i(e,r);case 3:return n(e,r,a);case 4:return s(e,r,a,l);case 5:return o(e,r,a,l,h)}for(var u=new Array(arguments.length),c=0;c<arguments.length;++c)u[c]=arguments[c];return t(u)}}function v(){while(w.length<=a)w.push(p(w.length));t.exports=y.apply(void 0,[b].concat(w));for(var e=0;e<=a;++e)t.exports[e]=w[e]}v()},3778:function(t,e,r){t.exports=n;var i=r(21573);function n(t,e){for(var r=e[0],n=e[1],s=t.length,o=1,a=s,l=0,h=s-1;l<a;h=l++){var u=t[l],c=t[h],f=u[1],d=c[1];if(d<f){if(d<n&&n<f){var p=i(u,c,e);if(0===p)return 0;o^=0<p|0}else if(n===f){var m=t[(l+1)%s],g=m[1];if(f<g){p=i(u,c,e);if(0===p)return 0;o^=0<p|0}}}else if(f<d){if(f<n&&n<d){p=i(u,c,e);if(0===p)return 0;o^=p<0|0}else if(n===f){m=t[(l+1)%s],g=m[1];if(g<f){p=i(u,c,e);if(0===p)return 0;o^=p<0|0}}}else if(n===f){var w=Math.min(u[0],c[0]),b=Math.max(u[0],c[0]);if(0===l){while(h>0){var y=(h+s-1)%s,v=t[y];if(v[1]!==n)break;var x=v[0];w=Math.min(w,x),b=Math.max(b,x),h=y}if(0===h)return w<=r&&r<=b?0:1;a=h+1}var k=t[(h+s-1)%s][1];while(l+1<a){v=t[l+1];if(v[1]!==n)break;x=v[0];w=Math.min(w,x),b=Math.max(b,x),l+=1}if(w<=r&&r<=b)return 0;var _=t[(l+1)%s][1];r<w&&k<n!==_<n&&(o^=1)}}return 2*o-1}},93297:function(t,e,r){"use strict";var i=r(34383),n=r(81519);function s(t,e){var r=t.length;if(1===r){var s=i(t[0],e);return s[0]?s:[s[1]]}var o=new Array(2*r),a=[.1,.1],l=[.1,.1],h=0;i(t[0],e,a),a[0]&&(o[h++]=a[0]);for(var u=1;u<r;++u){i(t[u],e,l);var c=a[1];n(c,l[0],a),a[0]&&(o[h++]=a[0]);var f=l[1],d=a[1],p=f+d,m=p-f,g=d-m;a[1]=p,g&&(o[h++]=g)}return a[1]&&(o[h++]=a[1]),0===h&&(o[h++]=0),o.length=h,o}t.exports=s},64916:function(t){"use strict";function e(t,e){var r=t+e,i=r-t,n=r-i,s=e-i,o=t-n,a=o+s;return a?[a,r]:[r]}function r(t,r){var i=0|t.length,n=0|r.length;if(1===i&&1===n)return e(t[0],-r[0]);var s,o,a=i+n,l=new Array(a),h=0,u=0,c=0,f=Math.abs,d=t[u],p=f(d),m=-r[c],g=f(m);p<g?(o=d,u+=1,u<i&&(d=t[u],p=f(d))):(o=m,c+=1,c<n&&(m=-r[c],g=f(m))),u<i&&p<g||c>=n?(s=d,u+=1,u<i&&(d=t[u],p=f(d))):(s=m,c+=1,c<n&&(m=-r[c],g=f(m)));var w,b,y,v,x,k=s+o,_=k-s,M=o-_,E=M,S=k;while(u<i&&c<n)p<g?(s=d,u+=1,u<i&&(d=t[u],p=f(d))):(s=m,c+=1,c<n&&(m=-r[c],g=f(m))),o=E,k=s+o,_=k-s,M=o-_,M&&(l[h++]=M),w=S+k,b=w-S,y=w-b,v=k-b,x=S-y,E=x+v,S=w;while(u<i)s=d,o=E,k=s+o,_=k-s,M=o-_,M&&(l[h++]=M),w=S+k,b=w-S,y=w-b,v=k-b,x=S-y,E=x+v,S=w,u+=1,u<i&&(d=t[u]);while(c<n)s=m,o=E,k=s+o,_=k-s,M=o-_,M&&(l[h++]=M),w=S+k,b=w-S,y=w-b,v=k-b,x=S-y,E=x+v,S=w,c+=1,c<n&&(m=-r[c]);return E&&(l[h++]=E),S&&(l[h++]=S),h||(l[h++]=0),l.length=h,l}t.exports=r},75951:function(t){"use strict";function e(t,e){var r=t+e,i=r-t,n=r-i,s=e-i,o=t-n,a=o+s;return a?[a,r]:[r]}function r(t,r){var i=0|t.length,n=0|r.length;if(1===i&&1===n)return e(t[0],r[0]);var s,o,a=i+n,l=new Array(a),h=0,u=0,c=0,f=Math.abs,d=t[u],p=f(d),m=r[c],g=f(m);p<g?(o=d,u+=1,u<i&&(d=t[u],p=f(d))):(o=m,c+=1,c<n&&(m=r[c],g=f(m))),u<i&&p<g||c>=n?(s=d,u+=1,u<i&&(d=t[u],p=f(d))):(s=m,c+=1,c<n&&(m=r[c],g=f(m)));var w,b,y,v,x,k=s+o,_=k-s,M=o-_,E=M,S=k;while(u<i&&c<n)p<g?(s=d,u+=1,u<i&&(d=t[u],p=f(d))):(s=m,c+=1,c<n&&(m=r[c],g=f(m))),o=E,k=s+o,_=k-s,M=o-_,M&&(l[h++]=M),w=S+k,b=w-S,y=w-b,v=k-b,x=S-y,E=x+v,S=w;while(u<i)s=d,o=E,k=s+o,_=k-s,M=o-_,M&&(l[h++]=M),w=S+k,b=w-S,y=w-b,v=k-b,x=S-y,E=x+v,S=w,u+=1,u<i&&(d=t[u]);while(c<n)s=m,o=E,k=s+o,_=k-s,M=o-_,M&&(l[h++]=M),w=S+k,b=w-S,y=w-b,v=k-b,x=S-y,E=x+v,S=w,c+=1,c<n&&(m=r[c]);return E&&(l[h++]=E),S&&(l[h++]=S),h||(l[h++]=0),l.length=h,l}t.exports=r},92861:function(t,e,r){
/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */
var i=r(48287),n=i.Buffer;function s(t,e){for(var r in t)e[r]=t[r]}function o(t,e,r){return n(t,e,r)}n.from&&n.alloc&&n.allocUnsafe&&n.allocUnsafeSlow?t.exports=i:(s(i,e),e.Buffer=o),o.prototype=Object.create(n.prototype),s(n,o),o.from=function(t,e,r){if("number"===typeof t)throw new TypeError("Argument must not be a number");return n(t,e,r)},o.alloc=function(t,e,r){if("number"!==typeof t)throw new TypeError("Argument must be a number");var i=n(t);return void 0!==e?"string"===typeof r?i.fill(e,r):i.fill(e):i.fill(0),i},o.allocUnsafe=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return n(t)},o.allocUnsafeSlow=function(t){if("number"!==typeof t)throw new TypeError("Argument must be a number");return i.SlowBuffer(t)}},83141:function(t,e,r){"use strict";var i=r(92861).Buffer,n=i.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function s(t){if(!t)return"utf8";var e;while(1)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function o(t){var e=s(t);if("string"!==typeof e&&(i.isEncoding===n||!n(t)))throw new Error("Unknown encoding: "+t);return e||t}function a(t){var e;switch(this.encoding=o(t),this.encoding){case"utf16le":this.text=p,this.end=m,e=4;break;case"utf8":this.fillLast=c,e=4;break;case"base64":this.text=g,this.end=w,e=3;break;default:return this.write=b,void(this.end=y)}this.lastNeed=0,this.lastTotal=0,this.lastChar=i.allocUnsafe(e)}function l(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function h(t,e,r){var i=e.length-1;if(i<r)return 0;var n=l(e[i]);return n>=0?(n>0&&(t.lastNeed=n-1),n):--i<r||-2===n?0:(n=l(e[i]),n>=0?(n>0&&(t.lastNeed=n-2),n):--i<r||-2===n?0:(n=l(e[i]),n>=0?(n>0&&(2===n?n=0:t.lastNeed=n-3),n):0))}function u(t,e,r){if(128!==(192&e[0]))return t.lastNeed=0,"�";if(t.lastNeed>1&&e.length>1){if(128!==(192&e[1]))return t.lastNeed=1,"�";if(t.lastNeed>2&&e.length>2&&128!==(192&e[2]))return t.lastNeed=2,"�"}}function c(t){var e=this.lastTotal-this.lastNeed,r=u(this,t,e);return void 0!==r?r:this.lastNeed<=t.length?(t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(t.copy(this.lastChar,e,0,t.length),void(this.lastNeed-=t.length))}function f(t,e){var r=h(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var i=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,i),t.toString("utf8",e,i)}function d(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"�":e}function p(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var i=r.charCodeAt(r.length-1);if(i>=55296&&i<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function m(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function g(t,e){var r=(t.length-e)%3;return 0===r?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function w(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function b(t){return t.toString(this.encoding)}function y(t){return t&&t.length?this.write(t):""}e.I=a,a.prototype.write=function(t){if(0===t.length)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),void 0===e)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""},a.prototype.end=d,a.prototype.text=f,a.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length}},34383:function(t){"use strict";t.exports=r;var e=+(Math.pow(2,27)+1);function r(t,r,i){var n=t*r,s=e*t,o=s-t,a=s-o,l=t-a,h=e*r,u=h-r,c=h-u,f=r-c,d=n-a*c,p=d-l*c,m=p-a*f,g=l*f-m;return i?(i[0]=g,i[1]=n,i):[g,n]}},81519:function(t){"use strict";function e(t,e,r){var i=t+e,n=i-t,s=i-n,o=e-n,a=t-s;return r?(r[0]=a+o,r[1]=i,r):[a+o,i]}t.exports=e},94643:function(t,e,r){function i(t,e){if(n("noDeprecation"))return t;var r=!1;function i(){if(!r){if(n("throwDeprecation"))throw new Error(e);n("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return i}function n(t){try{if(!r.g.localStorage)return!1}catch(i){return!1}var e=r.g.localStorage[t];return null!=e&&"true"===String(e).toLowerCase()}t.exports=i},94125:function(t,e,r){"use strict";var i=r(1789),n=navigator.hardwareConcurrency||1;Function.prototype;function s(t,e){if("string"!==typeof t&&"function"!==typeof t)throw new TypeError("func argument must be a function");if(void 0===e&&(e={}),"object"!==typeof e||null===e)throw new TypeError("options argument must be an object");this._workerCode=t.toString(),void 0===e.maxWorkers||"auto"===e.maxWorkers?this._numWorkers=Math.min(n-1,1):e.maxWorkers>0?this._numWorkers=Math.min(e.maxWorkers,n):this._numWorkers=n,this._workers=new Map,this._timeout=e.timeout||0,this._terminateOnError=!!e.terminateOnError;var r=e.deps;"string"===typeof r&&(r=[r]),Array.isArray(r)||(r=void 0),this._id=0,this._terminated=!1,this._working=0,this._waiting=[],this._init(r)}s.prototype._init=function(t){for(var e=i.newWorkerURL(this._workerCode,t),r=0;r<this._numWorkers;r++){var n=new Worker(e);n.onmessage=this._onmessage.bind(this,n),n.onerror=this._onerror.bind(this,n),n.running=!1,n.id=r,this._workers.set(n,null)}URL.revokeObjectURL(e)},s.prototype._onerror=function(t,e){if(!this._terminated){this._working--,t.running=!1;var r=this._workers.get(t);r&&r[1](e.message),this._workers.set(t,null),this._terminateOnError?this.terminate():this._exec()}},s.prototype._onmessage=function(t,e){if(!this._terminated){this._working--,t.running=!1;var r=this._workers.get(t);r&&r[0](e.data.data),this._workers.set(t,null),this._exec()}},s.prototype._exec=function(){for(var t of this._workers.keys()){if(this._working===this._numWorkers||0===this._waiting.length)return;if(!t.running)for(var e=0;e<this._waiting.length;e++){var r=this._waiting[e];if("number"!==typeof r[4]||r[4]===t.id){this._waiting.splice(e,1),t.postMessage({action:"exec",event:r[0],args:r[1]},r[2]),t.running=!0,t.time=Date.now(),this._workers.set(t,r[3]),this._working++;break}}}},s.prototype.terminate=function(){if(!this._terminated){for(var t of this._workers)t[0].terminate(),t[1]&&t[1][1](new Error("Terminated"));this._workers.clear(),this._waiting=[],this._working=0,this._terminated=!0}},s.prototype.postAll=function(t,e){if(this._terminated)throw new Error("Cannot post (terminated)");var r=[];for(var i of this._workers.keys())r.push(this.post(t,e,[],i.id));return Promise.all(r)},s.prototype.post=function(t,e,r,i){void 0===e&&(e=[]),void 0===r&&(r=[]),Array.isArray(e)||(e=[e]),Array.isArray(r)||(r=[r]);var n=this;return new Promise((function(s,o){if(n._terminated)throw new Error("Cannot post (terminated)");n._waiting.push([t,e,r,[s,o],i]),n._exec()}))},t.exports=s},1789:function(t,e){"use strict";var r=function(){self.window=self;function t(){this._listeners={}}t.prototype.on=function(t,e){if(this._listeners[t])throw new RangeError("there is already a listener for "+t);if("function"!==typeof e)throw new TypeError("callback argument must be a function");this._listeners[t]=e},t.prototype._send=function(t,e,r){void 0===r?r=[]:Array.isArray(r)||(r=[r]),self.postMessage({id:t,data:e},r)},t.prototype._trigger=function(t,e){if(!this._listeners[t])throw new Error("event "+t+" is not defined");this._listeners[t].apply(null,e)};var e=new t;self.onmessage=function(t){switch(t.data.action){case"exec":t.data.args.unshift((function(r,i){e._send(t.data.id,r,i)})),e._trigger(t.data.event,t.data.args);break;case"ping":e._send(t.data.id,"pong");break;default:throw new Error("unexpected action: "+t.data.action)}}},i=r.toString().split('"CODE";');e.newWorkerURL=function(t,e){var r=new Blob(["(",i[0],"importScripts.apply(self, "+JSON.stringify(e)+");\n","(",t,")();",i[1],")();"],{type:"application/javascript"});return URL.createObjectURL(r)}},15340:function(){},79838:function(){},77753:function(t){"use strict";t.exports={version:"1.0.1"}}}]);
//# sourceMappingURL=5372.f5b6ae38.js.map