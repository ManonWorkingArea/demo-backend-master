"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[6240],{56240:function(e,t,s){s.r(t),s.d(t,{default:function(){return bt}});var a=s(20641);function l(e,t,s,l,r,i){const o=(0,a.g2)("Authen"),n=(0,a.g2)("Dashboard");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.bF)(o),this.login?((0,a.uX)(),(0,a.Wv)(n,{key:0})):(0,a.Q3)("",!0)],64)}var r=s(52968),i=s(75220),o=(s(44114),s(90033)),n=s(53751);const c={class:"bg-gray-50 flex overflow-hidden enroll-container"},d={class:"hidden lg:flex lg:w-64 lg:flex-col"},g={class:"flex flex-col flex-grow bg-white border-r border-gray-200 h-full"},u={class:"flex items-center justify-between px-4 py-4 border-b border-gray-200 flex-shrink-0"},m={class:"px-4 py-4 border-b border-gray-200"},h={class:"space-y-2"},p={class:"flex items-center justify-between p-2 bg-blue-50 rounded-lg stats-card"},x={class:"text-sm font-semibold text-blue-600"},b={class:"flex items-center justify-between p-2 bg-green-50 rounded-lg stats-card"},f={class:"text-sm font-semibold text-green-600"},y={class:"flex items-center justify-between p-2 bg-yellow-50 rounded-lg stats-card"},k={class:"text-sm font-semibold text-yellow-600"},v={class:"px-4 py-4 border-b border-gray-200"},L={class:"space-y-1"},w={class:"px-2 py-1 text-xs rounded-full bg-gray-200 text-gray-600"},C={class:"px-4 py-4 border-b border-gray-200"},P={class:"space-y-2"},T={class:"flex items-center cursor-pointer"},$={class:"flex items-center cursor-pointer"},I={class:"px-4 py-4 border-b border-gray-200"},A={class:"space-y-2"},Q={class:"mt-auto px-4 py-4 flex-shrink-0"},S={class:"flex items-center gap-3 p-3 bg-gray-50 rounded-lg"},_={class:"flex-1 min-w-0"},M={class:"text-sm font-medium text-gray-900 truncate"},D={class:"flex-1 flex flex-col min-w-0 h-full"},E={class:"lg:hidden bg-white border-b border-gray-200 px-4 py-3"},j={class:"flex items-center justify-between"},N={class:"bg-white border-b border-gray-200 px-4 py-3"},X={class:"flex flex-col md:flex-row md:items-center md:justify-between gap-3"},V={class:"flex-1 max-w-md"},B={class:"relative"},F={class:"lg:hidden flex gap-2"},U={class:"flex-1 p-4 overflow-hidden"},H={class:"mb-4 flex items-center justify-between"},R={class:"flex items-center gap-2"},O={class:"px-2 py-1 bg-gray-100 text-gray-600 text-sm rounded-full"},W={key:0,class:"flex items-center gap-2"},K={class:"text-sm text-gray-500"},q={class:"font-semibold text-gray-900"},z={class:"flex items-center gap-2"},J=["value"],Y={class:"h-full overflow-y-auto"},Z={class:"bg-white rounded-lg shadow overflow-hidden"},G={key:0,class:"text-center p-8"},ee={key:1,class:"overflow-hidden"},te={class:"flex border-b border-gray-200 text-sm hover:bg-gray-50 transition-colors"},se={class:"w-16 py-3 px-4 flex items-center justify-center bg-gray-50"},ae={class:"text-gray-600 font-semibold"},le={class:"flex-1 py-3 px-4"},re={class:"flex items-center"},ie=["src"],oe=["innerHTML"],ne={class:"text-sm text-gray-500"},ce=["innerHTML"],de=["innerHTML"],ge={class:"hidden md:flex w-32 py-3 px-4 items-center"},ue=["innerHTML"],me={class:"hidden md:block w-48 py-3 px-4"},he={class:"flex items-center mb-1"},pe=["innerHTML"],xe={class:"flex items-center"},be=["innerHTML"],fe={class:"hidden md:flex w-20 py-3 px-4 items-center justify-center"},ye={class:"flex items-center"},ke={class:"font-semibold text-blue-600 mr-1"},ve={class:"hidden md:flex w-32 py-3 px-4 items-center"},Le={class:"text-sm text-gray-600"},we={class:"hidden md:flex w-32 py-3 px-4 items-center justify-center"},Ce=["onClick"],Pe={class:"md:hidden p-3 border-b border-gray-300 bg-blue-50"},Te={class:"flex justify-between items-center"},$e={class:"text-sm text-gray-600"},Ie={class:"flex items-center mb-1"},Ae=["innerHTML"],Qe={class:"flex items-center"},Se=["onClick"],_e={key:1,class:"text-center py-12"},Me={class:"mt-4 flex justify-center"},De={class:"flex flex-col h-full"},Ee={class:"flex items-center justify-between px-4 py-4 border-b border-gray-200"},je={class:"px-4 py-4 border-b border-gray-200"},Ne={class:"space-y-2"},Xe={class:"flex items-center justify-between p-2 bg-blue-50 rounded-lg"},Ve={class:"text-sm font-semibold text-blue-600"},Be={class:"px-4 py-4 border-b border-gray-200"},Fe={class:"space-y-2"},Ue={class:"flex items-center cursor-pointer"},He={class:"flex items-center cursor-pointer"},Re={key:1,class:"relative z-10","aria-labelledby":"slide-over-title",role:"dialog","aria-modal":"true"},Oe={class:"fixed inset-0 overflow-hidden"},We={class:"absolute inset-0 overflow-hidden"},Ke={class:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10"},qe={class:"pointer-events-auto w-screen max-w-md"},ze={class:"flex h-full flex-col overflow-y-scroll bg-white py-6 shadow-xl"},Je={class:"px-4 sm:px-6"},Ye={class:"flex items-start justify-between"},Ze={class:"ml-3 flex h-7 items-center"},Ge={class:"relative mt-6 flex-1 px-4 sm:px-6"},et={class:"space-y-4"},tt={key:2,class:"loading-overlay"},st={class:"loading-text"},at={class:"processing-count"};function lt(e,t,s,l,r,i){const lt=(0,a.g2)("Pagination"),rt=(0,a.g2)("Loader"),it=(0,a.g2)("router-link"),ot=(0,a.g2)("batch-progress");return(0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",d,[(0,a.Lk)("div",g,[(0,a.Lk)("div",u,[t[25]||(t[25]=(0,a.Lk)("h1",{class:"text-lg font-semibold text-gray-900"},"การลงทะเบียน",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>i.togglePanel&&i.togglePanel(...e)),class:"bg-blue-600 hover:bg-blue-700 text-white p-2 rounded-lg transition-colors duration-200",title:"เครื่องมือ"},t[24]||(t[24]=[(0,a.Lk)("i",{class:"fas fa-cogs text-sm"},null,-1)]))]),(0,a.Lk)("div",m,[t[29]||(t[29]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"สถิติรวม",-1)),(0,a.Lk)("div",h,[(0,a.Lk)("div",p,[t[26]||(t[26]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"นักเรียนทั้งหมด")],-1)),(0,a.Lk)("span",x,(0,o.v_)(r.totalItems),1)]),(0,a.Lk)("div",b,[t[27]||(t[27]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-green-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"หน้าปัจจุบัน")],-1)),(0,a.Lk)("span",f,(0,o.v_)(r.currentPage),1)]),(0,a.Lk)("div",y,[t[28]||(t[28]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-yellow-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"รายการต่อหน้า")],-1)),(0,a.Lk)("span",k,(0,o.v_)(r.limitItem),1)])])]),(0,a.Lk)("div",v,[t[32]||(t[32]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"เมนู",-1)),(0,a.Lk)("nav",L,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>i.getData&&i.getData(...e)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm rounded-lg transition-colors duration-200 sidebar-menu-item text-gray-600 hover:bg-gray-100 hover:text-gray-900"},[t[30]||(t[30]=(0,a.Lk)("i",{class:"fas fa-list text-sm w-4"},null,-1)),t[31]||(t[31]=(0,a.Lk)("span",{class:"flex-1 text-left"},"รายการทั้งหมด",-1)),(0,a.Lk)("span",w,(0,o.v_)(r.totalItems),1)])])]),(0,a.Lk)("div",C,[t[35]||(t[35]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"ตัวเลือกการแสดงผล",-1)),(0,a.Lk)("div",P,[(0,a.Lk)("label",T,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[2]||(t[2]=e=>r.layoutVisibility.order=e),class:"mr-2 rounded border-gray-300"},null,512),[[n.lH,r.layoutVisibility.order]]),t[33]||(t[33]=(0,a.Lk)("span",{class:"text-sm text-gray-700"},"แสดงคำสั่งซื้อ",-1))]),(0,a.Lk)("label",$,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>r.layoutVisibility.enroll=e),class:"mr-2 rounded border-gray-300"},null,512),[[n.lH,r.layoutVisibility.enroll]]),t[34]||(t[34]=(0,a.Lk)("span",{class:"text-sm text-gray-700"},"แสดงการเรียน",-1))])])]),(0,a.Lk)("div",I,[t[39]||(t[39]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"การดำเนินการ",-1)),(0,a.Lk)("div",A,[(0,a.Lk)("button",{onClick:t[4]||(t[4]=(...t)=>e.exportToCSV&&e.exportToCSV(...t)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},t[36]||(t[36]=[(0,a.Lk)("i",{class:"fas fa-download text-sm w-4"},null,-1),(0,a.Lk)("span",null,"Export CSV",-1)])),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>i.togglePanel&&i.togglePanel(...e)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},t[37]||(t[37]=[(0,a.Lk)("i",{class:"fas fa-cogs text-sm w-4"},null,-1),(0,a.Lk)("span",null,"เครื่องมือ",-1)])),(0,a.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>i.getData&&i.getData(...e)),class:"w-full flex items-center gap-3 px-3 py-2 text-sm text-gray-600 hover:bg-gray-100 hover:text-gray-900 rounded-lg transition-colors duration-200"},t[38]||(t[38]=[(0,a.Lk)("i",{class:"fas fa-sync-alt text-sm w-4"},null,-1),(0,a.Lk)("span",null,"รีเฟรช",-1)]))])]),(0,a.Lk)("div",Q,[(0,a.Lk)("div",S,[t[41]||(t[41]=(0,a.Lk)("div",{class:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center"},[(0,a.Lk)("i",{class:"fas fa-user text-white text-sm"})],-1)),(0,a.Lk)("div",_,[(0,a.Lk)("p",M,(0,o.v_)(r.session?.current?.name||"ผู้ใช้"),1),t[40]||(t[40]=(0,a.Lk)("p",{class:"text-xs text-gray-500"},"ผู้ดูแลระบบ",-1))])])])])]),(0,a.Lk)("div",D,[(0,a.Lk)("div",E,[(0,a.Lk)("div",j,[t[43]||(t[43]=(0,a.Lk)("h1",{class:"text-lg font-semibold text-gray-900"},"การลงทะเบียน",-1)),(0,a.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>i.toggleMobileSidebar&&i.toggleMobileSidebar(...e)),class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},t[42]||(t[42]=[(0,a.Lk)("i",{class:"fas fa-bars"},null,-1)]))])]),(0,a.Lk)("div",N,[(0,a.Lk)("div",X,[(0,a.Lk)("div",V,[(0,a.Lk)("div",B,[t[44]||(t[44]=(0,a.Lk)("i",{class:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 text-sm"},null,-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[8]||(t[8]=e=>r.searchQuery=e),onKeydown:t[9]||(t[9]=(...e)=>i.handleSearchKeydown&&i.handleSearchKeydown(...e)),placeholder:"ค้นหานักเรียน...",class:"w-full pl-10 pr-4 py-2 border border-gray-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm"},null,544),[[n.Jo,r.searchQuery]])])]),(0,a.Lk)("div",F,[(0,a.Lk)("button",{onClick:t[10]||(t[10]=(...t)=>e.exportToCSV&&e.exportToCSV(...t)),class:"bg-blue-600 hover:bg-blue-700 text-white font-medium px-3 py-2 rounded-lg transition-colors duration-200 text-sm flex items-center gap-2"},t[45]||(t[45]=[(0,a.Lk)("i",{class:"fas fa-download text-xs"},null,-1),(0,a.eW)(" Export ")])),(0,a.Lk)("button",{onClick:t[11]||(t[11]=(...e)=>i.togglePanel&&i.togglePanel(...e)),class:"bg-gray-600 hover:bg-gray-700 text-white font-medium px-3 py-2 rounded-lg transition-colors duration-200 text-sm flex items-center gap-2"},t[46]||(t[46]=[(0,a.Lk)("i",{class:"fas fa-cogs text-xs"},null,-1),(0,a.eW)(" เครื่องมือ ")]))])])]),(0,a.Lk)("div",U,[(0,a.Lk)("div",H,[(0,a.Lk)("div",R,[t[48]||(t[48]=(0,a.Lk)("h2",{class:"text-lg font-semibold text-gray-900"},"รายการนักเรียน",-1)),(0,a.Lk)("span",O,(0,o.v_)(r.totalItems)+" รายการ ",1),r.searchQuery.length>0?((0,a.uX)(),(0,a.CE)("div",W,[(0,a.Lk)("span",K,[t[47]||(t[47]=(0,a.eW)(" ผลการค้นหา: ")),(0,a.Lk)("span",q,(0,o.v_)(r.searchQuery),1)]),(0,a.Lk)("button",{onClick:t[12]||(t[12]=(...e)=>i.clearSearchQuery&&i.clearSearchQuery(...e)),class:"text-blue-500 hover:text-blue-700 text-sm"}," ล้าง ")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",z,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>r.limitItem=e),onChange:t[14]||(t[14]=(...e)=>i.handleLimitChange&&i.handleLimitChange(...e)),class:"block w-20 py-1 px-2 text-xs font-medium bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.limitOptions,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e},(0,o.v_)(e),9,J)))),128))],544),[[n.u1,r.limitItem]]),(0,a.bF)(lt,{"current-page":r.currentPage,"total-items":r.totalItems,"total-pages":r.totalPages,"limit-items":r.limitItem,"data-loading":r.loading,"display-mode":"nav",onPageChanged:i.handlePageChanged,class:"text-sm"},null,8,["current-page","total-items","total-pages","limit-items","data-loading","onPageChanged"])])]),(0,a.Lk)("div",Y,[(0,a.Lk)("div",Z,[r.loading_sources?((0,a.uX)(),(0,a.CE)("div",ee,[t[59]||(t[59]=(0,a.Fv)('<div class="bg-gray-50 border-b border-gray-200" data-v-e9bdd42e><div class="flex text-sm font-semibold text-gray-900" data-v-e9bdd42e><div class="w-16 py-3 px-4 text-center" data-v-e9bdd42e>#</div><div class="flex-1 py-3 px-4 text-left" data-v-e9bdd42e>ชื่อ-นามสกุล</div><div class="hidden md:block w-32 py-3 px-4 text-left" data-v-e9bdd42e>Citizen ID</div><div class="hidden md:block w-48 py-3 px-4 text-left" data-v-e9bdd42e>การติดต่อ</div><div class="hidden md:block w-20 py-3 px-4 text-center" data-v-e9bdd42e>หลักสูตร</div><div class="hidden md:block w-32 py-3 px-4 text-left" data-v-e9bdd42e>วันที่ลงทะเบียน</div><div class="hidden md:block w-32 py-3 px-4 text-center" data-v-e9bdd42e>เครื่องมือ</div></div></div>',1)),(0,a.Lk)("div",{class:(0,o.C4)(["bg-white min-h-[50px] relative",[r.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},[r.listItems&&r.listItems.length>0?((0,a.uX)(!0),(0,a.CE)(a.FK,{key:0},(0,a.pI)(r.listItems,((s,l)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:s._id},[(0,a.Lk)("div",te,[(0,a.Lk)("div",se,[(0,a.Lk)("span",ae,(0,o.v_)(i.leadingZero((r.currentPage-1)*r.limitItem+l+1)),1)]),(0,a.Lk)("div",le,[(0,a.bF)(it,{to:"/student/detail/"+s.user._id+"?back=/lesson/detail/"+this.dataItem+"/enroll",class:"text-gray-700 hover:text-indigo-600"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",re,[(0,a.Lk)("img",{src:s.user.avatar_img,class:"w-10 h-10 mr-3 rounded-full bg-gray-200 object-cover",alt:"Profile Image"},null,8,ie),(0,a.Lk)("div",null,[(0,a.Lk)("div",{class:"font-medium text-gray-900",innerHTML:s.user.firstname+" "+s.user.lastname},null,8,oe),(0,a.Lk)("div",ne,[t[49]||(t[49]=(0,a.eW)("ID: ")),(0,a.Lk)("span",{innerHTML:s.user.old_id},null,8,ce)]),(0,a.Lk)("div",{class:"text-xs text-gray-400",innerHTML:s.user.token},null,8,de)])])])),_:2},1032,["to"])]),(0,a.Lk)("div",ge,[t[50]||(t[50]=(0,a.Lk)("i",{class:"fas fa-id-card text-gray-400 mr-2 text-sm"},null,-1)),(0,a.Lk)("span",{class:"text-sm",innerHTML:s.user.citizen},null,8,ue)]),(0,a.Lk)("div",me,[(0,a.Lk)("div",he,[t[51]||(t[51]=(0,a.Lk)("i",{class:"fas fa-phone text-gray-400 mr-2 text-sm"},null,-1)),(0,a.Lk)("span",{class:"text-sm",innerHTML:s.user.phone},null,8,pe)]),(0,a.Lk)("div",xe,[t[52]||(t[52]=(0,a.Lk)("i",{class:"fas fa-envelope text-gray-400 mr-2 text-sm"},null,-1)),(0,a.Lk)("span",{class:"text-sm truncate",innerHTML:s.user.email},null,8,be)])]),(0,a.Lk)("div",fe,[(0,a.Lk)("div",ye,[(0,a.Lk)("span",ke,(0,o.v_)(s.user.enroll&&s.user.enroll.length>0?s.user.enroll.length:"0"),1),t[53]||(t[53]=(0,a.Lk)("i",{class:"fas fa-book text-gray-400 text-sm"},null,-1))])]),(0,a.Lk)("div",ve,[(0,a.Lk)("span",Le,(0,o.v_)(s.user.info.regdate?s.user.info.regdate:s.user.createAt?s.user.createAt:"ไม่ระบุ"),1)]),(0,a.Lk)("div",we,[(0,a.Lk)("button",{onClick:t=>e.$router.push("/lesson/edit/"+s.user._id),type:"button",class:"inline-flex items-center px-3 py-1 border border-gray-300 rounded-md text-xs font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors"},t[54]||(t[54]=[(0,a.Lk)("i",{class:"fas fa-edit mr-1"},null,-1),(0,a.eW)(" แก้ไข ")]),8,Ce)])]),(0,a.Lk)("div",Pe,[(0,a.Lk)("div",Te,[(0,a.Lk)("div",$e,[(0,a.Lk)("div",Ie,[t[55]||(t[55]=(0,a.Lk)("i",{class:"fas fa-phone text-gray-400 mr-2"},null,-1)),(0,a.Lk)("span",{innerHTML:s.user.phone},null,8,Ae)]),(0,a.Lk)("div",Qe,[t[56]||(t[56]=(0,a.Lk)("i",{class:"fas fa-book text-gray-400 mr-2"},null,-1)),(0,a.Lk)("span",null,(0,o.v_)(s.user.enroll?s.user.enroll.length:0)+" หลักสูตร",1)])]),(0,a.Lk)("button",{onClick:t=>e.$router.push("/lesson/edit/"+s.user._id),type:"button",class:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"},t[57]||(t[57]=[(0,a.Lk)("i",{class:"fas fa-edit mr-2"},null,-1),(0,a.eW)(" แก้ไข ")]),8,Se)])])],64)))),128)):((0,a.uX)(),(0,a.CE)("div",_e,t[58]||(t[58]=[(0,a.Lk)("i",{class:"fas fa-users text-gray-300 text-4xl mb-4"},null,-1),(0,a.Lk)("p",{class:"text-gray-500"},"ไม่พบข้อมูลนักเรียน",-1)])))],2)])):((0,a.uX)(),(0,a.CE)("div",G,[(0,a.bF)(rt)]))]),(0,a.Lk)("div",Me,[(0,a.bF)(lt,{"current-page":r.currentPage,"total-items":r.totalItems,"total-pages":r.totalPages,"limit-items":r.limitItem,"data-loading":r.loading,"display-mode":"summary",onPageChanged:i.handlePageChanged},null,8,["current-page","total-items","total-pages","limit-items","data-loading","onPageChanged"])])])])]),r.showMobileSidebar?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"lg:hidden fixed inset-0 bg-black bg-opacity-50 z-50",onClick:t[19]||(t[19]=(...e)=>i.toggleMobileSidebar&&i.toggleMobileSidebar(...e))},[(0,a.Lk)("div",{class:"w-64 h-full bg-white transform transition-transform duration-300",onClick:t[18]||(t[18]=(0,n.D$)((()=>{}),["stop"]))},[(0,a.Lk)("div",De,[(0,a.Lk)("div",Ee,[t[61]||(t[61]=(0,a.Lk)("h1",{class:"text-lg font-semibold text-gray-900"},"การลงทะเบียน",-1)),(0,a.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>i.toggleMobileSidebar&&i.toggleMobileSidebar(...e)),class:"p-2 text-gray-600 hover:text-gray-900 hover:bg-gray-100 rounded-lg transition-colors"},t[60]||(t[60]=[(0,a.Lk)("i",{class:"fas fa-times"},null,-1)]))]),(0,a.Lk)("div",je,[t[63]||(t[63]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"สถิติรวม",-1)),(0,a.Lk)("div",Ne,[(0,a.Lk)("div",Xe,[t[62]||(t[62]=(0,a.Lk)("div",{class:"flex items-center gap-2"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full"}),(0,a.Lk)("span",{class:"text-sm text-gray-700"},"นักเรียนทั้งหมด")],-1)),(0,a.Lk)("span",Ve,(0,o.v_)(r.totalItems),1)])])]),(0,a.Lk)("div",Be,[t[66]||(t[66]=(0,a.Lk)("h3",{class:"text-sm font-medium text-gray-700 mb-3"},"ตัวเลือกการแสดงผล",-1)),(0,a.Lk)("div",Fe,[(0,a.Lk)("label",Ue,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[16]||(t[16]=e=>r.layoutVisibility.order=e),class:"mr-2 rounded border-gray-300"},null,512),[[n.lH,r.layoutVisibility.order]]),t[64]||(t[64]=(0,a.Lk)("span",{class:"text-sm text-gray-700"},"แสดงคำสั่งซื้อ",-1))]),(0,a.Lk)("label",He,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[17]||(t[17]=e=>r.layoutVisibility.enroll=e),class:"mr-2 rounded border-gray-300"},null,512),[[n.lH,r.layoutVisibility.enroll]]),t[65]||(t[65]=(0,a.Lk)("span",{class:"text-sm text-gray-700"},"แสดงการเรียน",-1))])])])])])])):(0,a.Q3)("",!0),r.open?((0,a.uX)(),(0,a.CE)("div",Re,[t[69]||(t[69]=(0,a.Lk)("div",{class:"fixed inset-0"},null,-1)),(0,a.Lk)("div",Oe,[(0,a.Lk)("div",We,[(0,a.Lk)("div",Ke,[(0,a.Lk)("div",qe,[(0,a.Lk)("div",ze,[(0,a.Lk)("div",Je,[(0,a.Lk)("div",Ye,[t[68]||(t[68]=(0,a.Lk)("h2",{class:"text-base font-semibold leading-6 text-gray-900",id:"slide-over-title"},"เครื่องมือ",-1)),(0,a.Lk)("div",Ze,[(0,a.Lk)("button",{onClick:t[20]||(t[20]=(...e)=>i.closePanel&&i.closePanel(...e)),type:"button",class:"relative rounded-md bg-white text-gray-400 hover:text-gray-500 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},t[67]||(t[67]=[(0,a.Lk)("span",{class:"absolute -inset-2.5"},null,-1),(0,a.Lk)("span",{class:"sr-only"},"Close panel",-1),(0,a.Lk)("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M6 18L18 6M6 6l12 12"})],-1)]))])])]),(0,a.Lk)("div",Ge,[(0,a.Lk)("ul",et,[(0,a.Lk)("li",null,[(0,a.Lk)("button",{class:"text-blue-600 hover:underline",onClick:t[21]||(t[21]=(...t)=>e.renderBilling&&e.renderBilling(...t))},"Render Billing")]),(0,a.Lk)("li",null,[(0,a.Lk)("button",{class:"text-blue-600 hover:underline",onClick:t[22]||(t[22]=t=>e.renderEnroll())},"Render Enroll")]),(0,a.Lk)("li",null,[(0,a.Lk)("button",{class:"text-blue-600 hover:underline",onClick:t[23]||(t[23]=(...t)=>e.renderProfile&&e.renderProfile(...t))},"Render Profile")])])])])])])])])])):(0,a.Q3)("",!0),(0,a.bF)(ot,{processName:r.processName,progressText:r.progressText,progressTotal:r.progressTotal,progressCurrent:r.progressCurrent,isVisible:r.isProcessing,startTime:r.startTime,endTime:r.endTime,onClose:i.closeProgress},null,8,["processName","progressText","progressTotal","progressCurrent","isVisible","startTime","endTime","onClose"]),r.isShowingOverlay?((0,a.uX)(),(0,a.CE)("div",tt,[(0,a.Lk)("div",st,(0,o.v_)(r.loadingMessage),1),(0,a.Lk)("div",at,(0,o.v_)(r.processingCount),1)])):(0,a.Q3)("",!0)])}s(98992),s(54520),s(3949),s(81454),s(14603),s(47566),s(98721);var rt=s(40475),it=s(75435),ot=s(38558),nt=s(86530),ct=s(9964),dt={data(){const e=rt.A.get("session"),t=rt.A.get("paging");return{open:!1,dataItem:this.$route.params.id,school:e.current.id,login:e.login,courseData:[],listItems:[],categoryData:[],loading_sources:!0,endpoint:"",master:e.master,accessToken:rt.A.get("session","token"),configs:rt.A.get("configs"),session:rt.A.get("session"),limitOptions:[1,10,50,100,200,500,1e3,2e3,3e3,4e3],totalPages:0,totalItems:0,limitItem:50,currentPage:1,searchQuery:"",debounceTimer:null,pagingInfo:t||{[this.$route.path]:{limitItem:50,currentPage:1,searchQuery:""}},loading:!1,showingOverlay:!1,statusFilter:"all",isCreatingUser:!1,isShowingOverlay:!1,loadingMessage:"",processingCount:"",activeBlock:!1,scb:[],isProcessing:!1,processName:"",progressText:"",progressTotal:0,progressCurrent:0,startTime:null,endTime:null,layoutVisibility:{order:!0,enroll:!0},showMobileSidebar:!1}},components:{Loader:it.A,Pagination:ot.A,BatchProgress:nt.A},methods:{togglePanel(){this.open=!this.open},closePanel(){this.open=!1},leadingZero(e){return e<10?"0"+e:e.toString()},formatThaidate(e){return ct.A.toThaiDatetime(e,"short")},updateURLParameters(){const e=new URLSearchParams(window.location.search);this.currentPage>1?e.set("page",this.currentPage):e.delete("page"),this.searchQuery?e.set("searchQuery",this.searchQuery):e.delete("searchQuery");const t=`${window.location.pathname}?${e.toString()}`;window.history.replaceState({},"",t)},handleLimitChange(){const e=rt.A.get("paging")||{};e[this.$route.path]={limitItem:this.limitItem,currentPage:1,searchQuery:this.searchQuery},rt.A.set("paging",e),this.updateURLParameters(),this.getData()},handlePageChanged(e){if(e!==this.currentPage){window.scrollTo(0,0),this.currentPage=e;const t=rt.A.get("paging")||{};t[this.$route.path]={limitItem:this.limitItem,currentPage:this.currentPage,searchQuery:this.searchQuery},rt.A.set("paging",t),this.updateURLParameters(),this.getData()}},clearSearchQuery(){this.searchQuery="";const e=rt.A.get("paging")||{};e[this.$route.path]={limitItem:this.limitItem,currentPage:this.currentPage,searchQuery:this.searchQuery},rt.A.set("paging",e),this.updateURLParameters(),this.handleSearchKeydown({key:"Enter"}),this.getData()},handleSearchKeydown(e){clearTimeout(this.debounceTimer);const t=()=>{this.getData();const e=rt.A.get("paging")||{};e[this.$route.path]={limitItem:this.limitItem,currentPage:1,searchQuery:this.searchQuery},rt.A.set("paging",e),this.updateURLParameters(),this.handlePageChanged(1)};"Enter"===e.key&&this.searchQuery.length>=3?t():this.debounceTimer=setTimeout(t,500)},toggleStatus(e){console.log("Toggle Status",e),this.statusFilter=e,this.getData()},closeProgress(){this.isProcessing=!1},async batchProcess(){this.open=!1;let e=this.listItems.length,t=0;this.isProcessing=!0,this.processName="Render Billing",this.progressTotal=e,this.startTime=(new Date).toISOString(),this.endTime=null;for(const s of this.listItems)t++,this.progressText=`Processing : ${t}/${e}`,this.progressCurrent=t,await this.executeCustomQueries(s.order.ref,s.order._id);this.progressText="All Process : Done",this.endTime=(new Date).toISOString()},async getData(){this.listItems=[],this.totalItems=0;try{let e=[{unit:this.session.current._id,status:"ลงทะเบียนคอร์ส"}];const t=[{$match:{$and:e}},{$set:{userID:{$toObjectId:"$userID"},courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"user",localField:"userID",foreignField:"_id",as:"user"}},{$unwind:"$user"},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},...this.searchQuery?[{$match:{$or:[{"user.name":{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{"user.citizen":{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{"user.email":{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{"user.firstname":{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{"user.lastname":{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{"user.old_id":{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{"user.phone":{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{"user.token":{$regex:`.*${this.searchQuery}.*`,$options:"i"}}]}}]:[],{$facet:{table:[{$skip:(this.currentPage-1)*this.limitItem},{$limit:this.limitItem},{$project:{order:"$$ROOT",user:"$user",course:"$course"}}],count:[{$count:"count"}]}}],s={method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({pipeline:t})},a=await fetch("https://gateway.cloudrestfulapi.com/api/order/aggregate",s),l=await a.json();if(l&&l.length>0){const e=l[0];if(e.table&&e.table.length>0){const t=e.table;if(console.log(e.table),e.count&&e.count.length>0){const s=e.count[0].count,a={data:t,total:s,paging:{page:this.currentPage,limit:this.limitItem,totalPages:Math.ceil(s/this.limitItem)}};this.listItems=a.data.map((e=>(console.log(e),Object.keys(e).forEach((t=>{if("string"===typeof e[t]){const s=e[t].toLowerCase(),a=this.searchQuery.toLowerCase(),l=s.indexOf(a);if(-1!==l&&a.length>0){const s=l+a.length,r=e[t].substring(0,l)+'<span class="text-red-500 font-bold">'+e[t].substring(l,s)+"</span>"+e[t].substring(s);e[t]=r}}})),e))),this.totalItems=a.total,this.totalPages=a.paging.totalPages,this.loading=!1,this.activeBlock=!1,console.log("formattedData",this.formattedData)}else console.error("Total count data is missing.")}else console.error("Paginated data is missing or empty.")}else console.error("No data in 'restReturn' or 'restReturn' is empty.")}catch(e){console.log(e)}finally{this.loading=!1,this.activeBlock=!1}},toggleMobileSidebar(){this.showMobileSidebar=!this.showMobileSidebar}},async mounted(){try{const e=rt.A.get("paging")||{},t=e[this.$route.path]||{};this.limitItem=t.limitItem||50,this.currentPage=t.currentPage||1,this.searchQuery=t.searchQuery||"",this.updateURLParameters(),await this.getData()}catch(e){console.error(e)}},setup(){},computed:{filteredListItems(){return"All"===this.selectedStatus?this.listItems:this.listItems.filter((e=>e.status===this.selectedStatus))}}},gt=s(64621);const ut=(0,gt.A)(dt,[["render",lt],["__scopeId","data-v-e9bdd42e"]]);var mt=ut,ht=s(74284),pt={name:"Home",components:{Dashboard:mt,Authen:ht.A},data(){return{login:rt.A.get("session","login")}},methods:{},mounted(){},setup(){const e=(0,i.lq)(),t=e.meta.title;(0,r.K7)(t),console.log("Dashboard")}};const xt=(0,gt.A)(pt,[["render",l]]);var bt=xt},86530:function(e,t,s){s.d(t,{A:function(){return x}});var a=s(20641),l=s(90033);const r={key:0,class:"fixed top-0 left-0 w-full h-full flex flex-col justify-center items-center z-50"},i={class:"text-white text-center z-20"},o={class:"text-2xl text-green-500 font-bold mb-2"},n={class:"text-xl"},c={key:0,class:"mt-2"},d={class:"text-lg"},g={class:"fixed top-0 left-0 w-full h-1 bg-gray-600"};function u(e,t,s,u,m,h){return s.isVisible?((0,a.uX)(),(0,a.CE)("div",r,[t[1]||(t[1]=(0,a.Lk)("div",{class:"absolute w-full h-full bg-black bg-opacity-80"},null,-1)),(0,a.Lk)("div",i,[(0,a.Lk)("div",o,"## "+(0,l.v_)(s.processName)+" ##",1),(0,a.Lk)("div",n,(0,l.v_)(s.progressText),1),s.startTime&&s.endTime?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",d,"Usage Time : "+(0,l.v_)(h.calculateUsageTime(s.startTime,s.endTime)),1)])):(0,a.Q3)("",!0),s.startTime&&s.endTime?((0,a.uX)(),(0,a.CE)("button",{key:1,class:"mt-4 bg-blue-600 text-white px-4 py-2 rounded",onClick:t[0]||(t[0]=(...e)=>h.closeProgress&&h.closeProgress(...e))},"Close")):(0,a.Q3)("",!0)]),(0,a.Lk)("div",g,[(0,a.Lk)("div",{style:(0,l.Tr)({width:h.progressBarWidth}),class:"h-full bg-green-500"},null,4)])])):(0,a.Q3)("",!0)}var m={props:{processName:String,progressText:String,progressTotal:Number,progressCurrent:Number,isVisible:Boolean,startTime:String,endTime:String},computed:{progressBarWidth(){return this.progressCurrent/this.progressTotal*100+"%"}},methods:{calculateUsageTime(e,t){const s=new Date(e),a=new Date(t),l=a-s,r=Math.floor(l/1e3),i=Math.floor(r/60),o=r%60;return`${i}m ${o}s`},closeProgress(){this.$emit("close")}}},h=s(64621);const p=(0,h.A)(m,[["render",u],["__scopeId","data-v-48124189"]]);var x=p},38558:function(e,t,s){s.d(t,{A:function(){return A}});var a=s(20641),l=s(90033);const r={class:"flex flex-col justify-center items-center h-full"},i={key:0,class:"flex flex-wrap justify-center"},o=["disabled"],n={key:0,class:"font-medium"},c=["disabled"],d=["onClick","disabled"],g={key:1,class:"font-medium"},u=["disabled"],m=["disabled"],h={key:1,class:"text-sm text-gray-400 text-center"},p={class:"font-medium"},x={class:"text-gray-600"},b={class:"font-medium"},f={class:"text-gray-600"},y={class:"font-medium"},k={class:"text-gray-600"},v={class:"font-medium"},L={class:"text-gray-600"};function w(e,t,s,w,C,P){const T=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",r,["nav"===s.displayMode||"full"===s.displayMode?((0,a.uX)(),(0,a.CE)("ul",i,[(0,a.Lk)("li",{class:(0,l.C4)({"opacity-50 cursor-not-allowed":1===C.activePage})},[(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>P.handleButtonClick(C.activePage-1)),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},[(0,a.bF)(T,{icon:["fas","chevron-left"],class:"text-gray-700 pl-1 pr-1 text-md"})],8,o)],2),C.activePage>2?((0,a.uX)(),(0,a.CE)("li",n,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>P.handleButtonClick(1)),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 ml-1 mr-1 text-sm text-gray-700 rounded-md hover:bg-indigo-100"}," หน้าแรก ",8,c)])):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(P.pages,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e,class:(0,l.C4)([{"bg-indigo-100 ml-1 mr-1 rounded-md border-indigo-500 text-indigo-600 font-semibold":C.activePage===e},"font-medium"])},[(0,a.Lk)("button",{onClick:t=>P.handleButtonClick(e),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 ml-1 mr-1 text-sm text-gray-700 rounded-md hover:bg-indigo-100"},(0,l.v_)(e.toString().padStart(2,"0")),9,d)],2)))),128)),C.activePage<s.totalPages-1?((0,a.uX)(),(0,a.CE)("li",g,[(0,a.Lk)("button",{onClick:t[2]||(t[2]=e=>P.handleButtonClick(s.totalPages)),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 ml-1 mr-1 text-sm text-gray-700 rounded-md hover:bg-indigo-100"}," หน้าสุดท้าย ",8,u)])):(0,a.Q3)("",!0),(0,a.Lk)("li",{class:(0,l.C4)({"opacity-50 cursor-not-allowed":C.activePage===s.totalPages})},[(0,a.Lk)("button",{onClick:t[3]||(t[3]=e=>P.handleButtonClick(C.activePage+1)),disabled:s.dataLoading||C.buttonClicked,class:"block px-2 py-2 rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50"},[(0,a.bF)(T,{icon:["fas","chevron-right"],class:"text-gray-700 pl-1 pr-1 text-md"})],8,m)],2)])):(0,a.Q3)("",!0),"summary"===s.displayMode||"full"===s.displayMode?((0,a.uX)(),(0,a.CE)("div",h,[(0,a.eW)((0,l.v_)(P.translate("paging-display"))+" ",1),(0,a.Lk)("span",p,[(0,a.Lk)("span",x,(0,l.v_)(P.startItem),1)]),(0,a.eW)(" "+(0,l.v_)(P.translate("paging-to"))+" ",1),(0,a.Lk)("span",b,[(0,a.Lk)("span",f,(0,l.v_)(P.endItem),1)]),t[4]||(t[4]=(0,a.eW)(" / ")),(0,a.Lk)("span",y,[(0,a.Lk)("span",k,(0,l.v_)(P.formatNumber(s.totalPages)),1)]),(0,a.eW)(" "+(0,l.v_)(P.translate("paging-page"))+" | "+(0,l.v_)(P.translate("paging-from"))+" ",1),(0,a.Lk)("span",v,[(0,a.Lk)("span",L,(0,l.v_)(P.formatNumber(s.totalItems)),1)]),(0,a.eW)(" "+(0,l.v_)(P.translate("paging-item")),1)])):(0,a.Q3)("",!0)])}s(44114),s(14603),s(47566),s(98721);var C=s(9964),P=s(93426),T={props:{currentPage:{type:Number,required:!0},dataLoading:{type:Boolean,required:!0},displayMode:{type:String,required:!0,default:"full"},totalPages:{type:Number,required:!0},totalItems:{type:Number,required:!0},limitItems:{type:Number,required:!0}},data(){return{activePage:this.currentPage,buttonClicked:!1}},computed:{pages(){if(window.innerWidth>=600){const e=Math.max(this.activePage-2,1),t=Math.min(this.activePage+2,this.totalPages);let s=[];for(let a=e;a<=t;a++)s.push(a);return s}{let e=Math.max(this.activePage-1,1),t=Math.min(e+2,this.totalPages);t-e<2&&(e=Math.max(t-2,1));let s=[];for(let a=e;a<=t;a++)s.push(a);return s}},startItem(){return(this.activePage-1)*this.limitItems+1},endItem(){return Math.min(this.activePage*this.limitItems,this.totalItems)}},methods:{translate:P.Tl,formatNumber(e){return C.A.formatNumber(e,"short")},goToPage(e){if(e<1||e>this.totalPages)return;const t=new URLSearchParams(window.location.search),s=t.get("searchQuery");let a="";e>1&&s?a=`?page=${e}&searchQuery=${s}`:e>1?a=`?page=${e}`:s&&(a=`?searchQuery=${s}`);const l=`${window.location.pathname}${a||""}`;window.history.pushState({path:l},"",l),this.activePage=e,this.$emit("page-changed",e)},handleButtonClick(e){this.buttonClicked||(this.buttonClicked=!0,this.goToPage(e),setTimeout((()=>{this.buttonClicked=!1}),1e3))}},watch:{currentPage(e){this.activePage=e},activePage(e){this.$emit("page-changed",e)},$route(){}},created(){const e=new URLSearchParams(window.location.search),t=e.get("page");if(t){const e=parseInt(t);isNaN(e)||this.goToPage(e)}}},$=s(64621);const I=(0,$.A)(T,[["render",w]]);var A=I},74284:function(e,t,s){s.d(t,{A:function(){return g}});var a=s(20641);function l(e,t,s,l,r,i){return(0,a.uX)(),(0,a.CE)("div")}var r=s(75220),i=s(63084),o=s(40475),n={name:"Authen",data(){return{configs:o.A.get("configs"),session:o.A.get("session")}},created(){i.A.option(this.$route)},computed:{},components:{},mounted(){this.checkAuth()},updated(){},methods:{async checkAuth(){const e=(0,r.lq)(),t=e.meta.auth,s=e.name,a=o.A.get("session");let l=a.token,n=a.login,c=a.current;i.A.log("hasLogin",n),i.A.log("Page -> Auth:",t),i.A.log("User -> Token:",l),i.A.log("User -> Login:",n),"frontend"===this.session.interface?i.A.log("Front-End"):"backend"===this.session.interface&&(i.A.log("Back-End"),n?("Login"==s||void 0==c?(i.A.log("Not Login Again"),this.$router.replace({path:"/"})):(i.A.log("Has School Active"),t?(i.A.log("This page is : Authen Request"),""===l||null===l||void 0==l?i.A.log("Your Cannot Access"):i.A.log("Your Can Access")):i.A.log("This page is : No Authen Request")),i.A.log("Login")):(i.A.log("Not Login"),"Login"!=s?(window.location.href="/member/login",i.A.log("Not Login Page",s)):i.A.log("Login Page",s)))}},setup(){}},c=s(64621);const d=(0,c.A)(n,[["render",l]]);var g=d}}]);
//# sourceMappingURL=6240.95d1b533.js.map