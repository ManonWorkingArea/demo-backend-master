"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[6290],{11904:function(e,t,s){s.r(t),s.d(t,{default:function(){return st}});var l=s(20641);function o(e,t,s,o,n,a){return(0,l.uX)(),(0,l.Wv)((0,l.$y)(a.componentName))}var n=s(52968),a=s(75220),r=s(40475),i=s(90033);const c={class:"relative isolate pt-1"},d={class:"mx-auto max-w-7xl px-4 py-5 sm:px-6 lg:px-8"},u={class:"mx-auto flex max-w-2xl items-center justify-between gap-x-8 lg:mx-0 lg:max-w-none"},m={class:"flex items-center gap-x-6"},p={class:"relative inline-block"},f={class:"text-sm leading-6 text-white"},g={class:"mt-1 text-base font-semibold leading-6 text-white"},x={class:"flex items-center gap-x-4 sm:gap-x-6"},b={class:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8 pt-0"},k={class:"mx-auto mb-5 grid grid-cols-1 gap-px bg-white sm:grid-cols-2 lg:grid-cols-3"},y={key:0,class:"flex flex-wrap items-baseline justify-between gap-x-4 gap-y-2 bg-white px-4 py-10 sm:px-6 xl:px-8 border-r border-gray-200"},h={class:"text-sm font-semibold leading-6 text-gray-700"},v={class:"w-full flex-none text-3xl font-medium leading-10 tracking-tight text-gray-900"},L={key:1,class:"flex flex-wrap items-baseline justify-between gap-x-4 gap-y-2 bg-white px-4 py-10 sm:px-6 xl:px-8 border-r border-gray-200"},w={class:"text-sm font-semibold leading-6 text-gray-700"},$={class:"w-full flex-none text-3xl font-medium leading-10 tracking-tight text-gray-900"},C={key:2,class:"flex flex-wrap items-baseline justify-between gap-x-4 gap-y-2 bg-white px-4 py-10 sm:px-6 xl:px-8 border-r border-gray-200"},E={class:"text-sm font-semibold leading-6 text-gray-700"},D={class:"w-full flex-none text-3xl font-medium leading-10 tracking-tight text-gray-900"},F={class:"mx-auto"};function _(e,t,s,o,n,a){const r=(0,l.g2)("avatar"),_=(0,l.g2)("font-awesome-icon");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("header",c,[t[3]||(t[3]=(0,l.Lk)("div",{class:"absolute inset-0 -z-10 overflow-hidden bg-profile","aria-hidden":"true"},[(0,l.Lk)("div",{class:"absolute left-16 top-full -mt-16 transform-gpu opacity-50 blur-3xl xl:left-1/2 xl:-ml-80"}),(0,l.Lk)("div",{class:"absolute inset-x-0 bottom-0 h-px bg-gray-900/5"})],-1)),(0,l.Lk)("div",d,[(0,l.Lk)("div",u,[(0,l.Lk)("div",m,[(0,l.Lk)("span",p,[(0,l.bF)(r,{data:{name:n.profile.firstname+" "+n.profile.lastname,image:n.profile.avatar,size:14},class:"h-16 w-16"},null,8,["data"]),t[1]||(t[1]=(0,l.Lk)("span",{class:"absolute right-0 top-0 block h-4 w-4 rounded-full bg-green-400 ring-2 ring-white"},null,-1))]),(0,l.Lk)("h1",null,[(0,l.Lk)("div",f,(0,i.v_)(this.profile.email),1),(0,l.Lk)("div",g,(0,i.v_)(this.profile.firstname)+" "+(0,i.v_)(this.profile.lastname),1)])]),(0,l.Lk)("div",x,[t[2]||(t[2]=(0,l.Lk)("a",{href:"#",class:"hidden text-sm font-semibold leading-6 text-white sm:block"},"แก้ไขข้อมูลส่วนตัว",-1)),(0,l.Lk)("button",{onClick:t[0]||(t[0]=e=>a.logout()),type:"button",class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[(0,l.bF)(_,{icon:["fas","power-off"]})])])])])]),(0,l.Lk)("div",b,[(0,l.Lk)("dl",k,[n.config.plugins.includes("lesson")?((0,l.uX)(),(0,l.CE)("div",y,[(0,l.Lk)("dt",h,[(0,l.bF)(_,{icon:["fas","graduation-cap"],class:"text-xl pr-2"}),t[4]||(t[4]=(0,l.eW)(" หลักสูตรที่ลงทะเบียน "))]),t[5]||(t[5]=(0,l.Lk)("dd",{class:"text-xs font-medium text-gray-700"},"Enroll",-1)),(0,l.Lk)("dd",v,(0,i.v_)(a.countTotalEnrollment),1)])):(0,l.Q3)("",!0),n.config.plugins.includes("application")?((0,l.uX)(),(0,l.CE)("div",L,[(0,l.Lk)("dt",w,[(0,l.bF)(_,{icon:["fas","file-alt"],class:"text-xl pr-2"}),t[6]||(t[6]=(0,l.eW)(" แบบฟอร์มการลงทะเบียน "))]),t[7]||(t[7]=(0,l.Lk)("dd",{class:"text-xs font-medium text-gray-700"},"Assignment",-1)),(0,l.Lk)("dd",$,(0,i.v_)(a.countCompleteEnrollments),1)])):(0,l.Q3)("",!0),n.config.plugins.includes("shop")?((0,l.uX)(),(0,l.CE)("div",C,[(0,l.Lk)("dt",E,[(0,l.bF)(_,{icon:["fas","shopping-cart"],class:"text-xl pr-2"}),t[8]||(t[8]=(0,l.eW)(" คำสั่งซื้อ "))]),t[9]||(t[9]=(0,l.Lk)("dd",{class:"text-xs font-medium text-gray-700"},"Shop",-1)),(0,l.Lk)("dd",D,(0,i.v_)(a.countProcessingEnrollments),1)])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",F,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.config.plugins,(e=>((0,l.uX)(),(0,l.Wv)((0,l.$y)(a.getComponent(e)),{key:e})))),128))])])],64)}s(44114),s(98992),s(54520);var I=s(9964),A=s(68831),T=s(54973),X=s(31398),K=s(15851),B=s(40471),S=s(63084);const W=new B.A(!1);var N={name:"User Profile",components:{avatar:A.A},data(){return{config:r.A.get("configs"),profile:r.A.get("session","user"),session:r.A.get("session"),enroll:[],avatarData:{image:null}}},created(){this.profile.req_reset&&this.$router.push("/user/reset")},methods:{getComponent(e){const t={application:T.A,lesson:X.A,shop:K.A};return t[e]||null},formatThaidate(e){return I.A.toThaiDatetime(e)},logout(){this.$swal({toast:!0,position:"bottom-end",showConfirmButton:!1,timer:500,icon:"success",title:"แจ้งเตือน",text:"ออกจากระบบเรียบร้อยแล้ว"}).then((()=>{r.A.delete("session"),window.location.href="/"}))},countEnrollmentsByStatus(e=[],t){return e&&0!==e.length?e.filter((e=>e.analytics&&e.analytics.status&&e.analytics.status.trim()===t)).length:0},countTotalEnrollments(e=[]){return e?e.length:0},async getData(){try{this.activeBlock=!0;const e=[{$match:{$and:[{userID:this.session.userID}]}},{$set:{courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},{$facet:{enroll:[{$skip:0},{$limit:100}],totalCount:[{$count:"count"}]}}],t=await W.POST("enroll/aggregate",{pipeline:e},this.config.key),s=t.data;this.enroll=s[0].enroll,this.activeBlock=!1}catch(e){S.A.log(e)}}},async mounted(){try{await this.getData()}catch(e){S.A.log(Error)}},computed:{countPendingEnrollments(){return this.countEnrollmentsByStatus(this.enroll,"pending")},countProcessingEnrollments(){return this.countEnrollmentsByStatus(this.enroll,"processing")},countCompleteEnrollments(){return this.countEnrollmentsByStatus(this.enroll,"complete")},countTotalEnrollment(){return this.countTotalEnrollments(this.enroll)}}},O=s(64621);const P=(0,O.A)(N,[["render",_]]);var Q=P;const j={class:"relative isolate pt-1"},U={class:"mx-auto max-w-7xl px-4 py-5 sm:px-6 lg:px-8"},M={class:"mx-auto flex max-w-2xl items-center justify-between gap-x-8 lg:mx-0 lg:max-w-none"},q={class:"flex items-center gap-x-6"},R={class:"relative inline-block"},z={class:"text-sm leading-6 text-white"},H={class:"mt-1 text-base font-semibold leading-6 text-white"},Y={class:"flex items-center gap-x-4 sm:gap-x-6"},Z={class:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8 pt-0"},G={class:"mx-auto mb-5 grid grid-cols-1 gap-px bg-white sm:grid-cols-2 lg:grid-cols-3"},J={class:"flex flex-wrap items-baseline justify-between gap-x-4 gap-y-2 bg-white px-4 py-10 sm:px-6 xl:px-8 border-r border-gray-200"},V={class:"text-sm font-semibold leading-6 text-gray-700"},ee={class:"w-full flex-none text-3xl font-medium leading-10 tracking-tight text-gray-900"},te={class:"mx-auto"};function se(e,t,s,o,n,a){const r=(0,l.g2)("avatar"),c=(0,l.g2)("font-awesome-icon");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("header",j,[t[3]||(t[3]=(0,l.Lk)("div",{class:"absolute inset-0 -z-10 overflow-hidden bg-profile","aria-hidden":"true"},[(0,l.Lk)("div",{class:"absolute left-16 top-full -mt-16 transform-gpu opacity-50 blur-3xl xl:left-1/2 xl:-ml-80"}),(0,l.Lk)("div",{class:"absolute inset-x-0 bottom-0 h-px bg-gray-900/5"})],-1)),(0,l.Lk)("div",U,[(0,l.Lk)("div",M,[(0,l.Lk)("div",q,[(0,l.Lk)("span",R,[(0,l.bF)(r,{data:{name:n.profile.firstname+" "+n.profile.lastname,image:n.profile.avatar,size:14},class:"h-16 w-16"},null,8,["data"]),t[1]||(t[1]=(0,l.Lk)("span",{class:"absolute right-0 top-0 block h-4 w-4 rounded-full bg-green-400 ring-2 ring-white"},null,-1))]),(0,l.Lk)("h1",null,[(0,l.Lk)("div",z,(0,i.v_)(this.profile.email),1),(0,l.Lk)("div",H,(0,i.v_)(this.profile.firstname)+" "+(0,i.v_)(this.profile.lastname),1)])]),(0,l.Lk)("div",Y,[t[2]||(t[2]=(0,l.Lk)("a",{href:"#",class:"hidden text-sm font-semibold leading-6 text-white sm:block"},"แก้ไขข้อมูลส่วนตัว",-1)),(0,l.Lk)("button",{onClick:t[0]||(t[0]=e=>a.logout()),type:"button",class:"rounded-md bg-indigo-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[(0,l.bF)(c,{icon:["fas","power-off"]})])])])])]),(0,l.Lk)("div",Z,[(0,l.Lk)("dl",G,[(0,l.Lk)("div",J,[(0,l.Lk)("dt",V,[(0,l.bF)(c,{icon:["fas","shopping-cart"],class:"text-xl pr-2"}),t[4]||(t[4]=(0,l.eW)(" คำสั่งซื้อ "))]),t[5]||(t[5]=(0,l.Lk)("dd",{class:"text-xs font-medium text-gray-700"},"Shop",-1)),(0,l.Lk)("dd",ee,(0,i.v_)(a.countProcessingEnrollments),1)])]),(0,l.Lk)("div",te,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.config.plugins,(e=>((0,l.uX)(),(0,l.Wv)((0,l.$y)(a.getComponent(e)),{key:e})))),128))])])],64)}const le=["onClick"],oe={class:"grid sm:grid-cols-2 gap-4"},ne={id:"applicant-information-title",class:"text-lg font-bold leading-6 text-gray-800 mb-2 sm:mb-0"},ae={key:0},re={class:"text-gray-600"},ie={class:"flex justify-center sm:justify-end items-center mb-2 sm:mb-0"},ce={class:"bg-green-500 text-white p-2 rounded-sm"},de={class:"w-full flex justify-center items-center mt-4"},ue={class:"bg-gray-500 px-3 py-1 rounded-sm text-white text-sm"},me={class:"grid grid-cols-2 sm:grid-cols-2 md:grid-cols-4 gap-3 p-2"},pe={class:"flex flex-col border rounded-sm shadow-sm items-center p-6 text-center"},fe={class:"text-3xl font-bold mb-2"},ge={class:"flex flex-col border rounded-sm shadow-sm items-center p-6 text-center"},xe={class:"text-3xl font-bold mb-2"},be={class:"text-3xl font-bold mb-2"},ke={class:"text-3xl font-bold mb-2"},ye={class:"text-3xl font-bold mb-2"},he={class:"text-3xl font-bold mb-2"},ve={class:"text-3xl font-bold mb-2"},Le={class:"flex flex-col border rounded-sm shadow-sm items-center p-6 text-center"},we={class:"text-3xl font-bold mb-2"},$e={class:"text-base uppercase tracking-wide text-gray-600"},Ce={class:"font-normal text-xs"},Ee={class:"flex flex-col border rounded-sm shadow-sm items-center p-6 text-center"},De={class:"text-3xl font-bold mb-2"},Fe={class:"text-base uppercase tracking-wide text-gray-600"},_e={key:0,class:"col-span-2 sm:col-span-2 md:col-span-4 grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 gap-3 mt-1"},Ie={key:0,class:"flex items-center"},Ae={class:"flex items-center"},Te={class:"flex items-center"},Xe={key:0,class:"flex items-center"},Ke={class:"flex items-center"},Be={class:"flex items-center"},Se={class:"border-t border-b border-gray-200 px-4 py-5 sm:px-6 grid grid-cols-1 sm:grid-cols-2 gap-4"},We={key:0,class:"text-center sm:text-right"},Ne=["onClick"],Oe={class:"border-t border-gray-200 px-4 py-5 sm:px-6"},Pe={class:"border-t border-gray-200 px-4 py-5 sm:px-6"},Qe={class:"overflow-x-auto"},je={class:"leading-6 text-gray-900 p-3 mb-3 bg-blue-50 border border-gray-200 rounded-sm"};function Ue(e,t,s,o,n,a){const r=(0,l.g2)("font-awesome-icon"),c=(0,l.g2)("DynamicFormRender");return(0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(n.order,((e,s)=>((0,l.uX)(),(0,l.CE)("div",{key:e._id,class:"bg-white mb-4 border border-gray-200 mt-3"},[(0,l.Lk)("div",{class:(0,i.C4)(["px-4 py-5 sm:px-6 hover:bg-blue-50 cursor-pointer",{"bg-blue-50":e.expanded}]),onClick:e=>a.toggleExpand(s)},[(0,l.Lk)("div",oe,[(0,l.Lk)("div",null,[(0,l.Lk)("span",null,[(0,l.Lk)("h2",ne,[(0,l.eW)((0,i.v_)(s+1)+". #"+(0,i.v_)(e._id)+" ",1),e.forms?((0,l.uX)(),(0,l.CE)("span",ae,[(0,l.bF)(r,{icon:e.expanded?["fas","caret-up"]:["fas","caret-down"],class:"text-gray-600 pr-3"},null,8,["icon"])])):(0,l.Q3)("",!0)]),(0,l.Lk)("p",re,(0,i.v_)(e.course.name),1)])]),(0,l.Lk)("div",ie,[(0,l.Lk)("span",ce,[(0,l.eW)(" สถานะ: "+(0,i.v_)(a.findStatusByCode(e.forms.process,e.posts.status)?.name||"Not Found"),1),t[4]||(t[4]=(0,l.Lk)("br",null,null,-1)),(0,l.Lk)("small",null,(0,i.v_)(a.findStatusByCode(e.forms.process,e.posts.status)?.description||"Not Found"),1)])])]),(0,l.Lk)("div",de,[(0,l.Lk)("div",ue,[t[5]||(t[5]=(0,l.eW)(" คลิ๊กเพื่อแสดงข้อมูลการลงทะเบียนของคุณ ")),(0,l.bF)(r,{icon:e.expanded?["fas","angle-up"]:["fas","angle-down"],class:"ml-2",onClick:e=>a.toggleExpand(s)},null,8,["icon","onClick"])])])],10,le),(0,l.Lk)("div",me,[(0,l.Lk)("div",pe,[(0,l.Lk)("div",fe,(0,i.v_)(e.enroll.analytics.pre.score||0),1),t[6]||(t[6]=(0,l.Lk)("div",{class:"text-base uppercase tracking-wide text-gray-600"},"คะแนนก่อนเรียน",-1))]),(0,l.Lk)("div",ge,["round-1"===e.forms.formData["radiobox-23-10-10"].value.value?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.post?.score<33?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.retest?.score?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,i.C4)([e.enroll?.analytics?.retest?.score>32?"text-green-700":"text-red-700"])},[(0,l.Lk)("div",xe,(0,i.v_)(e.enroll?.analytics?.retest?.score),1),(0,l.Lk)("p",null,(0,i.v_)(e.enroll?.analytics?.retest?.message)+" (สอบซ่อม)",1)],2)):((0,l.uX)(),(0,l.CE)("div",{key:1,class:(0,i.C4)([e.enroll?.analytics?.post?.score>32?"text-green-700":"text-red-700"])},[(0,l.Lk)("div",be,(0,i.v_)(e.enroll?.analytics?.post?.score),1),(0,l.Lk)("p",null,(0,i.v_)(e.enroll?.analytics?.post?.message),1)],2))],64)):((0,l.uX)(),(0,l.CE)("div",{key:1,class:(0,i.C4)([e.enroll?.analytics?.post?.score>32?"text-green-700":"text-red-700"])},[(0,l.Lk)("div",ke,(0,i.v_)(e.enroll?.analytics?.post?.score),1),(0,l.Lk)("p",null,(0,i.v_)(e.enroll?.analytics?.post?.message),1)],2))],64)):(0,l.Q3)("",!0),"round-2"===e.forms.formData["radiobox-23-10-10"].value.value?((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[e.enroll?.analytics?.post?.score<33?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.retest?.score?((0,l.uX)(),(0,l.CE)("div",{key:0,class:(0,i.C4)([e.enroll?.analytics?.retest?.score>32?"text-green-700":"text-red-700"])},[(0,l.Lk)("div",ye,(0,i.v_)(e.enroll?.analytics?.retest?.score),1),(0,l.Lk)("p",null,(0,i.v_)(e.enroll?.analytics?.retest?.message)+" (สอบซ่อม)",1)],2)):((0,l.uX)(),(0,l.CE)("div",{key:1,class:(0,i.C4)([e.enroll?.analytics?.post?.score>32?"text-green-700":"text-red-700"])},[(0,l.Lk)("div",he,(0,i.v_)(e.enroll?.analytics?.post?.score),1),(0,l.Lk)("p",null,(0,i.v_)(e.enroll?.analytics?.post?.message),1)],2))],64)):((0,l.uX)(),(0,l.CE)("div",{key:1,class:(0,i.C4)([e.enroll?.analytics?.post?.score>32?"text-green-700":"text-red-700"])},[(0,l.Lk)("div",ve,(0,i.v_)(e.enroll?.analytics?.post?.score),1),(0,l.Lk)("p",null,(0,i.v_)(e.enroll?.analytics?.post?.message),1)],2))],64)):(0,l.Q3)("",!0),t[7]||(t[7]=(0,l.Lk)("div",{class:"text-base uppercase tracking-wide text-gray-600"},"คะแนนหลังเรียน",-1))]),(0,l.Lk)("div",Le,[(0,l.Lk)("div",we,[(0,l.eW)((0,i.v_)(e.enroll.analytics.complete)+"/"+(0,i.v_)(e.enroll.analytics.total)+" ",1),t[8]||(t[8]=(0,l.Lk)("small",{class:"font-normal text-xs"},"EP",-1))]),(0,l.Lk)("div",$e,[t[9]||(t[9]=(0,l.eW)("เรียนไปแล้ว ")),(0,l.Lk)("small",Ce," ("+(0,i.v_)(e.enroll.analytics.percent)+"%)",1)])]),(0,l.Lk)("div",Ee,[(0,l.Lk)("div",De,(0,i.v_)(e.forms.formData["radiobox-23-10-10"].value.label),1),(0,l.Lk)("div",Fe,"รอบสอบ วันที่ "+(0,i.v_)(e.forms.formData["radiobox-23-10-10"].value.description),1)]),"draft"!=e.forms.process?((0,l.uX)(),(0,l.CE)("div",_e,["round-1"===e.forms.formData["radiobox-23-10-10"].value.value?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[0===e.enroll.analytics.post.score||null==e.enroll?.analytics?.post?.score||"N/a"===e.enroll?.analytics?.post?.score?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[e.enroll?.analytics?.post?.score?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.post?.score<33||"N/a"===e.enroll?.analytics?.post?.score?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.retest?.score?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.retest?.score<33?((0,l.uX)(),(0,l.CE)("div",Ie,[(0,l.bF)(r,{icon:["fas","edit"],class:"text-gray-200 flex-shrink-0 text-3xl"}),t[10]||(t[10]=(0,l.Lk)("div",{class:"ml-3 pl-3 pr-3 border-l border-white border-opacity-50"},[(0,l.Lk)("div",{class:"flex flex-col text-left"},[(0,l.Lk)("span",{class:"font-bold"},"ไม่ผ่านการรับรอง"),(0,l.Lk)("span",{class:"font-normal text-sm"},"ลงทะเบียนใหม่ในรุ่นถัดไป ")])],-1))])):((0,l.uX)(),(0,l.CE)("button",{key:1,class:"w-full bg-green-600 text-white font-bold py-2 px-4 rounded",onClick:t[0]||(t[0]=(...e)=>a.navigateToCertificationn&&a.navigateToCertificationn(...e))},[(0,l.Lk)("div",Ae,[(0,l.bF)(r,{icon:["fas","download"],class:"text-gray-200 flex-shrink-0 text-3xl"}),t[11]||(t[11]=(0,l.Lk)("div",{class:"ml-3 pl-3 pr-3 border-l border-white border-opacity-50"},[(0,l.Lk)("div",{class:"flex flex-col text-left"},[(0,l.Lk)("span",{class:"font-bold"},"ดาวน์โหลดใบรับรอง"),(0,l.Lk)("span",{class:"font-normal text-sm"},"ผ่านการรับรอง ")])],-1))])]))],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[],64))],64)):e.enroll?.analytics?.post?.score>32||e.enroll?.analytics?.retest?.score>32?((0,l.uX)(),(0,l.CE)("div",{key:1,class:(0,i.C4)([e.enroll?.analytics?.post?.score>32?"text-green-700":"text-red-700"])},[(0,l.Lk)("button",{class:"w-full bg-green-600 text-white font-bold py-2 px-4 rounded",onClick:t[1]||(t[1]=(...e)=>a.navigateToCertificationn&&a.navigateToCertificationn(...e))},[(0,l.Lk)("div",Te,[(0,l.bF)(r,{icon:["fas","download"],class:"text-gray-200 flex-shrink-0 text-3xl"}),t[12]||(t[12]=(0,l.Lk)("div",{class:"ml-3 pl-3 pr-3 border-l border-white border-opacity-50"},[(0,l.Lk)("div",{class:"flex flex-col text-left"},[(0,l.Lk)("span",{class:"font-bold"},"ดาวน์โหลดใบรับรอง"),(0,l.Lk)("span",{class:"font-normal text-sm"},"ผ่านการรับรอง ")])],-1))])])],2)):(0,l.Q3)("",!0)],64)):(0,l.Q3)("",!0)],64))],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[e.enroll?.analytics?.post?.score?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.post?.score<33||"N/a"===e.enroll?.analytics?.post?.score?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.retest?.score?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[e.enroll?.analytics?.retest?.score<33?((0,l.uX)(),(0,l.CE)("div",Xe,[(0,l.bF)(r,{icon:["fas","edit"],class:"text-gray-200 flex-shrink-0 text-3xl"}),t[13]||(t[13]=(0,l.Lk)("div",{class:"ml-3 pl-3 pr-3 border-l border-white border-opacity-50"},[(0,l.Lk)("div",{class:"flex flex-col text-left"},[(0,l.Lk)("span",{class:"font-bold"},"ไม่ผ่านการรับรอง"),(0,l.Lk)("span",{class:"font-normal text-sm"},"ลงทะเบียนใหม่ในรุ่นถัดไป ")])],-1))])):((0,l.uX)(),(0,l.CE)("button",{key:1,class:"w-full bg-green-600 text-white font-bold py-2 px-4 rounded",onClick:t[2]||(t[2]=(...e)=>a.navigateToCertificationn&&a.navigateToCertificationn(...e))},[(0,l.Lk)("div",Ke,[(0,l.bF)(r,{icon:["fas","download"],class:"text-gray-200 flex-shrink-0 text-3xl"}),t[14]||(t[14]=(0,l.Lk)("div",{class:"ml-3 pl-3 pr-3 border-l border-white border-opacity-50"},[(0,l.Lk)("div",{class:"flex flex-col text-left"},[(0,l.Lk)("span",{class:"font-bold"},"ดาวน์โหลดใบรับรอง"),(0,l.Lk)("span",{class:"font-normal text-sm"},"ผ่านการรับรอง ")])],-1))])]))],64)):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[],64))],64)):e.enroll?.analytics?.post?.score>32||e.enroll?.analytics?.retest?.score>32?((0,l.uX)(),(0,l.CE)("div",{key:1,class:(0,i.C4)([e.enroll?.analytics?.post?.score>32?"text-green-700":"text-red-700"])},[(0,l.Lk)("button",{class:"w-full bg-green-600 text-white font-bold py-2 px-4 rounded",onClick:t[3]||(t[3]=(...e)=>a.navigateToCertificationn&&a.navigateToCertificationn(...e))},[(0,l.Lk)("div",Be,[(0,l.bF)(r,{icon:["fas","download"],class:"text-gray-200 flex-shrink-0 text-3xl"}),t[15]||(t[15]=(0,l.Lk)("div",{class:"ml-3 pl-3 pr-3 border-l border-white border-opacity-50"},[(0,l.Lk)("div",{class:"flex flex-col text-left"},[(0,l.Lk)("span",{class:"font-bold"},"ดาวน์โหลดใบรับรอง"),(0,l.Lk)("span",{class:"font-normal text-sm"},"ผ่านการรับรอง ")])],-1))])])],2)):(0,l.Q3)("",!0)],64)):(0,l.Q3)("",!0)],64))])):(0,l.Q3)("",!0)]),(0,l.Lk)("div",Se,[(0,l.Lk)("div",null,[(0,l.Lk)("p",null,[t[16]||(t[16]=(0,l.Lk)("strong",null,"REF1:",-1)),(0,l.eW)(" "+(0,i.v_)(e.ref1),1)]),(0,l.Lk)("p",null,[t[17]||(t[17]=(0,l.Lk)("strong",null,"REF2:",-1)),(0,l.eW)(" "+(0,i.v_)(e.ref2),1)]),(0,l.Lk)("p",null,[t[18]||(t[18]=(0,l.Lk)("strong",null,"ราคา:",-1)),(0,l.eW)(" "+(0,i.v_)(e.price)+" บาท",1)]),(0,l.Lk)("p",null,[t[19]||(t[19]=(0,l.Lk)("strong",null,"วันที่ลงทะเบียน:",-1)),(0,l.eW)(" "+(0,i.v_)(e.createdAt),1)])]),"draft"===e.forms.process?((0,l.uX)(),(0,l.CE)("div",We,[(0,l.Lk)("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded",onClick:t=>a.openNewTab(e._id)},t[20]||(t[20]=[(0,l.eW)(" QR CODE "),(0,l.Lk)("br",null,null,-1),(0,l.Lk)("small",null,"ชำระเงิน",-1)]),8,Ne)])):(0,l.Q3)("",!0)]),e.expanded&&e.forms?((0,l.uX)(),(0,l.CE)(l.FK,{key:0},[t[23]||(t[23]=(0,l.Lk)("div",{class:"px-4 py-5 sm:px-6"},[(0,l.Lk)("h2",{id:"course-information-title",class:"text-lg font-bold leading-6 text-gray-900"},"รายละเอียดหลักสูตร")],-1)),(0,l.Lk)("div",Oe,[(0,l.Lk)("p",null,[t[21]||(t[21]=(0,l.Lk)("strong",null,"ชื่อหลักสูตร:",-1)),(0,l.eW)(" "+(0,i.v_)(e.course.name),1)])]),t[24]||(t[24]=(0,l.Lk)("div",{class:"px-4 py-5 sm:px-6"},[(0,l.Lk)("h2",{id:"form-data-title",class:"text-lg font-bold leading-6 text-gray-900"},"รายละเอียดแบบฟอร์ม")],-1)),(0,l.Lk)("div",Pe,[(0,l.Lk)("div",Qe,[(0,l.Lk)("h2",je,[(0,l.bF)(r,{icon:["fas","id-card"],class:""}),t[22]||(t[22]=(0,l.eW)(" ข้อมูลทั่วไป"))]),(0,l.bF)(c,{formData:e,formID:e.forms._id},null,8,["formData","formID"])])])],64)):(0,l.Q3)("",!0)])))),128)}s(72577),s(81454);var Me=s(23324),qe=s(10300);const Re=new B.A(!1);var ze={components:{DynamicFormRender:qe.A},data(){return{config:r.A.get("configs"),member:r.A.get("session","user"),session:r.A.get("session"),message:"Order",order:[],round:{"round-1":"9-10 เม.ย. 67","round-2":"18-19 เม.ย. 67"}}},methods:{checkDateDiff(e,t){return(0,Me.rv)(e,t)},navigateToLesson(){this.$router.push("/lesson/assessment/668c94ea7fb1dd8057b5f360/65eb076bef03bebf9ead6f1c")},navigateToRetest(){this.$router.push("/lesson/assessment/668c94ea7fb1dd8057b5f360/65eb076bef03bebf9ead6f1c/retest/1")},navigateToCertificationn(){this.$router.push("/lesson/detail/668c94ea7fb1dd8057b5f360/")},checkDuedate(e){const t=420,s=new Date(e),l=new Date(s.getUTCFullYear(),s.getUTCMonth(),s.getUTCDate(),s.getUTCHours(),s.getUTCMinutes()+t),o=new Date,n=new Date(o.getUTCFullYear(),o.getUTCMonth(),o.getUTCDate(),o.getUTCHours(),o.getUTCMinutes()+t);return n<l},toggleExpand(e){this.order[e].expanded=!this.order[e].expanded},openNewTab(e){window.open("/lesson/pay/"+e,"_blank")},openNewPlayTab(e){window.open("/lesson/detail/"+e)},formatThaidate(e){return I.A.toThaiDatetime(e)},countEnrollmentsByStatus(e=[],t){return e&&0!==e.length?e.filter((e=>e.analytics&&e.analytics.status&&e.analytics.status.trim()===t)).length:0},countTotalEnrollments(e=[]){return e?e.length:0},findStatusByCode(e,t){return t.find((t=>t.code===e))||null},createDefaultOrderItem(e){const t={pre:{score:0},post:{score:0},complete:0,total:0,percent:0},s=e.enroll?.analytics?{...t,...e.enroll.analytics,pre:{score:e.enroll.analytics.pre?.score??"N/a"},post:{score:e.enroll.analytics.post?.score??"N/a",message:e.enroll.analytics.post?.message??"N/a"},complete:e.enroll.analytics.complete??"N/a",total:e.enroll.analytics.total??"N/a",percent:e.enroll.analytics.percent??"N/a"}:t;return{...e,enroll:{...e.enroll,analytics:s}}},async getData(){try{this.activeBlock=!0;const e=[{$match:{$and:[{userID:this.member._id}]}},{$lookup:{from:"form",let:{userId:"$userID",courseId:"$courseID"},pipeline:[{$match:{$expr:{$and:[{$eq:["$userID","$$userId"]},{$eq:["$courseID","$$courseId"]}]}}},{$set:{formID:{$toObjectId:"$formID"}}}],as:"forms"}},{$unwind:"$forms"},{$lookup:{from:"enroll",let:{userId:"$forms.userID",courseId:"$forms.courseID"},pipeline:[{$match:{$expr:{$and:[{$eq:["$userID","$$userId"]},{$eq:["$courseID","$$courseId"]}]}}}],as:"enroll"}},{$unwind:{path:"$enroll",preserveNullAndEmptyArrays:!0}},{$set:{courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},{$unwind:"$forms"},{$set:{formID:"$forms.formID"}},{$lookup:{from:"post",localField:"formID",foreignField:"_id",as:"posts"}},{$unwind:"$posts"},{$set:{userId:"$userID",courseId:"$courseID"}},{$sort:{createdAt:-1}},{$facet:{enroll:[{$skip:0},{$limit:100}],totalCount:[{$count:"count"}]}}],t=await Re.POST("order/aggregate",{pipeline:e},this.config.key),s=t.data[0]["enroll"];this.order=s.map((e=>this.createDefaultOrderItem(e))),this.codeToFind=this.order,this.activeBlock=!1,console.log("Order",this.order)}catch(e){console.log(e)}}},computed:{foundStatus(){return this.posts.status.find((e=>e.code===this.codeToFind))||null}},mounted(){this.getData(),S.A.slack("Member:",this.member.firstname+" "+this.member.lastname);const e=this.member.firstname+" "+this.member.lastname+" / Dashboard";this.$setPageTitle(e)}};const He=(0,O.A)(ze,[["render",Ue]]);var Ye=He;const Ze=new B.A(!1);var Ge={name:"User Profile DOA",components:{avatar:A.A},data(){return{config:r.A.get("configs"),profile:r.A.get("session","user"),session:r.A.get("session"),enroll:[],avatarData:{image:null}}},created(){this.profile.req_reset&&this.$router.push("/user/reset")},methods:{getComponent(e){const t={application:T.A,lesson:Ye,shop:K.A};return t[e]||null},formatThaidate(e){return I.A.toThaiDatetime(e)},logout(){this.$swal({toast:!0,position:"bottom-end",showConfirmButton:!1,timer:500,icon:"success",title:"แจ้งเตือน",text:"ออกจากระบบเรียบร้อยแล้ว"}).then((()=>{r.A.delete("session"),window.location.href="/"}))},countEnrollmentsByStatus(e=[],t){return e&&0!==e.length?e.filter((e=>e.analytics&&e.analytics.status&&e.analytics.status.trim()===t)).length:0},countTotalEnrollments(e=[]){return e?e.length:0},async getData(){try{this.activeBlock=!0;const e=[{$match:{$and:[{userID:this.session.userID}]}},{$set:{courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},{$facet:{enroll:[{$skip:0},{$limit:100}],totalCount:[{$count:"count"}]}}],t=await Ze.POST("enroll/aggregate",{pipeline:e},this.config.key),s=t.data;this.enroll=s[0].enroll,this.activeBlock=!1}catch(e){S.A.log(e)}}},async mounted(){try{await this.getData()}catch(e){S.A.log(Error)}},computed:{countPendingEnrollments(){return this.countEnrollmentsByStatus(this.enroll,"pending")},countProcessingEnrollments(){return this.countEnrollmentsByStatus(this.enroll,"processing")},countCompleteEnrollments(){return this.countEnrollmentsByStatus(this.enroll,"complete")},countTotalEnrollment(){return this.countTotalEnrollments(this.enroll)}}};const Je=(0,O.A)(Ge,[["render",se]]);var Ve=Je,et={name:"LessonDetail",components:{},data(){return{session:r.A.get("session"),configs:r.A.get("configs")}},setup(){const e=(0,a.lq)(),t=e.meta.title;(0,n.K7)(t)},computed:{componentName(){return this.configs&&this.configs.layout&&this.configs.layout.userDashboard&&"DOA"===this.configs.layout.userDashboard?Ve:Q}}};const tt=(0,O.A)(et,[["render",o]]);var st=tt},23324:function(e,t,s){function l(e){const t={timeZone:"Asia/Bangkok",hour12:!1};return new Date(e.toLocaleString("en-US",t))}function o(e,t){const s=Math.abs(t-e),l=Math.floor(s/864e5),o=Math.floor(s%864e5/36e5);return{days:l,hours:o}}function n(e,t=null){const s=l(new Date(e)),n=l(new Date);let a="",r="";if(t){const e=l(new Date(t));if(n>=s&&n<=e){const t=o(s,n),l=o(n,e);a="in",r=`เริ่มมาแล้ว ${t.days} วัน ${t.hours} ชั่วโมง จะจบในอีก ${l.days} วัน ${l.hours} ชั่วโมง`}else if(n<s){const e=o(n,s);a="not",r=`จะถึงในอีก ${e.days} วัน ${e.hours} ชั่วโมง`}else if(n>e){const t=o(e,n);a="over",r=`เกินกำหนดมา ${t.days} วัน ${t.hours} ชั่วโมง`}}else if(n<s){const e=o(n,s);a="not",r=`จะถึงในอีก ${e.days} วัน ${e.hours} ชั่วโมง`}else if(n>=s){const e=o(s,n);a="over",r=`เกินกำหนดมา ${e.days} วัน ${e.hours} ชั่วโมง`}return{status:a,message:r}}s.d(t,{rv:function(){return n}})}}]);
//# sourceMappingURL=6290.e2a56086.js.map