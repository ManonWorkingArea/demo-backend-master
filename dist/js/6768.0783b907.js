"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[6768],{56768:function(t,e,o){o.r(e),o.d(e,{default:function(){return li}});var a=o(20641);function n(t,e,o,n,i,r){return(0,a.uX)(),(0,a.Wv)((0,a.$y)(r.componentName))}var i=o(52968),r=o(75220),s=o(40475);function l(t,e,o,n,i,r){const s=(0,a.g2)("Store"),l=(0,a.g2)("ProductDetail"),u=(0,a.g2)("Product",!0),d=(0,a.g2)("Inventory"),c=(0,a.g2)("Category"),p=(0,a.g2)("Price"),h=(0,a.g2)("Test"),y=(0,a.g2)("Coupon"),m=(0,a.g2)("Fee"),k=(0,a.g2)("Payment"),g=(0,a.g2)("Status");return(0,a.uX)(),(0,a.CE)("div",null,[e[0]||(e[0]=(0,a.Lk)("hr",null,null,-1)),e[1]||(e[1]=(0,a.Lk)("br",null,null,-1)),e[2]||(e[2]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Store Front")],-1)),(0,a.bF)(s),e[3]||(e[3]=(0,a.Lk)("hr",null,null,-1)),e[4]||(e[4]=(0,a.Lk)("br",null,null,-1)),e[5]||(e[5]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"ProductDetail")],-1)),(0,a.bF)(l),e[6]||(e[6]=(0,a.Lk)("hr",null,null,-1)),e[7]||(e[7]=(0,a.Lk)("br",null,null,-1)),e[8]||(e[8]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Product")],-1)),(0,a.bF)(u),e[9]||(e[9]=(0,a.Lk)("hr",null,null,-1)),e[10]||(e[10]=(0,a.Lk)("br",null,null,-1)),e[11]||(e[11]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Inventory")],-1)),(0,a.bF)(d),e[12]||(e[12]=(0,a.Lk)("hr",null,null,-1)),e[13]||(e[13]=(0,a.Lk)("br",null,null,-1)),e[14]||(e[14]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Category")],-1)),(0,a.bF)(c),e[15]||(e[15]=(0,a.Lk)("hr",null,null,-1)),e[16]||(e[16]=(0,a.Lk)("br",null,null,-1)),e[17]||(e[17]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Price")],-1)),(0,a.bF)(p),e[18]||(e[18]=(0,a.Lk)("hr",null,null,-1)),e[19]||(e[19]=(0,a.Lk)("br",null,null,-1)),e[20]||(e[20]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Test")],-1)),(0,a.bF)(h),e[21]||(e[21]=(0,a.Lk)("hr",null,null,-1)),e[22]||(e[22]=(0,a.Lk)("br",null,null,-1)),e[23]||(e[23]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Coupon")],-1)),(0,a.bF)(y),e[24]||(e[24]=(0,a.Lk)("hr",null,null,-1)),e[25]||(e[25]=(0,a.Lk)("br",null,null,-1)),e[26]||(e[26]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Fee")],-1)),(0,a.bF)(m),e[27]||(e[27]=(0,a.Lk)("hr",null,null,-1)),e[28]||(e[28]=(0,a.Lk)("br",null,null,-1)),e[29]||(e[29]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Payment")],-1)),(0,a.bF)(k),e[30]||(e[30]=(0,a.Lk)("hr",null,null,-1)),e[31]||(e[31]=(0,a.Lk)("br",null,null,-1)),e[32]||(e[32]=(0,a.Lk)("h1",null,[(0,a.Lk)("strong",null,"Status")],-1)),(0,a.bF)(g)])}var u=o(90033),d=o(53751);const c=["innerHTML"],p=["onClick"],h=["onClick"],y={key:0},m=["innerHTML"],k=["onClick"],g={key:0},b=["disabled"],v=["value"],L=["value"],f={key:0},C=["value"],w={key:0},P=["onUpdate:modelValue"],S=["onUpdate:modelValue"],_=["onUpdate:modelValue"],E=["onUpdate:modelValue"],x=["onUpdate:modelValue"],D=["onUpdate:modelValue"],A=["onUpdate:modelValue"],T=["onUpdate:modelValue"],U=["onUpdate:modelValue"],F=["onChange"],V=["onClick"],I=["onUpdate:modelValue"],X=["onUpdate:modelValue"],Q=["onUpdate:modelValue"],q=["onUpdate:modelValue"],M=["onUpdate:modelValue"],$=["onUpdate:modelValue"],N=["onChange"],O={key:1},J=["onUpdate:modelValue"],K=["onUpdate:modelValue"],G=["onUpdate:modelValue"],B=["onUpdate:modelValue"],W=["onUpdate:modelValue"],R=["onUpdate:modelValue","onChange"],j=["value"],H=["src","alt"],z=["value"],Y=["value"],Z={key:0},tt=["value"];function et(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[60]||(e[60]=(0,a.Lk)("h1",null,"Product Manager",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.fetchProducts&&r.fetchProducts(...t))},"Load Products"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.productList,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.Lk)("span",null,[(0,a.eW)((0,u.v_)(t.name)+" ("+(0,u.v_)(t.sku)+") - $"+(0,u.v_)(t.price)+" - ",1),(0,a.Lk)("span",{innerHTML:r.formatPrice(t)},null,8,c),(0,a.eW)(" "+(0,u.v_)(r.calculateTotalStock(t))+" in stock - "+(0,u.v_)(t.status)+" - "+(0,u.v_)(t.type)+" - "+(0,u.v_)(r.getInventoryName(t.inventoryId)),1)]),(0,a.Lk)("button",{onClick:e=>r.prepareEditProduct(t)},"Update",8,p),(0,a.Lk)("button",{onClick:o=>r.removeProduct(t._id,e)},"Delete",8,h),"variation"===t.type?((0,a.uX)(),(0,a.CE)("ul",y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.subProducts,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{key:o},[(0,a.Lk)("span",null,[(0,a.eW)((0,u.v_)(e.name)+" ("+(0,u.v_)(e.sku)+") - ",1),(0,a.Lk)("span",{innerHTML:r.formatPrice(e,t.price)},null,8,m),(0,a.eW)(" - "+(0,u.v_)(e.stock)+" in stock - "+(0,u.v_)(e.status),1)]),(0,a.Lk)("button",{onClick:a=>r.removeSubProduct(t._id,e._id,o)},"Remove Sub-Product",8,k)])))),128))])):(0,a.Q3)("",!0)])))),128))]),i.showProductConfig?((0,a.uX)(),(0,a.CE)("div",g,[e[40]||(e[40]=(0,a.Lk)("h2",null,"Edit Product",-1)),e[41]||(e[41]=(0,a.Lk)("label",{for:"productName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"productName","onUpdate:modelValue":e[1]||(e[1]=t=>i.productData.name=t),placeholder:"Name"},null,512),[[d.Jo,i.productData.name]]),e[42]||(e[42]=(0,a.Lk)("label",{for:"productSku"},"SKU",-1)),(0,a.bo)((0,a.Lk)("input",{id:"productSku","onUpdate:modelValue":e[2]||(e[2]=t=>i.productData.sku=t),placeholder:"SKU"},null,512),[[d.Jo,i.productData.sku]]),e[43]||(e[43]=(0,a.Lk)("label",{for:"productPrice"},"Price",-1)),(0,a.bo)((0,a.Lk)("input",{id:"productPrice","onUpdate:modelValue":e[3]||(e[3]=t=>i.productData.price=t),type:"number",placeholder:"Price"},null,512),[[d.Jo,i.productData.price]]),e[44]||(e[44]=(0,a.Lk)("label",{for:"productStock"},"Stock",-1)),(0,a.bo)((0,a.Lk)("input",{id:"productStock","onUpdate:modelValue":e[4]||(e[4]=t=>i.productData.stock=t),type:"number",placeholder:"Stock",disabled:"variation"===i.productData.type},null,8,b),[[d.Jo,i.productData.stock]]),e[45]||(e[45]=(0,a.Lk)("label",{for:"productStatus"},"Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"productStatus","onUpdate:modelValue":e[5]||(e[5]=t=>i.productData.status=t)},e[27]||(e[27]=[(0,a.Lk)("option",{value:"pending"},"Pending",-1),(0,a.Lk)("option",{value:"draft"},"Draft",-1),(0,a.Lk)("option",{value:"public"},"Public",-1),(0,a.Lk)("option",{value:"trash"},"Trash",-1)]),512),[[d.u1,i.productData.status]]),e[46]||(e[46]=(0,a.Lk)("label",{for:"productType"},"Type",-1)),(0,a.bo)((0,a.Lk)("select",{id:"productType","onUpdate:modelValue":e[6]||(e[6]=t=>i.productData.type=t)},e[28]||(e[28]=[(0,a.Lk)("option",{value:"simple"},"Simple",-1),(0,a.Lk)("option",{value:"digital"},"Digital",-1),(0,a.Lk)("option",{value:"variation"},"Variation",-1)]),512),[[d.u1,i.productData.type]]),e[47]||(e[47]=(0,a.Lk)("label",{for:"productInventory"},"Inventory",-1)),(0,a.bo)((0,a.Lk)("select",{id:"productInventory","onUpdate:modelValue":e[7]||(e[7]=t=>i.productData.inventoryId=t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.inventoryList,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t._id,value:t._id},(0,u.v_)(t.name),9,v)))),128))],512),[[d.u1,i.productData.inventoryId]]),e[48]||(e[48]=(0,a.Lk)("h3",null,"Categories",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.nestedCategoryList,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",value:t._id,"onUpdate:modelValue":e[8]||(e[8]=t=>i.productData.categories=t)},null,8,L),[[d.lH,i.productData.categories]]),(0,a.eW)(" "+(0,u.v_)(t.name)+" ",1),t.subCategories&&t.subCategories.length?((0,a.uX)(),(0,a.CE)("ul",f,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.subCategories,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",value:t._id,"onUpdate:modelValue":e[9]||(e[9]=t=>i.productData.categories=t)},null,8,C),[[d.lH,i.productData.categories]]),(0,a.eW)(" "+(0,u.v_)(t.name),1)])))),128))])):(0,a.Q3)("",!0)])))),128))]),"variation"===i.productData.type?((0,a.uX)(),(0,a.CE)("div",w,[e[32]||(e[32]=(0,a.Lk)("h3",null,"Variation Attributes",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.productData.variationAttributes,((t,o)=>((0,a.uX)(),(0,a.CE)("div",{key:o},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e=>t.name=e,placeholder:"Attribute Name (e.g., Size)"},null,8,P),[[d.Jo,t.name]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e=>t.code=e,placeholder:"Attribute Code (e.g., size)"},null,8,S),[[d.Jo,t.code]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e=>t.displayType=e},e[29]||(e[29]=[(0,a.Lk)("option",{value:"text"},"Text",-1),(0,a.Lk)("option",{value:"color"},"Color",-1),(0,a.Lk)("option",{value:"image"},"Image",-1)]),8,_),[[d.u1,t.displayType]]),(0,a.Lk)("div",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.values,((e,n)=>((0,a.uX)(),(0,a.CE)("div",{key:n},["text"===t.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:0,"onUpdate:modelValue":t=>e.name=t,placeholder:"Attribute Value Name (e.g., S, M, L)"},null,8,E)),[[d.Jo,e.name]]):(0,a.Q3)("",!0),"text"===t.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,"onUpdate:modelValue":t=>e.code=t,placeholder:"Attribute Value Code (e.g., S, M, L)"},null,8,x)),[[d.Jo,e.code]]):(0,a.Q3)("",!0),"color"===t.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:2,"onUpdate:modelValue":t=>e.display=t,type:"color"},null,8,D)),[[d.Jo,e.display]]):(0,a.Q3)("",!0),"color"===t.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:3,"onUpdate:modelValue":t=>e.name=t,placeholder:"Attribute Value Name (e.g., Red, Blue)"},null,8,A)),[[d.Jo,e.name]]):(0,a.Q3)("",!0),"color"===t.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:4,"onUpdate:modelValue":t=>e.code=t,placeholder:"Attribute Value Name (e.g., Red, Blue)"},null,8,T)),[[d.Jo,e.code]]):(0,a.Q3)("",!0),"image"===t.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:5,"onUpdate:modelValue":t=>e.name=t,placeholder:"Attribute Value Name"},null,8,U)),[[d.Jo,e.name]]):(0,a.Q3)("",!0),"image"===t.displayType?((0,a.uX)(),(0,a.CE)("input",{key:6,type:"file",onChange:t=>r.handleFileUpload(t,o,n)},null,40,F)):(0,a.Q3)("",!0)])))),128)),(0,a.Lk)("button",{onClick:t=>r.addAttrValue(o)},"Add Value",8,V)])])))),128)),(0,a.Lk)("div",null,[e[31]||(e[31]=(0,a.Lk)("h4",null,"Add New Attribute",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[10]||(e[10]=t=>i.newAttribute.name=t),placeholder:"Attribute Name"},null,512),[[d.Jo,i.newAttribute.name]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[11]||(e[11]=t=>i.newAttribute.code=t),placeholder:"Attribute Code"},null,512),[[d.Jo,i.newAttribute.code]]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[12]||(e[12]=t=>i.newAttribute.displayType=t)},e[30]||(e[30]=[(0,a.Lk)("option",{value:"text"},"Text",-1),(0,a.Lk)("option",{value:"color"},"Color",-1),(0,a.Lk)("option",{value:"image"},"Image",-1)]),512),[[d.u1,i.newAttribute.displayType]]),(0,a.Lk)("div",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.newAttribute.values,((t,e)=>((0,a.uX)(),(0,a.CE)("div",{key:e},["text"===i.newAttribute.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:0,"onUpdate:modelValue":e=>t.name=e,placeholder:"Attribute Value Name"},null,8,I)),[[d.Jo,t.name]]):(0,a.Q3)("",!0),"text"===i.newAttribute.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,"onUpdate:modelValue":e=>t.code=e,placeholder:"Attribute Value Code"},null,8,X)),[[d.Jo,t.code]]):(0,a.Q3)("",!0),"color"===i.newAttribute.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:2,"onUpdate:modelValue":e=>t.display=e,type:"color"},null,8,Q)),[[d.Jo,t.display]]):(0,a.Q3)("",!0),"color"===i.newAttribute.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:3,"onUpdate:modelValue":e=>t.name=e,placeholder:"Attribute Value Name (e.g., Red, Blue)"},null,8,q)),[[d.Jo,t.name]]):(0,a.Q3)("",!0),"color"===i.newAttribute.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:4,"onUpdate:modelValue":e=>t.code=e,placeholder:"Attribute Value Name (e.g., Red, Blue)"},null,8,M)),[[d.Jo,t.code]]):(0,a.Q3)("",!0),"image"===i.newAttribute.displayType?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:5,"onUpdate:modelValue":e=>t.name=e,placeholder:"Attribute Value Name"},null,8,$)),[[d.Jo,t.name]]):(0,a.Q3)("",!0),"image"===i.newAttribute.displayType?((0,a.uX)(),(0,a.CE)("input",{key:6,type:"file",onChange:t=>r.handleFileUpload(t,null,e)},null,40,N)):(0,a.Q3)("",!0)])))),128)),(0,a.Lk)("button",{onClick:e[13]||(e[13]=(...t)=>r.addNewAttrValue&&r.addNewAttrValue(...t))},"Add Value")]),(0,a.Lk)("button",{onClick:e[14]||(e[14]=(...t)=>r.addVariationAttribute&&r.addVariationAttribute(...t))},"Add Attribute")])])):(0,a.Q3)("",!0),i.productData.subProducts.length?((0,a.uX)(),(0,a.CE)("div",O,[e[39]||(e[39]=(0,a.Lk)("h3",null,"Sub-Products",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.productData.subProducts,((t,o)=>((0,a.uX)(),(0,a.CE)("div",{key:o},[(0,a.Lk)("h4",null,(0,u.v_)(t.name),1),e[34]||(e[34]=(0,a.Lk)("label",{for:"subProductName"},"Sub-Product Name",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e=>t.name=e,placeholder:"Sub-Product Name"},null,8,J),[[d.Jo,t.name]]),e[35]||(e[35]=(0,a.Lk)("label",{for:"subProductSku"},"Sub-Product SKU",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e=>t.sku=e,placeholder:"Sub-Product SKU"},null,8,K),[[d.Jo,t.sku]]),e[36]||(e[36]=(0,a.Lk)("label",{for:"subProductPrice"},"Sub-Product Price",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e=>t.price=e,type:"number",placeholder:"Sub-Product Price"},null,8,G),[[d.Jo,t.price]]),e[37]||(e[37]=(0,a.Lk)("label",{for:"subProductStock"},"Sub-Product Stock",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e=>t.stock=e,type:"number",placeholder:"Sub-Product Stock"},null,8,B),[[d.Jo,t.stock]]),e[38]||(e[38]=(0,a.Lk)("label",{for:"subProductStatus"},"Sub-Product Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"subProductStatus","onUpdate:modelValue":e=>t.status=e},e[33]||(e[33]=[(0,a.Lk)("option",{value:"pending"},"Pending",-1),(0,a.Lk)("option",{value:"draft"},"Draft",-1),(0,a.Lk)("option",{value:"public"},"Public",-1),(0,a.Lk)("option",{value:"trash"},"Trash",-1)]),8,W),[[d.u1,t.status]]),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.productData.variationAttributes,((e,o)=>((0,a.uX)(),(0,a.CE)("div",{key:o},[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":o=>t.attributes[e.code]=o,onChange:e=>r.updateSubProductNameAndSku(t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.values,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t.code,value:t.code},["text"===e.displayType?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,u.v_)(t.name),1)],64)):(0,a.Q3)("",!0),"color"===e.displayType?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.Lk)("span",{style:(0,u.Tr)({backgroundColor:t.code,display:"inline-block",width:"20px",height:"20px"})},null,4),(0,a.eW)(" "+(0,u.v_)(t.name),1)],64)):(0,a.Q3)("",!0),"image"===e.displayType?((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.Lk)("img",{src:t.code,alt:t.name,style:{width:"20px",height:"20px"}},null,8,H),(0,a.eW)(" "+(0,u.v_)(t.name),1)],64)):(0,a.Q3)("",!0)],8,j)))),128))],40,R),[[d.u1,t.attributes[e.code]]])])))),128))])))),128))])):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:e[15]||(e[15]=(...t)=>r.updateProduct&&r.updateProduct(...t))},"Save Changes"),(0,a.Lk)("button",{onClick:e[16]||(e[16]=(...t)=>r.generateSubProducts&&r.generateSubProducts(...t))},"Generate Sub-Products")])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[e[51]||(e[51]=(0,a.Lk)("h2",null,"Add Product",-1)),e[52]||(e[52]=(0,a.Lk)("label",{for:"newProductName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newProductName","onUpdate:modelValue":e[17]||(e[17]=t=>i.newProduct.name=t),placeholder:"Name"},null,512),[[d.Jo,i.newProduct.name]]),e[53]||(e[53]=(0,a.Lk)("label",{for:"newProductSku"},"SKU",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newProductSku","onUpdate:modelValue":e[18]||(e[18]=t=>i.newProduct.sku=t),placeholder:"SKU"},null,512),[[d.Jo,i.newProduct.sku]]),e[54]||(e[54]=(0,a.Lk)("label",{for:"newProductPrice"},"Price",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newProductPrice","onUpdate:modelValue":e[19]||(e[19]=t=>i.newProduct.price=t),type:"number",placeholder:"Price"},null,512),[[d.Jo,i.newProduct.price]]),e[55]||(e[55]=(0,a.Lk)("label",{for:"newProductStock"},"Stock",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newProductStock","onUpdate:modelValue":e[20]||(e[20]=t=>i.newProduct.stock=t),type:"number",placeholder:"Stock"},null,512),[[d.Jo,i.newProduct.stock]]),e[56]||(e[56]=(0,a.Lk)("label",{for:"newProductStatus"},"Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newProductStatus","onUpdate:modelValue":e[21]||(e[21]=t=>i.newProduct.status=t)},e[49]||(e[49]=[(0,a.Lk)("option",{value:"pending"},"Pending",-1),(0,a.Lk)("option",{value:"draft"},"Draft",-1),(0,a.Lk)("option",{value:"public"},"Public",-1),(0,a.Lk)("option",{value:"trash"},"Trash",-1)]),512),[[d.u1,i.newProduct.status]]),e[57]||(e[57]=(0,a.Lk)("label",{for:"newProductType"},"Type",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newProductType","onUpdate:modelValue":e[22]||(e[22]=t=>i.newProduct.type=t)},e[50]||(e[50]=[(0,a.Lk)("option",{value:"simple"},"Simple",-1),(0,a.Lk)("option",{value:"digital"},"Digital",-1),(0,a.Lk)("option",{value:"variation"},"Variation",-1)]),512),[[d.u1,i.newProduct.type]]),e[58]||(e[58]=(0,a.Lk)("label",{for:"newProductInventory"},"Inventory",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newProductInventory","onUpdate:modelValue":e[23]||(e[23]=t=>i.newProduct.inventoryId=t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.inventoryList,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t._id,value:t._id},(0,u.v_)(t.name),9,z)))),128))],512),[[d.u1,i.newProduct.inventoryId]]),e[59]||(e[59]=(0,a.Lk)("h3",null,"Categories",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.nestedCategoryList,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",value:t._id,"onUpdate:modelValue":e[24]||(e[24]=t=>i.newProduct.categories=t)},null,8,Y),[[d.lH,i.newProduct.categories]]),(0,a.eW)(" "+(0,u.v_)(t.name)+" ",1),t.subCategories&&t.subCategories.length?((0,a.uX)(),(0,a.CE)("ul",Z,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.subCategories,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",value:t._id,"onUpdate:modelValue":e[25]||(e[25]=t=>i.newProduct.categories=t)},null,8,tt),[[d.lH,i.newProduct.categories]]),(0,a.eW)(" "+(0,u.v_)(t.name),1)])))),128))])):(0,a.Q3)("",!0)])))),128))]),(0,a.Lk)("button",{onClick:e[26]||(e[26]=(...t)=>r.addProduct&&r.addProduct(...t))},"Add Product")])])}o(44114),o(98992),o(72577),o(30670),o(3949),o(81454),o(8872);var ot=o(40471);const at=new ot.A(!1);var nt={data(){return{productList:[],inventoryList:[],categoryList:[],nestedCategoryList:[],priceList:[],productData:{_id:"",name:"",sku:"",price:0,stock:0,status:"pending",type:"simple",variationAttributes:[],subProducts:[],inventoryId:"",categories:[]},subProductData:{name:"",sku:"",price:0,stock:0,status:"pending",attributes:{}},newProduct:{name:"",sku:"",price:0,stock:0,status:"pending",type:"simple",variationAttributes:[],subProducts:[],inventoryId:"",categories:[]},newAttribute:{name:"",code:"",values:[{name:"",code:""}],displayType:"text"},showProductConfig:!1,showSubProductConfig:!1,configs:s.A.get("configs"),session:s.A.get("session")}},watch:{"productData.price"(t){"variation"===this.productData.type&&this.productData.subProducts.forEach((e=>{e.price=t}))}},methods:{async fetchProducts(){try{const t=await at.POST("product/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.productList=t.data);const e=await at.POST("inventory/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===e.status&&(this.inventoryList=e.data);const o=await at.POST("product_category/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===o.status&&(this.categoryList=o.data,this.nestedCategoryList=this.createNestedCategoryList(this.categoryList));const a=await at.POST("product_price/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===a.status&&(this.priceList=a.data)}catch(t){console.error("Error fetching data:",t)}},createNestedCategoryList(t){const e={};t.forEach((t=>{e[t._id]={...t,subCategories:[]}}));const o=[];return t.forEach((t=>{t.parent?e[t.parent]&&e[t.parent].subCategories.push(e[t._id]):o.push(e[t._id])})),o},prepareEditProduct(t){this.productData={...t,categories:[...t.categories]||[]},this.showProductConfig=!0,this.showSubProductConfig=!1},prepareEditSubProduct(t,e){this.subProductData={...t},this.subProductData.index=e,this.showSubProductConfig=!0},async updateProduct(){try{"variation"===this.productData.type&&(this.productData.stock=this.calculateTotalStock(this.productData));const t=await at.PUT(`product/${this.productData._id}`,{data:{...this.productData,_id:void 0}},this.configs.key);200===t.status&&(await this.fetchProducts(),this.showProductConfig=!1,this.resetProductData())}catch(t){console.error("Error updating product:",t)}},async removeProduct(t,e){try{const o=await at.DELETE(`product/${t}`,"",this.configs.key);200===o.status&&this.productList.splice(e,1)}catch(o){console.error("Error deleting product:",o)}},async addProduct(){try{"variation"===this.newProduct.type&&(this.newProduct.stock=this.calculateTotalStock(this.newProduct));const t=await at.POST("product/",{data:{...this.newProduct,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(this.productList.push(t.data),this.resetNewProduct())}catch(t){console.error("Error adding product:",t)}},async addSubProduct(t){const e={...this.subProductData,name:this.generateVariationName(this.productData.name,this.subProductData.attributes),sku:this.generateVariationSKU(this.productData.sku,this.subProductData.attributes),price:this.productData.price};try{this.productData.subProducts.push(e),this.productData.stock=this.calculateTotalStock(this.productData);const o=await at.PUT(`product/${t}`,{data:{subProducts:this.productData.subProducts,stock:this.productData.stock}},this.configs.key);200===o.status&&(await this.fetchProducts(),this.showSubProductConfig=!1,this.resetSubProductData())}catch(o){console.error("Error adding sub-product:",o)}},async removeSubProduct(t,e,o){try{const e=this.productList.find((e=>e._id===t));if(e){e.subProducts.splice(o,1);const a=await at.PUT(`product/${t}`,{data:{subProducts:e.subProducts,stock:this.calculateTotalStock(e)}},this.configs.key);200===a.status&&await this.fetchProducts()}}catch(a){console.error("Error deleting sub-product:",a)}},async addVariationAttribute(){this.newAttribute.name&&this.newAttribute.code&&this.newAttribute.values.length>0&&""!==this.newAttribute.values[0].name&&""!==this.newAttribute.values[0].code?(this.productData.variationAttributes.push({...this.newAttribute}),this.resetNewAttribute(),await this.updateProduct()):alert("Please provide a valid attribute name, code, and at least one value with name and code.")},addAttrValue(t){this.productData.variationAttributes[t].values.push({name:"",code:""})},addNewAttrValue(){this.newAttribute.values.push({name:"",code:""})},resetNewAttribute(){this.newAttribute={name:"",code:"",values:[{name:"",code:""}],displayType:"text"}},resetNewProduct(){this.newProduct={name:"",sku:"",price:0,stock:0,status:"pending",type:"simple",variationAttributes:[],subProducts:[],inventoryId:"",categories:[]}},resetProductData(){this.productData={_id:"",name:"",sku:"",price:0,stock:0,status:"pending",type:"simple",variationAttributes:[],subProducts:[],inventoryId:"",categories:[]}},resetSubProductData(){this.subProductData={name:"",sku:"",price:0,stock:0,status:"pending",attributes:{}}},generateVariationSKU(t,e){const o=Object.values(e).join("-");return`${t}-${o}`},generateVariationName(t,e){const o=Object.keys(e).map((t=>{const o=this.productData.variationAttributes.find((e=>e.code===t));if(o){const a=o.values.find((o=>o.code===e[t]));return a?a.name:""}return""})).join(" ");return`${t} ${o}`},updateSubProductNameAndSku(t){t.name=this.generateVariationName(this.productData.name,t.attributes),t.sku=this.generateVariationSKU(this.productData.sku,t.attributes)},generateSubProducts(){const t=this.productData.variationAttributes,e=this.getCombinations(t),o=e.map((e=>{const o={};return e.forEach(((e,a)=>{o[t[a].code]=e})),{name:this.generateVariationName(this.productData.name,o),sku:this.generateVariationSKU(this.productData.sku,o),price:this.productData.price,stock:0,status:this.productData.status,attributes:o}})),a=[];o.forEach((t=>{const e=this.productData.subProducts.find((e=>e.sku===t.sku));e?a.push({...e,...t}):a.push(t)})),this.productData.subProducts=a,this.productData.stock=this.calculateTotalStock(this.productData),this.updateProduct()},getCombinations(t){const e=t.map((t=>t.values.map((t=>t.code))));return this.cartesianProduct(e)},cartesianProduct(t){if(0===t.length)return[[]];const[e,...o]=t,a=this.cartesianProduct(o);return e.flatMap((t=>a.map((e=>[t,...e]))))},calculateTotalStock(t){return"variation"===t.type?t.subProducts.reduce(((t,e)=>t+e.stock),0):t.stock},getInventoryName(t){const e=this.inventoryList.find((e=>e._id===t));return e?e.name:"Unknown"},getSalePrice(t){const e=this.priceList.find((e=>(t.categories||[]).includes(e.category)));if(!e)return null;let o=t.price;return"fix"===e.mode?o=e.value:"percent"===e.mode&&(o=t.price-t.price*e.value/100),parseFloat(o.toFixed(2))},formatPrice(t,e=null){const o=this.getSalePrice(t);if(null===o)return`$${parseFloat(t.price).toFixed(2)}`;const a=null!==e?e:t.price,n=parseFloat((a-o).toFixed(2)),i=parseFloat((n/a*100).toFixed(0));return`\n        <span style="text-decoration: line-through; color: grey;">$${parseFloat(a).toFixed(2)}</span>\n        <span style="color: green;">$${parseFloat(o).toFixed(2)}</span>\n        <small style="color: grey;">Save: $${n} (${i}%)</small>\n      `},handleFileUpload(t,e,o){const a=t.target.files[0],n=new FileReader;n.onload=t=>{const a=t.target.result;null!==e?this.productData.variationAttributes[e].values[o].code=a:this.newAttribute.values[o].code=a},n.readAsDataURL(a)}},async mounted(){await this.fetchProducts()}},it=o(64621);const rt=(0,it.A)(nt,[["render",et]]);var st=rt;const lt={key:0,class:"border border-gray-400"},ut={key:0},dt={key:0},ct={class:"regular-price"},pt={class:"sale-price"},ht={key:1},yt={key:1},mt={key:0},kt={class:"regular-price"},gt={class:"sale-price"},bt={key:1},vt={key:0},Lt=["onClick"],ft={key:1},Ct=["onClick"],wt={class:"text-gray-500"},Pt={key:2},St=["onClick"],_t=["src","alt"],Et={key:0},xt={key:1},Dt={key:0},At={key:1,class:"quantity-control"},Tt=["disabled"],Ut=["disabled"],Ft={key:0},Vt=["onClick"],It={class:"border border-gray-400 mb-2"},Xt={key:0},Qt=["onClick"],qt={key:0,class:"quantity-control"},Mt=["onClick","disabled"],$t=["onClick","disabled"],Nt=["onClick"];function Ot(t,e,o,n,i,r){const s=(0,a.g2)("checkout-form");return(0,a.uX)(),(0,a.CE)("div",null,[e[25]||(e[25]=(0,a.Lk)("h1",null,"Store",-1)),(0,a.Lk)("section",null,[e[15]||(e[15]=(0,a.Lk)("h2",null,"Load Product by SKU",-1)),(0,a.Lk)("div",null,[e[12]||(e[12]=(0,a.Lk)("label",{for:"productSku"},"Product SKU:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"productSku","onUpdate:modelValue":e[0]||(e[0]=t=>i.productSku=t),placeholder:"Enter Product SKU"},null,512),[[d.Jo,i.productSku]]),(0,a.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>r.loadProductBySku&&r.loadProductBySku(...t))},"Load Product By SKU")]),i.singleProduct?((0,a.uX)(),(0,a.CE)("div",lt,[(0,a.Lk)("h2",null,(0,u.v_)(i.singleProduct.name),1),(0,a.Lk)("div",null,[i.selectedSubProduct?((0,a.uX)(),(0,a.CE)("div",ut,[i.selectedSubProduct.salePrice<i.selectedSubProduct.price?((0,a.uX)(),(0,a.CE)("span",dt,[(0,a.Lk)("span",ct,(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.selectedSubProduct.price),1),(0,a.Lk)("span",pt,(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.selectedSubProduct.salePrice),1)])):((0,a.uX)(),(0,a.CE)("span",ht,(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.selectedSubProduct.price),1))])):((0,a.uX)(),(0,a.CE)("div",yt,[i.singleProduct.salePrice<i.singleProduct.price?((0,a.uX)(),(0,a.CE)("span",mt,[(0,a.Lk)("span",kt,(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.singleProduct.price),1),(0,a.Lk)("span",gt,(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.singleProduct.salePrice),1)])):((0,a.uX)(),(0,a.CE)("span",bt,(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.singleProduct.price),1))]))]),(0,a.Lk)("p",null,(0,u.v_)(i.singleProduct.description),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.variationAttributes,((t,e)=>((0,a.uX)(),(0,a.CE)("div",{key:e},[(0,a.Lk)("h3",null,(0,u.v_)(t.name),1),"text"===t.displayType?((0,a.uX)(),(0,a.CE)("div",vt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.values,((e,o)=>((0,a.uX)(),(0,a.CE)("span",{key:o,onClick:o=>r.selectAttribute(t.code,e.code),class:(0,u.C4)([{"size-selected":i.selectedAttributes[t.code]===e.code},"attribute-option"]),style:{paddingTop:"2px",textAlign:"center"}},(0,u.v_)(e.name),11,Lt)))),128))])):(0,a.Q3)("",!0),"color"===t.displayType?((0,a.uX)(),(0,a.CE)("div",ft,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.values,((e,o)=>((0,a.uX)(),(0,a.CE)("div",{key:o,onClick:o=>r.selectAttribute(t.code,e.code),class:(0,u.C4)([{"size-selected":i.selectedAttributes[t.code]===e.code},"attribute-option rounded-full"]),style:{backgroundColor:"#484848",display:"inline-block",marginBottom:"5px",textAlign:"center"}},[(0,a.Lk)("div",{style:(0,u.Tr)({backgroundColor:e.display,width:"24px",height:"24px",margin:"1px"}),class:"rounded-full"},null,4),(0,a.Lk)("small",wt,(0,u.v_)(e.name),1)],10,Ct)))),128))])):(0,a.Q3)("",!0),"image"===t.displayType?((0,a.uX)(),(0,a.CE)("div",Pt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.values,((e,o)=>((0,a.uX)(),(0,a.CE)("span",{key:o,onClick:o=>r.selectAttribute(t.code,e.code),class:(0,u.C4)([{"size-selected":i.selectedAttributes[t.code]===e.code},"attribute-option"])},[(0,a.Lk)("img",{src:e.code,alt:e.name,style:{width:"30px",height:"30px"}},null,8,_t)],10,St)))),128))])):(0,a.Q3)("",!0)])))),128)),i.selectedSubProduct?((0,a.uX)(),(0,a.CE)("div",Et,[(0,a.Lk)("h4",null,"Selected : "+(0,u.v_)(i.selectedSubProduct.sku),1),(0,a.Lk)("span",null,(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.selectedSubProduct.salePrice),1),(0,a.Lk)("p",null,[e[13]||(e[13]=(0,a.eW)("Availability: ")),(0,a.Lk)("span",{style:(0,u.Tr)({color:i.selectedSubProduct.stock>0?"green":"red"})},(0,u.v_)(i.selectedSubProduct.stock)+" in stock",5)])])):(0,a.Q3)("",!0),r.allAttributesSelected||"variation"!==i.singleProduct.type?((0,a.uX)(),(0,a.CE)("div",xt,["variation"!==i.singleProduct.type?((0,a.uX)(),(0,a.CE)("div",Dt,[(0,a.Lk)("p",null,[e[14]||(e[14]=(0,a.eW)("Availability: ")),(0,a.Lk)("span",{style:(0,u.Tr)({color:i.singleProduct.stock>0?"green":"red"})},(0,u.v_)(i.singleProduct.stock)+" in stock",5)])])):(0,a.Q3)("",!0),i.catalogMode?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",At,[(0,a.Lk)("button",{onClick:e[2]||(e[2]=(...t)=>r.decreaseQuantity&&r.decreaseQuantity(...t)),disabled:i.quantity<=1},"-",8,Tt),(0,a.Lk)("span",null,(0,u.v_)(i.quantity),1),(0,a.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>r.increaseQuantity&&r.increaseQuantity(...t)),disabled:i.quantity>=r.maxQuantity},"+",8,Ut)])),i.catalogMode?i.catalogMode&&i.callMeButton?((0,a.uX)(),(0,a.CE)("button",{key:3,onClick:e[5]||(e[5]=(...t)=>r.contactUs&&r.contactUs(...t))},(0,u.v_)(i.buttonText),1)):(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:2,onClick:e[4]||(e[4]=(...t)=>r.addToCart&&r.addToCart(...t))},"Add to Cart"))])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),e[16]||(e[16]=(0,a.Lk)("div",{id:"cart-respond"},null,-1))]),e[26]||(e[26]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("section",null,[e[18]||(e[18]=(0,a.Lk)("h2",null,"Products",-1)),(0,a.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>r.loadProducts&&r.loadProducts(...t))},"Load Products"),i.products.length?((0,a.uX)(),(0,a.CE)("div",Ft,[e[17]||(e[17]=(0,a.Lk)("h3",null,"Product List",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.products,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.eW)((0,u.v_)(t.name)+" ("+(0,u.v_)(t.sku)+") - "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(t.salePrice)+" - Stock: "+(0,u.v_)(t.stock)+" ",1),i.catalogMode?i.catalogMode&&i.callMeButton?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:e[7]||(e[7]=(...t)=>r.contactUs&&r.contactUs(...t))},(0,u.v_)(i.buttonText),1)):(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e=>r.addToCart(t)},"Add to Cart",8,Vt))])))),128))])])):(0,a.Q3)("",!0)]),e[27]||(e[27]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("section",It,[e[22]||(e[22]=(0,a.Lk)("h2",null,"Cart",-1)),(0,a.Lk)("button",{onClick:e[8]||(e[8]=(...t)=>r.loadCart&&r.loadCart(...t))},"Load Cart"),i.cart.items.products.length||i.cart.items.coupons.length||i.cart.items.fees.length?((0,a.uX)(),(0,a.CE)("div",Xt,[e[19]||(e[19]=(0,a.Lk)("h3",null,"Cart Items",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.cart.items.products,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t.sku,class:"border-b border-gray-300 mb-1 mt-1"},[(0,a.eW)((0,u.v_)(t.name)+" ("+(0,u.v_)(t.sku)+") - "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(t.salePrice)+" x "+(0,u.v_)(t.quantity)+" ",1),(0,a.Lk)("button",{onClick:e=>r.removeFromCart(t.sku,"products")},"Remove",8,Qt),i.catalogMode?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",qt,[(0,a.Lk)("button",{onClick:e=>r.decreaseCartQuantity(t),disabled:t.quantity<=1},"-",8,Mt),(0,a.Lk)("span",null,(0,u.v_)(t.quantity),1),(0,a.Lk)("button",{onClick:e=>r.increaseCartQuantity(t),disabled:t.quantity>=t.stock},"+",8,$t)]))])))),128))]),e[20]||(e[20]=(0,a.Lk)("h3",null,"Applied Coupons",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.cart.items.coupons,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t.code},[(0,a.eW)((0,u.v_)(t.code)+" - "+(0,u.v_)(t.value)+" "+(0,u.v_)("percent"===t.mode?"%":i.currency.symbol)+" ",1),(0,a.Lk)("button",{onClick:e=>r.removeCoupon(t.code)},"Remove Coupon",8,Nt)])))),128))]),e[21]||(e[21]=(0,a.Lk)("h3",null,"Fees",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.cart.items.fees,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t.code},(0,u.v_)(t.code)+" + "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(t.amount),1)))),128))]),(0,a.Lk)("p",null,"Subtotal: "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.subtotal),1),(0,a.Lk)("p",null,"Discount: -"+(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.totalDiscount),1),(0,a.Lk)("p",null,"Total: "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.cartTotal),1),i.catalogMode?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e[9]||(e[9]=(...t)=>r.showCheckout&&r.showCheckout(...t))},"Proceed to Checkout"))])):(0,a.Q3)("",!0)]),e[28]||(e[28]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("section",null,[e[24]||(e[24]=(0,a.Lk)("h2",null,"Apply Coupon",-1)),(0,a.Lk)("div",null,[e[23]||(e[23]=(0,a.Lk)("label",{for:"couponCode"},"Coupon Code:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponCode","onUpdate:modelValue":e[10]||(e[10]=t=>i.couponCode=t),placeholder:"Enter Coupon Code"},null,512),[[d.Jo,i.couponCode]]),(0,a.Lk)("button",{onClick:e[11]||(e[11]=(...t)=>r.applyCoupon&&r.applyCoupon(...t))},"Apply Coupon")])]),i.isCheckoutVisible?((0,a.uX)(),(0,a.Wv)(s,{key:0,cart:i.cart,subtotal:i.subtotal,totalDiscount:i.totalDiscount,cartTotal:i.cartTotal},null,8,["cart","subtotal","totalDiscount","cartTotal"])):(0,a.Q3)("",!0)])}o(23215),o(54520);var Jt=o(92824);const Kt=new ot.A(!1),Gt=s.A.get("configs"),Bt=s.A.get("session"),Wt=async()=>{const t=await Kt.POST("product/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status)return t.data;throw new Error("Failed to fetch products")},Rt=async()=>{const t=await Kt.POST("product_price/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status)return t.data;throw new Error("Failed to fetch prices")},jt=(t,e,o=[])=>{const a=t.categories&&t.categories.length>0?t.categories:o,n=e.find((t=>a.includes(t.category)));if(!n)return t.price;let i=t.price;return"fix"===n.mode?i=n.value:"percent"===n.mode&&(i=t.price-t.price*n.value/100),parseFloat(i.toFixed(2))},Ht=async()=>{const t=await Wt(),e=await Rt();return t.map((t=>(t.salePrice=jt(t,e),t)))},zt=async t=>{if(!t)throw new Error("SKU is null");const e=await Wt(),o=await Rt();for(const a of e){if(a.sku===t)return a.salePrice=jt(a,o),a.subProducts&&a.subProducts.length>0&&(a.subProducts=a.subProducts.map((t=>({...t,salePrice:jt(t,o,a.categories)})))),a;if(a.subProducts&&a.subProducts.length>0)for(const e of a.subProducts)if(e.sku===t)return e.salePrice=jt(e,o,a.categories),e.mainProduct={...a,salePrice:jt(a,o)},e}throw new Error(`Failed to fetch product or sub-product with SKU ${t}`)},Yt=async()=>{try{const t=await Kt.POST("coupon/query",{method:"find",args:[{autoAssign:!0},{unit:Bt.current._id}]},Gt.key);if(200===t.status)return t.data;throw new Error("Failed to fetch auto-assign coupons")}catch(t){throw console.error("Error fetching auto-assign coupons:",t),t}},Zt=async()=>{try{const t=await Kt.POST("product_fee/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status)return t.data;throw new Error("Failed to fetch fees")}catch(t){throw console.error("Error fetching fees:",t),t}},te=async t=>{try{const e=await ce(t);if(!e)throw new Error(`Coupon with code ${t} not found`);let o=await ie();o||(o=await se());const a=o.items.coupons.find((t=>t.code===e.code));if(a)return"Coupon already applied!";let n=0,i=0;for(const t of o.items.products){const e=await zt(t.sku);n+=e.salePrice*t.quantity,i+=t.quantity}if(e.enableSubtotalLimit){if(e.minSubtotal&&n<e.minSubtotal)return`Subtotal must be at least ${e.minSubtotal} to apply this coupon.`;if(e.maxSubtotal&&n>e.maxSubtotal)return`Subtotal must be no more than ${e.maxSubtotal} to apply this coupon.`}if(e.enableQuantityLimit){if(e.minQuantity&&i<e.minQuantity)return`Minimum quantity must be at least ${e.minQuantity} to apply this coupon.`;if(e.maxQuantity&&i>e.maxQuantity)return`Maximum quantity must be no more than ${e.maxQuantity} to apply this coupon.`}o.items.coupons.push(e);const r=await Kt.PUT(`cart/${o._id}`,{data:{...o,_id:void 0}},Gt.key);if(200===r.status)return`Coupon ${t} applied to the cart!`;throw new Error("Failed to apply coupon")}catch(e){throw console.error("Error applying coupon:",e),e}},ee=async t=>{try{let e=await ie();if(!e)throw new Error("Cart not found");const o=e.items.coupons.findIndex((e=>e.code===t));if(-1!==o){e.items.coupons.splice(o,1);const a=await Kt.PUT(`cart/${e._id}`,{data:{...e,_id:void 0}},Gt.key);if(200===a.status)return`Removed coupon ${t} from the cart!`;throw new Error("Failed to remove coupon")}return"Coupon not found in the cart!"}catch(e){throw console.error("Error removing coupon:",e),e}},oe=async t=>{let e=0,o=0,a=0;const n=[],i=[],r=(new Date).toISOString().split("T")[0];for(const u of t.items.products){const t=await zt(u.sku);e+=t.salePrice*u.quantity}for(const u of t.items.coupons){let a=0;if(u.enableDueDate){if(u.startDate&&r<u.startDate)continue;if(u.endDate&&r>u.endDate)continue}if(u.enableSubtotalLimit){if(u.minSubtotal&&e<u.minSubtotal)continue;if(u.maxSubtotal&&e>u.maxSubtotal)continue}if(u.enableQuantityLimit){const e=t.items.products.reduce(((t,e)=>t+e.quantity),0);if(u.minQuantity&&e<u.minQuantity)continue;if(u.maxQuantity&&e>u.maxQuantity)continue}"fix"===u.mode?a=u.value:"percent"===u.mode&&(a=e*u.value/100),u.maxDiscount&&a>u.maxDiscount&&(a=u.maxDiscount),o+=a,n.push({code:u.code,discount:a.toFixed(2)})}const s=await Zt();for(const u of s){let t=null;for(const o of u.conditions)e>=o.total_price&&(!t||o.total_price>t.total_price)&&(t=o);if(t){const o="fix"===t.mode?t.fee_value:e*t.fee_value/100;a+=o,i.push({code:u.code,amount:o.toFixed(2)})}}const l=(e-o+a).toFixed(2);return{subtotal:e.toFixed(2),totalDiscount:o.toFixed(2),totalFees:a.toFixed(2),cartTotal:l,couponDiscounts:n,feeDetails:i}},ae=async t=>{let e=0,o=0;const a=[];for(const n of t){const t=await zt(n.sku);e+=t.salePrice*n.quantity,o+=n.quantity,a.push({...n,price:t.price,salePrice:t.salePrice})}return{subtotal:e,totalQuantity:o,updatedProducts:a}},ne=async()=>{try{let t=await ie();if(t._id||(t=await se()),!t||!t._id)throw new Error("Failed to load or create a valid cart.");const{subtotal:e,totalQuantity:o,updatedProducts:a}=await ae(t.items.products);t.items.products=a;const n=await Yt();for(const s of n){if(s.enableSubtotalLimit){if(s.minSubtotal&&e<s.minSubtotal)continue;if(s.maxSubtotal&&e>s.maxSubtotal)continue}if(s.enableQuantityLimit){if(s.minQuantity&&o<s.minQuantity)continue;if(s.maxQuantity&&o>s.maxQuantity)continue}const a=t.items.coupons.find((t=>t.code===s.code));a||t.items.coupons.push(s)}const i=await Zt();t.items.fees=[];for(const s of i){let o=null;for(const t of s.conditions)e>=t.total_price&&(!o||t.total_price>o.total_price)&&(o=t);o&&t.items.fees.push({code:s.code,type:s.type,amount:"fix"===o.mode?o.fee_value:e*o.fee_value/100})}const r=await Kt.PUT(`cart/${t._id}`,{data:{...t,_id:void 0}},Gt.key);if(200!==r.status)throw new Error("Failed to update the cart.");return t}catch(t){throw console.error("Error in loadCart:",t),t}},ie=async()=>{const t=await Kt.POST("cart/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status&&t.data.length>0){const e=t.data[0];return e.items=e.items||{products:[],coupons:[],fees:[]},e}return{items:{products:[],coupons:[],fees:[]}}},re=async()=>await ne(),se=async()=>{try{const t={items:{products:[],coupons:[],fees:[]},unit:Bt.current._id},e=await Kt.POST("cart/",{data:t},Gt.key);if(200===e.status)return e.data;throw new Error("Failed to create cart")}catch(t){throw console.error("Error in createCart:",t),t}},le=async(t,e,o,a,n="products")=>{try{let i=await re();i||(i=await se());const r=i.items[n].find((e=>e.productId===a&&e.sku===t));if(r){const t=r.quantity+e;if(t>o&&"products"===n)return"Quantity exceeds available stock!";r.quantity=t}else{if(e>o&&"products"===n)return"Quantity exceeds available stock!";const r={sku:t,quantity:e,type:n,unit:Bt.current._id,productId:a};i.items[n].push(r)}const s=await Kt.PUT(`cart/${i._id}`,{data:{...i,_id:void 0}},Gt.key);if(200===s.status)return`Added ${e} item(s) to the cart!`;throw new Error("Failed to add cart item")}catch(i){throw console.error("Error adding to cart:",i),i}},ue=async(t,e,o="products")=>{try{let a=await re();if(!a)throw new Error("Cart not found");const n=a.items[o].find((e=>e.sku===t));if(!n)throw new Error("Item not found in the cart");const i=await zt(t);if(e>i.stock)return`Maximum available stock is ${i.stock}.`;n.quantity=e,n.quantity<1&&(a.items[o]=a.items[o].filter((e=>e.sku!==t)));const r=await Kt.PUT(`cart/${a._id}`,{data:{...a,_id:void 0}},Gt.key);if(200===r.status)return`Updated quantity to ${e}`;throw new Error("Failed to update cart item quantity")}catch(a){throw console.error("Error updating cart item quantity:",a),a}},de=async(t,e="products")=>{try{let o=await re();if(!o)throw new Error("Cart not found");const a=o.items[e].findIndex((e=>e.sku===t));if(-1!==a){o.items[e].splice(a,1);const t=await Kt.PUT(`cart/${o._id}`,{data:{...o,_id:void 0}},Gt.key);if(200===t.status)return"Removed item(s) from the cart!";throw new Error("Failed to remove cart item")}return"Item not found in the cart!"}catch(o){throw console.error("Error removing from cart:",o),o}},ce=async t=>{try{const e=await Kt.POST("coupon/query",{method:"find",args:[{code:t},{unit:Bt.current._id}]},Gt.key);if(200===e.status&&e.data.length>0)return e.data[0];throw new Error(`Failed to fetch coupon with code ${t}`)}catch(e){throw console.error("Error fetching coupon:",e),e}},pe=async()=>{try{const t=await Kt.POST("store_payment/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status)return t.data;throw new Error("Failed to fetch payment gateways")}catch(t){throw console.error("Error fetching payment gateways:",t),t}},he=async t=>{try{const e=await Kt.GET(`flow/${t}`,Gt.key,!0);if(200===e.status)return e.data;throw new Error("Failed to fetch flow by ID")}catch(e){throw console.error("Error fetching flow by ID:",e),e}},ye=async()=>{try{const t=await Kt.POST("shop_config/query",{method:"find",args:[{unit:Bt.current._id||Gt.siteID}]},Gt.key);if(200===t.status&&t.data.length>0)return t.data[0];throw new Error("Failed to load configuration")}catch(t){throw console.error("Error loading configuration:",t),t}},me=async(t,e)=>{try{const o=await ye(),a=o.action_flow[t];if(!a)throw new Error(`No flow found for action key: ${t}`);const n=await he(a),i=new Jt.A(n.steps);await i.run(e)}catch(o){throw console.error("Error executing flow:",o),o}},ke=async t=>{try{const e=await ve(),o={unit:Bt.current._id,billingAddress:t.billingAddress,shippingAddress:t.shippingAddress,paymentMethod:t.paymentMethod,requestFullTaxBill:t.requestFullTaxBill,requestGiftWrap:t.requestGiftWrap,giftMessage:t.giftMessage,status:t.status,code:e,discount:t.discount,fee:t.fee,subtotal:t.subtotal,total:t.total},a=await Kt.POST("shop_orders",{data:o},Gt.key);if(200===a.status)return a.data;throw new Error("Failed to create order")}catch(e){throw console.error("Error creating order:",e),e}},ge=async(t,e)=>{try{const o={unit:Bt.current._id,billingAddress:e.billingAddress,shippingAddress:e.shippingAddress,paymentMethod:e.paymentMethod,requestFullTaxBill:e.requestFullTaxBill,requestGiftWrap:e.requestGiftWrap,giftMessage:e.giftMessage,items:e.cart.items.products,discounts:e.cart.items.coupons,status:e.status,ordersId:t._id,code:t.code,discount:e.discount,fee:e.fee,subtotal:e.subtotal,total:e.total},a=await Kt.POST("shop_order",{data:o},Gt.key);if(200===a.status)return a.data;throw new Error("Failed to create order summary")}catch(o){throw console.error("Error creating order summary:",o),o}},be=async t=>{try{const e=await Kt.GET(`shop_order_status/${t}`,Gt.key,!0);if(200===e.status)return e.data;throw new Error("Failed to fetch default order status")}catch(e){throw console.error("Error fetching default order status:",e),e}},ve=async(t=null)=>{if(!t){const e=await Kt.POST("shop_config/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(!(200===e.status&&e.data.length>0))throw new Error("Failed to fetch configuration");t=e.data[0].custom_order_code,t._id=e.data[0]._id}"undefined"===typeof t.order_code_index&&(t.order_code_index=0);const e=t.order_code_index,o=new Date;let a="",n=t.autoNumber+e;for(const r of t.groups)if("text"===r.type)a+=r.value.padEnd(r.digits," ");else if("year"===r.type){const t="4"===r.format?o.getFullYear().toString():o.getFullYear().toString().slice(-2);a+=t}else"month"===r.type?a+=("0"+(o.getMonth()+1)).slice(-2):"auto"===r.type&&(a+=n.toString().padStart(r.digits,"0"));t.order_code_index+=1;try{await Kt.PUT(`shop_config/${t._id}`,{data:{custom_order_code:t,_id:void 0}},Gt.key)}catch(i){console.error("Error updating order_code_index:",i)}return a},Le=async()=>{try{const t=await Kt.POST("shop_config/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status&&t.data.length>0&&t.data[0].currency){const{name:e,code:o,symbol:a}=t.data[0].currency;return{name:e,code:o,symbol:a}}throw new Error("Failed to fetch currency configuration")}catch(t){throw console.error("Error fetching currency configuration:",t),t}},fe=async()=>{try{const t=await Kt.POST("shop_config/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status&&t.data.length>0){const{catalog_mode:e,call_me_button:o,button_text:a,contact_method:n}=t.data[0];return{catalog_mode:e,call_me_button:o,button_text:a,contact_method:n}}throw new Error("Failed to fetch catalog mode configuration")}catch(t){throw console.error("Error fetching catalog mode configuration:",t),t}},Ce=async()=>{const t=await Kt.POST("inventory/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status)return t.data;throw new Error("Failed to fetch inventories")},we=async()=>{const t=await Kt.POST("product_category/query",{method:"find",args:[{unit:Bt.current._id}]},Gt.key);if(200===t.status)return t.data;throw new Error("Failed to fetch categories")},Pe={class:"checkout-form"},Se={class:"section"},_e={class:"section"},Ee={class:"section"},xe={class:"border border-gray-400 mb-2"},De={class:"border border-gray-400 mb-2"},Ae={class:"border border-gray-400 mb-2"},Te={class:"section"},Ue=["value"],Fe={class:"section"},Ve={key:0};function Ie(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",Pe,[e[35]||(e[35]=(0,a.Lk)("h2",null,"Checkout",-1)),(0,a.Lk)("form",{onSubmit:e[22]||(e[22]=(0,d.D$)(((...t)=>r.completeOrder&&r.completeOrder(...t)),["prevent"]))},[(0,a.Lk)("div",Se,[e[24]||(e[24]=(0,a.Lk)("h3",null,"Billing Address",-1)),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[0]||(e[0]=t=>i.billingAddress.firstName=t),placeholder:"First Name",required:""},null,512),[[d.Jo,i.billingAddress.firstName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[1]||(e[1]=t=>i.billingAddress.lastName=t),placeholder:"Last Name",required:""},null,512),[[d.Jo,i.billingAddress.lastName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[2]||(e[2]=t=>i.billingAddress.email=t),placeholder:"Email",required:""},null,512),[[d.Jo,i.billingAddress.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[3]||(e[3]=t=>i.billingAddress.phone=t),placeholder:"Phone",required:""},null,512),[[d.Jo,i.billingAddress.phone]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[4]||(e[4]=t=>i.billingAddress.address=t),placeholder:"Address",required:""},null,512),[[d.Jo,i.billingAddress.address]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[5]||(e[5]=t=>i.billingAddress.city=t),placeholder:"City",required:""},null,512),[[d.Jo,i.billingAddress.city]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[6]||(e[6]=t=>i.billingAddress.state=t),placeholder:"State",required:""},null,512),[[d.Jo,i.billingAddress.state]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[7]||(e[7]=t=>i.billingAddress.zip=t),placeholder:"Zip",required:""},null,512),[[d.Jo,i.billingAddress.zip]]),i.requestFullTaxBill?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:0,"onUpdate:modelValue":e[8]||(e[8]=t=>i.billingAddress.taxId=t),placeholder:"Tax ID"},null,512)),[[d.Jo,i.billingAddress.taxId]]):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",id:"requestTaxBill","onUpdate:modelValue":e[9]||(e[9]=t=>i.requestFullTaxBill=t)},null,512),[[d.lH,i.requestFullTaxBill]]),e[23]||(e[23]=(0,a.Lk)("label",{for:"requestTaxBill"},"Request Full Tax Bill",-1))])]),(0,a.Lk)("div",_e,[e[25]||(e[25]=(0,a.Lk)("h3",null,"Shipping Address",-1)),(0,a.Lk)("button",{type:"button",onClick:e[10]||(e[10]=(...t)=>r.useBillingAddress&&r.useBillingAddress(...t))},"Use Billing Address"),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[11]||(e[11]=t=>i.shippingAddress.firstName=t),placeholder:"First Name",required:""},null,512),[[d.Jo,i.shippingAddress.firstName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[12]||(e[12]=t=>i.shippingAddress.lastName=t),placeholder:"Last Name",required:""},null,512),[[d.Jo,i.shippingAddress.lastName]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[13]||(e[13]=t=>i.shippingAddress.email=t),placeholder:"Email",required:""},null,512),[[d.Jo,i.shippingAddress.email]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[14]||(e[14]=t=>i.shippingAddress.phone=t),placeholder:"Phone",required:""},null,512),[[d.Jo,i.shippingAddress.phone]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[15]||(e[15]=t=>i.shippingAddress.address=t),placeholder:"Address",required:""},null,512),[[d.Jo,i.shippingAddress.address]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[16]||(e[16]=t=>i.shippingAddress.city=t),placeholder:"City",required:""},null,512),[[d.Jo,i.shippingAddress.city]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[17]||(e[17]=t=>i.shippingAddress.state=t),placeholder:"State",required:""},null,512),[[d.Jo,i.shippingAddress.state]]),(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":e[18]||(e[18]=t=>i.shippingAddress.zip=t),placeholder:"Zip",required:""},null,512),[[d.Jo,i.shippingAddress.zip]])]),(0,a.Lk)("div",Ee,[(0,a.Lk)("div",xe,[e[26]||(e[26]=(0,a.Lk)("h3",null,"Cart Details",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.cart.items.products,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t.sku},(0,u.v_)(t.name)+" ("+(0,u.v_)(t.sku)+") - "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(t.salePrice)+" x "+(0,u.v_)(t.quantity),1)))),128))])]),(0,a.Lk)("div",De,[e[27]||(e[27]=(0,a.Lk)("h4",null,"Coupons",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.couponDiscounts,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t.code}," Coupon: "+(0,u.v_)(t.code)+" : (-"+(0,u.v_)(i.currency.symbol)+(0,u.v_)(t.discount)+") ",1)))),128))])]),(0,a.Lk)("div",Ae,[e[28]||(e[28]=(0,a.Lk)("h4",null,"Fees",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(o.cart.items.fees,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t.code}," Fee: "+(0,u.v_)(t.code)+" : "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(t.amount),1)))),128))])]),(0,a.Lk)("p",null,"Subtotal: "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.localSubtotal),1),(0,a.Lk)("p",null,"Fees: "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.localFeeTotal),1),(0,a.Lk)("p",null,"Discount: -"+(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.localTotalDiscount),1),(0,a.Lk)("p",null,"Total: "+(0,u.v_)(i.currency.symbol)+(0,u.v_)(i.localCartTotal),1)]),(0,a.Lk)("div",Te,[e[30]||(e[30]=(0,a.Lk)("h3",null,"Payment Gateway",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e[19]||(e[19]=t=>i.paymentMethod=t),required:""},[e[29]||(e[29]=(0,a.Lk)("option",{value:"",disabled:""},"Select Payment Gateway",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.paymentGateways,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t.code,value:t.code},(0,u.v_)(t.name),9,Ue)))),128))],512),[[d.u1,i.paymentMethod]])]),(0,a.Lk)("div",Fe,[e[32]||(e[32]=(0,a.Lk)("h3",null,"Gift Options",-1)),(0,a.Lk)("div",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox",id:"requestGiftWrap","onUpdate:modelValue":e[20]||(e[20]=t=>i.requestGiftWrap=t)},null,512),[[d.lH,i.requestGiftWrap]]),e[31]||(e[31]=(0,a.Lk)("label",{for:"requestGiftWrap"},"Request Gift Wrap",-1))]),i.requestGiftWrap?((0,a.uX)(),(0,a.CE)("div",Ve,[(0,a.bo)((0,a.Lk)("textarea",{"onUpdate:modelValue":e[21]||(e[21]=t=>i.giftMessage=t),placeholder:"Enter gift greeting message"},null,512),[[d.Jo,i.giftMessage]])])):(0,a.Q3)("",!0)]),e[33]||(e[33]=(0,a.Lk)("div",{id:"checkout-respond"},null,-1)),e[34]||(e[34]=(0,a.Lk)("button",{type:"submit"},"Complete Order",-1))],32)])}var Xe={props:{cart:{type:Object,required:!0},subtotal:{type:Number,required:!0},totalDiscount:{type:Number,required:!0},cartTotal:{type:Number,required:!0}},data(){return{billingAddress:{firstName:"",lastName:"",email:"",phone:"",address:"",city:"",state:"",zip:"",taxId:""},shippingAddress:{firstName:"",lastName:"",email:"",phone:"",address:"",city:"",state:"",zip:""},paymentMethod:"",requestFullTaxBill:!1,requestGiftWrap:!1,giftMessage:"",paymentGateways:[],couponDiscounts:[],localSubtotal:this.subtotal,localTotalDiscount:this.totalDiscount,localFeeTotal:0,localCartTotal:this.cartTotal,orderStatus:null,currency:{name:"",code:"",symbol:""}}},async mounted(){try{this.currency=await Le(),await this.fetchPaymentGateways(),await this.calculateCartDetails()}catch(t){console.error("Error fetching currency configuration:",t)}},watch:{paymentMethod(t){console.log("Selected payment method:",t);const e=this.paymentGateways.find((e=>e.code===t));console.log("Selected payment gateway data:",e),e&&this.updateDefaultOrderStatus(e.defaultOrderStatus)}},methods:{async fetchPaymentGateways(){try{this.paymentGateways=await pe()}catch(t){console.error("Error fetching payment gateways:",t)}},useBillingAddress(){this.shippingAddress={...this.billingAddress},delete this.shippingAddress.taxId},async calculateCartDetails(){const{subtotal:t,totalDiscount:e,cartTotal:o,couponDiscounts:a}=await oe(this.cart);this.localSubtotal=t,this.localTotalDiscount=e,this.localCartTotal=o,this.couponDiscounts=a,this.localFeeTotal=this.cart.items.fees.reduce(((t,e)=>t+parseFloat(e.amount)),0).toFixed(2)},async updateDefaultOrderStatus(t){try{const e=await be(t);e&&e._id&&(this.orderStatus=e.code)}catch(e){console.error("Error fetching default order status:",e)}},async completeOrder(){try{const e={billingAddress:this.billingAddress,shippingAddress:this.shippingAddress,cart:this.cart,paymentMethod:this.paymentMethod,requestFullTaxBill:this.requestFullTaxBill,requestGiftWrap:this.requestGiftWrap,giftMessage:this.giftMessage,status:this.orderStatus,discount:this.localTotalDiscount,fee:this.localFeeTotal,subtotal:this.localSubtotal,total:this.localCartTotal},o=await ke(e);await ge(o,e),await me("before_checkout",e);const a=e.cart.items.products;let n="out";for(const i of a){const{sku:e,quantity:o}=i;try{await me("stock_movement",{sku:e,quantity:o,mode:n})}catch(t){console.error(`Error processing stock out for ${e}:`,t)}}await me("after_checkout",e)}catch(t){console.error("Error completing order:",t),alert("Failed to complete order")}}}};const Qe=(0,it.A)(Xe,[["render",Ie],["__scopeId","data-v-49e6275c"]]);var qe=Qe,Me={data(){return{products:[],cart:{items:{products:[],coupons:[],fees:[]}},productSku:"",singleProduct:null,couponCode:"",subtotal:0,totalDiscount:0,cartTotal:0,variationAttributes:[],selectedAttributes:{},selectedSubProduct:null,quantity:1,isCheckoutVisible:!1,currency:null,catalogMode:!1,callMeButton:!1,buttonText:""}},components:{CheckoutForm:qe},computed:{maxQuantity(){return this.selectedSubProduct?this.selectedSubProduct.stock:this.singleProduct?this.singleProduct.stock:1},allAttributesSelected(){return this.variationAttributes.every((t=>this.selectedAttributes[t.code]))}},watch:{selectedAttributes:{deep:!0,handler(){this.updateSelectedSubProduct()}}},async mounted(){try{this.currency=await Le();const t=await fe();this.catalogMode=t.catalog_mode,this.callMeButton=t.call_me_button,this.buttonText=t.button_text,this.loadCart()}catch(t){console.error("Error fetching configuration:",t)}},methods:{showCheckout(){this.isCheckoutVisible=!0},async loadProducts(){try{this.products=await Ht()}catch(t){console.error("Error loading products:",t)}},async loadProductBySku(){try{this.singleProduct=await zt(this.productSku),this.variationAttributes=this.singleProduct.variationAttributes||[],this.selectedAttributes={},this.updatePriceRange()}catch(t){console.error("Error loading product by SKU:",t)}},selectAttribute(t,e){this.selectedAttributes={...this.selectedAttributes,[t]:e}},updateSelectedSubProduct(){if(this.allAttributesSelected){const t=this.selectedAttributes;this.selectedSubProduct=this.singleProduct.subProducts.find((e=>Object.keys(t).every((o=>e.attributes[o]===t[o]))))||null}else this.selectedSubProduct=null},updatePriceRange(){if(this.singleProduct.subProducts&&this.singleProduct.subProducts.length>0){const t=this.singleProduct.subProducts.map((t=>t.salePrice)),e=Math.min(...t),o=Math.max(...t);this.singleProduct.salePriceRange=e===o?`${this.currency.symbol}${e}.00`:`${this.currency.symbol}${e}.00 - ${this.currency.symbol}${o}.00`}else{const t=this.singleProduct.salePrice,e=this.singleProduct.salePrice;this.singleProduct.salePriceRange=t===e?`${this.currency.symbol}${t}.00`:`${this.currency.symbol}${t}.00 - ${this.currency.symbol}${e}.00`}},async addToCart(t){try{const e=this.selectedSubProduct||this.singleProduct||t,o=this.selectedSubProduct?this.singleProduct._id:e._id,a=await le(e.sku,this.quantity,e.stock,o);console.log(a),await this.loadCart();const n={...e,quantity:this.quantity};await me("add_to_cart",n)}catch(e){console.error("Error adding to cart:",e)}},async loadCart(){try{let t=await re();t||(t={items:{products:[],coupons:[],fees:[]}}),this.cart={items:{products:t.items.products.map((t=>({...t,productId:t.productId||t._id}))),coupons:t.items.coupons||[],fees:t.items.fees||[]}},await this.calculateCartTotal()}catch(t){console.error("Error loading cart:",t)}},async updateQuantity(t,e,o){try{const a=await zt(t);let n=a.stock;e>n&&(alert(`Quantity exceeds available stock! Maximum available stock is ${n}.`),e=n);const i=await ue(t,e,o);console.log(i),await this.loadCart()}catch(a){console.error("Error updating quantity:",a)}},async increaseQuantity(){this.quantity<this.maxQuantity&&(this.quantity+=1)},async decreaseQuantity(){this.quantity>1&&(this.quantity-=1)},async increaseCartQuantity(t){console.log("increaseCartQuantity",t);const e=await zt(t.sku);t.quantity<e.stock&&await this.updateQuantity(t.sku,t.quantity+1,"products")},async decreaseCartQuantity(t){t.quantity>1&&await this.updateQuantity(t.sku,t.quantity-1,"products")},async removeFromCart(t,e){try{const o=await de(t,e);console.log(o),await this.loadCart()}catch(o){console.error("Error removing from cart:",o)}},async applyCoupon(){try{const t=await te(this.couponCode);console.log(t),await this.loadCart()}catch(t){console.error("Error applying coupon:",t)}},async removeCoupon(t){try{const e=await ee(t);console.log(e),await this.loadCart()}catch(e){console.error("Error removing coupon:",e)}},async calculateCartTotal(){const{subtotal:t,totalDiscount:e,cartTotal:o}=await oe(this.cart);this.subtotal=t,this.totalDiscount=e,this.cartTotal=o},contactUs(){const t=this.contactMethod;"lineid"===t?window.location.href=`https://line.me/R/ti/p/${this.buttonText}`:"contactform"===t||"email"===t&&(window.location.href=`mailto:${this.buttonText}`)}}};const $e=(0,it.A)(Me,[["render",Ot],["__scopeId","data-v-7382948c"]]);var Ne=$e;const Oe=["onClick"],Je=["onClick"],Ke={key:0},Ge=["onClick"],Be={key:0};function We(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[17]||(e[17]=(0,a.Lk)("h1",null,"Inventory Manager",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.fetchInventories&&r.fetchInventories(...t))},"Load Inventories"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.inventoryList,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.Lk)("span",null,(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") - Location: "+(0,u.v_)(t.location),1),(0,a.Lk)("button",{onClick:e=>r.prepareEditInventory(t)},"Update",8,Oe),(0,a.Lk)("button",{onClick:o=>r.removeInventory(t._id,e)},"Delete",8,Je),t.products&&t.products.length?((0,a.uX)(),(0,a.CE)("ul",Ke,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.products,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{key:e._id},[(0,a.Lk)("span",null,(0,u.v_)(o)+" "+(0,u.v_)(e.name)+" ("+(0,u.v_)(e.sku)+") - $"+(0,u.v_)(e.price)+" - "+(0,u.v_)(e.stock)+" in stock - "+(0,u.v_)(e.status)+" - "+(0,u.v_)(e.type),1),(0,a.Lk)("button",{onClick:a=>r.removeProductFromInventory(t._id,e._id,o)},"Remove Product",8,Ge)])))),128))])):(0,a.Q3)("",!0)])))),128))]),i.showInventoryConfig?((0,a.uX)(),(0,a.CE)("div",Be,[e[9]||(e[9]=(0,a.Lk)("h2",null,"Edit Inventory",-1)),e[10]||(e[10]=(0,a.Lk)("label",{for:"inventoryName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"inventoryName","onUpdate:modelValue":e[1]||(e[1]=t=>i.inventoryData.name=t),placeholder:"Name"},null,512),[[d.Jo,i.inventoryData.name]]),e[11]||(e[11]=(0,a.Lk)("label",{for:"inventoryCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"inventoryCode","onUpdate:modelValue":e[2]||(e[2]=t=>i.inventoryData.code=t),placeholder:"Code"},null,512),[[d.Jo,i.inventoryData.code]]),e[12]||(e[12]=(0,a.Lk)("label",{for:"inventoryLocation"},"Location",-1)),(0,a.bo)((0,a.Lk)("input",{id:"inventoryLocation","onUpdate:modelValue":e[3]||(e[3]=t=>i.inventoryData.location=t),placeholder:"Location"},null,512),[[d.Jo,i.inventoryData.location]]),(0,a.Lk)("button",{onClick:e[4]||(e[4]=(...t)=>r.updateInventory&&r.updateInventory(...t))},"Save Changes")])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[e[13]||(e[13]=(0,a.Lk)("h2",null,"Add Inventory",-1)),e[14]||(e[14]=(0,a.Lk)("label",{for:"newInventoryName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newInventoryName","onUpdate:modelValue":e[5]||(e[5]=t=>i.newInventory.name=t),placeholder:"Name"},null,512),[[d.Jo,i.newInventory.name]]),e[15]||(e[15]=(0,a.Lk)("label",{for:"newInventoryCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newInventoryCode","onUpdate:modelValue":e[6]||(e[6]=t=>i.newInventory.code=t),placeholder:"Code"},null,512),[[d.Jo,i.newInventory.code]]),e[16]||(e[16]=(0,a.Lk)("label",{for:"newInventoryLocation"},"Location",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newInventoryLocation","onUpdate:modelValue":e[7]||(e[7]=t=>i.newInventory.location=t),placeholder:"Location"},null,512),[[d.Jo,i.newInventory.location]]),(0,a.Lk)("button",{onClick:e[8]||(e[8]=(...t)=>r.addInventory&&r.addInventory(...t))},"Add Inventory")])])}const Re=new ot.A(!1);var je={data(){return{inventoryList:[],inventoryData:{_id:"",name:"",code:"",location:""},newInventory:{name:"",code:"",location:""},showInventoryConfig:!1,configs:s.A.get("configs"),session:s.A.get("session")}},methods:{async fetchInventories(){try{const t=await Re.POST("inventory/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.inventoryList=t.data,await this.loadProductsForInventories())}catch(t){console.error("Error fetching inventories:",t)}},async loadProductsForInventories(){try{const t=await Promise.all(this.inventoryList.map((async t=>{const e=await Re.POST("product/query",{method:"find",args:[{$and:[{inventoryId:t._id}]}]},this.configs.key);return 200===e.status?{...t,products:e.data}:t})));this.inventoryList=t}catch(t){console.error("Error loading products for inventories:",t)}},prepareEditInventory(t){this.inventoryData={...t},this.showInventoryConfig=!0},async updateInventory(){try{const t=await Re.PUT(`inventory/${this.inventoryData._id}`,{data:{...this.inventoryData,_id:void 0}},this.configs.key);200===t.status&&(await this.fetchInventories(),this.showInventoryConfig=!1,this.resetInventoryData())}catch(t){console.error("Error updating inventory:",t)}},async removeInventory(t,e){try{const o=this.inventoryList.find((e=>e._id===t));if(o&&o.products&&o.products.length>0)return void alert("Cannot delete inventory because it has products assigned.");const a=await Re.DELETE(`inventory/${t}`,"",this.configs.key);200===a.status&&this.inventoryList.splice(e,1)}catch(o){console.error("Error deleting inventory:",o)}},async addInventory(){try{const t=await Re.POST("inventory/",{data:{...this.newInventory,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(this.inventoryList.push(t.data),this.resetNewInventory())}catch(t){console.error("Error adding inventory:",t)}},async removeProductFromInventory(t,e,o){try{const e=this.inventoryList.find((e=>e._id===t));if(e){e.products.splice(o,1);const a=await Re.PUT(`inventory/${t}`,{data:{products:e.products}},this.configs.key);200===a.status&&await this.fetchInventories()}}catch(a){console.error("Error removing product from inventory:",a)}},resetNewInventory(){this.newInventory={name:"",code:"",location:""}},resetInventoryData(){this.inventoryData={_id:"",name:"",code:"",location:""}}},async mounted(){await this.fetchInventories()}};const He=(0,it.A)(je,[["render",We]]);var ze=He;const Ye=["onClick"],Ze=["onClick"],to={key:0},eo=["onClick"],oo=["onClick"],ao={key:0},no=["value"],io=["value"];function ro(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[19]||(e[19]=(0,a.Lk)("h1",null,"Category Manager",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.fetchCategories&&r.fetchCategories(...t))},"Load Categories"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.nestedCategoryList,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.Lk)("span",null,(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") - Parent: "+(0,u.v_)(r.getCategoryName(t.parent)),1),(0,a.Lk)("button",{onClick:e=>r.prepareEditCategory(t)},"Update",8,Ye),(0,a.Lk)("button",{onClick:o=>r.removeCategory(t._id,e)},"Delete",8,Ze),t.subCategories&&t.subCategories.length?((0,a.uX)(),(0,a.CE)("ul",to,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.subCategories,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.Lk)("span",null,(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+")",1),(0,a.Lk)("button",{onClick:e=>r.prepareEditCategory(t)},"Update",8,eo),(0,a.Lk)("button",{onClick:o=>r.removeCategory(t._id,e)},"Delete",8,oo)])))),128))])):(0,a.Q3)("",!0)])))),128))]),i.showCategoryConfig?((0,a.uX)(),(0,a.CE)("div",ao,[e[10]||(e[10]=(0,a.Lk)("h2",null,"Edit Category",-1)),e[11]||(e[11]=(0,a.Lk)("label",{for:"categoryName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"categoryName","onUpdate:modelValue":e[1]||(e[1]=t=>i.categoryData.name=t),placeholder:"Name"},null,512),[[d.Jo,i.categoryData.name]]),e[12]||(e[12]=(0,a.Lk)("label",{for:"categoryCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"categoryCode","onUpdate:modelValue":e[2]||(e[2]=t=>i.categoryData.code=t),placeholder:"Code"},null,512),[[d.Jo,i.categoryData.code]]),e[13]||(e[13]=(0,a.Lk)("label",{for:"categoryParent"},"Parent",-1)),(0,a.bo)((0,a.Lk)("select",{id:"categoryParent","onUpdate:modelValue":e[3]||(e[3]=t=>i.categoryData.parent=t)},[e[9]||(e[9]=(0,a.Lk)("option",{value:""},"None",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.categoryList,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t._id,value:t._id},(0,u.v_)(t.name),9,no)))),128))],512),[[d.u1,i.categoryData.parent]]),(0,a.Lk)("button",{onClick:e[4]||(e[4]=(...t)=>r.updateCategory&&r.updateCategory(...t))},"Save Changes")])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[e[15]||(e[15]=(0,a.Lk)("h2",null,"Add Category",-1)),e[16]||(e[16]=(0,a.Lk)("label",{for:"newCategoryName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCategoryName","onUpdate:modelValue":e[5]||(e[5]=t=>i.newCategory.name=t),placeholder:"Name"},null,512),[[d.Jo,i.newCategory.name]]),e[17]||(e[17]=(0,a.Lk)("label",{for:"newCategoryCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCategoryCode","onUpdate:modelValue":e[6]||(e[6]=t=>i.newCategory.code=t),placeholder:"Code"},null,512),[[d.Jo,i.newCategory.code]]),e[18]||(e[18]=(0,a.Lk)("label",{for:"newCategoryParent"},"Parent",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newCategoryParent","onUpdate:modelValue":e[7]||(e[7]=t=>i.newCategory.parent=t)},[e[14]||(e[14]=(0,a.Lk)("option",{value:""},"None",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.categoryList,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t._id,value:t._id},(0,u.v_)(t.name),9,io)))),128))],512),[[d.u1,i.newCategory.parent]]),(0,a.Lk)("button",{onClick:e[8]||(e[8]=(...t)=>r.addCategory&&r.addCategory(...t))},"Add Category")])])}const so=new ot.A(!1);var lo={data(){return{categoryList:[],nestedCategoryList:[],categoryData:{_id:"",name:"",code:"",parent:""},newCategory:{name:"",code:"",parent:""},showCategoryConfig:!1,configs:s.A.get("configs"),session:s.A.get("session")}},methods:{async fetchCategories(){try{const t=await so.POST("product_category/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.categoryList=t.data,this.nestedCategoryList=this.createNestedCategoryList(this.categoryList))}catch(t){console.error("Error fetching categories:",t)}},createNestedCategoryList(t){const e={};t.forEach((t=>{e[t._id]={...t,subCategories:[]}}));const o=[];return t.forEach((t=>{t.parent?e[t.parent]&&e[t.parent].subCategories.push(e[t._id]):o.push(e[t._id])})),o},prepareEditCategory(t){this.categoryData={...t},this.showCategoryConfig=!0},async updateCategory(){try{const t=await so.PUT(`product_category/${this.categoryData._id}`,{data:{...this.categoryData,_id:void 0}},this.configs.key);200===t.status&&(await this.fetchCategories(),this.showCategoryConfig=!1,this.resetCategoryData())}catch(t){console.error("Error updating category:",t)}},async removeCategory(t){try{const e=await so.DELETE(`product_category/${t}`,"",this.configs.key);200===e.status&&this.fetchCategories()}catch(e){console.error("Error deleting category:",e)}},async addCategory(){try{const t=await so.POST("product_category/",{data:{...this.newCategory,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(await this.fetchCategories(),this.resetNewCategory())}catch(t){console.error("Error adding category:",t)}},resetNewCategory(){this.newCategory={name:"",code:"",parent:""}},resetCategoryData(){this.categoryData={_id:"",name:"",code:"",parent:""}},getCategoryName(t){const e=this.categoryList.find((e=>e._id===t));return e?e.name:"None"}},async mounted(){await this.fetchCategories()}};const uo=(0,it.A)(lo,[["render",ro]]);var co=uo;const po=["onClick"],ho=["onClick"],yo={key:0},mo=["value"],ko=["value"];function go(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[41]||(e[41]=(0,a.Lk)("h1",null,"Price Manager",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.fetchPrices&&r.fetchPrices(...t))},"Load Prices"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.priceList,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.Lk)("span",null,(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") - Category: "+(0,u.v_)(r.getCategoryName(t.category))+" - Type: "+(0,u.v_)(t.type)+" - Mode: "+(0,u.v_)(t.mode)+" - Period: "+(0,u.v_)(t.period.start)+" to "+(0,u.v_)(t.period.end)+" - Value: "+(0,u.v_)(t.value),1),(0,a.Lk)("button",{onClick:e=>r.prepareEditPrice(t)},"Update",8,po),(0,a.Lk)("button",{onClick:o=>r.removePrice(t._id,e)},"Delete",8,ho)])))),128))]),i.showPriceConfig?((0,a.uX)(),(0,a.CE)("div",yo,[e[21]||(e[21]=(0,a.Lk)("h2",null,"Edit Price",-1)),e[22]||(e[22]=(0,a.Lk)("label",{for:"priceName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"priceName","onUpdate:modelValue":e[1]||(e[1]=t=>i.priceData.name=t),placeholder:"Name"},null,512),[[d.Jo,i.priceData.name]]),e[23]||(e[23]=(0,a.Lk)("label",{for:"priceCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"priceCode","onUpdate:modelValue":e[2]||(e[2]=t=>i.priceData.code=t),placeholder:"Code"},null,512),[[d.Jo,i.priceData.code]]),e[24]||(e[24]=(0,a.Lk)("label",{for:"priceCategory"},"Category",-1)),(0,a.bo)((0,a.Lk)("select",{id:"priceCategory","onUpdate:modelValue":e[3]||(e[3]=t=>i.priceData.category=t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.categoryList,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t._id,value:t._id},(0,u.v_)(t.name),9,mo)))),128))],512),[[d.u1,i.priceData.category]]),e[25]||(e[25]=(0,a.Lk)("label",{for:"priceType"},"Type",-1)),(0,a.bo)((0,a.Lk)("select",{id:"priceType","onUpdate:modelValue":e[4]||(e[4]=t=>i.priceData.type=t)},e[19]||(e[19]=[(0,a.Lk)("option",{value:"one"},"One",-1),(0,a.Lk)("option",{value:"multiple"},"Multiple",-1)]),512),[[d.u1,i.priceData.type]]),e[26]||(e[26]=(0,a.Lk)("label",{for:"priceMode"},"Mode",-1)),(0,a.bo)((0,a.Lk)("select",{id:"priceMode","onUpdate:modelValue":e[5]||(e[5]=t=>i.priceData.mode=t)},e[20]||(e[20]=[(0,a.Lk)("option",{value:"fix"},"Fix",-1),(0,a.Lk)("option",{value:"percent"},"Percent",-1)]),512),[[d.u1,i.priceData.mode]]),e[27]||(e[27]=(0,a.Lk)("label",{for:"pricePeriodStart"},"Period Start",-1)),(0,a.bo)((0,a.Lk)("input",{id:"pricePeriodStart","onUpdate:modelValue":e[6]||(e[6]=t=>i.priceData.period.start=t),type:"date"},null,512),[[d.Jo,i.priceData.period.start]]),e[28]||(e[28]=(0,a.Lk)("label",{for:"pricePeriodEnd"},"Period End",-1)),(0,a.bo)((0,a.Lk)("input",{id:"pricePeriodEnd","onUpdate:modelValue":e[7]||(e[7]=t=>i.priceData.period.end=t),type:"date"},null,512),[[d.Jo,i.priceData.period.end]]),e[29]||(e[29]=(0,a.Lk)("label",{for:"priceValue"},"Value",-1)),(0,a.bo)((0,a.Lk)("input",{id:"priceValue","onUpdate:modelValue":e[8]||(e[8]=t=>i.priceData.value=t),type:"number",placeholder:"Value"},null,512),[[d.Jo,i.priceData.value]]),(0,a.Lk)("button",{onClick:e[9]||(e[9]=(...t)=>r.updatePrice&&r.updatePrice(...t))},"Save Changes")])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[e[32]||(e[32]=(0,a.Lk)("h2",null,"Add Price",-1)),e[33]||(e[33]=(0,a.Lk)("label",{for:"newPriceName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newPriceName","onUpdate:modelValue":e[10]||(e[10]=t=>i.newPrice.name=t),placeholder:"Name"},null,512),[[d.Jo,i.newPrice.name]]),e[34]||(e[34]=(0,a.Lk)("label",{for:"newPriceCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newPriceCode","onUpdate:modelValue":e[11]||(e[11]=t=>i.newPrice.code=t),placeholder:"Code"},null,512),[[d.Jo,i.newPrice.code]]),e[35]||(e[35]=(0,a.Lk)("label",{for:"newPriceCategory"},"Category",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newPriceCategory","onUpdate:modelValue":e[12]||(e[12]=t=>i.newPrice.category=t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.categoryList,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t._id,value:t._id},(0,u.v_)(t.name),9,ko)))),128))],512),[[d.u1,i.newPrice.category]]),e[36]||(e[36]=(0,a.Lk)("label",{for:"newPriceType"},"Type",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newPriceType","onUpdate:modelValue":e[13]||(e[13]=t=>i.newPrice.type=t)},e[30]||(e[30]=[(0,a.Lk)("option",{value:"one"},"One",-1),(0,a.Lk)("option",{value:"multiple"},"Multiple",-1)]),512),[[d.u1,i.newPrice.type]]),e[37]||(e[37]=(0,a.Lk)("label",{for:"newPriceMode"},"Mode",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newPriceMode","onUpdate:modelValue":e[14]||(e[14]=t=>i.newPrice.mode=t)},e[31]||(e[31]=[(0,a.Lk)("option",{value:"fix"},"Fix",-1),(0,a.Lk)("option",{value:"percent"},"Percent",-1)]),512),[[d.u1,i.newPrice.mode]]),e[38]||(e[38]=(0,a.Lk)("label",{for:"newPricePeriodStart"},"Period Start",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newPricePeriodStart","onUpdate:modelValue":e[15]||(e[15]=t=>i.newPrice.period.start=t),type:"date"},null,512),[[d.Jo,i.newPrice.period.start]]),e[39]||(e[39]=(0,a.Lk)("label",{for:"newPricePeriodEnd"},"Period End",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newPricePeriodEnd","onUpdate:modelValue":e[16]||(e[16]=t=>i.newPrice.period.end=t),type:"date"},null,512),[[d.Jo,i.newPrice.period.end]]),e[40]||(e[40]=(0,a.Lk)("label",{for:"newPriceValue"},"Value",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newPriceValue","onUpdate:modelValue":e[17]||(e[17]=t=>i.newPrice.value=t),type:"number",placeholder:"Value"},null,512),[[d.Jo,i.newPrice.value]]),(0,a.Lk)("button",{onClick:e[18]||(e[18]=(...t)=>r.addPrice&&r.addPrice(...t))},"Add Price")])])}const bo=new ot.A(!1);var vo={data(){return{priceList:[],categoryList:[],priceData:{_id:"",name:"",code:"",category:"",type:"one",mode:"fix",period:{start:"",end:""},value:0},newPrice:{name:"",code:"",category:"",type:"one",mode:"fix",period:{start:"",end:""},value:0},showPriceConfig:!1,configs:s.A.get("configs"),session:s.A.get("session")}},methods:{async fetchPrices(){try{const t=await bo.POST("product_price/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.priceList=t.data);const e=await bo.POST("product_category/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===e.status&&(this.categoryList=e.data)}catch(t){console.error("Error fetching data:",t)}},prepareEditPrice(t){this.priceData={...t,period:{...t.period}},this.showPriceConfig=!0},async updatePrice(){try{const t=await bo.PUT(`product_price/${this.priceData._id}`,{data:{...this.priceData,_id:void 0}},this.configs.key);200===t.status&&(await this.fetchPrices(),this.showPriceConfig=!1,this.resetPriceData())}catch(t){console.error("Error updating price:",t)}},async removePrice(t,e){try{const o=await bo.DELETE(`product_price/${t}`,"",this.configs.key);200===o.status&&this.priceList.splice(e,1)}catch(o){console.error("Error deleting price:",o)}},async addPrice(){try{const t=await bo.POST("product_price/",{data:{...this.newPrice,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(this.priceList.push(t.data),this.resetNewPrice())}catch(t){console.error("Error adding price:",t)}},resetNewPrice(){this.newPrice={name:"",code:"",category:"",type:"one",mode:"fix",period:{start:"",end:""},value:0}},resetPriceData(){this.priceData={_id:"",name:"",code:"",category:"",type:"one",mode:"fix",period:{start:"",end:""},value:0}},getCategoryName(t){const e=this.categoryList.find((e=>e._id===t));return e?e.name:"None"}},async mounted(){await this.fetchPrices()}};const Lo=(0,it.A)(vo,[["render",go]]);var fo=Lo;const Co={key:0},wo={key:0},Po={key:1},So={key:0},_o=["onClick"],Eo={key:1},xo=["onClick"],Do={key:0},Ao={key:1},To=["max"],Uo={key:0},Fo={key:0},Vo={key:0},Io={key:0};function Xo(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[26]||(e[26]=(0,a.Lk)("h1",null,"Shop Test Interface",-1)),(0,a.Lk)("section",null,[e[13]||(e[13]=(0,a.Lk)("h2",null,"Load Product by SKU",-1)),(0,a.Lk)("div",null,[e[11]||(e[11]=(0,a.Lk)("label",{for:"productSku"},"Product SKU:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"productSku","onUpdate:modelValue":e[0]||(e[0]=t=>i.testSku=t),placeholder:"Enter Product SKU"},null,512),[[d.Jo,i.testSku]]),(0,a.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>r.loadProductBySku&&r.loadProductBySku(...t))},"Load Product By SKU")]),i.singleProduct?((0,a.uX)(),(0,a.CE)("div",Co,[(0,a.Lk)("h2",null,(0,u.v_)(i.singleProduct.name),1),(0,a.Lk)("div",null,[i.singleProduct.salePriceRange?((0,a.uX)(),(0,a.CE)("span",wo,(0,u.v_)(i.singleProduct.salePriceRange),1)):((0,a.uX)(),(0,a.CE)("span",Po,"$"+(0,u.v_)(i.singleProduct.salePrice),1))]),(0,a.Lk)("p",null,(0,u.v_)(i.singleProduct.description),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.variationAttributes,((t,e)=>((0,a.uX)(),(0,a.CE)("div",{key:e},[(0,a.Lk)("h3",null,(0,u.v_)(t.name),1),"color"===t.name.toLowerCase()?((0,a.uX)(),(0,a.CE)("div",So,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.values,((e,o)=>((0,a.uX)(),(0,a.CE)("span",{key:o,onClick:o=>r.selectAttribute(t.name,e.code),style:(0,u.Tr)({backgroundColor:e.code,border:i.selectedAttributes[t.name]===e.code?"2px solid black":"1px solid grey"}),class:"color-circle"},null,12,_o)))),128))])):((0,a.uX)(),(0,a.CE)("div",Eo,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.values,((e,o)=>((0,a.uX)(),(0,a.CE)("span",{key:o,onClick:o=>r.selectAttribute(t.name,e.code),class:(0,u.C4)({"size-selected":i.selectedAttributes[t.name]===e.code})},(0,u.v_)(e.name),11,xo)))),128))]))])))),128)),i.selectedSubProduct?((0,a.uX)(),(0,a.CE)("div",Do,[(0,a.Lk)("h4",null,"Selected Sub-Product SKU: "+(0,u.v_)(i.selectedSubProduct.sku),1),(0,a.Lk)("span",null,"$"+(0,u.v_)(i.selectedSubProduct.salePrice),1),(0,a.Lk)("p",null,[e[12]||(e[12]=(0,a.eW)("Availability: ")),(0,a.Lk)("span",{style:(0,u.Tr)({color:i.selectedSubProduct.stock>0?"green":"red"})},(0,u.v_)(i.selectedSubProduct.stock)+" in stock",5)])])):((0,a.uX)(),(0,a.CE)("div",Ao,[(0,a.Lk)("span",null,"$"+(0,u.v_)(i.singleProduct.salePrice),1)])),(0,a.Lk)("div",null,[(0,a.bo)((0,a.Lk)("input",{type:"number","onUpdate:modelValue":e[2]||(e[2]=t=>i.quantity=t),max:r.maxQuantity,min:"1"},null,8,To),[[d.Jo,i.quantity,void 0,{number:!0}]]),(0,a.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>r.addToCart&&r.addToCart(...t))},"Add to Cart")])])):(0,a.Q3)("",!0)]),e[27]||(e[27]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("section",null,[e[16]||(e[16]=(0,a.Lk)("h2",null,"Update Stock",-1)),(0,a.Lk)("div",null,[e[14]||(e[14]=(0,a.Lk)("label",{for:"updateSku"},"Product SKU:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"updateSku","onUpdate:modelValue":e[4]||(e[4]=t=>i.updateSku=t),placeholder:"Enter Product SKU"},null,512),[[d.Jo,i.updateSku]])]),e[17]||(e[17]=(0,a.Fv)('<div><label for="updateAction">Action:</label><select id="updateAction"><option value="in">In</option><option value="out">Out</option><option value="adjust">Adjust</option></select></div>',1)),(0,a.Lk)("div",null,[e[15]||(e[15]=(0,a.Lk)("label",{for:"updateValue"},"Value:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"updateValue","onUpdate:modelValue":e[5]||(e[5]=t=>i.updateValue=t),type:"number",placeholder:"Enter Value"},null,512),[[d.Jo,i.updateValue]])]),(0,a.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>r.adjustStock&&r.adjustStock(...t))},"Update Stock")]),e[28]||(e[28]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("section",null,[e[19]||(e[19]=(0,a.Lk)("h2",null,"List Products",-1)),(0,a.Lk)("button",{onClick:e[7]||(e[7]=(...t)=>r.loadProducts&&r.loadProducts(...t))},"Load Products"),i.products.length?((0,a.uX)(),(0,a.CE)("div",Uo,[e[18]||(e[18]=(0,a.Lk)("h3",null,"Product List",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.products,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},(0,u.v_)(t.name)+" ("+(0,u.v_)(t.sku)+") - $"+(0,u.v_)(t.salePrice)+" - Stock: "+(0,u.v_)(t.stock),1)))),128))])])):(0,a.Q3)("",!0)]),e[29]||(e[29]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("section",null,[e[21]||(e[21]=(0,a.Lk)("h2",null,"List Inventories",-1)),(0,a.Lk)("button",{onClick:e[8]||(e[8]=(...t)=>r.loadInventories&&r.loadInventories(...t))},"Load Inventories"),i.inventories.length?((0,a.uX)(),(0,a.CE)("div",Fo,[e[20]||(e[20]=(0,a.Lk)("h3",null,"Inventory List",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.inventories,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") ",1)))),128))])])):(0,a.Q3)("",!0)]),e[30]||(e[30]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("section",null,[e[23]||(e[23]=(0,a.Lk)("h2",null,"List Categories",-1)),(0,a.Lk)("button",{onClick:e[9]||(e[9]=(...t)=>r.loadCategories&&r.loadCategories(...t))},"Load Categories"),i.categories.length?((0,a.uX)(),(0,a.CE)("div",Vo,[e[22]||(e[22]=(0,a.Lk)("h3",null,"Category List",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.categories,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") ",1)))),128))])])):(0,a.Q3)("",!0)]),e[31]||(e[31]=(0,a.Lk)("hr",null,null,-1)),(0,a.Lk)("section",null,[e[25]||(e[25]=(0,a.Lk)("h2",null,"List Prices",-1)),(0,a.Lk)("button",{onClick:e[10]||(e[10]=(...t)=>r.loadPrices&&r.loadPrices(...t))},"Load Prices"),i.prices.length?((0,a.uX)(),(0,a.CE)("div",Io,[e[24]||(e[24]=(0,a.Lk)("h3",null,"Price List",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.prices,(t=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") - $"+(0,u.v_)(t.value)+" ("+(0,u.v_)(t.mode)+") ",1)))),128))])])):(0,a.Q3)("",!0)])])}var Qo=o(47376),qo={data(){return{products:[],singleProduct:null,inventories:[],categories:[],prices:[],testSku:"",updateSku:"",updateAction:"in",updateValue:0,variationAttributes:[],selectedAttributes:{},selectedSubProduct:null,quantity:1}},computed:{maxQuantity(){return this.selectedSubProduct?this.selectedSubProduct.stock:this.singleProduct?this.singleProduct.stock:1}},methods:{async loadProducts(){try{this.products=await Ht()}catch(t){console.error("Error loading products:",t)}},async loadProductBySku(){try{const t=await zt(this.testSku);this.singleProduct=t,this.variationAttributes=t.variationAttributes||[],this.selectedAttributes={},this.updatePriceRange()}catch(t){console.error("Error loading product by SKU:",t)}},selectAttribute(t,e){this.selectedAttributes={...this.selectedAttributes,[t]:e},this.updateSelectedSubProduct()},updateSelectedSubProduct(){const t=this.selectedAttributes;this.selectedSubProduct=this.singleProduct.subProducts.find((e=>Object.keys(t).every((o=>e.attributes[o]===t[o]))))||null},updatePriceRange(){const t=this.singleProduct.subProducts.map((t=>t.salePrice));this.singleProduct.salePriceRange=`$${Math.min(...t)}.00 - $${Math.max(...t)}.00`},async adjustStock(){try{const t=await(0,Qo.UW)(this.updateSku,this.updateAction,parseInt(this.updateValue));console.log("Updated product stock:",t),this.loadProducts()}catch(t){console.error("Error updating stock:",t)}},async loadInventories(){try{this.inventories=await Ce()}catch(t){console.error("Error loading inventories:",t)}},async loadCategories(){try{this.categories=await we()}catch(t){console.error("Error loading categories:",t)}},async loadPrices(){try{this.prices=await Rt()}catch(t){console.error("Error loading prices:",t)}},addToCart(){this.quantity>this.maxQuantity?alert(`Cannot add more than ${this.maxQuantity} items to the cart.`):console.log("Added to cart:",this.selectedSubProduct?this.selectedSubProduct:this.singleProduct,"Quantity:",this.quantity)}}};const Mo=(0,it.A)(qo,[["render",Xo]]);var $o=Mo;const No={key:0},Oo=["innerHTML"],Jo={key:0},Ko=["onClick"],Go={key:0},Bo=["innerHTML"],Wo=["max"],Ro={key:1},jo=["max"],Ho={key:1},zo={key:0},Yo={key:1},Zo={key:2},ta={key:3},ea=["onClick"];function oa(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[13]||(e[13]=(0,a.Lk)("h2",null,"Product Detail",-1)),(0,a.Lk)("div",null,[e[8]||(e[8]=(0,a.Lk)("label",{for:"productSku"},"Product SKU:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"productSku","onUpdate:modelValue":e[0]||(e[0]=t=>i.testSku=t),placeholder:"Enter Product SKU"},null,512),[[d.Jo,i.testSku]]),(0,a.Lk)("button",{onClick:e[1]||(e[1]=(...t)=>r.loadProductBySku&&r.loadProductBySku(...t))},"Load Product By SKU")]),i.singleProduct?((0,a.uX)(),(0,a.CE)("div",No,[(0,a.Lk)("h3",null,(0,u.v_)(i.singleProduct.name),1),(0,a.Lk)("div",{innerHTML:r.formatPrice(i.singleProduct.salePrice,i.singleProduct.price)},null,8,Oo),(0,a.Lk)("p",null,(0,u.v_)(i.singleProduct.description),1),"variation"===i.singleProduct.type?((0,a.uX)(),(0,a.CE)("div",Jo,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.variationAttributes,((t,e)=>((0,a.uX)(),(0,a.CE)("div",{key:e},[(0,a.Lk)("h4",null,(0,u.v_)(t.name),1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.values,((e,o)=>((0,a.uX)(),(0,a.CE)("span",{key:o,onClick:o=>r.selectAttribute(t.code,e.code),class:(0,u.C4)({"size-selected":i.selectedAttributes[t.code]===e.code})},(0,u.v_)(e.name),11,Ko)))),128))])))),128)),i.selectedSubProduct?((0,a.uX)(),(0,a.CE)("div",Go,[(0,a.Lk)("h4",null,"Selected Sub-Product SKU: "+(0,u.v_)(i.selectedSubProduct.sku),1),(0,a.Lk)("div",{innerHTML:r.formatPrice(i.selectedSubProduct.salePrice,i.selectedSubProduct.price)},null,8,Bo),(0,a.Lk)("p",null,[e[9]||(e[9]=(0,a.eW)(" Availability: ")),(0,a.Lk)("span",{style:(0,u.Tr)({color:i.selectedSubProduct.stock>0?"green":"red"})},(0,u.v_)(i.selectedSubProduct.stock)+" in stock",5)]),e[10]||(e[10]=(0,a.Lk)("label",{for:"quantity"},"Quantity:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"quantity",type:"number","onUpdate:modelValue":e[2]||(e[2]=t=>i.quantity=t),onInput:e[3]||(e[3]=(...t)=>r.validateQuantity&&r.validateQuantity(...t)),max:i.selectedSubProduct.stock},null,40,Wo),[[d.Jo,i.quantity,void 0,{number:!0}]]),(0,a.Lk)("p",null,"Total Price: $"+(0,u.v_)(r.calculateTotalPrice(i.selectedSubProduct.salePrice,i.quantity)),1),(0,a.Lk)("button",{onClick:e[4]||(e[4]=t=>r.handleAddToCart(i.selectedSubProduct.sku))},"Add to Cart")])):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("div",Ro,[e[11]||(e[11]=(0,a.Lk)("label",{for:"quantity"},"Quantity:",-1)),(0,a.bo)((0,a.Lk)("input",{id:"quantity",type:"number","onUpdate:modelValue":e[5]||(e[5]=t=>i.quantity=t),onInput:e[6]||(e[6]=(...t)=>r.validateQuantity&&r.validateQuantity(...t)),max:i.singleProduct.stock},null,40,jo),[[d.Jo,i.quantity,void 0,{number:!0}]]),(0,a.Lk)("p",null,"Total Price: $"+(0,u.v_)(r.calculateTotalPrice(i.singleProduct.salePrice,i.quantity)),1),(0,a.Lk)("button",{onClick:e[7]||(e[7]=t=>r.handleAddToCart(i.singleProduct.sku))},"Add to Cart")]))])):(0,a.Q3)("",!0),i.cart.length>0?((0,a.uX)(),(0,a.CE)("div",Ho,[e[12]||(e[12]=(0,a.Lk)("h2",null,"Cart",-1)),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.cart,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:e},["product"===t.type?((0,a.uX)(),(0,a.CE)("span",zo," Product ID: "+(0,u.v_)(t.itemId)+", SKU: "+(0,u.v_)(t.sku||"N/A")+", Quantity: "+(0,u.v_)(t.quantity),1)):(0,a.Q3)("",!0),"coupon"===t.type?((0,a.uX)(),(0,a.CE)("span",Yo," Coupon Code: "+(0,u.v_)(t.sku)+", Discount: "+(0,u.v_)(t.quantity),1)):(0,a.Q3)("",!0),"shipping"===t.type?((0,a.uX)(),(0,a.CE)("span",Zo," Shipping Method: "+(0,u.v_)(t.sku)+", Cost: "+(0,u.v_)(t.quantity),1)):(0,a.Q3)("",!0),"fee"===t.type?((0,a.uX)(),(0,a.CE)("span",ta," Fee Description: "+(0,u.v_)(t.sku)+", Amount: "+(0,u.v_)(t.quantity),1)):(0,a.Q3)("",!0),(0,a.Lk)("button",{onClick:e=>r.handleRemoveFromCart(t.itemId,t.sku)},"Remove",8,ea)])))),128))]),(0,a.Lk)("p",null,"Total Cart Value: $"+(0,u.v_)(i.cartTotal),1)])):(0,a.Q3)("",!0)])}var aa={data(){return{singleProduct:null,testSku:"",variationAttributes:[],selectedAttributes:{},selectedSubProduct:null,quantity:1,cart:[],cartTotal:"0.00"}},methods:{async loadProductBySku(){try{const t=await(0,Qo.qi)(this.testSku);this.singleProduct=t.mainProduct||t,this.variationAttributes=this.singleProduct.variationAttributes||[],this.selectedAttributes=t.attributes||{},this.selectedSubProduct=t.mainProduct?t:null,this.updatePriceRange(),this.selectedSubProduct&&(this.selectedSubProduct.salePrice=this.calculateSalePrice(this.selectedSubProduct))}catch(t){console.error("Error loading product by SKU:",t)}},selectAttribute(t,e){this.selectedAttributes={...this.selectedAttributes,[t]:e},this.updateSelectedSubProduct()},updateSelectedSubProduct(){Object.keys(this.selectedAttributes).length===this.variationAttributes.length?(this.selectedSubProduct=this.findSubProduct(this.selectedAttributes),this.quantity=1,this.selectedSubProduct&&(this.selectedSubProduct.salePrice=this.calculateSalePrice(this.selectedSubProduct))):this.selectedSubProduct=null},findSubProduct(t){return this.singleProduct.subProducts.find((e=>Object.keys(t).every((o=>e.attributes[o]===t[o]))))||null},updatePriceRange(){if(this.singleProduct.subProducts){const t=this.singleProduct.subProducts.map((t=>t.salePrice||t.price));this.singleProduct.salePriceRange=`$${Math.min(...t).toFixed(2)} - $${Math.max(...t).toFixed(2)}`}},calculateSalePrice(t){const e=t.salePrice?t.salePrice:t.price;return parseFloat(e.toFixed(2))},formatPrice(t,e){if(t=t||e,t===e)return`<span style="color: green;">$${parseFloat(t).toFixed(2)}</span>`;const o=parseFloat((e-t).toFixed(2)),a=parseFloat((o/e*100).toFixed(0));return`\n          <span style="text-decoration: line-through; color: grey;">$${parseFloat(e).toFixed(2)}</span>\n          <span style="color: green;">$${parseFloat(t).toFixed(2)}</span>\n          <small style="color: grey;">Save: $${o} (${a}%)</small>\n        `},validateQuantity(){const t=this.selectedSubProduct?this.selectedSubProduct.stock:this.singleProduct.stock;this.quantity>t?this.quantity=t:this.quantity<1&&(this.quantity=1)},calculateTotalPrice(t,e){return t=t||this.singleProduct.price,(t*e).toFixed(2)},async handleAddToCart(t){const e=this.selectedSubProduct?this.selectedSubProduct.stock:this.singleProduct.stock,o=this.singleProduct._id,a=await(0,Qo.bE)(o,t,this.quantity,e);a.includes("exceeds available stock")||await this.refreshCart(),alert(a)},async handleRemoveFromCart(t,e){const o=await(0,Qo.dt)(t,e);await this.refreshCart(),alert(o)},async refreshCart(){this.cart=await(0,Qo.Fy)(),this.cartTotal=await(0,Qo.te)()}},async mounted(){await this.refreshCart()}};const na=(0,it.A)(aa,[["render",oa]]);var ia=na;const ra=["onClick"],sa=["onClick"],la={key:0},ua={key:0},da={key:1},ca={key:2},pa={key:0},ha={key:1},ya={key:2};function ma(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[75]||(e[75]=(0,a.Lk)("h1",null,"Coupon Manager",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.fetchCoupons&&r.fetchCoupons(...t))},"Load Coupons"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.couponList,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.Lk)("span",null,(0,u.v_)(t.code)+" - "+(0,u.v_)(t.mode)+" - "+(0,u.v_)(t.type)+" - "+(0,u.v_)(t.value)+" - Min Subtotal: "+(0,u.v_)(t.minSubtotal)+" - Max Subtotal: "+(0,u.v_)(t.maxSubtotal)+" - Min Quantity: "+(0,u.v_)(t.minQuantity)+" - Max Quantity: "+(0,u.v_)(t.maxQuantity)+" - Usage: "+(0,u.v_)(t.usage)+" - Max Discount: "+(0,u.v_)(t.maxDiscount)+" - Start Date: "+(0,u.v_)(t.startDate)+" - End Date: "+(0,u.v_)(t.endDate)+" - Auto Assign: "+(0,u.v_)(t.autoAssign?"Yes":"No"),1),(0,a.Lk)("button",{onClick:e=>r.prepareEditCoupon(t)},"Update",8,ra),(0,a.Lk)("button",{onClick:o=>r.removeCoupon(t._id,e)},"Delete",8,sa)])))),128))]),i.showCouponConfig?((0,a.uX)(),(0,a.CE)("div",la,[e[48]||(e[48]=(0,a.Lk)("h2",null,"Edit Coupon",-1)),e[49]||(e[49]=(0,a.Lk)("label",{for:"couponCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponCode","onUpdate:modelValue":e[1]||(e[1]=t=>i.couponData.code=t),placeholder:"Code"},null,512),[[d.Jo,i.couponData.code]]),e[50]||(e[50]=(0,a.Lk)("label",{for:"couponMode"},"Mode",-1)),(0,a.bo)((0,a.Lk)("select",{id:"couponMode","onUpdate:modelValue":e[2]||(e[2]=t=>i.couponData.mode=t)},e[35]||(e[35]=[(0,a.Lk)("option",{value:"fix"},"Fix",-1),(0,a.Lk)("option",{value:"percent"},"Percent",-1)]),512),[[d.u1,i.couponData.mode]]),e[51]||(e[51]=(0,a.Lk)("label",{for:"couponType"},"Type",-1)),(0,a.bo)((0,a.Lk)("select",{id:"couponType","onUpdate:modelValue":e[3]||(e[3]=t=>i.couponData.type=t)},e[36]||(e[36]=[(0,a.Lk)("option",{value:"standard"},"Standard Discount",-1),(0,a.Lk)("option",{value:"category"},"Discount by Category",-1)]),512),[[d.u1,i.couponData.type]]),e[52]||(e[52]=(0,a.Lk)("label",{for:"couponValue"},"Value",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponValue","onUpdate:modelValue":e[4]||(e[4]=t=>i.couponData.value=t),type:"number",placeholder:"Value"},null,512),[[d.Jo,i.couponData.value]]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[5]||(e[5]=t=>i.couponData.enableSubtotalLimit=t)},null,512),[[d.lH,i.couponData.enableSubtotalLimit]]),e[37]||(e[37]=(0,a.eW)(" Enable Subtotal Limit "))]),i.couponData.enableSubtotalLimit?((0,a.uX)(),(0,a.CE)("div",ua,[e[38]||(e[38]=(0,a.Lk)("label",{for:"couponMinSubtotal"},"Min Subtotal",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponMinSubtotal","onUpdate:modelValue":e[6]||(e[6]=t=>i.couponData.minSubtotal=t),type:"number",placeholder:"Min Subtotal"},null,512),[[d.Jo,i.couponData.minSubtotal]]),e[39]||(e[39]=(0,a.Lk)("label",{for:"couponMaxSubtotal"},"Max Subtotal",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponMaxSubtotal","onUpdate:modelValue":e[7]||(e[7]=t=>i.couponData.maxSubtotal=t),type:"number",placeholder:"Max Subtotal"},null,512),[[d.Jo,i.couponData.maxSubtotal]])])):(0,a.Q3)("",!0),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[8]||(e[8]=t=>i.couponData.enableQuantityLimit=t)},null,512),[[d.lH,i.couponData.enableQuantityLimit]]),e[40]||(e[40]=(0,a.eW)(" Enable Quantity Limit "))]),i.couponData.enableQuantityLimit?((0,a.uX)(),(0,a.CE)("div",da,[e[41]||(e[41]=(0,a.Lk)("label",{for:"couponMinQuantity"},"Min Quantity",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponMinQuantity","onUpdate:modelValue":e[9]||(e[9]=t=>i.couponData.minQuantity=t),type:"number",placeholder:"Min Quantity"},null,512),[[d.Jo,i.couponData.minQuantity]]),e[42]||(e[42]=(0,a.Lk)("label",{for:"couponMaxQuantity"},"Max Quantity",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponMaxQuantity","onUpdate:modelValue":e[10]||(e[10]=t=>i.couponData.maxQuantity=t),type:"number",placeholder:"Max Quantity"},null,512),[[d.Jo,i.couponData.maxQuantity]])])):(0,a.Q3)("",!0),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[11]||(e[11]=t=>i.couponData.enableDueDate=t)},null,512),[[d.lH,i.couponData.enableDueDate]]),e[43]||(e[43]=(0,a.eW)(" Enable Due Date "))]),i.couponData.enableDueDate?((0,a.uX)(),(0,a.CE)("div",ca,[e[44]||(e[44]=(0,a.Lk)("label",{for:"couponStartDate"},"Start Date",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponStartDate","onUpdate:modelValue":e[12]||(e[12]=t=>i.couponData.startDate=t),type:"date",placeholder:"Start Date"},null,512),[[d.Jo,i.couponData.startDate]]),e[45]||(e[45]=(0,a.Lk)("label",{for:"couponEndDate"},"End Date",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponEndDate","onUpdate:modelValue":e[13]||(e[13]=t=>i.couponData.endDate=t),type:"date",placeholder:"End Date"},null,512),[[d.Jo,i.couponData.endDate]])])):(0,a.Q3)("",!0),e[53]||(e[53]=(0,a.Lk)("label",{for:"couponUsage"},"Usage",-1)),(0,a.bo)((0,a.Lk)("select",{id:"couponUsage","onUpdate:modelValue":e[14]||(e[14]=t=>i.couponData.usage=t)},e[46]||(e[46]=[(0,a.Lk)("option",{value:"unlimited"},"Unlimited",-1),(0,a.Lk)("option",{value:"single"},"Single Use",-1)]),512),[[d.u1,i.couponData.usage]]),e[54]||(e[54]=(0,a.Lk)("label",{for:"couponMaxDiscount"},"Max Discount",-1)),(0,a.bo)((0,a.Lk)("input",{id:"couponMaxDiscount","onUpdate:modelValue":e[15]||(e[15]=t=>i.couponData.maxDiscount=t),type:"number",placeholder:"Max Discount"},null,512),[[d.Jo,i.couponData.maxDiscount]]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[16]||(e[16]=t=>i.couponData.autoAssign=t)},null,512),[[d.lH,i.couponData.autoAssign]]),e[47]||(e[47]=(0,a.eW)(" Auto Assign When Conditions Met "))]),(0,a.Lk)("button",{onClick:e[17]||(e[17]=(...t)=>r.updateCoupon&&r.updateCoupon(...t))},"Save Changes")])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[e[68]||(e[68]=(0,a.Lk)("h2",null,"Add Coupon",-1)),e[69]||(e[69]=(0,a.Lk)("label",{for:"newCouponCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponCode","onUpdate:modelValue":e[18]||(e[18]=t=>i.newCoupon.code=t),placeholder:"Code"},null,512),[[d.Jo,i.newCoupon.code]]),e[70]||(e[70]=(0,a.Lk)("label",{for:"newCouponMode"},"Mode",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newCouponMode","onUpdate:modelValue":e[19]||(e[19]=t=>i.newCoupon.mode=t)},e[55]||(e[55]=[(0,a.Lk)("option",{value:"fix"},"Fix",-1),(0,a.Lk)("option",{value:"percent"},"Percent",-1)]),512),[[d.u1,i.newCoupon.mode]]),e[71]||(e[71]=(0,a.Lk)("label",{for:"newCouponType"},"Type",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newCouponType","onUpdate:modelValue":e[20]||(e[20]=t=>i.newCoupon.type=t)},e[56]||(e[56]=[(0,a.Lk)("option",{value:"standard"},"Standard Discount",-1),(0,a.Lk)("option",{value:"category"},"Discount by Category",-1)]),512),[[d.u1,i.newCoupon.type]]),e[72]||(e[72]=(0,a.Lk)("label",{for:"newCouponValue"},"Value",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponValue","onUpdate:modelValue":e[21]||(e[21]=t=>i.newCoupon.value=t),type:"number",placeholder:"Value"},null,512),[[d.Jo,i.newCoupon.value]]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[22]||(e[22]=t=>i.newCoupon.enableSubtotalLimit=t)},null,512),[[d.lH,i.newCoupon.enableSubtotalLimit]]),e[57]||(e[57]=(0,a.eW)(" Enable Subtotal Limit "))]),i.newCoupon.enableSubtotalLimit?((0,a.uX)(),(0,a.CE)("div",pa,[e[58]||(e[58]=(0,a.Lk)("label",{for:"newCouponMinSubtotal"},"Min Subtotal",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponMinSubtotal","onUpdate:modelValue":e[23]||(e[23]=t=>i.newCoupon.minSubtotal=t),type:"number",placeholder:"Min Subtotal"},null,512),[[d.Jo,i.newCoupon.minSubtotal]]),e[59]||(e[59]=(0,a.Lk)("label",{for:"newCouponMaxSubtotal"},"Max Subtotal",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponMaxSubtotal","onUpdate:modelValue":e[24]||(e[24]=t=>i.newCoupon.maxSubtotal=t),type:"number",placeholder:"Max Subtotal"},null,512),[[d.Jo,i.newCoupon.maxSubtotal]])])):(0,a.Q3)("",!0),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[25]||(e[25]=t=>i.newCoupon.enableQuantityLimit=t)},null,512),[[d.lH,i.newCoupon.enableQuantityLimit]]),e[60]||(e[60]=(0,a.eW)(" Enable Quantity Limit "))]),i.newCoupon.enableQuantityLimit?((0,a.uX)(),(0,a.CE)("div",ha,[e[61]||(e[61]=(0,a.Lk)("label",{for:"newCouponMinQuantity"},"Min Quantity",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponMinQuantity","onUpdate:modelValue":e[26]||(e[26]=t=>i.newCoupon.minQuantity=t),type:"number",placeholder:"Min Quantity"},null,512),[[d.Jo,i.newCoupon.minQuantity]]),e[62]||(e[62]=(0,a.Lk)("label",{for:"newCouponMaxQuantity"},"Max Quantity",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponMaxQuantity","onUpdate:modelValue":e[27]||(e[27]=t=>i.newCoupon.maxQuantity=t),type:"number",placeholder:"Max Quantity"},null,512),[[d.Jo,i.newCoupon.maxQuantity]])])):(0,a.Q3)("",!0),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[28]||(e[28]=t=>i.newCoupon.enableDueDate=t)},null,512),[[d.lH,i.newCoupon.enableDueDate]]),e[63]||(e[63]=(0,a.eW)(" Enable Due Date "))]),i.newCoupon.enableDueDate?((0,a.uX)(),(0,a.CE)("div",ya,[e[64]||(e[64]=(0,a.Lk)("label",{for:"newCouponStartDate"},"Start Date",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponStartDate","onUpdate:modelValue":e[29]||(e[29]=t=>i.newCoupon.startDate=t),type:"date",placeholder:"Start Date"},null,512),[[d.Jo,i.newCoupon.startDate]]),e[65]||(e[65]=(0,a.Lk)("label",{for:"newCouponEndDate"},"End Date",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponEndDate","onUpdate:modelValue":e[30]||(e[30]=t=>i.newCoupon.endDate=t),type:"date",placeholder:"End Date"},null,512),[[d.Jo,i.newCoupon.endDate]])])):(0,a.Q3)("",!0),e[73]||(e[73]=(0,a.Lk)("label",{for:"newCouponUsage"},"Usage",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newCouponUsage","onUpdate:modelValue":e[31]||(e[31]=t=>i.newCoupon.usage=t)},e[66]||(e[66]=[(0,a.Lk)("option",{value:"unlimited"},"Unlimited",-1),(0,a.Lk)("option",{value:"single"},"Single Use",-1)]),512),[[d.u1,i.newCoupon.usage]]),e[74]||(e[74]=(0,a.Lk)("label",{for:"newCouponMaxDiscount"},"Max Discount",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newCouponMaxDiscount","onUpdate:modelValue":e[32]||(e[32]=t=>i.newCoupon.maxDiscount=t),type:"number",placeholder:"Max Discount"},null,512),[[d.Jo,i.newCoupon.maxDiscount]]),(0,a.Lk)("label",null,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":e[33]||(e[33]=t=>i.newCoupon.autoAssign=t)},null,512),[[d.lH,i.newCoupon.autoAssign]]),e[67]||(e[67]=(0,a.eW)(" Auto Assign When Conditions Met "))]),(0,a.Lk)("button",{onClick:e[34]||(e[34]=(...t)=>r.addCoupon&&r.addCoupon(...t))},"Add Coupon")])])}const ka=new ot.A(!1);var ga={data(){return{couponList:[],couponData:{_id:"",code:"",mode:"fix",type:"standard",value:0,minSubtotal:0,maxSubtotal:0,minQuantity:0,maxQuantity:0,usage:"unlimited",maxDiscount:0,autoAssign:!1,enableSubtotalLimit:!1,enableQuantityLimit:!1,enableDueDate:!1,startDate:"",endDate:""},newCoupon:{code:"",mode:"fix",type:"standard",value:0,minSubtotal:0,maxSubtotal:0,minQuantity:0,maxQuantity:0,usage:"unlimited",maxDiscount:0,autoAssign:!1,enableSubtotalLimit:!1,enableQuantityLimit:!1,enableDueDate:!1,startDate:"",endDate:""},showCouponConfig:!1,configs:s.A.get("configs"),session:s.A.get("session")}},methods:{async fetchCoupons(){try{const t=await ka.POST("coupon/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.couponList=t.data)}catch(t){console.error("Error fetching coupons:",t)}},prepareEditCoupon(t){this.couponData={...t},this.showCouponConfig=!0},async updateCoupon(){try{"percent"===this.couponData.mode&&(this.couponData.value=Math.min(this.couponData.value,this.couponData.maxDiscount));const t=await ka.PUT(`coupon/${this.couponData._id}`,{data:{...this.couponData,_id:void 0}},this.configs.key);200===t.status&&(await this.fetchCoupons(),this.showCouponConfig=!1,this.resetCouponData())}catch(t){console.error("Error updating coupon:",t)}},async removeCoupon(t,e){try{const o=await ka.DELETE(`coupon/${t}`,"",this.configs.key);200===o.status&&this.couponList.splice(e,1)}catch(o){console.error("Error deleting coupon:",o)}},async addCoupon(){try{"percent"===this.newCoupon.mode&&(this.newCoupon.value=Math.min(this.newCoupon.value,this.newCoupon.maxDiscount));const t=await ka.POST("coupon/",{data:{...this.newCoupon,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(this.couponList.push(t.data),this.resetNewCoupon())}catch(t){console.error("Error adding coupon:",t)}},resetCouponData(){this.couponData={_id:"",code:"",mode:"fix",type:"standard",value:0,minSubtotal:0,maxSubtotal:0,minQuantity:0,maxQuantity:0,usage:"unlimited",maxDiscount:100,autoAssign:!1,enableSubtotalLimit:!1,enableQuantityLimit:!1,enableDueDate:!1,startDate:"",endDate:""}},resetNewCoupon(){this.newCoupon={code:"",mode:"fix",type:"standard",value:0,minSubtotal:0,maxSubtotal:0,minQuantity:0,maxQuantity:0,usage:"unlimited",maxDiscount:100,autoAssign:!1,enableSubtotalLimit:!1,enableQuantityLimit:!1,enableDueDate:!1,startDate:"",endDate:""}}},async mounted(){await this.fetchCoupons()}};const ba=(0,it.A)(ga,[["render",ma]]);var va=ba;const La=["onClick"],fa=["onClick"],Ca=["onClick"],wa={key:0},Pa=["onUpdate:modelValue"],Sa=["onUpdate:modelValue"],_a=["onUpdate:modelValue"],Ea=["onClick"],xa=["onUpdate:modelValue"],Da=["onUpdate:modelValue"],Aa=["onUpdate:modelValue"],Ta=["onClick"];function Ua(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[27]||(e[27]=(0,a.Lk)("h1",null,"Fee Manager",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.fetchFees&&r.fetchFees(...t))},"Load Fees"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.feeList,((e,o)=>((0,a.uX)(),(0,a.CE)("li",{key:e._id},[(0,a.Lk)("span",null,[(0,a.eW)((0,u.v_)(e.code)+" - "+(0,u.v_)(e.type)+" - Conditions: ",1),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.conditions,((e,n)=>((0,a.uX)(),(0,a.CE)("li",{key:n},[(0,a.eW)(" Total Price: "+(0,u.v_)(e.total_price)+" - Fee Value: "+(0,u.v_)(e.fee_value)+" ("+(0,u.v_)(e.mode)+") ",1),(0,a.Lk)("button",{onClick:e=>t.removeCondition(o,n)},"Remove Condition",8,La)])))),128))])]),(0,a.Lk)("button",{onClick:t=>r.prepareEditFee(e)},"Update",8,fa),(0,a.Lk)("button",{onClick:t=>r.removeFee(e._id,o)},"Delete",8,Ca)])))),128))]),i.showFeeConfig?((0,a.uX)(),(0,a.CE)("div",wa,[e[15]||(e[15]=(0,a.Lk)("h2",null,"Edit Fee",-1)),e[16]||(e[16]=(0,a.Lk)("label",{for:"feeCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"feeCode","onUpdate:modelValue":e[1]||(e[1]=t=>i.feeData.code=t),placeholder:"Code"},null,512),[[d.Jo,i.feeData.code]]),e[17]||(e[17]=(0,a.Lk)("label",{for:"feeType"},"Type",-1)),(0,a.bo)((0,a.Lk)("select",{id:"feeType","onUpdate:modelValue":e[2]||(e[2]=t=>i.feeData.type=t)},e[9]||(e[9]=[(0,a.Lk)("option",{value:"shipping"},"Shipping",-1),(0,a.Lk)("option",{value:"tax"},"Tax",-1),(0,a.Lk)("option",{value:"custom"},"Custom",-1)]),512),[[d.u1,i.feeData.type]]),(0,a.Lk)("div",null,[e[14]||(e[14]=(0,a.Lk)("h3",null,"Conditions",-1)),(0,a.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>r.addCondition&&r.addCondition(...t))},"Add Condition"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.feeData.conditions,((t,o)=>((0,a.uX)(),(0,a.CE)("li",{key:o},[e[11]||(e[11]=(0,a.Lk)("label",{for:"totalPrice"},"Total Price",-1)),(0,a.bo)((0,a.Lk)("input",{id:"totalPrice","onUpdate:modelValue":e=>t.total_price=e,type:"number",placeholder:"Total Price"},null,8,Pa),[[d.Jo,t.total_price]]),e[12]||(e[12]=(0,a.Lk)("label",{for:"feeValue"},"Fee Value",-1)),(0,a.bo)((0,a.Lk)("input",{id:"feeValue","onUpdate:modelValue":e=>t.fee_value=e,type:"number",placeholder:"Fee Value"},null,8,Sa),[[d.Jo,t.fee_value]]),e[13]||(e[13]=(0,a.Lk)("label",{for:"mode"},"Mode",-1)),(0,a.bo)((0,a.Lk)("select",{id:"mode","onUpdate:modelValue":e=>t.mode=e},e[10]||(e[10]=[(0,a.Lk)("option",{value:"fix"},"Fix",-1),(0,a.Lk)("option",{value:"percent"},"Percent",-1)]),8,_a),[[d.u1,t.mode]]),(0,a.Lk)("button",{onClick:t=>r.removeConditionFromEdit(o)},"Remove",8,Ea)])))),128))])]),(0,a.Lk)("button",{onClick:e[4]||(e[4]=(...t)=>r.updateFee&&r.updateFee(...t))},"Save Changes")])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[e[24]||(e[24]=(0,a.Lk)("h2",null,"Add Fee",-1)),e[25]||(e[25]=(0,a.Lk)("label",{for:"newFeeCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newFeeCode","onUpdate:modelValue":e[5]||(e[5]=t=>i.newFee.code=t),placeholder:"Code"},null,512),[[d.Jo,i.newFee.code]]),e[26]||(e[26]=(0,a.Lk)("label",{for:"newFeeType"},"Type",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newFeeType","onUpdate:modelValue":e[6]||(e[6]=t=>i.newFee.type=t)},e[18]||(e[18]=[(0,a.Lk)("option",{value:"shipping"},"Shipping",-1),(0,a.Lk)("option",{value:"tax"},"Tax",-1),(0,a.Lk)("option",{value:"custom"},"Custom",-1)]),512),[[d.u1,i.newFee.type]]),(0,a.Lk)("div",null,[e[23]||(e[23]=(0,a.Lk)("h3",null,"Conditions",-1)),(0,a.Lk)("button",{onClick:e[7]||(e[7]=(...t)=>r.addConditionToNew&&r.addConditionToNew(...t))},"Add Condition"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.newFee.conditions,((t,o)=>((0,a.uX)(),(0,a.CE)("li",{key:o},[e[20]||(e[20]=(0,a.Lk)("label",{for:"newTotalPrice"},"Total Price",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newTotalPrice","onUpdate:modelValue":e=>t.total_price=e,type:"number",placeholder:"Total Price"},null,8,xa),[[d.Jo,t.total_price]]),e[21]||(e[21]=(0,a.Lk)("label",{for:"newFeeValue"},"Fee Value",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newFeeValue","onUpdate:modelValue":e=>t.fee_value=e,type:"number",placeholder:"Fee Value"},null,8,Da),[[d.Jo,t.fee_value]]),e[22]||(e[22]=(0,a.Lk)("label",{for:"newMode"},"Mode",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newMode","onUpdate:modelValue":e=>t.mode=e},e[19]||(e[19]=[(0,a.Lk)("option",{value:"fix"},"Fix",-1),(0,a.Lk)("option",{value:"percent"},"Percent",-1)]),8,Aa),[[d.u1,t.mode]]),(0,a.Lk)("button",{onClick:t=>r.removeConditionFromNew(o)},"Remove",8,Ta)])))),128))])]),(0,a.Lk)("button",{onClick:e[8]||(e[8]=(...t)=>r.addFee&&r.addFee(...t))},"Add Fee")])])}const Fa=new ot.A(!1);var Va={data(){return{feeList:[],feeData:{_id:"",code:"",type:"shipping",conditions:[]},newFee:{code:"",type:"shipping",conditions:[]},showFeeConfig:!1,configs:s.A.get("configs"),session:s.A.get("session")}},methods:{async fetchFees(){try{const t=await Fa.POST("product_fee/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.feeList=t.data)}catch(t){console.error("Error fetching fees:",t)}},prepareEditFee(t){this.feeData={...t},this.showFeeConfig=!0},async updateFee(){try{const t=await Fa.PUT(`product_fee/${this.feeData._id}`,{data:{...this.feeData,_id:void 0}},this.configs.key);200===t.status&&(await this.fetchFees(),this.showFeeConfig=!1,this.resetFeeData())}catch(t){console.error("Error updating fee:",t)}},async removeFee(t,e){try{const o=await Fa.DELETE(`product_fee/${t}`,"",this.configs.key);200===o.status&&this.feeList.splice(e,1)}catch(o){console.error("Error deleting fee:",o)}},async addFee(){try{const t=await Fa.POST("product_fee/",{data:{...this.newFee,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(this.feeList.push(t.data),this.resetNewFee())}catch(t){console.error("Error adding fee:",t)}},addCondition(){this.feeData.conditions.push({total_price:0,fee_value:0,mode:"fix"})},removeConditionFromEdit(t){this.feeData.conditions.splice(t,1)},addConditionToNew(){this.newFee.conditions.push({total_price:0,fee_value:0,mode:"fix"})},removeConditionFromNew(t){this.newFee.conditions.splice(t,1)},resetFeeData(){this.feeData={_id:"",code:"",type:"shipping",conditions:[]}},resetNewFee(){this.newFee={code:"",type:"shipping",conditions:[]}}},async mounted(){await this.fetchFees()}};const Ia=(0,it.A)(Va,[["render",Ua]]);var Xa=Ia;const Qa=["onClick"],qa=["onClick"],Ma={key:0},$a=["value"],Na=["value"];function Oa(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[23]||(e[23]=(0,a.Lk)("h1",null,"Payment Gateway Manager",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.fetchData&&r.fetchData(...t))},"Load Payment Gateways and Order Statuses"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.paymentGatewayList,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.Lk)("span",null,(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") - Status: "+(0,u.v_)(t.status),1),(0,a.Lk)("button",{onClick:e=>r.prepareEditGateway(t)},"Update",8,Qa),(0,a.Lk)("button",{onClick:o=>r.removePaymentGateway(t._id,e)},"Delete",8,qa)])))),128))]),i.showGatewayConfig?((0,a.uX)(),(0,a.CE)("div",Ma,[e[12]||(e[12]=(0,a.Lk)("h2",null,"Edit Payment Gateway",-1)),e[13]||(e[13]=(0,a.Lk)("label",{for:"gatewayName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"gatewayName","onUpdate:modelValue":e[1]||(e[1]=t=>i.gatewayData.name=t),placeholder:"Name"},null,512),[[d.Jo,i.gatewayData.name]]),e[14]||(e[14]=(0,a.Lk)("label",{for:"gatewayCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"gatewayCode","onUpdate:modelValue":e[2]||(e[2]=t=>i.gatewayData.code=t),placeholder:"Code"},null,512),[[d.Jo,i.gatewayData.code]]),e[15]||(e[15]=(0,a.Lk)("label",{for:"gatewayStatus"},"Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"gatewayStatus","onUpdate:modelValue":e[3]||(e[3]=t=>i.gatewayData.status=t)},e[11]||(e[11]=[(0,a.Lk)("option",{value:"active"},"Active",-1),(0,a.Lk)("option",{value:"pending"},"Pending",-1),(0,a.Lk)("option",{value:"unactive"},"Unactive",-1)]),512),[[d.u1,i.gatewayData.status]]),e[16]||(e[16]=(0,a.Lk)("label",{for:"defaultOrderStatus"},"Default Order Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"defaultOrderStatus","onUpdate:modelValue":e[4]||(e[4]=t=>i.gatewayData.defaultOrderStatus=t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.orderStatusList,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t._id,value:t._id},(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") ",9,$a)))),128))],512),[[d.u1,i.gatewayData.defaultOrderStatus]]),(0,a.Lk)("button",{onClick:e[5]||(e[5]=(...t)=>r.updatePaymentGateway&&r.updatePaymentGateway(...t))},"Save Changes")])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[e[18]||(e[18]=(0,a.Lk)("h2",null,"Add Payment Gateway",-1)),e[19]||(e[19]=(0,a.Lk)("label",{for:"newGatewayName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newGatewayName","onUpdate:modelValue":e[6]||(e[6]=t=>i.newGateway.name=t),placeholder:"Name"},null,512),[[d.Jo,i.newGateway.name]]),e[20]||(e[20]=(0,a.Lk)("label",{for:"newGatewayCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newGatewayCode","onUpdate:modelValue":e[7]||(e[7]=t=>i.newGateway.code=t),placeholder:"Code"},null,512),[[d.Jo,i.newGateway.code]]),e[21]||(e[21]=(0,a.Lk)("label",{for:"newGatewayStatus"},"Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newGatewayStatus","onUpdate:modelValue":e[8]||(e[8]=t=>i.newGateway.status=t)},e[17]||(e[17]=[(0,a.Lk)("option",{value:"active"},"Active",-1),(0,a.Lk)("option",{value:"pending"},"Pending",-1),(0,a.Lk)("option",{value:"unactive"},"Unactive",-1)]),512),[[d.u1,i.newGateway.status]]),e[22]||(e[22]=(0,a.Lk)("label",{for:"newDefaultOrderStatus"},"Default Order Status",-1)),(0,a.bo)((0,a.Lk)("select",{id:"newDefaultOrderStatus","onUpdate:modelValue":e[9]||(e[9]=t=>i.newGateway.defaultOrderStatus=t)},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.orderStatusList,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t._id,value:t._id},(0,u.v_)(t.name)+" ("+(0,u.v_)(t.code)+") ",9,Na)))),128))],512),[[d.u1,i.newGateway.defaultOrderStatus]]),(0,a.Lk)("button",{onClick:e[10]||(e[10]=(...t)=>r.addPaymentGateway&&r.addPaymentGateway(...t))},"Add Payment Gateway")])])}const Ja=new ot.A(!1);var Ka={data(){return{paymentGatewayList:[],orderStatusList:[],gatewayData:{_id:"",name:"",code:"",status:"active",defaultOrderStatus:""},newGateway:{name:"",code:"",status:"active",defaultOrderStatus:""},showGatewayConfig:!1,configs:s.A.get("configs"),session:s.A.get("session")}},methods:{async fetchData(){await this.fetchPaymentGateways(),await this.fetchOrderStatuses()},async fetchPaymentGateways(){try{const t=await Ja.POST("store_payment/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.paymentGatewayList=t.data)}catch(t){console.error("Error fetching payment gateways:",t)}},async fetchOrderStatuses(){try{const t=await Ja.POST("shop_order_status/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.orderStatusList=t.data.sort(((t,e)=>t.order-e.order)))}catch(t){console.error("Error fetching order statuses:",t)}},prepareEditGateway(t){this.gatewayData={...t},this.showGatewayConfig=!0},async updatePaymentGateway(){try{const t=await Ja.PUT(`store_payment/${this.gatewayData._id}`,{data:{...this.gatewayData,_id:void 0}},this.configs.key);200===t.status&&(await this.fetchPaymentGateways(),this.showGatewayConfig=!1,this.resetGatewayData())}catch(t){console.error("Error updating payment gateway:",t)}},async removePaymentGateway(t){try{const e=await Ja.DELETE(`store_payment/${t}`,"",this.configs.key);200===e.status&&this.fetchPaymentGateways()}catch(e){console.error("Error deleting payment gateway:",e)}},async addPaymentGateway(){try{const t=await Ja.POST("store_payment/",{data:{...this.newGateway,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(await this.fetchPaymentGateways(),this.resetNewGateway())}catch(t){console.error("Error adding payment gateway:",t)}},resetNewGateway(){this.newGateway={name:"",code:"",status:"active",defaultOrderStatus:""}},resetGatewayData(){this.gatewayData={_id:"",name:"",code:"",status:"active",defaultOrderStatus:""}}},async mounted(){await this.fetchData()}};const Ga=(0,it.A)(Ka,[["render",Oa],["__scopeId","data-v-6e935a70"]]);var Ba=Ga;const Wa=["onClick","disabled"],Ra=["onClick","disabled"],ja=["onClick"],Ha=["onClick"],za={key:0};function Ya(t,e,o,n,i,r){return(0,a.uX)(),(0,a.CE)("div",null,[e[13]||(e[13]=(0,a.Lk)("h1",null,"Order Status Manager",-1)),(0,a.Lk)("button",{onClick:e[0]||(e[0]=(...t)=>r.fetchOrderStatuses&&r.fetchOrderStatuses(...t))},"Load Order Statuses"),(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.orderStatusList,((t,e)=>((0,a.uX)(),(0,a.CE)("li",{key:t._id},[(0,a.Lk)("span",null,(0,u.v_)(t.name)+" - "+(0,u.v_)(t.code)+" - Order: "+(0,u.v_)(t.order),1),(0,a.Lk)("button",{onClick:t=>r.moveStatusUp(e),disabled:0===e},"Move Up",8,Wa),(0,a.Lk)("button",{onClick:t=>r.moveStatusDown(e),disabled:e===i.orderStatusList.length-1},"Move Down",8,Ra),(0,a.Lk)("button",{onClick:e=>r.prepareEditStatus(t)},"Update",8,ja),(0,a.Lk)("button",{onClick:o=>r.removeOrderStatus(t._id,e)},"Delete",8,Ha)])))),128))]),i.showStatusConfig?((0,a.uX)(),(0,a.CE)("div",za,[e[7]||(e[7]=(0,a.Lk)("h2",null,"Edit Order Status",-1)),e[8]||(e[8]=(0,a.Lk)("label",{for:"statusName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"statusName","onUpdate:modelValue":e[1]||(e[1]=t=>i.orderStatusData.name=t),placeholder:"Name"},null,512),[[d.Jo,i.orderStatusData.name]]),e[9]||(e[9]=(0,a.Lk)("label",{for:"statusCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"statusCode","onUpdate:modelValue":e[2]||(e[2]=t=>i.orderStatusData.code=t),placeholder:"Code"},null,512),[[d.Jo,i.orderStatusData.code]]),(0,a.Lk)("button",{onClick:e[3]||(e[3]=(...t)=>r.updateOrderStatus&&r.updateOrderStatus(...t))},"Save Changes")])):(0,a.Q3)("",!0),(0,a.Lk)("div",null,[e[10]||(e[10]=(0,a.Lk)("h2",null,"Add Order Status",-1)),e[11]||(e[11]=(0,a.Lk)("label",{for:"newStatusName"},"Name",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newStatusName","onUpdate:modelValue":e[4]||(e[4]=t=>i.newOrderStatus.name=t),placeholder:"Name"},null,512),[[d.Jo,i.newOrderStatus.name]]),e[12]||(e[12]=(0,a.Lk)("label",{for:"newStatusCode"},"Code",-1)),(0,a.bo)((0,a.Lk)("input",{id:"newStatusCode","onUpdate:modelValue":e[5]||(e[5]=t=>i.newOrderStatus.code=t),placeholder:"Code"},null,512),[[d.Jo,i.newOrderStatus.code]]),(0,a.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>r.addOrderStatus&&r.addOrderStatus(...t))},"Add Status")])])}const Za=new ot.A(!1);var tn={data(){return{orderStatusList:[],orderStatusData:{_id:"",name:"",code:"",order:0},newOrderStatus:{name:"",code:"",order:0},showStatusConfig:!1,configs:s.A.get("configs"),session:s.A.get("session")}},methods:{async fetchOrderStatuses(){try{const t=await Za.POST("shop_order_status/query",{method:"find",args:[{$and:[{unit:this.session.current._id}]}]},this.configs.key);200===t.status&&(this.orderStatusList=t.data.sort(((t,e)=>t.order-e.order)))}catch(t){console.error("Error fetching order statuses:",t)}},prepareEditStatus(t){this.orderStatusData={...t},this.showStatusConfig=!0},async updateOrderStatus(){try{const t=await Za.PUT(`shop_order_status/${this.orderStatusData._id}`,{data:{...this.orderStatusData,_id:void 0}},this.configs.key);200===t.status&&(await this.fetchOrderStatuses(),this.showStatusConfig=!1,this.resetOrderStatusData())}catch(t){console.error("Error updating order status:",t)}},async removeOrderStatus(t,e){try{const o=await Za.DELETE(`shop_order_status/${t}`,"",this.configs.key);200===o.status&&this.orderStatusList.splice(e,1)}catch(o){console.error("Error deleting order status:",o)}},async addOrderStatus(){try{const t=await Za.POST("shop_order_status/",{data:{...this.newOrderStatus,order:this.orderStatusList.length,unit:this.session.current._id||this.configs.siteID}},this.configs.key);200===t.status&&(this.orderStatusList.push(t.data),this.resetNewOrderStatus())}catch(t){console.error("Error adding order status:",t)}},moveStatusUp(t){if(t>0){const e=this.orderStatusList[t-1];this.orderStatusList[t-1]=this.orderStatusList[t],this.orderStatusList[t]=e,this.updateOrderIndices()}},moveStatusDown(t){if(t<this.orderStatusList.length-1){const e=this.orderStatusList[t+1];this.orderStatusList[t+1]=this.orderStatusList[t],this.orderStatusList[t]=e,this.updateOrderIndices()}},async updateOrderIndices(){try{for(let t=0;t<this.orderStatusList.length;t++)this.orderStatusList[t].order=t,await Za.PUT(`shop_order_status/${this.orderStatusList[t]._id}`,{data:{order:t}},this.configs.key)}catch(t){console.error("Error updating order indices:",t)}},resetOrderStatusData(){this.orderStatusData={_id:"",name:"",code:"",order:0}},resetNewOrderStatus(){this.newOrderStatus={name:"",code:"",order:0}}},async mounted(){await this.fetchOrderStatuses()}};const en=(0,it.A)(tn,[["render",Ya],["__scopeId","data-v-42913540"]]);var on=en,an={components:{Product:st,Inventory:ze,Category:co,Price:fo,Test:$o,ProductDetail:ia,Coupon:va,Store:Ne,Fee:Xa,Payment:Ba,Status:on}};const nn=(0,it.A)(an,[["render",l]]);var rn=nn;const sn={key:0,class:"absolute text-center"},ln={key:1,class:"text-center text-red-500"},un={class:"bg-gray-100 border-b border-gray-200"},dn={key:0,class:"mx-auto max-w-2xl px-4 pt-3 pb-3 sm:px-18 sm:pt-3 sm:pb-3 lg:grid lg:max-w-7xl lg:grid-cols-2 lg:gap-x-4"},cn={class:"lg:flex lg:items-center lg:justify-between"},pn={class:"flex","aria-label":"Breadcrumb"},hn={role:"list",class:"flex items-center space-x-4"},yn={class:"flex items-center"},mn={class:"flex items-center"},kn={class:"ml-4 text-sm font-bold text-gray-600 hover:text-gray-700 truncate"},gn={key:1,class:"mx-auto max-w-2xl px-4 pt-3 pb-3 sm:px-18 sm:pt-3 sm:pb-3 lg:grid lg:max-w-7xl lg:grid-cols-2 lg:gap-x-4"},bn={class:"grid grid-cols-2 gap-x-4"},vn={class:"bg-white"},Ln={class:"pb-16 pt-6 sm:pb-24"},fn={class:"mx-auto mt-4 sm:mt-8 max-w-2xl px-4 sm:px-6 lg:max-w-7xl lg:px-8"},Cn={class:"lg:grid lg:auto-rows-min lg:grid-cols-12 lg:gap-x-8"},wn={class:"lg:col-span-5 lg:col-start-8"},Pn={class:"flex justify-between"},Sn={class:"text-xl font-medium text-gray-900"},_n={class:"text-gray-500"},En={class:"font-bold"},xn={class:"block relative text-3xl mt-2 font-medium text-gray-900"},Dn=["innerHTML"],An={class:"mt-4 border-t border-gray-100 lg:col-span-5"},Tn={key:0},Un={class:"text-md mt-2 font-medium text-gray-500"},Fn={class:"mt-2"},Vn={class:"sr-only"},In={class:"grid grid-cols-4 gap-2 sm:grid-cols-6"},Xn=["name","value","aria-labelledby","onChange","checked","disabled"],Qn=["id"],qn={class:"mt-4 pt-4 border-t border-gray-100 flex flex-col items-center sm:flex-row sm:w-full"},Mn={class:"flex mt-1 w-full sm:w-auto"},$n=["disabled"],Nn=["max","disabled"],On=["disabled"],Jn={key:0,class:"flex w-full sm:w-auto ml-3 mt-2 text-md font-medium text-gray-500"},Kn={key:0,class:"mr-2"},Gn={class:"font-bold"},Bn={key:1,class:"text-red-500"},Wn={key:0},Rn={class:"mt-4 pt-4 border-t border-gray-100"},jn={key:0,type:"button",class:"flex w-full items-center justify-center rounded-md border border-transparent bg-gray-400 px-8 py-3 text-base font-medium text-gray-600 cursor-not-allowed bg-opacity-50"},Hn={key:1,class:"mt-3"},zn={class:"font-bold"};function Yn(t,e,o,n,i,r){const s=(0,a.g2)("router-link"),l=(0,a.g2)("font-awesome-icon"),c=(0,a.g2)("LoginPopup");return(0,a.uX)(),(0,a.CE)(a.FK,null,[i.isLoading?((0,a.uX)(),(0,a.CE)("div",sn)):(0,a.Q3)("",!0),i.isError?((0,a.uX)(),(0,a.CE)("div",ln,"Error occurred while fetching data.")):(0,a.Q3)("",!0),(0,a.Lk)("div",un,["desktop"===this.deviceType?((0,a.uX)(),(0,a.CE)("div",dn,[(0,a.Lk)("div",cn,[(0,a.Lk)("div",null,[(0,a.Lk)("nav",pn,[(0,a.Lk)("ol",hn,[(0,a.Lk)("li",null,[(0,a.Lk)("div",null,[(0,a.bF)(s,{to:"/",class:"text-gray-400 hover:text-gray-500"},{default:(0,a.k6)((()=>e[5]||(e[5]=[(0,a.Lk)("svg",{class:"h-5 w-5 flex-shrink-0",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true"},[(0,a.Lk)("path",{"fill-rule":"evenodd",d:"M9.293 2.293a1 1 0 011.414 0l7 7A1 1 0 0117 11h-1v6a1 1 0 01-1 1h-2a1 1 0 01-1-1v-3a1 1 0 00-1-1H9a1 1 0 00-1 1v3a1 1 0 01-1 1H5a1 1 0 01-1-1v-6H3a1 1 0 01-.707-1.707l7-7z","clip-rule":"evenodd"})],-1),(0,a.Lk)("span",{class:"sr-only"},"",-1)]))),_:1})])]),(0,a.Lk)("li",null,[(0,a.Lk)("div",yn,[e[7]||(e[7]=(0,a.Lk)("svg",{class:"h-5 w-5 flex-shrink-0 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true"},[(0,a.Lk)("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})],-1)),(0,a.bF)(s,{to:"/shop/products",class:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700 truncate"},{default:(0,a.k6)((()=>e[6]||(e[6]=[(0,a.eW)("")]))),_:1})])]),(0,a.Lk)("li",null,[(0,a.Lk)("div",mn,[e[8]||(e[8]=(0,a.Lk)("svg",{class:"h-5 w-5 flex-shrink-0 text-gray-300",fill:"currentColor",viewBox:"0 0 20 20","aria-hidden":"true"},[(0,a.Lk)("path",{d:"M5.555 17.776l8-16 .894.448-8 16-.894-.448z"})],-1)),(0,a.Lk)("span",kn,(0,u.v_)(r.productName),1)])])])])])])])):(0,a.Q3)("",!0),"mobile"===this.deviceType?((0,a.uX)(),(0,a.CE)("div",gn,[(0,a.Lk)("div",bn,[(0,a.bF)(s,{to:"/",class:"text-sm font-medium text-gray-500 hover:text-gray-700 justify-self-start"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{icon:["fas","home"]}),e[9]||(e[9]=(0,a.Lk)("span",{class:"ml-1"},"",-1))])),_:1}),(0,a.bF)(s,{to:"/shop/products",class:"ml-4 text-sm font-medium text-gray-500 hover:text-gray-700 justify-self-end"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{icon:["fas","chevron-left"]}),e[10]||(e[10]=(0,a.Lk)("span",{class:"ml-1"},"",-1))])),_:1})])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",vn,[(0,a.Lk)("div",Ln,[(0,a.Lk)("div",fn,[(0,a.Lk)("div",Cn,[(0,a.Lk)("div",wn,[(0,a.Lk)("div",Pn,[(0,a.Lk)("h1",Sn,(0,u.v_)(r.productName),1)]),(0,a.Lk)("p",_n,[(0,a.bF)(l,{icon:["fas","box-open"],class:"w-4 h-4 text-gray-400"}),e[11]||(e[11]=(0,a.eW)("  : ")),(0,a.Lk)("span",En,(0,u.v_)(i.mainProduct.stock),1),e[12]||(e[12]=(0,a.eW)(" "))]),(0,a.Lk)("p",xn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.formatPrice(i.mainProduct.regularPrice,i.mainProduct.salePrice),((t,e)=>((0,a.uX)(),(0,a.CE)("span",{key:e,class:(0,u.C4)(t.size),innerHTML:t.text},null,10,Dn)))),128))]),e[13]||(e[13]=(0,a.Fv)('<div class="mt-4"><h2 class="sr-only">Reviews</h2><div class="flex items-center"><p class="text-sm text-gray-700"> 3.9 <span class="sr-only"> out of 5 stars</span></p><div class="ml-1 flex items-center"><svg class="text-yellow-400 h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z" clip-rule="evenodd"></path></svg><svg class="text-yellow-400 h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z" clip-rule="evenodd"></path></svg><svg class="text-yellow-400 h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z" clip-rule="evenodd"></path></svg><svg class="text-yellow-400 h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z" clip-rule="evenodd"></path></svg><svg class="text-gray-200 h-5 w-5 flex-shrink-0" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true"><path fill-rule="evenodd" d="M10.868 2.884c-.321-.772-1.415-.772-1.736 0l-1.83 4.401-4.753.381c-.833.067-1.171 1.107-.536 1.651l3.62 3.102-1.106 4.637c-.194.813.691 1.456 1.405 1.02L10 15.591l4.069 2.485c.713.436 1.598-.207 1.404-1.02l-1.106-4.637 3.62-3.102c.635-.544.297-1.584-.536-1.65l-4.752-.382-1.831-4.401z" clip-rule="evenodd"></path></svg></div><div aria-hidden="true" class="ml-4 text-sm text-gray-300"></div><div class="ml-4 flex"><a href="#" class="text-sm font-medium text-indigo-600 hover:text-indigo-500">See all 512 reviews</a></div></div></div>',1))]),e[23]||(e[23]=(0,a.Fv)('<div class="mt-8 lg:col-span-7 lg:col-start-1 lg:row-span-3 lg:row-start-1 lg:mt-0"><h2 class="sr-only">Images</h2><div class="grid grid-cols-1 lg:grid-cols-2 lg:grid-rows-3 lg:gap-8"><img src="https://tailwindui.com/img/ecommerce-images/product-page-01-featured-product-shot.jpg" alt="Back of women&#39;s Basic Tee in black." class="lg:col-span-2 lg:row-span-2 rounded-lg"><img src="https://tailwindui.com/img/ecommerce-images/product-page-01-product-shot-01.jpg" alt="Side profile of women&#39;s Basic Tee in black." class="hidden lg:block rounded-lg"><img src="https://tailwindui.com/img/ecommerce-images/product-page-01-product-shot-02.jpg" alt="Front of women&#39;s Basic Tee in black." class="hidden lg:block rounded-lg"></div></div>',1)),(0,a.Lk)("div",An,[i.isLoading||i.isError?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",Tn,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(r.availableOptions,(t=>((0,a.uX)(),(0,a.CE)("div",{key:t.option},[(0,a.Lk)("h2",Un,(0,u.v_)(t.name)+" :",1),(0,a.Lk)("fieldset",Fn,[(0,a.Lk)("legend",Vn,"Choose a "+(0,u.v_)(t.name.toLowerCase()),1),(0,a.Lk)("div",In,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.terms,(e=>((0,a.uX)(),(0,a.CE)("label",{key:e.code,class:(0,u.C4)({"flex items-center justify-center rounded-md border py-2 px-2 text-sm font-medium uppercase sm:flex-1 cursor-pointer focus:outline-none":!0,"cursor-not-allowed opacity-25":e.disabled,"bg-blue-500 text-white":t.selectedTerm===e.code})},[(0,a.Lk)("input",{type:"radio",name:t.option,value:e.code,class:"sr-only","aria-labelledby":`${t.option}-choice-${e.code}-label`,onChange:o=>r.selectTerm(t.option,e.code),checked:t.selectedTerm===e.code,disabled:e.disabled},null,40,Xn),(0,a.Lk)("span",{id:`${t.option}-choice-${e.code}-label`,class:"select-none"},(0,u.v_)(e.name),9,Qn)],2)))),128))])])])))),128)),(0,a.Lk)("div",qn,[e[15]||(e[15]=(0,a.Lk)("label",{for:"quantity",class:"block text-md font-medium text-gray-500 mr-2 sm:w-auto w-full"},"",-1)),(0,a.Lk)("div",Mn,[(0,a.Lk)("button",{type:"button",class:"px-3 py-2 border-l border-t border-b border-gray-300 rounded-l-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-600",onClick:e[0]||(e[0]=(...t)=>r.decreaseQuantity&&r.decreaseQuantity(...t)),disabled:i.quantity<=1}," - ",8,$n),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"quantity",class:"w-full sm:w-14 px-3 py-2 border-t border-b border-gray-300 text-center rounded-none focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm","onUpdate:modelValue":e[1]||(e[1]=t=>i.quantity=t),max:i.matchingItem?i.matchingItem.stock:1,disabled:!i.matchingItem||i.matchingItem.stock<=0},null,8,Nn),[[d.Jo,i.quantity,void 0,{number:!0}]]),(0,a.Lk)("button",{type:"button",class:"px-3 py-2 border-r border-t border-b border-gray-300 rounded-r-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 bg-gray-100 text-gray-500 hover:bg-gray-200 hover:text-gray-600",onClick:e[2]||(e[2]=(...t)=>r.increaseQuantity&&r.increaseQuantity(...t)),disabled:!i.matchingItem||i.matchingItem.stock<=0||i.quantity>=i.matchingItem.stock}," + ",8,On)]),i.matchingItem?((0,a.uX)(),(0,a.CE)("p",Jn,[i.matchingItem.stock>0?((0,a.uX)(),(0,a.CE)("span",Kn,[e[14]||(e[14]=(0,a.eW)("  : ")),(0,a.Lk)("span",Gn,(0,u.v_)(i.matchingItem.stock)+" ",1)])):((0,a.uX)(),(0,a.CE)("span",Bn,[i.matchingItem.stock<=0?((0,a.uX)(),(0,a.CE)("span",Wn,"  ")):(0,a.Q3)("",!0)]))])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Rn,[r.selectedTermCount>0&&r.totalTermOptionsCount>0?((0,a.uX)(),(0,a.CE)("button",{key:0,type:"button",class:"mb-2 text-sm font-medium text-gray-500 hover:text-gray-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500",onClick:e[3]||(e[3]=(...t)=>r.resetSelectedTerms&&r.resetSelectedTerms(...t))},[(0,a.bF)(l,{icon:["fas","times"],class:"text-orange-600"}),e[16]||(e[16]=(0,a.eW)("  "))])):(0,a.Q3)("",!0),this.login?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[r.selectedTermCount<r.totalTermOptionsCount?((0,a.uX)(),(0,a.CE)("button",jn,[(0,a.bF)(l,{icon:["fas","info"],class:"w-4 h-4 text-gray-600 mr-2"}),e[17]||(e[17]=(0,a.eW)("  "))])):r.selectedTermCount>=r.totalTermOptionsCount&&i.matchingItem&&i.matchingItem.stock>0?((0,a.uX)(),(0,a.CE)("button",{key:1,type:"button",class:"flex w-full items-center justify-center rounded-md border border-transparent bg-indigo-600 px-8 py-3 text-base font-medium text-white hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2",onClick:e[4]||(e[4]=(...t)=>r.addToCart&&r.addToCart(...t))},[(0,a.bF)(l,{icon:["fas","shopping-cart"],class:"w-4 h-4 text-white mr-2"}),e[18]||(e[18]=(0,a.eW)("  "))])):(0,a.Q3)("",!0)],64)):((0,a.uX)(),(0,a.Wv)(c,{key:2,onLoginSuccess:r.handleLoginSuccess},null,8,["onLoginSuccess"]))])])),i.matchingItem&&Object.keys(i.matchingItem).length?((0,a.uX)(),(0,a.CE)("p",Hn,[e[19]||(e[19]=(0,a.eW)("SKU: ")),(0,a.Lk)("span",zn,(0,u.v_)(i.matchingItem.sku),1)])):(0,a.Q3)("",!0),e[20]||(e[20]=(0,a.Lk)("div",{class:"mt-10"},[(0,a.Lk)("h2",{class:"text-sm font-medium text-gray-900"},"Description"),(0,a.Lk)("div",{class:"prose prose-sm mt-4 text-gray-500"},[(0,a.Lk)("p",null,"The Basic tee is an honest new take on a classic. The tee uses super soft, pre-shrunk cotton for true comfort and a dependable fit. They are hand cut and sewn locally, with a special dye technique that gives each tee it's own look."),(0,a.Lk)("p",null,"Looking to stock your closet? The Basic tee also comes in a 3-pack or 5-pack at a bundle discount.")])],-1)),e[21]||(e[21]=(0,a.Lk)("div",{class:"mt-8 border-t border-gray-200 pt-8"},[(0,a.Lk)("h2",{class:"text-sm font-medium text-gray-900"},"Fabric & Care"),(0,a.Lk)("div",{class:"prose prose-sm mt-4 text-gray-500"},[(0,a.Lk)("ul",{role:"list"},[(0,a.Lk)("li",null,"Only the best materials"),(0,a.Lk)("li",null,"Ethically and locally made"),(0,a.Lk)("li",null,"Pre-washed and pre-shrunk"),(0,a.Lk)("li",null,"Machine wash cold with similar colors")])])],-1)),e[22]||(e[22]=(0,a.Fv)('<section aria-labelledby="policies-heading" class="mt-10"><h2 id="policies-heading" class="sr-only">Our Policies</h2><dl class="grid grid-cols-1 gap-6 sm:grid-cols-2 lg:grid-cols-1 xl:grid-cols-2"><div class="rounded-lg border border-gray-200 bg-gray-50 p-6 text-center"><dt><svg class="mx-auto h-6 w-6 flex-shrink-0 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M6.115 5.19l.319 1.913A6 6 0 008.11 10.36L9.75 12l-.387.775c-.217.433-.132.956.21 1.298l1.348 1.348c.21.21.329.497.329.795v1.089c0 .426.24.815.622 1.006l.153.076c.433.217.956.132 1.298-.21l.723-.723a8.7 8.7 0 002.288-4.042 1.087 1.087 0 00-.358-1.099l-1.33-1.108c-.251-.21-.582-.299-.905-.245l-1.17.195a1.125 1.125 0 01-.98-.314l-.295-.295a1.125 1.125 0 010-1.591l.13-.132a1.125 1.125 0 011.3-.21l.603.302a.809.809 0 001.086-1.086L14.25 7.5l1.256-.837a4.5 4.5 0 001.528-1.732l.146-.292M6.115 5.19A9 9 0 1017.18 4.64M6.115 5.19A8.965 8.965 0 0112 3c1.929 0 3.716.607 5.18 1.64"></path></svg><span class="mt-4 text-sm font-medium text-gray-900">International delivery</span></dt><dd class="mt-1 text-sm text-gray-500">Get your order in 2 years</dd></div><div class="rounded-lg border border-gray-200 bg-gray-50 p-6 text-center"><dt><svg class="mx-auto h-6 w-6 flex-shrink-0 text-gray-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true"><path stroke-linecap="round" stroke-linejoin="round" d="M12 6v12m-3-2.818l.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg><span class="mt-4 text-sm font-medium text-gray-900">Loyalty rewards</span></dt><dd class="mt-1 text-sm text-gray-500">Don&#39;t look at other tees</dd></div></dl></section>',1))])])])])])],64)}o(37550);var Zn=o(9964),ti=o(17056),ei=o(6138),oi=o(57313),ai={inject:["eventBus"],name:"ProductDetail",components:{LoginPopup:ei.A},data(){return{login:s.A.get("session","login"),configs:s.A.get("configs"),deviceType:oi.A.deviceDetect(),mainSKU:this.$route.params.id,variantSKU:this.$route.params.variant,mainProduct:[],isLoading:!0,isError:!1,selectedTerms:{},matchingItem:{},quantity:1}},mounted(){this.fetchMainProduct()},watch:{selectedTerms:{handler(){this.selectedTermCount===this.totalTermOptionsCount&&this.findMatchingItem()},deep:!0},variantSKU:{handler(){this.variantSKU&&console.log("variantSKU found")},immediate:!0}},computed:{availableOptions(){return this.mainProduct?.configurableOptions?.map((t=>{const e=this.selectedTerms[t.option],o=t.terms.filter((e=>this.shouldShowOption(t.option,e.code)));return{...t,filteredTerms:o,selectedTerm:e||null}}))},selectedTermCount(){return Object.keys(this.selectedTerms).length},totalTermOptionsCount(){return this.availableOptions&&Array.isArray(this.availableOptions)?this.availableOptions.length:0},productName(){return this.selectedTermCount<this.totalTermOptionsCount?this.mainProduct.name:this.matchingItem?this.matchingItem.name:this.mainProduct.name}},methods:{emitEvent(){this.eventBus.emit("cart-event","Event payload")},handleLoginSuccess(){console.log("Login Success")},changePageName(){console.log("changePageName",this.matchingItem.name),this.$setPageTitle(this.matchingItem.name)},resetSelectedTerms(){this.selectedTerms={},this.matchingItem={};const t=`/shop/product/${this.$route.params.id}`;window.history.replaceState({},"",t)},formatPrice(t,e){return Zn.A.formatPriceRaw(t,e)},decreaseQuantity(){this.quantity>1&&this.quantity--},increaseQuantity(){this.matchingItem&&this.quantity<this.matchingItem.stock&&this.quantity++},findMatchingItem(){const t=this.mainProduct.subProducts.find((t=>Object.entries(this.selectedTerms).every((([e,o])=>t.config.includes(`${e} : ${o}`)))));if(t){this.variantSKU=t.sku,console.log("Matching item found:",t);const e=t.sku,o=`/shop/product/${this.$route.params.id}/${e}`;window.history.replaceState({},"",o)}else{const t=`/shop/product/${this.$route.params.id}`;window.history.replaceState({},"",t)}this.matchingItem=t,this.changePageName()},shouldShowOption(t,e){const o={...this.selectedTerms};return o[t]=e,this.mainProduct.subProducts.some((t=>Object.entries(o).every((([e,o])=>t[e]===o))))},selectTerm(t,e){this.selectedTerms={...this.selectedTerms,[t]:e},this.quantity=1;const o={...this.selectedTerms},a=this.mainProduct?.subProducts?.find((t=>Object.entries(o).every((([e,o])=>t[e]===o))));a&&(this.mainProduct={...a})},async fetchMainProduct(){const t=this.mainSKU,e=[{$match:{_id:t,type:"main"}},{$lookup:{from:"product",let:{mainId:"$_id"},pipeline:[{$match:{$expr:{$eq:["$parent",{$toString:"$$mainId"}]}}}],as:"subProducts"}}];try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/product/aggregate",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({pipeline:e})});if(!t.ok)throw new Error("Failed to fetch main product");const o=await t.json();if(this.mainProduct=o[0],this.$setPageTitle(this.mainProduct.name),"simple"===this.mainProduct.option&&(this.selectedTerms=this.mainProduct,this.matchingItem=this.mainProduct),this.variantSKU){const t=this.mainProduct.subProducts.find((t=>t.sku===this.variantSKU));t&&t.config?this.selectedTerms=t.config.reduce(((t,e)=>{const[o,a]=e.split(" : ");return t[o]=a,t}),{}):this.selectedTerms={},this.$setPageTitle(t.name)}this.isLoading=!1}catch(o){this.isError=!0,this.isLoading=!1}},addToCart(){let t;t=0===this.matchingItem.salePrice||null===this.matchingItem.salePrice||void 0===this.matchingItem.salePrice||""===this.matchingItem.salePrice||"string"===typeof this.matchingItem.salePrice&&""===this.matchingItem.salePrice.trim()?this.matchingItem.regularPrice:this.matchingItem.salePrice<this.matchingItem.regularPrice?this.matchingItem.salePrice:this.matchingItem.regularPrice;const e={productId:this.matchingItem._id,name:this.matchingItem.name,price:t,quantity:this.quantity};console.log(this.matchingItem),console.log(t),(0,ti.bE)(e,e.quantity).then((async t=>{await this.fetchMainProduct(),this.eventBus.emit("cart-event","Event payload"),this.$swal({toast:!0,position:"bottom-end",showConfirmButton:!1,timer:4e3,icon:"success",title:"",text:" "+e.name+"  "+e.quantity+"  "}).then((()=>{})),console.log(t)})).catch((t=>{console.error("Error adding item to cart:",t)}))}}};const ni=(0,it.A)(ai,[["render",Yn]]);var ii=ni,ri={name:"Lesson Detail",components:{Backend:rn,Frontend:ii},data(){return{session:s.A.get("session")}},setup(){const t=(0,r.lq)(),e=t.meta.title;(0,i.K7)(e)},computed:{componentName(){return"backend"===this.session.interface?"Backend":"frontend"===this.session.interface?"Frontend":(console.error("Invalid interface:",this.session.interface),null)}}};const si=(0,it.A)(ri,[["render",n]]);var li=si},57313:function(t,e){class o{isMobile(){return window.innerWidth<=768}deviceDetect(){return this.isMobile()?"mobile":"desktop"}}const a=new o;e.A=a},48646:function(t,e,o){var a=o(69565),n=o(28551),i=o(1767),r=o(50851);t.exports=function(t,e){e&&"string"===typeof t||n(t);var o=r(t);return i(n(void 0!==o?a(o,t):t))}},81148:function(t,e,o){var a=o(46518),n=o(72652),i=o(79306),r=o(28551),s=o(1767);a({target:"Iterator",proto:!0,real:!0},{every:function(t){r(this),i(t);var e=s(this),o=0;return!n(e,(function(e,a){if(!t(e,o++))return a()}),{IS_RECORD:!0,INTERRUPTED:!0}).stopped}})},30531:function(t,e,o){var a=o(46518),n=o(69565),i=o(79306),r=o(28551),s=o(1767),l=o(48646),u=o(19462),d=o(9539),c=o(96395),p=u((function(){var t,e,o=this.iterator,a=this.mapper;while(1){if(e=this.inner)try{if(t=r(n(e.next,e.iterator)),!t.done)return t.value;this.inner=null}catch(i){d(o,"throw",i)}if(t=r(n(this.next,o)),this.done=!!t.done)return;try{this.inner=l(a(t.value,this.counter++),!1)}catch(i){d(o,"throw",i)}}}));a({target:"Iterator",proto:!0,real:!0,forced:c},{flatMap:function(t){return r(this),i(t),new p(s(this),{mapper:t,inner:null})}})},23215:function(t,e,o){o(81148)},30670:function(t,e,o){o(30531)}}]);
//# sourceMappingURL=6768.0783b907.js.map