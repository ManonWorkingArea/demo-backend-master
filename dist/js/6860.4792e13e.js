"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[6860],{48659:function(e,t,o){o.d(t,{A:function(){return N}});var i=o(20641),s=o(90033),n=o(53751);const a={class:"mx-auto"},c={class:"flex justify-between items-center mb-4 border-b pb-2 pt-2 pl-2 pr-2 border-gray-200"},l={class:"p-4"},r={class:"grid grid-cols-1 md:grid-cols-2 gap-2"},d={class:"flex items-center justify-between"},f={class:"text-md font-semibold"},u={class:"text-xs text-gray-500 mt-1"},g={class:"text-sm text-gray-600 mt-1"},m={class:"mt-4 flex justify-between"},h={class:"space-x-2"},p=["onClick"],k=["onClick"],y={class:"space-x-2"},b=["onClick"],v=["onClick"],x={key:0,class:"fixed inset-0 flex items-center justify-center"},w={class:"bg-white rounded p-5 z-10"},L={class:"flex flex-col space-y-2"},G={class:"flex justify-end mt-6 space-x-4"},A={key:1,class:"fixed inset-0 flex items-center justify-center z-50"},C={class:"bg-white rounded p-5 z-10"},D={class:"flex justify-end mt-6 space-x-4"};function _(e,t,o,_,R,E){const T=(0,i.g2)("font-awesome-icon");return(0,i.uX)(),(0,i.CE)("div",a,[(0,i.Lk)("div",null,[(0,i.Lk)("div",c,[t[8]||(t[8]=(0,i.Lk)("h3",{class:"text-md font-bold"},"Gifts",-1)),(0,i.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>E.addGift&&E.addGift(...e)),class:"primary-btn px-4 py-2 bg-blue-500 text-white rounded shadow-sm hover:bg-blue-600"}," เพิ่ม Gift ")]),(0,i.Lk)("div",l,[(0,i.Lk)("div",r,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(R.gifts,(e=>((0,i.uX)(),(0,i.CE)("div",{key:e._id,class:"bg-white p-5 rounded-sm shadow-sm"},[(0,i.Lk)("div",d,[(0,i.Lk)("h3",f,(0,s.v_)(E.getGiftIndex(e))+"."+(0,s.v_)(e.name),1)]),(0,i.Lk)("p",u,(0,s.v_)(e.code),1),(0,i.Lk)("p",g,(0,s.v_)(e.description),1),(0,i.Lk)("div",m,[(0,i.Lk)("div",h,[(0,i.Lk)("button",{onClick:t=>E.moveGiftUp(e),class:"text-sm text-gray-500 hover:text-gray-700"},[(0,i.bF)(T,{icon:["fas","chevron-up"],class:"pr-2 pl-2"})],8,p),(0,i.Lk)("button",{onClick:t=>E.moveGiftDown(e),class:"text-sm text-gray-500 hover:text-gray-700"},[(0,i.bF)(T,{icon:["fas","chevron-down"],class:"pr-2 pl-2"})],8,k)]),(0,i.Lk)("div",y,[(0,i.Lk)("button",{onClick:t=>E.openRenameDialog(e),class:"text-sm text-gray-500 hover:text-gray-700"},[(0,i.bF)(T,{icon:["fas","edit"],class:"pl-2"}),t[9]||(t[9]=(0,i.eW)(" เปลี่ยนชื่อ "))],8,b),(0,i.Lk)("button",{onClick:t=>E.removeGiftConfirmation(e),class:"text-sm text-red-500 hover:text-red-700"},[(0,i.bF)(T,{icon:["fas","trash"],class:"pl-2"}),t[10]||(t[10]=(0,i.eW)(" ลบ "))],8,v)])])])))),128))])])]),R.showRenameDialog?((0,i.uX)(),(0,i.CE)("div",x,[t[15]||(t[15]=(0,i.Lk)("div",{class:"absolute inset-0 bg-black opacity-75",style:{"z-index":"10"}},null,-1)),(0,i.Lk)("div",w,[t[14]||(t[14]=(0,i.Lk)("h4",{class:"text-xl font-semibold mb-4"},"เปลี่ยนชื่อ Gift",-1)),(0,i.Lk)("div",L,[t[11]||(t[11]=(0,i.Lk)("label",{for:"newName",class:"font-medium"},"ชื่อใหม่",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>R.selectedGift.name=e),type:"text",id:"newName",placeholder:"Enter the new name",class:"px-4 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring focus:border-blue-500"},null,512),[[n.Jo,R.selectedGift.name]]),t[12]||(t[12]=(0,i.Lk)("label",{for:"newCode",class:"font-medium"},"รหัสใหม่",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>R.selectedGift.code=e),type:"text",id:"newCode",placeholder:"Enter the new code",class:"px-4 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring focus:border-blue-500"},null,512),[[n.Jo,R.selectedGift.code]]),t[13]||(t[13]=(0,i.Lk)("label",{for:"newDescription",class:"font-medium"},"คำอธิบาย",-1)),(0,i.bo)((0,i.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>R.selectedGift.description=e),id:"newDescription",placeholder:"Enter the new description",class:"px-4 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring focus:border-blue-500"},null,512),[[n.Jo,R.selectedGift.description]])]),(0,i.Lk)("div",G,[(0,i.Lk)("button",{onClick:t[4]||(t[4]=e=>E.renameGift(R.selectedGift)),class:"px-6 py-2 text-sm font-medium text-white bg-blue-500 rounded-sm hover:bg-blue-600"},"Rename"),(0,i.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>E.closeRenameDialog&&E.closeRenameDialog(...e)),class:"px-6 py-2 text-sm font-medium text-gray-500 hover:text-gray-700"},"Cancel")])])])):(0,i.Q3)("",!0),R.showConfirmationPopup?((0,i.uX)(),(0,i.CE)("div",A,[t[18]||(t[18]=(0,i.Lk)("div",{class:"absolute inset-0 bg-black opacity-75"},null,-1)),(0,i.Lk)("div",C,[t[16]||(t[16]=(0,i.Lk)("h4",{class:"text-xl font-semibold mb-4"},"Confirm Remove Gift",-1)),t[17]||(t[17]=(0,i.Lk)("p",null,"Are you sure you want to remove the gift?",-1)),(0,i.Lk)("div",D,[(0,i.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>E.confirmRemoveGift&&E.confirmRemoveGift(...e)),class:"px-6 py-2 text-sm font-medium text-white bg-red-500 rounded-sm"},"Remove"),(0,i.Lk)("button",{onClick:t[7]||(t[7]=(...t)=>e.cancelRemoveGift&&e.cancelRemoveGift(...t)),class:"px-6 py-2 text-sm font-medium text-gray-500 hover:text-gray-700"},"Cancel")])])])):(0,i.Q3)("",!0)])}var R=o(40475),E={name:"GiftList",props:{eventDetails:{type:Object,required:!0}},data(){return{session:R.A.get("session"),configs:R.A.get("configs"),gifts:[],showRenameDialog:!1,selectedGift:null,showConfirmationPopup:!1,giftToRemove:null}},computed:{getGiftIndex(){return e=>this.gifts.findIndex((t=>t._id===e._id))+1}},async mounted(){try{console.log("Event Details:",this.eventDetails),await this.getGiftData()}catch(e){console.log(e)}},methods:{async getGiftData(){try{const e=await fetch("https://gateway.cloudrestfulapi.com/api/vote_gift/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({method:"find",args:[{unit:this.session.current._id,eventID:this.eventDetails._id}],paging:{page:1,limit:200}})});if(e.ok){const t=await e.json();this.gifts=t.data}}catch(e){console.error(e)}},async addGift(){try{const e={unit:this.session.current._id,name:"New Gift",code:"gift-code",description:"Description for New Gift",eventID:this.eventDetails._id,visible:!0},t=await fetch("https://gateway.cloudrestfulapi.com/api/vote_gift/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:e,options:{}})});t.ok&&await this.getGiftData()}catch(e){console.error(e)}},async updateGift(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/vote_gift/"+e._id,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{name:e.name,code:e.code,description:e.description,visible:e.visible},options:{}})});t.ok&&await this.getGiftData()}catch(t){console.error(t)}},async deleteGift(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/vote_gift/"+e._id,{method:"DELETE",headers:{"Content-Type":"application/json","client-token-key":this.configs.key}});t.ok&&await this.getGiftData()}catch(t){console.error(t)}},moveGiftUp(e){const t=this.gifts.findIndex((t=>t._id===e._id));if(t>0){const e=this.gifts.splice(t,1)[0];this.gifts.splice(t-1,0,e)}},moveGiftDown(e){const t=this.gifts.findIndex((t=>t._id===e._id));if(t<this.gifts.length-1){const e=this.gifts.splice(t,1)[0];this.gifts.splice(t+1,0,e)}},async removeGiftConfirmation(e){this.giftToRemove=e,this.showConfirmationPopup=!0},async confirmRemoveGift(){try{await this.deleteGift(this.giftToRemove),this.giftToRemove=null,this.showConfirmationPopup=!1}catch(e){console.error(e)}},openRenameDialog(e){this.selectedGift=e,this.showRenameDialog=!0},async renameGift(e){try{await this.updateGift(e),this.selectedGift=null,this.showRenameDialog=!1}catch(t){console.error(t)}},closeRenameDialog(){this.selectedGift=null,this.showRenameDialog=!1}}},T=o(64621);const j=(0,T.A)(E,[["render",_],["__scopeId","data-v-db7d2eca"]]);var N=j},64479:function(e,t,o){o.r(t),o.d(t,{default:function(){return g}});var i=o(20641);function s(e,t,o,s,n,a){const c=(0,i.g2)("Authen"),l=(0,i.g2)("Dashboard");return(0,i.uX)(),(0,i.CE)(i.FK,null,[(0,i.bF)(c),this.login?((0,i.uX)(),(0,i.Wv)(l,{key:0})):(0,i.Q3)("",!0)],64)}var n=o(52968),a=o(75220),c=o(48659),l=o(74284),r=o(40475),d={name:"Home",components:{Dashboard:c.A,Authen:l.A},data(){return{login:r.A.get("session","login")}},methods:{},mounted(){},setup(){const e=(0,a.lq)(),t=e.meta.title;(0,n.K7)(t),console.log("Dashboard")}},f=o(64621);const u=(0,f.A)(d,[["render",s]]);var g=u},74284:function(e,t,o){o.d(t,{A:function(){return f}});var i=o(20641);function s(e,t,o,s,n,a){return(0,i.uX)(),(0,i.CE)("div")}var n=o(75220),a=o(63084),c=o(40475),l={name:"Authen",data(){return{configs:c.A.get("configs"),session:c.A.get("session")}},created(){a.A.option(this.$route)},computed:{},components:{},mounted(){this.checkAuth()},updated(){},methods:{async checkAuth(){const e=(0,n.lq)(),t=e.meta.auth,o=e.name,i=c.A.get("session");let s=i.token,l=i.login,r=i.current;a.A.log("hasLogin",l),a.A.log("Page -> Auth:",t),a.A.log("User -> Token:",s),a.A.log("User -> Login:",l),"frontend"===this.session.interface?a.A.log("Front-End"):"backend"===this.session.interface&&(a.A.log("Back-End"),l?("Login"==o||void 0==r?(a.A.log("Not Login Again"),this.$router.replace({path:"/"})):(a.A.log("Has School Active"),t?(a.A.log("This page is : Authen Request"),""===s||null===s||void 0==s?a.A.log("Your Cannot Access"):a.A.log("Your Can Access")):a.A.log("This page is : No Authen Request")),a.A.log("Login")):(a.A.log("Not Login"),"Login"!=o?(window.location.href="/member/login",a.A.log("Not Login Page",o)):a.A.log("Login Page",o)))}},setup(){}},r=o(64621);const d=(0,r.A)(l,[["render",s]]);var f=d}}]);
//# sourceMappingURL=6860.4792e13e.js.map