(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[7596],{42992:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return nt}});var a=s(20641),o=s(90033);const r={key:0,class:"text-center"},i={class:"bg-white border-b border-gray-200"},n={key:0,class:"mx-auto max-w-3xl px-4 sm:px-6 lg:max-w-7xl lg:px-8"},l={class:"pt-5"},d={class:"mx-auto max-w-3xl md:flex md:items-center md:justify-between md:space-x-5 lg:max-w-7xl"},c={class:"flex items-center space-x-5"},u={class:"flex-shrink-0"},m={class:"relative"},p={class:"h-24 w-24 rounded-md cursor-pointer"},g=["src"],h={class:"text-2xl font-bold text-gray-900"},f={class:"text-sm text-gray-800"},b={class:"text-gray-500"},x={class:"text-sm text-gray-800"},y={class:"text-gray-500"},k={class:"text-sm text-gray-800"},v={class:"text-gray-500"},w={class:"justify-stretch mt-6 flex flex-col-reverse space-y-4 space-y-reverse sm:flex-row-reverse sm:justify-end sm:space-y-0 sm:space-x-3 sm:space-x-reverse md:mt-0 md:flex-row md:space-x-3"},L={type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},C={class:"border-t border-gray-200 pt-3 mt-5"},_={class:"flex space-x-2",id:"tab-list"},E=["onClick"],D={class:"hidden md:inline"},T={key:0,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},A={key:1,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},I={class:"md:hidden text-xs"},P=["value"],$={class:"mx-auto mt-8 grid max-w-3xl grid-cols-1 gap-6 sm:px-6 lg:max-w-7xl lg:grid-flow-col-dense lg:grid-cols-1"},S={class:"space-y-6 lg:col-span-2 lg:col-start-1"},X={key:0,"aria-labelledby":"applicant-information-title"},F={key:1,"aria-labelledby":"applicant-information-title"},U={key:2,"aria-labelledby":"applicant-information-title"},j={key:3,"aria-labelledby":"applicant-information-title"};function W(e,t,s,W,R,B){const M=(0,a.g2)("Loader"),H=(0,a.g2)("Subhead"),O=(0,a.g2)("Image"),z=(0,a.g2)("font-awesome-icon"),Q=(0,a.g2)("copy-button"),N=(0,a.g2)("Enroll"),Y=(0,a.g2)("Order"),K=(0,a.g2)("Document"),J=(0,a.g2)("Profile");return(0,a.uX)(),(0,a.CE)(a.FK,null,[R.loading_sources?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(M)])),R.loading_sources?((0,a.uX)(),(0,a.Wv)(H,{key:1,navigation:[{name:"ย้อนกลับ",link:this.back?this.back:"/student/dashboard",style:"chevron-left",class:"default-btn",visible:!0,type:"button"}]},null,8,["navigation"])):(0,a.Q3)("",!0),R.showPopup?((0,a.uX)(),(0,a.Wv)(O,{key:2,cropImageWidth:"600px",cropImageHeight:"600px",uploadPath:"Upload/_profile/",imageUrl:e.imageUrl,filePrefix:this.profile._id,onFileUrlUpdated:B.handleFileUrlUpdated,onClosePopupEvent:B.closePopup},null,8,["imageUrl","filePrefix","onFileUrlUpdated","onClosePopupEvent"])):(0,a.Q3)("",!0),(0,a.Lk)("div",i,[R.loading_sources?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",l,[(0,a.Lk)("div",d,[(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[((0,a.uX)(),(0,a.CE)("img",{class:"h-full w-full rounded-md",src:R.profile.avatar_img,key:R.profile.avatar_img,alt:""},null,8,g)),(0,a.Lk)("div",{class:"absolute inset-0 rounded-md bg-black bg-opacity-0 hover:bg-opacity-50 flex justify-center items-center transition duration-300",onClick:t[0]||(t[0]=e=>B.openPopup(R.profile.avatar_img))},[(0,a.bF)(z,{icon:["fas","upload"],class:"text-white text-[24px] opacity-0 hover:opacity-100"})])])])]),(0,a.Lk)("div",null,[(0,a.Lk)("h1",h,(0,o.v_)(this.profile.firstname+" "+this.profile.lastname),1),(0,a.Lk)("p",f,[t[3]||(t[3]=(0,a.eW)("ลงทะเบียน : ")),(0,a.Lk)("span",b,(0,o.v_)(this.profile?.createdAt),1)]),(0,a.Lk)("p",x,[t[4]||(t[4]=(0,a.eW)("Email : ")),(0,a.Lk)("span",y,(0,o.v_)(this.profile?.email),1)]),(0,a.Lk)("p",k,[t[5]||(t[5]=(0,a.eW)("Phone : ")),(0,a.Lk)("span",v,(0,o.v_)(this.profile?.phone),1)])])]),(0,a.Lk)("div",w,[(0,a.bF)(Q,{class:"ml-1 text-gray-600 text-sm",text:`https://${this.session.current.hostname}/user/bypass/${this.profile._id}`,buttonText:"คัดลอกลิงค์เข้าสู่ระบบ",buttonTextDone:"คัดลอกแล้ว"},null,8,["text"]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>{B.redirectToExternalUrl(this.profile._id)}),type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},[(0,a.bF)(z,{icon:["fas","key"],class:"text-black text-[12px] mr-2"}),t[6]||(t[6]=(0,a.eW)(" เข้าสู่ระบบ "))]),(0,a.Lk)("button",L,[(0,a.bF)(z,{icon:["fas","trash"],class:"text-black text-[12px] mr-2"}),t[7]||(t[7]=(0,a.eW)(" ลบ "))])])])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",C,[(0,a.Lk)("ul",_,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(R.tabs,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.code,class:(0,o.C4)([{"text-gray-500":R.activeTab!==e.code,"text-black":R.activeTab===e.code,"border-b-4 border-blue-500":R.activeTab===e.code},"cursor-pointer py-2 px-2"]),onClick:t=>B.setActiveTab(e.code)},[(0,a.Lk)("span",D,[(0,a.bF)(z,{icon:["fas",e.icon]},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(e.name)+" ",1),"enroll"===e.code?((0,a.uX)(),(0,a.CE)("span",T,(0,o.v_)(R.enroll.length),1)):(0,a.Q3)("",!0),"material"===e.code?((0,a.uX)(),(0,a.CE)("span",A,"0")):(0,a.Q3)("",!0)]),(0,a.Lk)("span",I,[(0,a.bF)(z,{icon:["fas",e.icon]},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(e.shortname),1)])],10,E)))),128))]),(0,a.Lk)("select",{class:"mb-3 md:hidden w-full border border-gray-300 rounded-md",id:"tab-dropdown",onChange:t[2]||(t[2]=e=>B.setActiveTab(e.target.value))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(R.tabs,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t.code,value:t.code},[(0,a.eW)((0,o.v_)(t.name)+" ",1),"enroll"===t.code?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,o.v_)(R.enroll.length),1)],64)):(0,a.Q3)("",!0),"material"===t.code?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,o.v_)(e.playerCount),1)],64)):(0,a.Q3)("",!0)],8,P)))),128))],32)])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",$,[(0,a.Lk)("div",S,["enroll"===R.activeTab?((0,a.uX)(),(0,a.CE)("section",X,[R.profileLoaded?((0,a.uX)(),(0,a.Wv)(N,{key:0,enrolls:R.enroll,member:R.profile,ref:"enroll",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["enrolls","member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"order"===R.activeTab?((0,a.uX)(),(0,a.CE)("section",F,[R.profileLoaded?((0,a.uX)(),(0,a.Wv)(Y,{key:0,member:R.profile,ref:"order",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"document"===R.activeTab?((0,a.uX)(),(0,a.CE)("section",U,[R.profileLoaded?((0,a.uX)(),(0,a.Wv)(K,{key:0,member:R.profile,ref:"document",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"profile"===R.activeTab?((0,a.uX)(),(0,a.CE)("section",j,[R.profileLoaded?((0,a.uX)(),(0,a.Wv)(J,{key:0,member:R.profile,ref:"profile",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])])],64)}s(98992),s(72577),s(14603),s(47566),s(98721);var R=s(59911),B=s.n(R),M=s(75435),H=s(87814),O=s(61628),z=s(75220),Q=s(40475),N=s(9964),Y=s(95093),K=s.n(Y),J=s(53751);const G={class:"bg-white shadow sm:rounded-lg"},q={class:"grid grid-cols-1 md:grid-cols-2 px-2 py-3 sm:px-3 items-center"},V={class:"md:flex justify-end mt-4 md:mt-0"},Z={class:"grid grid-cols-1 sm:grid-cols-3 gap-2"},ee={class:"bg-blue-50 p-2 rounded-sm flex items-center"},te={class:"ml-2"},se={class:"text-2xl font-semibold"},ae={class:"bg-blue-50 p-2 rounded-sm flex items-center"},oe={class:"ml-2"},re={class:"text-2xl font-semibold"},ie={class:"bg-blue-50 p-2 rounded-sm flex items-center"},ne={class:"ml-2"},le={class:"text-2xl font-semibold"},de={class:"container mx-auto p-4"},ce={class:"grid grid-cols-1 md:grid-cols-6 gap-0"},ue={class:"md:col-span-1 flex flex-col items-start"},me={class:"w-full border-b border-t border-gray-200 flex items-center pr-2 pt-2 pb-2"},pe={class:"text-xs text-gray-600 mr-2 font-semibold"},ge={class:"text-xs text-gray-600"},he={class:"w-full border-b border-gray-200 flex items-center mb-2 pt-2 pb-2"},fe={class:"text-xs text-gray-600 mr-2 font-semibold"},be=["onUpdate:modelValue"],xe={class:"md:col-span-5 border-l border-gray-200 pl-2"},ye={class:"text-lg font-bold mb-2"},ke={class:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-2"},ve={key:0,class:"bg-gray-100 p-2 rounded-xs shadow col-span-2 md:col-span-1"},we={class:"grid grid-cols-2 gap-2"},Le={class:"text-right"},Ce={class:"mt-1"},_e={class:"w-full bg-gray-200 h-1"},Ee={class:"text-xs mt-2 text-gray-400"},De={key:1,class:"grid grid-cols-3 gap-2 col-span-2 md:col-span-3"},Te={class:"text-2xl font-semibold"},Ae={class:"text-2xl font-semibold"},Ie={class:"text-2xl font-semibold"},Pe={class:"grid grid-cols-1 md:grid-cols-4 gap-2 mb-4"},$e={class:"text-2xl font-semibold"},Se={class:"text-2xl font-semibold"},Xe={class:"text-2xl font-semibold"},Fe={key:0,class:"bg-gray-300 text-gray-700 px-4 py-2 mt-1 text-sm rounded-xs",disabled:""},Ue=["onClick"],je={key:2,class:"bg-red-600 text-white px-4 py-2 mt-1 text-sm rounded-xs",disabled:""};function We(e,t,s,r,i,n){const l=(0,a.g2)("Image"),d=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",G,[(0,a.Lk)("div",q,[t[9]||(t[9]=(0,a.Lk)("div",null,[(0,a.Lk)("h2",{id:"applicant-information-title",class:"text-lg font-bold leading-6 text-gray-900"},"หลักสูตรที่ลงทะเบียน"),(0,a.Lk)("p",{class:"text-gray-300"},"Student Enroll Lesson")],-1)),(0,a.Lk)("div",V,[(0,a.Lk)("div",Z,[(0,a.Lk)("div",ee,[t[2]||(t[2]=(0,a.Lk)("div",{class:"flex-shrink-0 border-r border-gray-200 pr-2 mr-2"},[(0,a.Lk)("i",{class:"fas fa-user-check text-2xl text-gray-500"})],-1)),(0,a.Lk)("div",te,[t[1]||(t[1]=(0,a.Lk)("h3",{class:"text-sm text-gray-400"},"ลงทะเบียน",-1)),(0,a.Lk)("p",se,[(0,a.eW)((0,o.v_)(n.formatNumber(i.summary.totalEnrolls))+" ",1),t[0]||(t[0]=(0,a.Lk)("small",{class:"text-xs text-gray-500"},"หลักสูตร",-1))])])]),(0,a.Lk)("div",ae,[t[5]||(t[5]=(0,a.Lk)("div",{class:"flex-shrink-0 border-r border-gray-200 pr-2 mr-2"},[(0,a.Lk)("i",{class:"fas fa-graduation-cap text-2xl text-gray-500"})],-1)),(0,a.Lk)("div",oe,[t[4]||(t[4]=(0,a.Lk)("h3",{class:"text-sm text-gray-400"},"เรียนจบแล้ว",-1)),(0,a.Lk)("p",re,[(0,a.eW)((0,o.v_)(n.formatNumber(i.summary.completedEnrolls))+" ",1),t[3]||(t[3]=(0,a.Lk)("small",{class:"text-xs text-gray-500"},"หลักสูตร",-1))])])]),(0,a.Lk)("div",ie,[t[8]||(t[8]=(0,a.Lk)("div",{class:"flex-shrink-0 border-r border-gray-200 pr-2 mr-2"},[(0,a.Lk)("i",{class:"fas fa-certificate text-2xl text-gray-500"})],-1)),(0,a.Lk)("div",ne,[t[7]||(t[7]=(0,a.Lk)("h3",{class:"text-sm text-gray-400"},"ผ่านการรับรอง",-1)),(0,a.Lk)("p",le,[(0,a.eW)((0,o.v_)(n.formatNumber(i.summary.passedEnrolls))+" ",1),t[6]||(t[6]=(0,a.Lk)("small",{class:"text-xs text-gray-500"},"หลักสูตร",-1))])])])])])]),t[23]||(t[23]=(0,a.Lk)("div",{class:"border-t border-gray-200"},null,-1)),(0,a.Lk)("div",de,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(i.enrolls,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"bg-white shadow-md p-4 mb-4"},[(0,a.Lk)("div",ce,[(0,a.Lk)("div",ue,[(0,a.bF)(l,{src:e.course.cover,class:"max-w-full h-auto mb-2 pr-2"},null,8,["src"]),(0,a.Lk)("div",me,[(0,a.Lk)("p",pe,[(0,a.bF)(d,{icon:["fas","calendar-alt"],class:"text-gray-500 text-md"}),t[10]||(t[10]=(0,a.eW)(" สมัคร"))]),(0,a.Lk)("p",ge,(0,o.v_)(n.formatDate(e.createdAt)),1)]),(0,a.Lk)("div",he,[(0,a.Lk)("p",fe,[(0,a.bF)(d,{icon:["fas","user-check"],class:"text-gray-500 text-md"}),t[11]||(t[11]=(0,a.eW)(" สถานะ "))]),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.status=t,id:"status",name:"status",class:"mt-1 block pl-2 pr-10 py-1 text-xs border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},t[12]||(t[12]=[(0,a.Lk)("option",{value:"active"},"Active",-1),(0,a.Lk)("option",{value:"inactive"},"Inactive",-1),(0,a.Lk)("option",{value:"pending"},"Pending",-1)]),8,be),[[J.u1,e.status]])])]),(0,a.Lk)("div",xe,[(0,a.Lk)("h2",ye,(0,o.v_)(e.course.name),1),(0,a.Lk)("div",ke,[e.analytics?((0,a.uX)(),(0,a.CE)("div",ve,[(0,a.Lk)("div",we,[t[13]||(t[13]=(0,a.Lk)("h3",{class:"text-sm font-semibold mb-2"},"ความคืบหน้า",-1)),(0,a.Lk)("span",Le,(0,o.v_)(e.analytics.complete)+"/"+(0,o.v_)(e.analytics.total),1)]),(0,a.Lk)("div",Ce,[(0,a.Lk)("div",_e,[(0,a.Lk)("div",{class:"bg-blue-600 h-1",style:(0,o.Tr)({width:n.progressPercentage(e.analytics)+"%"})},null,4)]),(0,a.Lk)("p",Ee,(0,o.v_)(n.progressPercentage(e.analytics))+"% Complete",1)])])):(0,a.Q3)("",!0),e.analytics?((0,a.uX)(),(0,a.CE)("div",De,[(0,a.Lk)("div",{class:(0,o.C4)([{"opacity-50":!e.analytics.total},"bg-gray-100 p-2 rounded-xs shadow"])},[t[14]||(t[14]=(0,a.Lk)("h3",{class:"text-sm mb-2 text-gray-500"},"เนื้อหาทั้งหมด",-1)),(0,a.Lk)("p",Te,(0,o.v_)(e.analytics.total||"0"),1)],2),(0,a.Lk)("div",{class:(0,o.C4)([{"opacity-50":!e.analytics.processing},"bg-gray-100 p-2 rounded-xs shadow"])},[t[15]||(t[15]=(0,a.Lk)("h3",{class:"text-sm mb-2 text-gray-500"},"กำลังเรียน",-1)),(0,a.Lk)("p",Ae,(0,o.v_)(e.analytics.processing||"0"),1)],2),(0,a.Lk)("div",{class:(0,o.C4)([{"opacity-50":!e.analytics.complete},"bg-gray-100 p-2 rounded-xs shadow"])},[t[16]||(t[16]=(0,a.Lk)("h3",{class:"text-sm mb-2 text-gray-500"},"เรียนจบแล้ว",-1)),(0,a.Lk)("p",Ie,(0,o.v_)(e.analytics.complete||"0"),1)],2)])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Pe,[(0,a.Lk)("div",{class:(0,o.C4)([{"opacity-50":!n.hasScore(e.analytics?.pre)},"bg-gray-100 p-2 rounded-xs shadow"])},[t[17]||(t[17]=(0,a.Lk)("h3",{class:"text-sm mb-2 text-gray-500"},"สอบก่อนเรียน",-1)),(0,a.Lk)("p",$e,(0,o.v_)(n.getScore(e.analytics?.pre)),1)],2),(0,a.Lk)("div",{class:(0,o.C4)([{"opacity-50":!n.hasScore(e.analytics?.post)},"bg-gray-100 p-2 rounded-xs shadow"])},[t[18]||(t[18]=(0,a.Lk)("h3",{class:"text-sm mb-2 text-gray-500"},"สอบหลังเรียน",-1)),(0,a.Lk)("p",Se,(0,o.v_)(n.getScore(e.analytics?.post)),1)],2),(0,a.Lk)("div",{class:(0,o.C4)([{"opacity-50":!n.hasScore(e.analytics?.retest)},"bg-gray-100 p-2 rounded-xs shadow"])},[t[19]||(t[19]=(0,a.Lk)("h3",{class:"text-sm mb-2 text-gray-500"},"สอบซ่อม",-1)),(0,a.Lk)("p",Xe,(0,o.v_)(n.getScore(e.analytics?.retest)),1)],2),n.hasResult(e.analytics)?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,o.C4)([n.calculateResult(e.analytics)?"bg-green-100":"bg-red-100","p-1 rounded-xs shadow flex flex-col justify-between"])},[(0,a.Lk)("h3",{class:(0,o.C4)([n.calculateResult(e.analytics)?"text-green-700 bg-green-200":"text-red-700 bg-red-200","mb-0 px-4 py-2 rounded-xs flex items-center"])},[(0,a.bF)(d,{icon:n.calculateResult(e.analytics)?["fas","check"]:["fas","times"],class:"text-sm mr-2"},null,8,["icon"]),(0,a.Lk)("span",{class:(0,o.C4)([n.calculateResult(e.analytics)?"border-green-300":"border-red-300","border-l pl-2 text-sm"])},(0,o.v_)(n.calculateResult(e.analytics)?"ผ่านการรับรอง":"ไม่ผ่านการรับรอง"),3)],2),"no"===e.course.certification?((0,a.uX)(),(0,a.CE)("button",Fe,[(0,a.bF)(d,{icon:["fas","id-card"],class:"text-white mt-[3px] mr-2 text-sm"}),t[20]||(t[20]=(0,a.eW)(" ไม่มีใบรับรอง "))])):"yes"===e.course.certification&&n.calculateResult(e.analytics)?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t=>n.openCertification(e.course),class:"bg-green-600 text-white px-4 py-2 mt-1 text-sm rounded-xs"},[(0,a.bF)(d,{icon:["fas","id-card"],class:"text-white mt-[3px] mr-2 text-sm"}),t[21]||(t[21]=(0,a.eW)(" แสดงใบรับรอง "))],8,Ue)):"yes"!==e.course.certification||n.calculateResult(e.analytics)?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("button",je,[(0,a.bF)(d,{icon:["fas","id-card"],class:"text-white mt-[3px] mr-2 text-sm"}),t[22]||(t[22]=(0,a.eW)(" ออกใบรับรองไม่ได้ "))]))],2)):(0,a.Q3)("",!0)])])])])))),128))])])}s(54520),s(81454);var Re=s(94614),Be=s(77823),Me=s(63084),He=s(40471);const Oe={class:"image-holder"},ze=["src"],Qe={key:1,class:"dummy-image"};function Ne(e,t,s,o,r,i){return(0,a.uX)(),(0,a.CE)("div",Oe,[r.hasError?((0,a.uX)(),(0,a.CE)("div",Qe,"No Image")):((0,a.uX)(),(0,a.CE)("img",{key:0,src:s.src,alt:"Image"},null,8,ze))])}var Ye={name:"ImageHolder",props:{src:{type:String,required:!0}},data(){return{hasError:!1}},mounted(){this.checkImage(this.src)},methods:{checkImage(e){const t=new Image;t.onload=()=>{this.hasError=!1},t.onerror=()=>{this.hasError=!0},t.src=e}},watch:{src(e){this.hasError=!1,this.checkImage(e)}}},Ke=s(64621);const Je=(0,Ke.A)(Ye,[["render",Ne],["__scopeId","data-v-713c859a"]]);var Ge=Je;const qe=new He.A(!1);var Ve={props:{member:Object,tabs:Object},components:{Image:Ge},data(){return{config:Q.A.get("configs"),session:Q.A.get("session"),enrolls:[],courseIDs:["646399b1db2e5913d490fdc1","646399b3db2e5913d490fdc2","646399b5db2e5913d490fdc3","646399b6db2e5913d490fdc4","646399b8db2e5913d490fdc5","65c967c4e83775a8e0d42771","64ba0f8e95b73060a5db8674"],summary:{totalEnrolls:0,completedEnrolls:0,passedEnrolls:0}}},methods:{calculateResult:Re.E,formatDate(e){const t={year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1};return new Date(e).toLocaleString(void 0,t)},formatNumber(e){return e<10?`0${e}`:e},progressPercentage(e){const t=e?.total||0,s=e?.complete||0;return t>0?Math.round(s/t*100):0},hasScore(e){return null!==e?.score&&void 0!==e?.score},getScore(e){return this.hasScore(e)?e.score:"-"},hasResult(e){return e?.post?.has||e?.retest?.has},openCertification(e){this.courseIDs.includes(e._id)?window.open("https://node-frontend.pages.dev/certification-force?token="+this.member.token+"&session="+e.lesson_old_id,"_blank"):window.open("https://"+this.session.current.hostname+"/lesson/certification/"+e._id+"/"+this.member._id+"?mode=admin","_blank")},calculateSummary(){this.summary.totalEnrolls=this.enrolls.length,this.summary.completedEnrolls=this.enrolls.filter((e=>100===this.progressPercentage(e.analytics))).length,this.summary.passedEnrolls=this.enrolls.filter((e=>this.calculateResult(e.analytics))).length},async getData(){try{this.toast=(0,Be.A)({type:"pending",message:"กำลังดึงข้อมูล.."});const e=[{$match:{$and:[{userID:this.member._id}]}},{$set:{courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},{$facet:{enroll:[{$skip:0},{$limit:100}],totalCount:[{$count:"count"}]}}],t=await qe.POST("enroll/aggregate",{pipeline:e},this.config.key),s=t.data;this.toast.hide("ดึงข้อมูลเสร็จแล้ว.","success",30,(()=>{this.enrolls=s[0].enroll.map((e=>({...e,status:e.status||"active"}))),this.calculateSummary(),this.$setPageTitle(this.member.firstname+" "+this.member.lastname+" / หลักสูตร"),this.activeBlock=!1}))}catch(e){Me.A.log(e)}}},async mounted(){try{await this.getData()}catch(e){Me.A.log(e)}}};const Ze=(0,Ke.A)(Ve,[["render",We],["__scopeId","data-v-4ad62d30"]]);var et=Ze,tt=s(76745),st=s(5293),at=s(58677),ot=s(23199);K()().format();var rt={data(){const e=(0,z.lq)();return{configs:Q.A.get("configs"),session:Q.A.get("session"),showCertAreaList:!1,editingExamRound:!1,editingCertAge:!1,selectedAreaId:"",selectedExamRound:"",selectedCertAge:"",PageName:e.meta.title,PageIcon:e.meta.icon,PagePath:e.meta.path,ParentName:e.meta.parent,ParentPage:e.meta.page,schoolData:[],profile:[],profileLoaded:!1,enroll:[],order:[],dataItem:this.$route.params.id,loading_sources:!0,back:"",capturedImageSrc:null,cert_area:[{id:"1",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 1 (เชียงใหม่ แพร่ น่าน ลำปาง เชียงราย แม่ฮ่องสอน)"},{id:"2",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 2 (พิษณุโลก พิจิตร สุโขทัย ตาก อุตรดิตถ์ เพชรบูรณ์)"},{id:"3",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 3 (ขอนแก่น หนองคาย กาฬสินธุ์ เลย อุดรธานี มุกดาหาร สกลนคร นครพนม ชัยภูมิ)"},{id:"4",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 4 (อุบลราชธานี นครราชสีมา สุรินทร์ มหาสารคาม ร้อยเอ็ด บุรีรัมย์ ศรีสะเกษ ยโสธร )"},{id:"5",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 5 (ชัยนาท กาญจนบุรี เพชรรัตน์เพชรบุรี ปทุมธานี ราชบุรี อุทัยธานี ลพบุรี นครปฐม นครสวรรค์ )"},{id:"6",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 6 (จันทบุรี ระยอง ปราจีนบุรี ฉะเชิงเทรา )"},{id:"7",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 7 (สุราษฎร์ธานี นครศรีธรรมราช กระบี่ ระนอง ภูเก็ต พังงา ชุมพร )"},{id:"8",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 8 (สงขลา ตาราง ตรัง นราธิวาส ปัตตานี ยะลา พัทลุง สตูล )"},{id:"9",value:"สำนักควบคุมพืชและวัสดุการเกษตร กรุงเทพมหานคร"}],cert_age:[{id:"3",value:"จำหน่ายสารไกลโฟเซต"},{id:"5",value:"ไม่จำหน่ายสารไกลโฟเซต"}],showPopup:!1,credits:0,amount:0,walletMember:this.$route.params.id,walletMethod:"deposit",activeTab:"enroll",tabs:[{code:"enroll",icon:"book",shortname:"Enroll",name:"หลักสูตร",description:"Personal details and application."},{code:"order",icon:"shopping-cart",shortname:"Order",name:"คำสั่งซื้อ",description:"Asset details."},{code:"document",icon:"file",shortname:"File",name:"เอกสาร",description:"Admin settings."},{code:"profile",icon:"user",shortname:"Profile",name:"ข้อมูลส่วนตัว",description:"Storage information."}]}},components:{Loader:M.A,Subhead:H.A,Image:O.A,Enroll:et,Document:tt.A,Order:st.A,Profile:at.A,CopyButton:ot.A},methods:{setActiveTab(e){this.activeTab=e,window.location.hash=`#${e}`},redirectToExternalUrl(e){window.open("https://"+this.session.current.hostname+"/user/bypass/"+e,"_blank")},toggleCertAreaList(e){this.showCertAreaList=!this.showCertAreaList,this.selectedAreaId=e},toggleCerAgeList(e){this.editingCertAge=!this.editingCertAge,this.selectedCertAge=e},editExamRound(e){this.editingExamRound=!this.editingExamRound,this.selectedExamRound=e},openPopup(e){this.imageUrl=e,this.originalImageUrl=e,this.showPopup=!0},closePopup(){this.showPopup=!1},handleFileUrlUpdated(e){this.updataData(e)},async updataData(e){const t=await fetch("https://gateway.cloudrestfulapi.com/api/user/"+this.profile._id,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{avatar_img:e},options:{}})});await t.json(),200===t.status&&(await this.getData(!0),console.log("Update Profile Image"))},async submitArea(e){try{e.activeBlock=!0,this.showCertAreaList=!1;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/editcert",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,area_cert:this.selectedAreaId})}),a=await s.json();this.updateEnroll(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async submitRound(e){try{this.editingExamRound=!1,e.activeBlock=!0;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/editround",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,exam_round:this.selectedExamRound})}),a=await s.json();this.updateEnrollRound(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async submitAge(e){try{this.editingCertAge=!1,e.activeBlock=!0;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/edit_certage",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,cert_age:this.selectedCertAge})}),a=await s.json();this.updateEnrollAge(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async updateEnrollAge(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,cert_age:this.selectedCertAge}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},async updateEnrollRound(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,exam_round:this.selectedExamRound}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},async updateEnroll(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,cert_area:this.selectedAreaId}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},getCertAreaValue(e){const t=this.cert_area.find((t=>t.id===e));return t?t.value:""},getCertAgeValue(e){const t=this.cert_age.find((t=>t.id===e));return t?t.value:""},openCertificatePage(e,t){window.open("https://doa.fti.or.th/certification-force?token="+e+"&session="+t,"_blank")},formatThaidate(e){return N.A.toThaiDatetime(e,"short")},dateTime(e){return K()(e).format("DD/MM/YYYY hh:mm:ss")},async getData(e){if(Q.A.get("session","login"))try{let t=this.$route.params.id;e&&(this.loading_sources=!1);const s=[{$match:{_id:t}},{$project:{profile:"$$ROOT"}}],a=await fetch("https://gateway.cloudrestfulapi.com/api/user/aggregate",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({pipeline:s})}),o=await a.json();if(200===a.status){const t=o[0].profile;console.log("profileData",t),this.profile=t,this.profileLoaded=!0,this.credits=t&&t.point&&t.point.active?t.point.active:0,this.profile.avatar_img||(this.profile.avatar_img="https://doa-academy.sgp1.digitaloceanspaces.com/2023/12/1701849647875.png"),e&&(this.loading_sources=!0)}}catch(t){console.log(t)}},async deleteData(e){if(Q.A.get("session","login"))try{this.loading_sources=!1;let t=Q.A.get("session","token"),s=this.$route.params.id;const a=await fetch("https://asia-southeast2-elearning-6871c.cloudfunctions.net/schools/removeAdmin/"+s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({userId:e})});console.log(await a),this.loading_sources=!0,await this.getData(!0)}catch(t){console.log(t)}},async getProfileData(e){if(Q.A.get("session","login"))try{const t=`https://faas-sgp1-18bc02ac.doserverless.co/api/v1/web/fn-3bf765c8-bb4f-4bac-ba41-9698000f7334/default/getstudentdata?id=${e}`,s=await fetch(t),a=await s.json();console.log(a)}catch(t){console.log(t)}},updated(){B().replace()}},async mounted(){try{await this.getData(!0),await this.balanceTransactions();const e=new URLSearchParams(window.location.search),t=e.get("back");this.back=t}catch(e){console.log(Error)}},setup(){},created(){},computed:{showTaxInvoice(){return this.enroll.orderData.address.tax.address.taX_ID&&this.enroll.orderData.address.tax.address.owneR_NAME_TH},imageStyle(){return{transform:`translate(${this.imagePositionX}px, ${this.imagePositionY}px) scale(${this.zoomPercentage/100}) rotate(${this.rotationAngle}deg)`}}}};const it=(0,Ke.A)(rt,[["render",W]]);var nt=it},44196:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return ae}});var a=s(20641),o=s(90033);const r={key:0,class:"text-center"},i={class:"bg-white border-b border-gray-200"},n={key:0,class:"mx-auto max-w-3xl px-4 sm:px-6 lg:max-w-7xl lg:px-8"},l={class:"pt-5"},d={class:"mx-auto max-w-3xl md:flex md:items-center md:justify-between md:space-x-5 lg:max-w-7xl"},c={class:"flex items-center space-x-5"},u={class:"flex-shrink-0"},m={class:"relative"},p={class:"h-24 w-24 rounded-md cursor-pointer"},g=["src"],h={class:"text-2xl font-bold text-gray-900"},f={class:"text-sm text-gray-800"},b={class:"text-gray-500"},x={class:"text-sm text-gray-800"},y={class:"text-gray-500"},k={class:"text-sm text-gray-800"},v={class:"text-gray-500"},w={class:"justify-stretch mt-6 flex flex-col-reverse space-y-4 space-y-reverse sm:flex-row-reverse sm:justify-end sm:space-y-0 sm:space-x-3 sm:space-x-reverse md:mt-0 md:flex-row md:space-x-3"},L={type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},C={class:"border-t border-gray-200 pt-3 mt-5"},_={class:"flex space-x-2",id:"tab-list"},E=["onClick"],D={class:"hidden md:inline"},T={key:0,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},A={key:1,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},I={class:"md:hidden text-xs"},P=["value"],$={class:"mx-auto mt-8 grid max-w-3xl grid-cols-1 gap-6 sm:px-6 lg:max-w-7xl lg:grid-flow-col-dense lg:grid-cols-1"},S={class:"space-y-6 lg:col-span-2 lg:col-start-1"},X={key:0,"aria-labelledby":"applicant-information-title"},F={key:1,"aria-labelledby":"applicant-information-title"},U={key:2,"aria-labelledby":"applicant-information-title"},j={key:3,"aria-labelledby":"applicant-information-title"};function W(e,t,s,W,R,B){const M=(0,a.g2)("Loader"),H=(0,a.g2)("Subhead"),O=(0,a.g2)("Image"),z=(0,a.g2)("font-awesome-icon"),Q=(0,a.g2)("copy-button"),N=(0,a.g2)("Enroll"),Y=(0,a.g2)("Order"),K=(0,a.g2)("Document"),J=(0,a.g2)("Profile");return(0,a.uX)(),(0,a.CE)(a.FK,null,[R.loading_sources?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(M)])),R.loading_sources?((0,a.uX)(),(0,a.Wv)(H,{key:1,navigation:[{name:"ย้อนกลับ",link:this.back?this.back:"/student/dashboard",style:"chevron-left",class:"default-btn",visible:!0,type:"button"}]},null,8,["navigation"])):(0,a.Q3)("",!0),R.showPopup?((0,a.uX)(),(0,a.Wv)(O,{key:2,cropImageWidth:"600px",cropImageHeight:"600px",uploadPath:"Upload/_profile/",imageUrl:e.imageUrl,filePrefix:this.profile._id,onFileUrlUpdated:B.handleFileUrlUpdated,onClosePopupEvent:B.closePopup},null,8,["imageUrl","filePrefix","onFileUrlUpdated","onClosePopupEvent"])):(0,a.Q3)("",!0),(0,a.Lk)("div",i,[R.loading_sources?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",l,[(0,a.Lk)("div",d,[(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[((0,a.uX)(),(0,a.CE)("img",{class:"h-full w-full rounded-md",src:R.profile.avatar_img,key:R.profile.avatar_img,alt:""},null,8,g)),(0,a.Lk)("div",{class:"absolute inset-0 rounded-md bg-black bg-opacity-0 hover:bg-opacity-50 flex justify-center items-center transition duration-300",onClick:t[0]||(t[0]=e=>B.openPopup(R.profile.avatar_img))},[(0,a.bF)(z,{icon:["fas","upload"],class:"text-white text-[24px] opacity-0 hover:opacity-100"})])])])]),(0,a.Lk)("div",null,[(0,a.Lk)("h1",h,(0,o.v_)(this.profile.firstname+" "+this.profile.lastname),1),(0,a.Lk)("p",f,[t[3]||(t[3]=(0,a.eW)("ลงทะเบียน : ")),(0,a.Lk)("span",b,(0,o.v_)(this.profile?.createdAt),1)]),(0,a.Lk)("p",x,[t[4]||(t[4]=(0,a.eW)("Email : ")),(0,a.Lk)("span",y,(0,o.v_)(this.profile?.email),1)]),(0,a.Lk)("p",k,[t[5]||(t[5]=(0,a.eW)("Phone : ")),(0,a.Lk)("span",v,(0,o.v_)(this.profile?.phone),1)])])]),(0,a.Lk)("div",w,[(0,a.bF)(Q,{class:"ml-1 text-gray-600 text-sm",text:`https://${this.session.current.hostname}/user/bypass/${this.profile._id}`,buttonText:"คัดลอกลิงค์เข้าสู่ระบบ",buttonTextDone:"คัดลอกแล้ว"},null,8,["text"]),(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>{B.redirectToExternalUrl(this.profile._id)}),type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},[(0,a.bF)(z,{icon:["fas","key"],class:"text-black text-[12px] mr-2"}),t[6]||(t[6]=(0,a.eW)(" เข้าสู่ระบบ "))]),(0,a.Lk)("button",L,[(0,a.bF)(z,{icon:["fas","trash"],class:"text-black text-[12px] mr-2"}),t[7]||(t[7]=(0,a.eW)(" ลบ "))])])])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",C,[(0,a.Lk)("ul",_,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(R.tabs,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.code,class:(0,o.C4)([{"text-gray-500":R.activeTab!==e.code,"text-black":R.activeTab===e.code,"border-b-4 border-blue-500":R.activeTab===e.code},"cursor-pointer py-2 px-2"]),onClick:t=>B.setActiveTab(e.code)},[(0,a.Lk)("span",D,[(0,a.bF)(z,{icon:["fas",e.icon]},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(e.name)+" ",1),"enroll"===e.code?((0,a.uX)(),(0,a.CE)("span",T,(0,o.v_)(R.enroll.length),1)):(0,a.Q3)("",!0),"material"===e.code?((0,a.uX)(),(0,a.CE)("span",A,"0")):(0,a.Q3)("",!0)]),(0,a.Lk)("span",I,[(0,a.bF)(z,{icon:["fas",e.icon]},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(e.shortname),1)])],10,E)))),128))]),(0,a.Lk)("select",{class:"mb-3 md:hidden w-full border border-gray-300 rounded-md",id:"tab-dropdown",onChange:t[2]||(t[2]=e=>B.setActiveTab(e.target.value))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(R.tabs,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t.code,value:t.code},[(0,a.eW)((0,o.v_)(t.name)+" ",1),"enroll"===t.code?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,o.v_)(R.enroll.length),1)],64)):(0,a.Q3)("",!0),"material"===t.code?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,o.v_)(e.playerCount),1)],64)):(0,a.Q3)("",!0)],8,P)))),128))],32)])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",$,[(0,a.Lk)("div",S,["enroll"===R.activeTab?((0,a.uX)(),(0,a.CE)("section",X,[R.profileLoaded?((0,a.uX)(),(0,a.Wv)(N,{key:0,enrolls:R.enroll,member:R.profile,ref:"enroll",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["enrolls","member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"order"===R.activeTab?((0,a.uX)(),(0,a.CE)("section",F,[R.profileLoaded?((0,a.uX)(),(0,a.Wv)(Y,{key:0,member:R.profile,ref:"order",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"document"===R.activeTab?((0,a.uX)(),(0,a.CE)("section",U,[R.profileLoaded?((0,a.uX)(),(0,a.Wv)(K,{key:0,member:R.profile,ref:"document",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"profile"===R.activeTab?((0,a.uX)(),(0,a.CE)("section",j,[R.profileLoaded?((0,a.uX)(),(0,a.Wv)(J,{key:0,member:R.profile,ref:"profile",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])])],64)}s(98992),s(72577),s(14603),s(47566),s(98721);var R=s(59911),B=s.n(R),M=s(75435),H=s(87814),O=s(61628),z=s(75220),Q=s(40475),N=s(9964),Y=s(95093),K=s.n(Y),J=s(59328),G=s(76745),q=s(5293),V=s(58677),Z=s(23199);K()().format();var ee={data(){const e=(0,z.lq)();return{configs:Q.A.get("configs"),session:Q.A.get("session"),showCertAreaList:!1,editingExamRound:!1,editingCertAge:!1,selectedAreaId:"",selectedExamRound:"",selectedCertAge:"",PageName:e.meta.title,PageIcon:e.meta.icon,PagePath:e.meta.path,ParentName:e.meta.parent,ParentPage:e.meta.page,schoolData:[],profile:[],profileLoaded:!1,enroll:[],order:[],dataItem:this.$route.params.id,loading_sources:!0,back:"",capturedImageSrc:null,cert_area:[{id:"1",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 1 (เชียงใหม่ แพร่ น่าน ลำปาง เชียงราย แม่ฮ่องสอน)"},{id:"2",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 2 (พิษณุโลก พิจิตร สุโขทัย ตาก อุตรดิตถ์ เพชรบูรณ์)"},{id:"3",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 3 (ขอนแก่น หนองคาย กาฬสินธุ์ เลย อุดรธานี มุกดาหาร สกลนคร นครพนม ชัยภูมิ)"},{id:"4",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 4 (อุบลราชธานี นครราชสีมา สุรินทร์ มหาสารคาม ร้อยเอ็ด บุรีรัมย์ ศรีสะเกษ ยโสธร )"},{id:"5",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 5 (ชัยนาท กาญจนบุรี เพชรรัตน์เพชรบุรี ปทุมธานี ราชบุรี อุทัยธานี ลพบุรี นครปฐม นครสวรรค์ )"},{id:"6",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 6 (จันทบุรี ระยอง ปราจีนบุรี ฉะเชิงเทรา )"},{id:"7",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 7 (สุราษฎร์ธานี นครศรีธรรมราช กระบี่ ระนอง ภูเก็ต พังงา ชุมพร )"},{id:"8",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 8 (สงขลา ตาราง ตรัง นราธิวาส ปัตตานี ยะลา พัทลุง สตูล )"},{id:"9",value:"สำนักควบคุมพืชและวัสดุการเกษตร กรุงเทพมหานคร"}],cert_age:[{id:"3",value:"จำหน่ายสารไกลโฟเซต"},{id:"5",value:"ไม่จำหน่ายสารไกลโฟเซต"}],showPopup:!1,credits:0,amount:0,walletMember:this.$route.params.id,walletMethod:"deposit",activeTab:"enroll",tabs:[{code:"enroll",icon:"book",shortname:"Enroll",name:"หลักสูตร",description:"Personal details and application."},{code:"order",icon:"shopping-cart",shortname:"Order",name:"คำสั่งซื้อ",description:"Asset details."},{code:"document",icon:"file",shortname:"File",name:"เอกสาร",description:"Admin settings."},{code:"profile",icon:"user",shortname:"Profile",name:"ข้อมูลส่วนตัว",description:"Storage information."}]}},components:{Loader:M.A,Subhead:H.A,Image:O.A,Enroll:J.A,Document:G.A,Order:q.A,Profile:V.A,CopyButton:Z.A},methods:{setActiveTab(e){this.activeTab=e,window.location.hash=`#${e}`},redirectToExternalUrl(e){window.open("https://"+this.session.current.hostname+"/user/bypass/"+e,"_blank")},toggleCertAreaList(e){this.showCertAreaList=!this.showCertAreaList,this.selectedAreaId=e},toggleCerAgeList(e){this.editingCertAge=!this.editingCertAge,this.selectedCertAge=e},editExamRound(e){this.editingExamRound=!this.editingExamRound,this.selectedExamRound=e},openPopup(e){this.imageUrl=e,this.originalImageUrl=e,this.showPopup=!0},closePopup(){this.showPopup=!1},handleFileUrlUpdated(e){this.updataData(e)},async updataData(e){const t=await fetch("https://gateway.cloudrestfulapi.com/api/user/"+this.profile._id,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{avatar_img:e},options:{}})});await t.json(),200===t.status&&(await this.getData(!0),console.log("Update Profile Image"))},async submitArea(e){try{e.activeBlock=!0,this.showCertAreaList=!1;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/editcert",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,area_cert:this.selectedAreaId})}),a=await s.json();this.updateEnroll(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async submitRound(e){try{this.editingExamRound=!1,e.activeBlock=!0;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/editround",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,exam_round:this.selectedExamRound})}),a=await s.json();this.updateEnrollRound(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async submitAge(e){try{this.editingCertAge=!1,e.activeBlock=!0;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/edit_certage",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,cert_age:this.selectedCertAge})}),a=await s.json();this.updateEnrollAge(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async updateEnrollAge(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,cert_age:this.selectedCertAge}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},async updateEnrollRound(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,exam_round:this.selectedExamRound}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},async updateEnroll(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,cert_area:this.selectedAreaId}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},getCertAreaValue(e){const t=this.cert_area.find((t=>t.id===e));return t?t.value:""},getCertAgeValue(e){const t=this.cert_age.find((t=>t.id===e));return t?t.value:""},openCertificatePage(e,t){window.open("https://doa.fti.or.th/certification-force?token="+e+"&session="+t,"_blank")},formatThaidate(e){return N.A.toThaiDatetime(e,"short")},dateTime(e){return K()(e).format("DD/MM/YYYY hh:mm:ss")},async getData(e){if(Q.A.get("session","login"))try{let t=this.$route.params.id;e&&(this.loading_sources=!1);const s=[{$match:{_id:t}},{$project:{profile:"$$ROOT"}}],a=await fetch("https://gateway.cloudrestfulapi.com/api/user/aggregate",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({pipeline:s})}),o=await a.json();if(200===a.status){const t=o[0].profile;console.log("profileData",t),this.profile=t,this.profileLoaded=!0,this.credits=t&&t.point&&t.point.active?t.point.active:0,this.profile.avatar_img||(this.profile.avatar_img="https://doa-academy.sgp1.digitaloceanspaces.com/2023/12/1701849647875.png"),e&&(this.loading_sources=!0)}}catch(t){console.log(t)}},async deleteData(e){if(Q.A.get("session","login"))try{this.loading_sources=!1;let t=Q.A.get("session","token"),s=this.$route.params.id;const a=await fetch("https://asia-southeast2-elearning-6871c.cloudfunctions.net/schools/removeAdmin/"+s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({userId:e})});console.log(await a),this.loading_sources=!0,await this.getData(!0)}catch(t){console.log(t)}},async getProfileData(e){if(Q.A.get("session","login"))try{const t=`https://faas-sgp1-18bc02ac.doserverless.co/api/v1/web/fn-3bf765c8-bb4f-4bac-ba41-9698000f7334/default/getstudentdata?id=${e}`,s=await fetch(t),a=await s.json();console.log(a)}catch(t){console.log(t)}},updated(){B().replace()}},async mounted(){try{await this.getData(!0),await this.balanceTransactions();const e=new URLSearchParams(window.location.search),t=e.get("back");this.back=t}catch(e){console.log(Error)}},setup(){},created(){},computed:{showTaxInvoice(){return this.enroll.orderData.address.tax.address.taX_ID&&this.enroll.orderData.address.tax.address.owneR_NAME_TH},imageStyle(){return{transform:`translate(${this.imagePositionX}px, ${this.imagePositionY}px) scale(${this.zoomPercentage/100}) rotate(${this.rotationAngle}deg)`}}}},te=s(64621);const se=(0,te.A)(ee,[["render",W]]);var ae=se},24743:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return Hs}});s(44114);var a=s(20641),o=s(90033),r=s(53751);const i={key:0,class:"text-center"},n={class:"bg-white border-b border-gray-200"},l={key:0,class:"mx-auto max-w-3xl px-4 sm:px-6 lg:max-w-7xl lg:px-8"},d={class:"pt-5"},c={class:"mx-auto max-w-3xl md:flex md:items-center md:justify-between md:space-x-5 lg:max-w-7xl"},u={class:"flex items-center space-x-5"},m={class:"flex-shrink-0"},p={class:"relative"},g={class:"h-24 w-24 rounded-md cursor-pointer"},h=["src"],f={class:"text-2xl font-bold text-gray-900"},b={class:"text-sm text-gray-800"},x={class:"text-gray-500"},y={class:"text-sm text-gray-800"},k={class:"text-gray-500"},v={class:"text-sm text-gray-800"},w={class:"text-gray-500"},L={class:"justify-stretch mt-6 flex flex-col-reverse space-y-4 space-y-reverse sm:flex-row-reverse sm:justify-end sm:space-y-0 sm:space-x-3 sm:space-x-reverse md:mt-0 md:flex-row md:space-x-3"},C={type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},_={class:"border-t border-gray-200 pt-3 mt-5"},E={class:"flex space-x-2 tab-navigation",id:"tab-list"},D=["onClick"],T={class:"hidden md:inline"},A={key:0,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},I={class:"md:hidden text-xs"},P={class:"mobile-navigation"},$={class:"dropdown-selected"},S={class:"flex justify-between"},X={class:"flex"},F={class:"tab-icon"},U={class:"flex flex-col"},j={class:"status-name"},W={key:0,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},R={class:"status-description text-xs text-gray-400 single-line-ellipsis"},B={class:"tab-icon icon-line"},M={class:"dropdown-content"},H=["onClick"],O={class:"flex"},z={class:"tab-icon"},Q={class:"flex flex-col"},N={key:0,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},Y={class:"status-description text-xs text-gray-400 single-line-ellipsis"},K={class:"mx-auto mt-8 grid max-w-3xl grid-cols-1 gap-6 sm:px-6 lg:max-w-7xl lg:grid-flow-col-dense lg:grid-cols-1"},J={class:"space-y-6 lg:col-span-2 lg:col-start-1"},G={key:0,"aria-labelledby":"applicant-information-title"},q={key:1,"aria-labelledby":"applicant-information-title"},V={key:2,"aria-labelledby":"applicant-information-title"},Z={key:3,"aria-labelledby":"applicant-information-title"},ee={key:4,"aria-labelledby":"applicant-information-title"},te={class:"divide-y divide-gray-200"},se={class:"bg-black px-4 py-5 sm:px-6 flex justify-between items-center"},ae={id:"notes-title",class:"text-[18px] font-bold text-white"},oe={class:"bg-blue-500 hover:bg-blue-600 text-white font-medium py-2 px-4 rounded"},re={class:"px-2 py-3 sm:px-3"},ie={class:"text-gray-600 font-semibold"},ne={class:"text-gray-600 font-semibold"},le={class:"text-gray-600 font-semibold"},de={class:"px-4 py-6 sm:px-6"},ce={role:"list",class:"space-y-8"},ue={class:"flex justify-between items-center"},me=["onClick"],pe={class:"w-32 text-center text-[16px] bg-gray-500 text-white font-medium rounded"},ge={key:1,class:"text-[14px] font-medium p-2"},he={class:"mt-4"},fe={class:"flex items-left mb-2 justify-left text-sm text-gray-500 font-medium"},be={class:"bg-gray-200 h-4 rounded-full"},xe={class:"mt-4"},ye={class:"grid grid-cols-4 gap-2"},ke={class:"col-span-1"},ve={class:"border border-gray-200 shadow-sm rounded-md p-4"},we={class:"text-center"},Le={key:0},Ce=["onClick"],_e={key:1},Ee={class:"text-2xl font-bold text-blue-500"},De={class:"font-medium text-gray-500"},Te=["onClick"],Ae={class:"col-span-1"},Ie={class:"border border-gray-200 shadow-sm rounded-md p-4"},Pe={class:"text-center"},$e={class:"font-medium text-gray-500"},Se={class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},Xe={class:"col-span-1"},Fe={class:"border border-gray-200 shadow-sm rounded-md p-4"},Ue={class:"text-center"},je={class:"font-medium text-gray-500"},We={class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},Re={class:"col-span-1"},Be={class:"border border-gray-200 shadow-sm rounded-md p-4"},Me={class:"text-center"},He={key:0,class:"text-2xl font-bold text-gray-300"},Oe={key:1,class:"text-2xl font-bold text-red-500"},ze={class:"font-medium text-gray-500"},Qe={class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},Ne={class:"px-4 py-6 sm:px-6"},Ye={role:"list",class:"space-y-8"},Ke={class:"mt-4"},Je={class:"grid grid-cols-1 gap-2"},Ge={class:"col-span-1"},qe={class:"border border-gray-200 shadow-sm rounded-md p-4"},Ve={class:"text-center"},Ze={class:"text-lg font-bold text-blue-500"},et={class:"font-medium text-gray-500"},tt=["onClick"],st={class:"mt-4 text-left p-2 border border-gray-100"},at={class:"flex items-center"},ot=["value"],rt=["onClick"],it={class:"col-span-1"},nt={class:"text-center"},lt={class:"text-lg font-bold text-blue-500"},dt={class:"font-medium text-gray-500"},ct=["onClick"],ut={class:"mt-4 text-left p-2 border border-gray-100"},mt={class:"flex items-center"},pt=["value"],gt=["onClick"],ht={class:"px-4 py-6 sm:px-6"},ft={class:"flex justify-between items-center"},bt={class:"w-24 text-center text-[24px] bg-gray-500 text-white font-medium rounded"},xt={class:"mt-2 space-y-2 text-md"},yt={class:"mb-5"},kt={class:"text-gray-600 font-semibold"},vt={class:"text-gray-600 font-semibold"},wt={class:"text-gray-600 font-semibold"},Lt={class:"text-gray-600 font-semibold"},Ct={class:"text-gray-600 font-semibold"},_t={class:"text-gray-600 font-semibold"},Et={class:"text-gray-600 font-semibold"},Dt={class:"flex items-start justify-between border-t border-gray-200 pt-5 pb-5"},Tt={class:"w-{{ showTaxInvoice ? '1/3' : '2/3' }} pr-5"},At={class:"flex items-center"},It={class:"flex items-center justify-between"},Pt={class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},$t={class:"font-normal text-sm text-gray-500"},St={class:"w-{{ showTaxInvoice ? '1/3' : '2/3' }} border-l border-r border-gray-300 pl-4 pr-5"},Xt={class:"flex items-center"},Ft={class:"flex items-center justify-between"},Ut={class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},jt={class:"font-normal text-sm text-gray-500"},Wt={key:0,class:"w-{{ showTaxInvoice ? '1/3' : 'hidden' }} pl-4"},Rt={class:"flex items-center"},Bt={class:"flex items-center justify-between"},Mt={class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},Ht={class:"font-normal text-sm text-gray-500"},Ot={"aria-labelledby":"notes-title"},zt={class:"bg-white shadow sm:overflow-hidden sm:rounded-lg"},Qt={class:"divide-y divide-gray-200"},Nt={class:"px-4 py-6 sm:px-6"},Yt={role:"list",class:"space-y-8"},Kt={class:"flex space-x-3"},Jt={class:"text-md"},Gt={href:"#",class:"font-medium text-gray-900"},qt={class:"sm:col-span-1"},Vt={class:"mt-1 text-sm text-gray-900"},Zt={class:"mt-1 text-sm text-gray-900"},es={class:"mt-1 text-sm text-gray-900"},ts={class:"mt-1 text-sm text-gray-900"},ss={class:"mt-4 sm:col-span-1"},as={class:"mt-1 text-sm text-gray-900"},os={class:"mt-1 text-sm text-gray-900"},rs={class:"mt-1 text-sm text-gray-900"},is={class:"mt-1 text-sm text-gray-900"},ns={class:"mt-4 sm:col-span-1"},ls={class:"mt-1 text-sm text-gray-900"},ds={class:"mt-1 text-sm text-gray-900"},cs={class:"mt-1 text-sm text-gray-900"},us={class:"mt-1 text-sm text-gray-900"},ms={class:"mt-1 text-sm text-gray-900"};function ps(e,t,s,ps,gs,hs){const fs=(0,a.g2)("Loader"),bs=(0,a.g2)("Subhead"),xs=(0,a.g2)("Image"),ys=(0,a.g2)("font-awesome-icon"),ks=(0,a.g2)("Enroll"),vs=(0,a.g2)("Order"),ws=(0,a.g2)("Document"),Ls=(0,a.g2)("Wallet"),Cs=(0,a.g2)("Profile");return(0,a.uX)(),(0,a.CE)(a.FK,null,[gs.loading_sources?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",i,[(0,a.bF)(fs)])),gs.loading_sources?((0,a.uX)(),(0,a.Wv)(bs,{key:1,navigation:[{name:"ย้อนกลับ",link:this.back?this.back:"/student/dashboard",style:"chevron-left",class:"default-btn",visible:!0,type:"button"}]},null,8,["navigation"])):(0,a.Q3)("",!0),gs.showPopup?((0,a.uX)(),(0,a.Wv)(xs,{key:2,cropImageWidth:"600px",cropImageHeight:"600px",uploadPath:"Upload/_profile/",imageUrl:e.imageUrl,filePrefix:this.profile._id,onFileUrlUpdated:hs.handleFileUrlUpdated,onClosePopupEvent:hs.closePopup},null,8,["imageUrl","filePrefix","onFileUrlUpdated","onClosePopupEvent"])):(0,a.Q3)("",!0),(0,a.Lk)("div",n,[gs.loading_sources?((0,a.uX)(),(0,a.CE)("div",l,[(0,a.Lk)("div",d,[(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[(0,a.Lk)("div",g,[((0,a.uX)(),(0,a.CE)("img",{class:"h-full w-full rounded-md",src:gs.profile.avatar_img,key:gs.profile.avatar_img,alt:""},null,8,h)),(0,a.Lk)("div",{class:"absolute inset-0 rounded-md bg-black bg-opacity-0 hover:bg-opacity-50 flex justify-center items-center transition duration-300",onClick:t[0]||(t[0]=e=>hs.openPopup(gs.profile.avatar_img))},[(0,a.bF)(ys,{icon:["fas","upload"],class:"text-white text-[24px] opacity-0 hover:opacity-100"})])])])]),(0,a.Lk)("div",null,[(0,a.Lk)("h1",f,(0,o.v_)(this.profile.firstname+" "+this.profile.lastname),1),(0,a.Lk)("p",b,[t[7]||(t[7]=(0,a.eW)(" ลงทะเบียน : ")),(0,a.Lk)("span",x,(0,o.v_)(this.profile?.createdAt),1)]),(0,a.Lk)("p",y,[t[8]||(t[8]=(0,a.eW)(" Email : ")),(0,a.Lk)("span",k,(0,o.v_)(this.profile?.email),1)]),(0,a.Lk)("p",v,[t[9]||(t[9]=(0,a.eW)(" Phone : ")),(0,a.Lk)("span",w,(0,o.v_)(this.profile?.phone),1)])])]),(0,a.Lk)("div",L,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=t=>e.$router.push("/school/edit/"+this.dataItem)),type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},[(0,a.bF)(ys,{icon:["fas","pencil"],class:"text-black text-[12px] mr-2"}),t[10]||(t[10]=(0,a.eW)(" แก้ไข "))]),(0,a.Lk)("button",{onClick:t[2]||(t[2]=e=>hs.redirectToExternalUrl(this.profile.token)),type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},[(0,a.bF)(ys,{icon:["fas","key"],class:"text-black text-[12px] mr-2"}),t[11]||(t[11]=(0,a.eW)(" เข้าสู่ระบบ "))]),(0,a.Lk)("button",C,[(0,a.bF)(ys,{icon:["fas","trash"],class:"text-black text-[12px] mr-2"}),t[12]||(t[12]=(0,a.eW)(" ลบ "))])])])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",_,[(0,a.Lk)("ul",E,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(gs.tabs,(e=>((0,a.uX)(),(0,a.CE)(a.FK,{key:e.code},[hs.isTabVisible(e)?((0,a.uX)(),(0,a.CE)("li",{key:0,class:(0,o.C4)([{"text-gray-500":gs.activeTab!==e.code,"text-black":gs.activeTab===e.code,"border-b-4 border-blue-500":gs.activeTab===e.code},"cursor-pointer py-2 px-2"]),onClick:t=>hs.setActiveTab(e.code)},[(0,a.Lk)("span",T,[(0,a.bF)(ys,{icon:["fas",e.icon]},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(e.name)+" ",1),null!==e.badge?((0,a.uX)(),(0,a.CE)("span",A,(0,o.v_)(e.badge),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("span",I,[(0,a.bF)(ys,{icon:["fas",e.icon]},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(e.shortname),1)])],10,D)):(0,a.Q3)("",!0)],64)))),128))]),(0,a.Lk)("div",P,[(0,a.Lk)("div",{class:"dropdown",onClick:t[3]||(t[3]=e=>gs.dropdownOpen=!gs.dropdownOpen)},[(0,a.Lk)("div",$,[(0,a.Lk)("div",S,[(0,a.Lk)("div",X,[(0,a.Lk)("div",F,[(0,a.bF)(ys,{icon:["fas",hs.TabData.icon],class:"text-sm mr-2"},null,8,["icon"])]),(0,a.Lk)("div",U,[(0,a.Lk)("div",j,[(0,a.eW)((0,o.v_)(hs.TabData.name)+" ",1),null!==hs.TabData.badge?((0,a.uX)(),(0,a.CE)("span",W,(0,o.v_)(hs.TabData.badge),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",R,(0,o.v_)(hs.TabData.description),1)])]),(0,a.Lk)("div",B,[(0,a.bF)(ys,{icon:gs.dropdownOpen?["fas","caret-up"]:["fas","caret-down"],class:"text-sm ml-2"},null,8,["icon"])])])]),(0,a.bo)((0,a.Lk)("div",M,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(gs.tabs,((e,t)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:t},[hs.isTabVisible(e)?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"dropdown-item",onClick:t=>hs.setActiveTab(e.code)},[(0,a.Lk)("div",O,[(0,a.Lk)("div",z,[(0,a.bF)(ys,{icon:["fas",e.icon],class:"text-sm mr-2"},null,8,["icon"])]),(0,a.Lk)("div",Q,[(0,a.Lk)("div",{class:(0,o.C4)(["status-name",{"font-bold":e.code===hs.TabData.code}])},[(0,a.eW)((0,o.v_)(e.name)+" ",1),null!==e.badge?((0,a.uX)(),(0,a.CE)("span",N,(0,o.v_)(e.badge),1)):(0,a.Q3)("",!0)],2),(0,a.Lk)("div",Y,(0,o.v_)(e.description),1)])])],8,H)):(0,a.Q3)("",!0)],64)))),128))],512),[[r.aG,gs.dropdownOpen]])])])])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",K,[(0,a.Lk)("div",J,["enroll"===gs.activeTab?((0,a.uX)(),(0,a.CE)("section",G,[gs.profileLoaded?((0,a.uX)(),(0,a.Wv)(ks,{key:0,member:gs.profile,ref:"enroll",tabs:hs.TabData,onUpdateBadge:hs.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"order"===gs.activeTab?((0,a.uX)(),(0,a.CE)("section",q,[gs.profileLoaded?((0,a.uX)(),(0,a.Wv)(vs,{key:0,member:gs.profile,ref:"order",tabs:hs.TabData,onUpdateBadge:hs.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"document"===gs.activeTab?((0,a.uX)(),(0,a.CE)("section",V,[gs.profileLoaded?((0,a.uX)(),(0,a.Wv)(ws,{key:0,member:gs.profile,ref:"document",tabs:hs.TabData,onUpdateBadge:hs.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"wallet"===gs.activeTab?((0,a.uX)(),(0,a.CE)("section",Z,[gs.profileLoaded?((0,a.uX)(),(0,a.Wv)(Ls,{key:0,member:gs.profile,ref:"wallet",tabs:hs.TabData,onUpdateBadge:hs.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"profile"===gs.activeTab?((0,a.uX)(),(0,a.CE)("section",ee,[gs.profileLoaded?((0,a.uX)(),(0,a.Wv)(Cs,{key:0,member:gs.profile,ref:"profile",tabs:hs.TabData,onUpdateBadge:hs.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.enroll,(s=>((0,a.uX)(),(0,a.CE)("section",{key:s._id,"aria-labelledby":"enroll-card"},[(0,a.Lk)("div",{class:(0,o.C4)(["bg-white shadow sm:overflow-hidden sm:rounded-lg relative",[s.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},[(0,a.Lk)("div",te,[(0,a.Lk)("div",se,[(0,a.Lk)("h2",ae,(0,o.v_)(s.courseData.name),1),(0,a.Lk)("button",oe,(0,o.v_)(s.orderData.status),1)]),(0,a.Lk)("div",re,[(0,a.Lk)("p",null,[t[13]||(t[13]=(0,a.Lk)("span",{class:"text-gray-500"},"ชื่อผู้อบรม : ",-1)),(0,a.Lk)("span",ie,(0,o.v_)(this.profile.firstname+" "+this.profile.lastname),1)]),(0,a.Lk)("p",null,[t[14]||(t[14]=(0,a.Lk)("span",{class:"text-gray-500"},"ลงทะเบียนเมื่อ : ",-1)),(0,a.Lk)("span",ne,(0,o.v_)(s.orderData.adddate),1)]),(0,a.Lk)("p",null,[t[15]||(t[15]=(0,a.Lk)("span",{class:"text-gray-500"},"สถานะ : ",-1)),(0,a.Lk)("span",le,(0,o.v_)(s.orderData.status),1)])]),(0,a.Lk)("div",de,[(0,a.Lk)("ul",ce,[(0,a.Lk)("li",null,[(0,a.Lk)("div",null,[(0,a.Lk)("div",ue,[t[17]||(t[17]=(0,a.Lk)("p",{class:"font-semibold text-gray-900"},"ผลการเรียน",-1)),"ผ่านการรับรอง"===s.analytics.post.message||"ผ่านการรับรอง"===s.analytics.retest.message?((0,a.uX)(),(0,a.CE)("button",{key:0,class:"bg-yellow-500 hover:bg-yellow-600 text-black font-medium py-2 px-4 rounded",onClick:e=>hs.openCertificatePage(this.profile.token,s.courseData.lesson_old_id)},[(0,a.bF)(ys,{icon:["fas","download"],class:"text-[12px]"}),t[16]||(t[16]=(0,a.eW)(" ดาวน์โหลดใบประกาศ "))],8,me)):(0,a.Q3)("",!0),(0,a.Lk)("div",pe,["complete"===s.analytics.status?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[s.analytics.post.score>=s.analytics.post.measure?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,o.C4)(["w-32 text-center text-[16px] font-medium rounded",{"bg-green-500 text-white":"ผ่านการรับรอง"===s.analytics.post.message,"bg-red-500 text-white":"ผ่านการรับรอง"!==s.analytics.post.message}])},(0,o.v_)(s.analytics.post.message),3)):((0,a.uX)(),(0,a.CE)("div",{key:1,class:(0,o.C4)(["w-32 text-center text-[16px] font-medium rounded",{"bg-green-500 text-white":"ผ่านการรับรอง"===s.analytics.retest.message,"bg-red-500 text-white":"ผ่านการรับรอง"!==s.analytics.retest.message}])},(0,o.v_)(s.analytics.retest.message),3))],64)):((0,a.uX)(),(0,a.CE)("div",ge," กำลังเรียน ("+(0,o.v_)(s.analytics.processing)+"/"+(0,o.v_)(s.analytics.total)+") ",1))])]),(0,a.Lk)("div",he,[(0,a.Lk)("span",fe,[t[18]||(t[18]=(0,a.eW)(" ความคืบหน้าในการเรียน : ")),(0,a.Lk)("strong",null,(0,o.v_)(Math.floor(s.analytics.complete/s.analytics.total*100))+"%",1)]),(0,a.Lk)("div",be,[(0,a.Lk)("div",{class:"bg-blue-500 h-full rounded-full",style:(0,o.Tr)({width:s.analytics.complete/s.analytics.total*100+"%"})},null,4)])]),(0,a.Lk)("div",xe,[(0,a.Lk)("div",ye,[(0,a.Lk)("div",ke,[(0,a.Lk)("div",ve,[(0,a.Lk)("div",we,[gs.editingExamRound?((0,a.uX)(),(0,a.CE)("div",Le,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[4]||(t[4]=e=>gs.selectedExamRound=e),class:"text-md text-blue-500 mr-1"},t[19]||(t[19]=[(0,a.Lk)("option",{value:"first"},"รอบแรก",-1),(0,a.Lk)("option",{value:"second"},"รอบสอง",-1)]),512),[[r.u1,gs.selectedExamRound]]),(0,a.Lk)("button",{onClick:e=>hs.submitRound(s),class:"bg-blue-500 text-white font-medium py-2 px-3 rounded mt-2"}," บันทึก ",8,Ce)])):((0,a.uX)(),(0,a.CE)("div",_e,[(0,a.Lk)("div",Ee,(0,o.v_)("first"===s.analytics.option.exam_round?"รอบแรก":"รอบสอง"),1)])),(0,a.Lk)("div",De,[t[22]||(t[22]=(0,a.eW)(" รอบการสอบ ")),(0,a.Lk)("button",{onClick:e=>hs.editExamRound(s.analytics.option.exam_round),class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},[gs.editingExamRound?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(ys,{icon:["fas","close"],class:"text-gray-500 hover:text-red-700 text-[12px]"}),t[20]||(t[20]=(0,a.eW)(" ปิด "))],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(ys,{icon:["fas","pencil"],class:"text-gray-500 hover:text-red-700 text-[12px]"}),t[21]||(t[21]=(0,a.eW)(" แก้ไข "))],64))],8,Te)])])])]),(0,a.Lk)("div",Ae,[(0,a.Lk)("div",Ie,[(0,a.Lk)("div",Pe,[(0,a.Lk)("div",{class:(0,o.C4)(["text-2xl font-bold",{"text-green-500":s.analytics.pre.score>=s.analytics.pre.measure,"text-red-500":s.analytics.pre.score<s.analytics.pre.measure}])},(0,o.v_)(s.analytics.pre.score?s.analytics.pre.score:"0"),3),(0,a.Lk)("div",$e,[t[23]||(t[23]=(0,a.eW)(" สอบก่อนเรียน ")),(0,a.Lk)("button",Se,[(0,a.bF)(ys,{icon:["fas","search"],class:"text-gray-500 hover:text-gray-700 text-[12px]"})])])])])]),(0,a.Lk)("div",Xe,[(0,a.Lk)("div",Fe,[(0,a.Lk)("div",Ue,[(0,a.Lk)("div",{class:(0,o.C4)(["text-2xl font-bold",{"text-green-500":s.analytics.post.score>=s.analytics.post.measure,"text-red-500":s.analytics.post.score<s.analytics.post.measure}])},(0,o.v_)(s.analytics.post.score?s.analytics.post.score:"0"),3),(0,a.Lk)("div",je,[t[24]||(t[24]=(0,a.eW)(" สอบวัดผล ")),(0,a.Lk)("button",We,[(0,a.bF)(ys,{icon:["fas","search"],class:"text-gray-500 hover:text-gray-700 text-[12px]"})])])])])]),(0,a.Lk)("div",Re,[(0,a.Lk)("div",Be,[(0,a.Lk)("div",Me,[s.analytics.post.score>=s.analytics.post.measure?((0,a.uX)(),(0,a.CE)("div",He,(0,o.v_)(s.analytics.retest.score?s.analytics.retest.score:"ไม่มีสอบ"),1)):((0,a.uX)(),(0,a.CE)("div",Oe,(0,o.v_)(s.analytics.retest.score?s.analytics.retest.score:"0"),1)),(0,a.Lk)("div",ze,[t[25]||(t[25]=(0,a.eW)(" สอบซ่อม ")),(0,a.Lk)("button",Qe,[(0,a.bF)(ys,{icon:["fas","search"],class:"text-gray-500 hover:text-gray-700 text-[12px]"})])])])])])])])])])])]),(0,a.Lk)("div",Ne,[(0,a.Lk)("ul",Ye,[(0,a.Lk)("li",null,[(0,a.Lk)("div",null,[t[32]||(t[32]=(0,a.Lk)("div",{class:"text-md"},[(0,a.Lk)("p",{class:"font-semibold text-gray-900"},"ข้อมูลใบรับรอง")],-1)),(0,a.Lk)("div",Ke,[(0,a.Lk)("div",Je,[(0,a.Lk)("div",Ge,[(0,a.Lk)("div",qe,[(0,a.Lk)("div",Ve,[(0,a.Lk)("div",Ze,(0,o.v_)(hs.getCertAreaValue(s.analytics.option.cert_area)),1),(0,a.Lk)("div",et,[t[28]||(t[28]=(0,a.eW)(" พื้นที่การใช้ใบรับรอง ")),(0,a.Lk)("button",{onClick:e=>hs.toggleCertAreaList(s.analytics.option.cert_area),class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},[gs.showCertAreaList?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(ys,{icon:["fas","close"],class:"text-red-500 hover:text-red-700 text-[12px]"}),t[26]||(t[26]=(0,a.eW)(" ปิด "))],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(ys,{icon:["fas","pencil"],class:"text-gray-500 hover:text-gray-700 text-[12px]"}),t[27]||(t[27]=(0,a.eW)(" แก้ไข "))],64))],8,tt)]),(0,a.bo)((0,a.Lk)("div",st,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cert_area,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id,class:"mb-3 pb-3 border-b border-gray-100"},[(0,a.Lk)("label",at,[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[5]||(t[5]=e=>gs.selectedAreaId=e),value:e.id,class:"mr-2"},null,8,ot),[[r.XL,gs.selectedAreaId]]),(0,a.eW)(" "+(0,o.v_)(e.value),1)])])))),128))]),(0,a.Lk)("button",{onClick:e=>hs.submitArea(s),class:"mt-2 bg-blue-500 text-white font-medium py-1 px-3 rounded"}," บันทึก ",8,rt)],512),[[r.aG,gs.showCertAreaList]])])])]),(0,a.Lk)("div",it,[(0,a.Lk)("div",{class:(0,o.C4)(["border border-gray-200 shadow-sm rounded-md p-4",{"opacity-50":!s.analytics.option.cert_age}])},[(0,a.Lk)("div",nt,[(0,a.Lk)("div",lt,(0,o.v_)(hs.getCertAgeValue(s.analytics.option.cert_age)||"none"),1),(0,a.Lk)("div",dt,[t[31]||(t[31]=(0,a.eW)(" การจำหน่ายสาร ")),(0,a.Lk)("button",{onClick:e=>hs.toggleCerAgeList(s.analytics.option.cert_age),class:"bg-transparent font-normal text-sm py-1 px-2 rounded"},[gs.editingCertAge?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.bF)(ys,{icon:["fas","close"],class:"text-red-500 hover:text-red-700 text-[12px]"}),t[29]||(t[29]=(0,a.eW)(" ปิด "))],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.bF)(ys,{icon:["fas","pencil"],class:"text-gray-500 hover:text-gray-700 text-[12px]"}),t[30]||(t[30]=(0,a.eW)(" แก้ไข "))],64))],8,ct)]),(0,a.bo)((0,a.Lk)("div",ut,[(0,a.Lk)("ul",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.cert_age,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.id,class:"mb-3 pb-3 border-b border-gray-100"},[(0,a.Lk)("label",mt,[(0,a.bo)((0,a.Lk)("input",{type:"radio","onUpdate:modelValue":t[6]||(t[6]=e=>gs.selectedCertAge=e),value:e.id,class:"mr-2"},null,8,pt),[[r.XL,gs.selectedCertAge]]),(0,a.eW)(" "+(0,o.v_)(e.value),1)])])))),128))]),(0,a.Lk)("button",{onClick:e=>hs.submitAge(s),class:"mt-2 bg-blue-500 text-white font-medium py-1 px-3 rounded"}," บันทึก ",8,gt)],512),[[r.aG,gs.editingCertAge]])])],2)])])])])])])]),(0,a.Lk)("div",ht,[(0,a.Lk)("div",ft,[t[33]||(t[33]=(0,a.Lk)("p",{class:"font-semibold text-gray-900"},"ข้อมูลการสั่งซื้อ",-1)),(0,a.Lk)("div",bt,(0,o.v_)(s.orderData.price),1)]),(0,a.Lk)("div",xt,[(0,a.Lk)("div",yt,[(0,a.Lk)("p",null,[t[34]||(t[34]=(0,a.Lk)("span",{class:"text-gray-500"},"ชื่อผู้สั่งซื้อ : ",-1)),(0,a.Lk)("span",kt,(0,o.v_)(s.orderData.address.invoice.name),1)]),(0,a.Lk)("p",null,[t[35]||(t[35]=(0,a.Lk)("span",{class:"text-gray-500"},"วันที่สั่งซื้อ : ",-1)),(0,a.Lk)("span",vt,(0,o.v_)(s.orderData.adddate),1)]),(0,a.Lk)("p",null,[t[36]||(t[36]=(0,a.Lk)("span",{class:"text-gray-500"},"ช่องทางการชำระเงิน : ",-1)),(0,a.Lk)("span",wt,(0,o.v_)("transfer"===s.orderData.payment?"โอนเงิน":"บิลเพย์เมนต์"),1)]),(0,a.Lk)("p",null,[t[37]||(t[37]=(0,a.Lk)("span",{class:"text-gray-500"},"ใบเสร็จ : ",-1)),(0,a.Lk)("span",Lt,(0,o.v_)("online"===s.analytics.option.get_receipt?"ออนไลน์":"ตัวจริง"),1)]),(0,a.Lk)("p",null,[t[38]||(t[38]=(0,a.Lk)("span",{class:"text-gray-500"},"Ref1 : ",-1)),(0,a.Lk)("span",Ct,(0,o.v_)(s.orderData.ref1),1)]),(0,a.Lk)("p",null,[t[39]||(t[39]=(0,a.Lk)("span",{class:"text-gray-500"},"Ref2 : ",-1)),(0,a.Lk)("span",_t,(0,o.v_)(s.orderData.ref2),1)]),(0,a.Lk)("p",null,[t[40]||(t[40]=(0,a.Lk)("span",{class:"text-gray-500"},"Ref3 : ",-1)),(0,a.Lk)("span",Et,(0,o.v_)(s.orderData.ref3),1)])]),(0,a.Lk)("div",Dt,[(0,a.Lk)("div",Tt,[(0,a.Lk)("div",At,[(0,a.Lk)("div",null,[(0,a.Lk)("div",It,[t[41]||(t[41]=(0,a.Lk)("div",{class:"block font-medium text-gray-700 mb-2"}," ที่อยู่ที่ติดต่อได้/จัดส่งเอกสาร ",-1)),(0,a.Lk)("button",Pt,[(0,a.bF)(ys,{icon:["fas","pencil"],class:"text-gray-500 hover:text-gray-700 text-[10px]"})])]),(0,a.Lk)("span",$t,[(0,a.eW)((0,o.v_)(s.orderData.address.delivery.name)+" ",1),t[42]||(t[42]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" "+(0,o.v_)(s.orderData.address.delivery.phone)+" ",1),t[43]||(t[43]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" เลขที่ "+(0,o.v_)(s.orderData.address.delivery.address.mailinG_NO||"-")+" หมู่ "+(0,o.v_)(s.orderData.address.delivery.address.mailinG_MOO||"-")+" ถนน "+(0,o.v_)(s.orderData.address.delivery.address.mailinG_ROAD_TH||"-")+" อาคาร "+(0,o.v_)(s.orderData.address.delivery.address.mailinG_BUILDING_TH||"-")+" ตำบล "+(0,o.v_)(s.orderData.address.delivery.address.mailinG_SUB_DISTRICT_TH||"-")+" อำเภอ "+(0,o.v_)(s.orderData.address.delivery.address.mailinG_DISTRICT_TH||"-")+" จังหวัด "+(0,o.v_)(s.orderData.address.delivery.province||"-")+" "+(0,o.v_)(s.orderData.address.delivery.zipcode||"-"),1)])])])]),(0,a.Lk)("div",St,[(0,a.Lk)("div",Xt,[(0,a.Lk)("div",null,[(0,a.Lk)("div",Ft,[t[44]||(t[44]=(0,a.Lk)("div",{class:"block font-medium text-gray-700 mb-2"}," ที่อยู่ออกใบเสร็จ ",-1)),(0,a.Lk)("button",Ut,[(0,a.bF)(ys,{icon:["fas","pencil"],class:"text-gray-500 hover:text-gray-700 text-[10px]"})])]),(0,a.Lk)("span",jt,[(0,a.eW)((0,o.v_)(s.orderData.address.invoice.name)+" ",1),t[45]||(t[45]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" "+(0,o.v_)(s.orderData.address.invoice.phone)+" ",1),t[46]||(t[46]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" เลขที่ "+(0,o.v_)(s.orderData.address.invoice.address.officE_NO||s.orderData.address.invoice.address.taX_NO||"-")+" หมู่ "+(0,o.v_)(s.orderData.address.invoice.address.officE_MOO||s.orderData.address.invoice.address.taX_MOO||"-")+" ถนน "+(0,o.v_)(s.orderData.address.invoice.address.officE_ROAD_TH||s.orderData.address.invoice.address.taX_ROAD_TH||"-")+" อาคาร "+(0,o.v_)(s.orderData.address.invoice.address.officE_BUILDING_TH||s.orderData.address.invoice.address.taX_BUILDING_TH||"-")+" ตำบล "+(0,o.v_)(s.orderData.address.invoice.address.officE_SUB_DISTRICT_TH||s.orderData.address.invoice.address.taX_SUB_DISTRICT_TH||"-")+" อำเภอ "+(0,o.v_)(s.orderData.address.invoice.address.officE_DISTRICT_TH||s.orderData.address.invoice.address.taX_DISTRICT_TH||"-")+" จังหวัด "+(0,o.v_)(s.orderData.address.invoice.province||"-")+" "+(0,o.v_)(s.orderData.address.invoice.zipcode||"-"),1)])])])]),"offline"===s.orderData.bill&&"corp"===s.orderData.receipt?((0,a.uX)(),(0,a.CE)("div",Wt,[(0,a.Lk)("div",Rt,[(0,a.Lk)("div",null,[(0,a.Lk)("div",Bt,[t[47]||(t[47]=(0,a.Lk)("div",{class:"block font-medium text-gray-700 mb-2"}," ที่อยู่ออกใบกำกับภาษี ",-1)),(0,a.Lk)("button",Mt,[(0,a.bF)(ys,{icon:["fas","pencil"],class:"text-gray-500 hover:text-gray-700 text-[10px]"})])]),(0,a.Lk)("span",Ht,[(0,a.eW)((0,o.v_)(s.orderData.address.tax.address.owneR_NAME_TH)+" ("+(0,o.v_)(s.orderData.address.tax.address.taX_ID)+")",1),t[48]||(t[48]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" "+(0,o.v_)(s.orderData.address.tax.phone)+" ",1),t[49]||(t[49]=(0,a.Lk)("br",null,null,-1)),(0,a.eW)(" เลขที่ "+(0,o.v_)(s.orderData.address.tax.address.taX_NO||"-")+" หมู่ "+(0,o.v_)(s.orderData.address.tax.address.taX_MOO||"-")+" ถนน "+(0,o.v_)(s.orderData.address.tax.address.taX_ROAD_TH||"-")+" อาคาร "+(0,o.v_)(s.orderData.address.tax.address.taX_BUILDING_TH||"-")+" ตำบล "+(0,o.v_)(s.orderData.address.tax.address.taX_SUB_DISTRICT_TH||"-")+" อำเภอ "+(0,o.v_)(s.orderData.address.tax.address.taX_DISTRICT_TH||"-")+" จังหวัด "+(0,o.v_)(s.orderData.address.tax.province||"-")+" "+(0,o.v_)(s.orderData.address.invoice.zipcode||"-"),1)])])])])):(0,a.Q3)("",!0)])])])]),t[50]||(t[50]=(0,a.Fv)('<footer class="border-t border-gray-300 bg-gray-200 py-4 px-6 flex items-center justify-center"><div class="flex space-x-4"><button class="bg-blue-500 hover:bg-blue-600 text-sm text-white py-2 px-4 rounded"> Button 1 </button><button class="bg-blue-500 hover:bg-blue-600 text-sm text-white py-2 px-4 rounded"> Button 2 </button><button class="bg-blue-500 hover:bg-blue-600 text-sm text-white py-2 px-4 rounded"> Button 3 </button></div></footer>',1))],2)])))),128)),(0,a.Lk)("section",Ot,[(0,a.Lk)("div",zt,[(0,a.Lk)("div",Qt,[t[54]||(t[54]=(0,a.Lk)("div",{class:"px-4 py-5 sm:px-6"},[(0,a.Lk)("h2",{id:"notes-title",class:"text-lg font-medium text-gray-900"}," คำสั่งซื้อ ")],-1)),(0,a.Lk)("div",Nt,[(0,a.Lk)("ul",Yt,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(this.order,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e._id},[(0,a.Lk)("div",Kt,[(0,a.Lk)("div",null,[(0,a.Lk)("div",Jt,[(0,a.Lk)("a",Gt,(0,o.v_)(e.courseData.name)+" - "+(0,o.v_)(e.status),1)]),(0,a.Lk)("div",qt,[t[51]||(t[51]=(0,a.Lk)("dt",{class:"text-sm font-medium text-gray-500"}," ที่อยู่ในการติดต่อ/จัดส่งเอกสาร ",-1)),(0,a.Lk)("dd",Vt,(0,o.v_)(e.address.delivery.name),1),(0,a.Lk)("dd",Zt,(0,o.v_)(e.address.delivery.address.mailinG_NO)+" "+(0,o.v_)(e.address.delivery.address.mailinG_MOO)+" "+(0,o.v_)(e.address.delivery.address.mailinG_ROAD_TH)+" "+(0,o.v_)(e.address.delivery.address.mailinG_BUILDING_TH)+" "+(0,o.v_)(e.address.delivery.address.mailinG_SUB_DISTRICT_TH)+" "+(0,o.v_)(e.address.delivery.address.mailinG_DISTRICT_TH),1),(0,a.Lk)("dd",es,(0,o.v_)(e.address.delivery.province),1),(0,a.Lk)("dd",ts,(0,o.v_)(e.address.delivery.phone),1)]),(0,a.Lk)("div",ss,[t[52]||(t[52]=(0,a.Lk)("dt",{class:"text-sm font-medium text-gray-500"}," ที่อยู่ออกใบเสร็จ ",-1)),(0,a.Lk)("dd",as,(0,o.v_)(e.address.invoice.name),1),(0,a.Lk)("dd",os,(0,o.v_)(e.address.invoice.address.officE_NO)+" "+(0,o.v_)(e.address.invoice.address.officE_MOO)+" "+(0,o.v_)(e.address.invoice.address.officE_ROAD_TH)+" "+(0,o.v_)(e.address.invoice.address.officE_BUILDING_TH)+" "+(0,o.v_)(e.address.invoice.address.officE_SUB_DISTRICT_TH)+" "+(0,o.v_)(e.address.invoice.address.officE_DISTRICT_TH),1),(0,a.Lk)("dd",rs,(0,o.v_)(e.address.invoice.province),1),(0,a.Lk)("dd",is,(0,o.v_)(e.address.invoice.phone),1)]),(0,a.Lk)("div",ns,[t[53]||(t[53]=(0,a.Lk)("dt",{class:"text-sm font-medium text-gray-500"}," ที่อยู่ในการออกใบกำกับภาษี ",-1)),(0,a.Lk)("dd",ls,(0,o.v_)(e.address.tax.name),1),(0,a.Lk)("dd",ds,(0,o.v_)(e.address.tax.address.owneR_NAME_TH),1),(0,a.Lk)("dd",cs,(0,o.v_)(e.address.tax.address.taX_ID)+" "+(0,o.v_)(e.address.tax.address.taX_NO)+" "+(0,o.v_)(e.address.tax.address.taX_MOO)+" "+(0,o.v_)(e.address.tax.address.taX_ROAD_TH)+" "+(0,o.v_)(e.address.tax.address.taX_BUILDING_TH)+" "+(0,o.v_)(e.address.tax.address.taX_SUB_DISTRICT_TH)+" "+(0,o.v_)(e.address.tax.address.taX_DISTRICT_TH),1),(0,a.Lk)("dd",us,(0,o.v_)(e.address.tax.province),1),(0,a.Lk)("dd",ms,(0,o.v_)(e.address.tax.phone),1)])])])])))),128))])])])])])])])],64)}s(98992),s(72577),s(81454),s(37550);var gs=s(59911),hs=s.n(gs),fs=s(75435),bs=s(87814),xs=s(61628),ys=s(75220),ks=s(40475),vs=s(9964),ws=s(59328),Ls=s(76745),Cs=s(5293),_s=s(58677);const Es={class:"bg-white shadow sm:rounded-lg"},Ds={class:"border-t border-gray-200 px-4 py-5 sm:px-6"},Ts={class:"font-bold"},As={key:0,for:"targetMemberId"};function Is(e,t,s,i,n,l){return(0,a.uX)(),(0,a.CE)("div",Es,[t[24]||(t[24]=(0,a.Lk)("div",{class:"px-4 py-5 sm:px-6"},[(0,a.Lk)("h2",{id:"applicant-information-title",class:"text-lg font-bold leading-6 text-gray-900"},"Wallet")],-1)),(0,a.Lk)("div",Ds,[(0,a.Lk)("div",null,[t[7]||(t[7]=(0,a.eW)("Balance ")),(0,a.Lk)("span",Ts,"("+(0,o.v_)(n.credits)+")",1)]),t[17]||(t[17]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("form",{onSubmit:t[4]||(t[4]=(0,r.D$)(((...e)=>l.handleSubmit&&l.handleSubmit(...e)),["prevent"]))},[t[9]||(t[9]=(0,a.Lk)("label",{for:"walletMember"},"Member : ",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text",id:"walletMember","onUpdate:modelValue":t[0]||(t[0]=e=>n.walletMember=e),required:""},null,512),[[r.Jo,n.walletMember]]),t[10]||(t[10]=(0,a.Lk)("br",null,null,-1)),t[11]||(t[11]=(0,a.Lk)("label",{for:"amount"},"Amount : ",-1)),(0,a.bo)((0,a.Lk)("input",{type:"number",id:"amount","onUpdate:modelValue":t[1]||(t[1]=e=>n.amount=e),required:""},null,512),[[r.Jo,n.amount]]),t[12]||(t[12]=(0,a.Lk)("br",null,null,-1)),t[13]||(t[13]=(0,a.Lk)("label",{for:"method"},"Method : ",-1)),(0,a.bo)((0,a.Lk)("select",{id:"method","onUpdate:modelValue":t[2]||(t[2]=e=>n.walletMethod=e)},t[8]||(t[8]=[(0,a.Lk)("option",{value:"deposit"},"Deposit",-1),(0,a.Lk)("option",{value:"withdraw"},"Withdraw",-1),(0,a.Lk)("option",{value:"transfer"},"Transfer",-1)]),512),[[r.u1,n.walletMethod]]),t[14]||(t[14]=(0,a.Lk)("br",null,null,-1)),"transfer"===n.walletMethod?((0,a.uX)(),(0,a.CE)("label",As,"Target Member : ")):(0,a.Q3)("",!0),"transfer"===n.walletMethod?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"text",id:"targetMemberId","onUpdate:modelValue":t[3]||(t[3]=t=>e.targetMemberId=t),required:""},null,512)),[[r.Jo,e.targetMemberId]]):(0,a.Q3)("",!0),t[15]||(t[15]=(0,a.Lk)("br",null,null,-1)),t[16]||(t[16]=(0,a.Lk)("button",{type:"submit"},"Submit",-1))],32),(0,a.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>l.balance&&l.balance(...e))},"Check"),t[18]||(t[18]=(0,a.eW)()),t[19]||(t[19]=(0,a.Lk)("br",null,null,-1)),t[20]||(t[20]=(0,a.Lk)("br",null,null,-1)),t[21]||(t[21]=(0,a.eW)()),(0,a.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>l.reset&&l.reset(...e))},"Reset"),t[22]||(t[22]=(0,a.eW)()),t[23]||(t[23]=(0,a.Lk)("br",null,null,-1)),(0,a.Lk)("pre",null,(0,o.v_)(n.transaction),1)])])}var Ps=s(88061),$s=s(73288),Ss=s(63084),Xs={props:{member:Object,tabs:Object},data(){return{message:"Wallet",credits:0,amount:0,walletMember:this.member._id,walletMethod:"deposit",transaction:[]}},methods:{async callbackFunction(){try{console.log("callbackFunction")}catch(e){console.error(e)}},updateBadge(e){this.$emit("update-badge",{code:this.tabs.code,badge:e})},async deposit(){try{$s.A.confirm({title:"คุณต้องการเพิ่มคะแนน?",message:"เติมยอด "+this.amount+" เข้าสู่บัญชีของคุณ !",confirm:async()=>{try{const e=await Ps.A.deposit(this.walletMember,this.amount);e&&200===e.status&&this.balance()}catch(e){Ss.A.log(e)}},cancel:()=>{}})}catch(e){console.error("Error",e)}},async withdraw(){try{$s.A.confirm({title:"คุณต้องการถอนคะแนน?",message:"ถอนยอด "+this.amount+" ออกจากบัญชีของคุณ !",confirm:async()=>{try{const e=await Ps.A.withdraw(this.walletMember,this.amount);e&&200===e.status&&this.balance()}catch(e){Ss.A.log(e)}},cancel:()=>{}})}catch(e){console.error("Error",e)}},async transfer(){try{$s.A.confirm({title:"คุณต้องการโอนคะแนน?",message:"โอนยอด "+this.amount+" เข้าสู่บัญชีของสมาชิกอื่น !",confirm:async()=>{try{const e=await Ps.A.transfer(this.walletMember,this.targetMemberId,this.amount);e&&200===e.status&&this.balance()}catch(e){Ss.A.log(e)}},cancel:()=>{}})}catch(e){console.error("Error",e)}},async balance(){try{await Ps.A.balance(this.walletMember),this.credits=Ps.A.credits,this.updateBadge(this.credits)}catch(e){console.error("Error",e)}},async reset(){try{$s.A.confirm({title:"คุณต้องการรีเซ็ตคะแนน?",message:"ลบยอด "+this.credits+" จากบัญชีของคุณ !",confirm:async()=>{try{await Ps.A.reset(this.walletMember),this.credits=Ps.A.credits}catch(e){Ss.A.log(e)}},cancel:()=>{}})}catch(e){console.error("Error",e)}},async balanceTransactions(){try{const e=await Ps.A.transaction(this.walletMember,5);this.transaction=e,Ss.A.log("Transaction logs:",e)}catch(e){console.error("Error",e)}},async handleSubmit(){"deposit"===this.walletMethod?this.deposit():"transfer"===this.walletMethod?this.transfer():"withdraw"===this.walletMethod?this.withdraw():"balance"===this.walletMethod&&this.balance()}},async mounted(){try{await this.balance(),await this.balanceTransactions(),this.$setPageTitle(this.member.firstname+" "+this.member.lastname+" / Wallet")}catch(e){Ss.A.log(Error)}}},Fs=s(64621);const Us=(0,Fs.A)(Xs,[["render",Is],["__scopeId","data-v-7f7bc8e9"]]);var js=Us,Ws=s(95093),Rs=s.n(Ws);Rs()().format();var Bs={components:{Loader:fs.A,Subhead:bs.A,Image:xs.A,Enroll:ws.A,Document:Ls.A,Order:Cs.A,Profile:_s.A,Wallet:js},data(){const e=(0,ys.lq)();return{configs:ks.A.get("configs"),receivedData:"",dropdownOpen:!1,showCertAreaList:!1,editingExamRound:!1,editingCertAge:!1,selectedAreaId:"",selectedExamRound:"",selectedCertAge:"",PageName:e.meta.title,PageIcon:e.meta.icon,PagePath:e.meta.path,ParentName:e.meta.parent,ParentPage:e.meta.page,schoolData:[],profile:[],profileLoaded:!1,enroll:[],order:[],dataItem:this.$route.params.id,loading_sources:!0,back:"",capturedImageSrc:null,showPopup:!1,activeTab:"enroll",tabs:[{code:"enroll",icon:"book",shortname:"Enroll",name:"หลักสูตร",description:"Personal details and application.",badge:0},{code:"order",icon:"shopping-cart",shortname:"Order",name:"คำสั่งซื้อ",description:"Asset details.",badge:0},{code:"document",icon:"file",shortname:"File",name:"เอกสาร",description:"Admin settings.",badge:0},{code:"profile",icon:"user",shortname:"Profile",name:"ข้อมูลส่วนตัว",description:"Storage information.",badge:null},{code:"wallet",icon:"wallet",shortname:"Wallet",name:"Wallet",description:"Wallet information.",badge:0}]}},methods:{isTabVisible(e){const t={};return!(e.code in t)||t[e.code]},handleUpdateBadge(e){const t=this.tabs.find((t=>t.code===e.code));return t&&(t.badge=e.badge),t},async setActiveTab(e){this.activeTab=e,window.location.hash=`#${e}`;const t={form:this.$refs.form,material:this.$refs.material,survey:this.$refs.survey,enroll:this.$refs.enroll,document:this.$refs.document,contest:this.$refs.contest,certification:this.$refs.certification},s=t[e];s&&s.callbackFunction(),await this.delay(1);const a=this.tabs.find((t=>t.code===e));a&&this.$setPageTitle(a.name+" / "+this.profile.firstname)},delay(e){return new Promise((t=>setTimeout(t,e)))},redirectToExternalUrl(e){window.open("https://doa.fti.or.th/bypass?token="+e,"_blank")},toggleCertAreaList(e){this.showCertAreaList=!this.showCertAreaList,this.selectedAreaId=e},toggleCerAgeList(e){this.editingCertAge=!this.editingCertAge,this.selectedCertAge=e},editExamRound(e){this.editingExamRound=!this.editingExamRound,this.selectedExamRound=e},openPopup(e){this.imageUrl=e,this.originalImageUrl=e,this.showPopup=!0},closePopup(){this.showPopup=!1},handleFileUrlUpdated(e){this.updataData(e)},async updateData(e){const{data:t,status:s}=await this.$Request.PUT(`user/${this.profile._id}`,{data:{avatar_img:e},options:{}},this.configs.key);console.log("Data:",t),console.log("Status:",s),200===s&&(await this.getData(!0),console.log("Update Profile Image"))},async submitArea(e){try{e.activeBlock=!0,this.showCertAreaList=!1;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/editcert",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,area_cert:this.selectedAreaId})}),a=await s.json();this.updateEnroll(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async submitRound(e){try{this.editingExamRound=!1,e.activeBlock=!0;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/editround",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,exam_round:this.selectedExamRound})}),a=await s.json();this.updateEnrollRound(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async submitAge(e){try{this.editingCertAge=!1,e.activeBlock=!0;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/edit_certage",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,cert_age:this.selectedCertAge})}),a=await s.json();this.updateEnrollAge(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async updateEnrollAge(e){try{const{data:t}=await this.$Request.GET(`enroll/${e}`,null,this.configs.key),s={...t,analytics:{...t.analytics,option:{...t.analytics.option,cert_age:this.selectedCertAge}}};delete s._id;const{data:a,status:o}=await this.$Request.PUT(`enroll/${e}`,{data:s},this.configs.key);console.log("Data:",a),console.log("Status:",o),await this.getData(!1),200===o&&console.log("Enroll "+e+" updated successfully!")}catch(t){console.log(t)}},async updateEnrollRound(e){try{const{data:t}=await this.$Request.GET(`enroll/${e}`,null,this.configs.key),s={...t,analytics:{...t.analytics,option:{...t.analytics.option,exam_round:this.selectedExamRound}}};delete s._id;const{data:a,status:o}=await this.$Request.PUT(`enroll/${e}`,{data:s},this.configs.key);console.log("Data:",a),console.log("Status:",o),await this.getData(!1),200===o&&console.log("Enroll "+e+" updated successfully!")}catch(t){console.log(t)}},async updateEnroll(e){try{const{data:t}=await this.$Request.GET(`enroll/${e}`,null,this.configs.key),s={...t,analytics:{...t.analytics,option:{...t.analytics.option,cert_area:this.selectedAreaId}}};delete s._id;const{data:a,status:o}=await this.$Request.PUT(`enroll/${e}`,{data:s},this.configs.key);console.log("Data:",a),console.log("Status:",o),await this.getData(!1),200===o&&console.log("Enroll "+e+" updated successfully!")}catch(t){console.log(t)}},getCertAreaValue(e){const t=this.cert_area.find((t=>t.id===e));return t?t.value:""},getCertAgeValue(e){const t=this.cert_age.find((t=>t.id===e));return t?t.value:""},openCertificatePage(e,t){window.open("https://doa.fti.or.th/certification-force?token="+e+"&session="+t,"_blank")},formatThaidate(e){return vs.A.toThaiDatetime(e,"short")},dateTime(e){return Rs()(e).format("DD/MM/YYYY hh:mm:ss")},async getData(e){if(ks.A.get("session","login"))try{let t=this.$route.params.id;e&&(this.loading_sources=!1);const s=[{$match:{_id:t}},{$lookup:{from:"enroll",let:{enrollIds:"$enroll"},pipeline:[{$match:{$expr:{$in:[{$toString:"$_id"},{$map:{input:"$$enrollIds",in:{$toString:"$$this"}}}]}}},{$addFields:{courseID:{$cond:[{$in:[{$type:"$courseID"},["string","objectId"]]},{$toObjectId:"$courseID"},"$courseID"]}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"courseData"}},{$addFields:{courseData:{$arrayElemAt:["$courseData",0]}}},{$unset:["courseID"]},{$lookup:{from:"order",localField:"courseData._id",foreignField:"courseData._id",as:"orderData"}}],as:"enrollData"}},{$lookup:{from:"course",localField:"enrollData.courseID",foreignField:"_id",as:"courseData"}},{$lookup:{from:"order",let:{orderIds:"$order"},pipeline:[{$match:{$expr:{$in:[{$toString:"$_id"},{$map:{input:"$$orderIds",in:{$toString:"$$this"}}}]}}},{$addFields:{courseID:{$cond:[{$in:[{$type:"$courseID"},["string","objectId"]]},{$toObjectId:"$courseID"},"$courseID"]},userID:{$cond:[{$in:[{$type:"$userID"},["string","objectId"]]},{$toObjectId:"$userID"},"$userID"]}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"courseData"}},{$addFields:{courseData:{$arrayElemAt:["$courseData",0]}}},{$unset:["courseID"]}],as:"orderData"}},{$addFields:{enroll:{$cond:[{$isArray:"$enrollData"},{$map:{input:"$enrollData",as:"enroll",in:{$mergeObjects:["$$enroll",{orderData:{$arrayElemAt:["$orderData",{$indexOfArray:["$enrollData.courseData._id","$$enroll.courseData._id"]}]}}]}}},[]]},order:"$orderData"}},{$project:{profile:{$arrayToObject:{$filter:{input:{$objectToArray:"$$ROOT"},cond:{$not:{$in:["$$this.k",["enrollData","orderData","courseData","enroll","order"]]}}}}},enroll:"$enroll",order:"$order"}}],{data:a,status:o}=await this.$Request.POST("user/aggregate",{pipeline:s},this.configs.key);if(200===o){const t=a[0].enroll,s=a[0].order,o=a[0].profile;this.profile=o,this.profileLoaded=!0,this.order=s,this.credits=o&&o.point&&o.point.active?o.point.active:0;const r=t.map((e=>({...e,activeBlock:!1})));this.enroll=r,this.profile.avatar_img||(this.profile.avatar_img="https://doa-academy.sgp1.digitaloceanspaces.com/2023/12/1701849647875.png"),e&&(this.loading_sources=!0)}}catch(t){console.log(t)}},async deleteData(e){if(ks.A.get("session","login"))try{this.loading_sources=!1;let t=ks.A.get("session","token"),s=this.$route.params.id;const a=await fetch("https://asia-southeast2-elearning-6871c.cloudfunctions.net/schools/removeAdmin/"+s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({userId:e})});console.log(await a),this.loading_sources=!0,await this.getData(!0)}catch(t){console.log(t)}},async getProfileData(e){if(ks.A.get("session","login"))try{const t=`https://faas-sgp1-18bc02ac.doserverless.co/api/v1/web/fn-3bf765c8-bb4f-4bac-ba41-9698000f7334/default/getstudentdata?id=${e}`,s=await fetch(t),a=await s.json();console.log(a)}catch(t){console.log(t)}},updated(){hs().replace()}},async mounted(){try{await this.getData(!0)}catch(e){console.log(Error)}},setup(){},created(){if(window.location.hash){const e=window.location.hash.replace("#","");this.tabs.some((t=>t.code===e))&&(this.activeTab=e)}},computed:{TabData(){return this.tabs.find((e=>e.code===this.activeTab))},showTaxInvoice(){return this.enroll.orderData.address.tax.address.taX_ID&&this.enroll.orderData.address.tax.address.owneR_NAME_TH},imageStyle(){return{transform:`translate(${this.imagePositionX}px, ${this.imagePositionY}px) scale(${this.zoomPercentage/100}) rotate(${this.rotationAngle}deg)`}}}};const Ms=(0,Fs.A)(Bs,[["render",ps]]);var Hs=Ms},21605:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return he}});s(98992),s(72577);var a=s(20641),o=s(90033);const r={key:0,class:"text-center"},i={class:"bg-white border-b border-gray-200"},n={key:0,class:"px-4 sm:px-6 lg:px-8"},l={class:"pt-5"},d={class:"md:flex md:items-center md:justify-between md:space-x-5"},c={class:"flex items-center space-x-5"},u={class:"flex-shrink-0"},m={class:"relative"},p={class:"h-24 w-24 rounded-md cursor-pointer"},g=["src"],h={class:"text-2xl font-bold text-gray-900"},f={class:"text-sm text-gray-800"},b={class:"text-gray-500"},x={class:"text-sm text-gray-800"},y={class:"text-gray-500"},k={class:"text-sm text-gray-800"},v={class:"text-gray-500"},w={class:"justify-stretch mt-6 flex flex-col-reverse space-y-4 space-y-reverse sm:flex-row-reverse sm:justify-end sm:space-y-0 sm:space-x-3 sm:space-x-reverse md:mt-0 md:flex-row md:space-x-3"},L={type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},C={class:"border-t border-gray-200 pt-3 mt-5"},_={class:"flex space-x-2",id:"tab-list"},E=["onClick"],D={class:"hidden md:inline"},T={key:0,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},A={key:1,class:"text-xs bg-red-500 text-white py-0 px-1 rounded-md text-center"},I={class:"md:hidden text-xs"},P=["value"],$={class:"mt-8 px-4 sm:px-6 lg:px-8"},S={class:"space-y-6"},X={class:"bg-white rounded-lg shadow-sm border border-gray-200"},F={key:0,class:"px-4 py-3 border-b border-gray-200"},U={class:"flex items-center justify-between"},j={class:"flex items-center space-x-3"},W={class:"w-8 h-8 bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg flex items-center justify-center"},R={class:"text-base font-semibold text-gray-900"},B={class:"text-xs text-gray-500"},M={class:"bg-blue-50 border-l-4 border-blue-400 p-3"},H={class:"flex"},O={class:"flex-shrink-0"},z={class:"ml-2"},Q={class:"text-xs text-blue-700"},N={class:"p-4"},Y={key:0,"aria-labelledby":"applicant-information-title"},K={key:1,"aria-labelledby":"applicant-information-title"},J={key:2,"aria-labelledby":"applicant-information-title"},G={key:3,"aria-labelledby":"applicant-information-title"};function q(e,t,s,q,V,Z){const ee=(0,a.g2)("Loader"),te=(0,a.g2)("Subhead"),se=(0,a.g2)("Image"),ae=(0,a.g2)("font-awesome-icon"),oe=(0,a.g2)("Enroll"),re=(0,a.g2)("Order"),ie=(0,a.g2)("Document"),ne=(0,a.g2)("Profile");return(0,a.uX)(),(0,a.CE)(a.FK,null,[V.loading_sources?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",r,[(0,a.bF)(ee)])),V.loading_sources?((0,a.uX)(),(0,a.Wv)(te,{key:1,navigation:[{name:"ย้อนกลับ",link:this.back?this.back:"/student/dashboard",style:"chevron-left",class:"default-btn",visible:!0,type:"button"}]},null,8,["navigation"])):(0,a.Q3)("",!0),V.showPopup?((0,a.uX)(),(0,a.Wv)(se,{key:2,cropImageWidth:"600px",cropImageHeight:"600px",uploadPath:"Upload/_profile/",imageUrl:e.imageUrl,filePrefix:this.profile._id,onFileUrlUpdated:Z.handleFileUrlUpdated,onClosePopupEvent:Z.closePopup},null,8,["imageUrl","filePrefix","onFileUrlUpdated","onClosePopupEvent"])):(0,a.Q3)("",!0),(0,a.Lk)("div",i,[V.loading_sources?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",l,[(0,a.Lk)("div",d,[(0,a.Lk)("div",c,[(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[((0,a.uX)(),(0,a.CE)("img",{class:"h-full w-full rounded-md",src:V.profile.avatar_img,key:V.profile.avatar_img,alt:""},null,8,g)),(0,a.Lk)("div",{class:"absolute inset-0 rounded-md bg-black bg-opacity-0 hover:bg-opacity-50 flex justify-center items-center transition duration-300",onClick:t[0]||(t[0]=e=>Z.openPopup(V.profile.avatar_img))},[(0,a.bF)(ae,{icon:["fas","upload"],class:"text-white text-[24px] opacity-0 hover:opacity-100"})])])])]),(0,a.Lk)("div",null,[(0,a.Lk)("h1",h,(0,o.v_)(this.profile.firstname+" "+this.profile.lastname),1),(0,a.Lk)("p",f,[t[3]||(t[3]=(0,a.eW)(" ลงทะเบียน : ")),(0,a.Lk)("span",b,(0,o.v_)(this.profile?.createdAt),1)]),(0,a.Lk)("p",x,[t[4]||(t[4]=(0,a.eW)(" Email : ")),(0,a.Lk)("span",y,(0,o.v_)(this.profile?.email),1)]),(0,a.Lk)("p",k,[t[5]||(t[5]=(0,a.eW)(" Phone : ")),(0,a.Lk)("span",v,(0,o.v_)(this.profile?.phone),1)])])]),(0,a.Lk)("div",w,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>Z.redirectToExternalUrl(this.profile.token)),type:"button",class:"inline-flex items-center justify-center rounded-md border border-gray-300 bg-white px-4 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-100"},[(0,a.bF)(ae,{icon:["fas","key"],class:"text-black text-[12px] mr-2"}),t[6]||(t[6]=(0,a.eW)(" เข้าสู่ระบบ "))]),(0,a.Lk)("button",L,[(0,a.bF)(ae,{icon:["fas","trash"],class:"text-black text-[12px] mr-2"}),t[7]||(t[7]=(0,a.eW)(" ลบ "))])])])]),(0,a.Lk)("div",null,[(0,a.Lk)("div",C,[(0,a.Lk)("ul",_,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(V.tabs,(e=>((0,a.uX)(),(0,a.CE)("li",{key:e.code,class:(0,o.C4)([{"text-gray-500":V.activeTab!==e.code,"text-black":V.activeTab===e.code,"border-b-4 border-blue-500":V.activeTab===e.code},"cursor-pointer py-2 px-2"]),onClick:t=>Z.setActiveTab(e.code)},[(0,a.Lk)("span",D,[(0,a.bF)(ae,{icon:["fas",e.icon]},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(e.name)+" ",1),"enroll"===e.code?((0,a.uX)(),(0,a.CE)("span",T,(0,o.v_)(V.enroll.length),1)):(0,a.Q3)("",!0),"material"===e.code?((0,a.uX)(),(0,a.CE)("span",A,"0")):(0,a.Q3)("",!0)]),(0,a.Lk)("span",I,[(0,a.bF)(ae,{icon:["fas",e.icon]},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(e.shortname),1)])],10,E)))),128))]),(0,a.Lk)("select",{class:"mb-3 md:hidden w-full border border-gray-300 rounded-md",id:"tab-dropdown",onChange:t[2]||(t[2]=e=>Z.setActiveTab(e.target.value))},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(V.tabs,(t=>((0,a.uX)(),(0,a.CE)("option",{key:t.code,value:t.code},[(0,a.eW)((0,o.v_)(t.name)+" ",1),"enroll"===t.code?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,o.v_)(V.enroll.length),1)],64)):(0,a.Q3)("",!0),"material"===t.code?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,o.v_)(e.playerCount),1)],64)):(0,a.Q3)("",!0)],8,P)))),128))],32)])])])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",$,[(0,a.Lk)("div",S,[(0,a.Lk)("div",X,[V.activeTab?((0,a.uX)(),(0,a.CE)("div",F,[(0,a.Lk)("div",U,[(0,a.Lk)("div",j,[(0,a.Lk)("div",W,[(0,a.bF)(ae,{icon:["fas",V.tabs.find((e=>e.code===V.activeTab))?.icon||"book"],class:"text-white text-sm"},null,8,["icon"])]),(0,a.Lk)("div",null,[(0,a.Lk)("h2",R,(0,o.v_)(V.tabs.find((e=>e.code===V.activeTab))?.name||"ข้อมูล"),1),(0,a.Lk)("p",B,(0,o.v_)(V.tabs.find((e=>e.code===V.activeTab))?.description||"จัดการข้อมูลนักเรียน"),1)])])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",M,[(0,a.Lk)("div",H,[(0,a.Lk)("div",O,[(0,a.bF)(ae,{icon:["fas","info-circle"],class:"text-blue-400 text-sm"})]),(0,a.Lk)("div",z,[(0,a.Lk)("p",Q,[t[8]||(t[8]=(0,a.Lk)("strong",null,"หมายเหตุ:",-1)),(0,a.eW)(" ข้อมูลในหน้านี้แสดงรายละเอียดของนักเรียน "+(0,o.v_)(this.profile.firstname+" "+this.profile.lastname)+" และสามารถจัดการข้อมูลต่างๆ ได้ตามแท็บที่เลือก ",1)])])])]),(0,a.Lk)("div",N,["enroll"===V.activeTab?((0,a.uX)(),(0,a.CE)("section",Y,[V.profileLoaded?((0,a.uX)(),(0,a.Wv)(oe,{key:0,enrolls:V.enroll,member:V.profile,ref:"enroll",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["enrolls","member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"order"===V.activeTab?((0,a.uX)(),(0,a.CE)("section",K,[V.profileLoaded?((0,a.uX)(),(0,a.Wv)(re,{key:0,member:V.profile,ref:"order",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"document"===V.activeTab?((0,a.uX)(),(0,a.CE)("section",J,[V.profileLoaded?((0,a.uX)(),(0,a.Wv)(ie,{key:0,member:V.profile,ref:"document",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0),"profile"===V.activeTab?((0,a.uX)(),(0,a.CE)("section",G,[V.profileLoaded?((0,a.uX)(),(0,a.Wv)(ne,{key:0,member:V.profile,ref:"profile",tabs:e.TabData,onUpdateBadge:e.handleUpdateBadge},null,8,["member","tabs","onUpdateBadge"])):(0,a.Q3)("",!0)])):(0,a.Q3)("",!0)])])])])],64)}s(14603),s(47566),s(98721);var V=s(59911),Z=s.n(V),ee=s(75435),te=s(87814),se=s(61628),ae=s(75220),oe=s(40475),re=s(9964),ie=s(95093),ne=s.n(ie),le=s(59328),de=s(76745),ce=s(5293),ue=s(58677);ne()().format();var me={data(){const e=(0,ae.lq)();return{configs:oe.A.get("configs"),session:oe.A.get("session"),showCertAreaList:!1,editingExamRound:!1,editingCertAge:!1,selectedAreaId:"",selectedExamRound:"",selectedCertAge:"",PageName:e.meta.title,PageIcon:e.meta.icon,PagePath:e.meta.path,ParentName:e.meta.parent,ParentPage:e.meta.page,schoolData:[],profile:[],profileLoaded:!1,enroll:[],order:[],dataItem:this.$route.params.id,loading_sources:!0,back:"",capturedImageSrc:null,cert_area:[{id:"1",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 1 (เชียงใหม่ แพร่ น่าน ลำปาง เชียงราย แม่ฮ่องสอน)"},{id:"2",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 2 (พิษณุโลก พิจิตร สุโขทัย ตาก อุตรดิตถ์ เพชรบูรณ์)"},{id:"3",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 3 (ขอนแก่น หนองคาย กาฬสินธุ์ เลย อุดรธานี มุกดาหาร สกลนคร นครพนม ชัยภูมิ)"},{id:"4",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 4 (อุบลราชธานี นครราชสีมา สุรินทร์ มหาสารคาม ร้อยเอ็ด บุรีรัมย์ ศรีสะเกษ ยโสธร )"},{id:"5",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 5 (ชัยนาท กาญจนบุรี เพชรรัตน์เพชรบุรี ปทุมธานี ราชบุรี อุทัยธานี ลพบุรี นครปฐม นครสวรรค์ )"},{id:"6",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 6 (จันทบุรี ระยอง ปราจีนบุรี ฉะเชิงเทรา )"},{id:"7",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 7 (สุราษฎร์ธานี นครศรีธรรมราช กระบี่ ระนอง ภูเก็ต พังงา ชุมพร )"},{id:"8",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 8 (สงขลา ตาราง ตรัง นราธิวาส ปัตตานี ยะลา พัทลุง สตูล )"},{id:"9",value:"สำนักควบคุมพืชและวัสดุการเกษตร กรุงเทพมหานคร"}],cert_age:[{id:"3",value:"จำหน่ายสารไกลโฟเซต"},{id:"5",value:"ไม่จำหน่ายสารไกลโฟเซต"}],showPopup:!1,credits:0,amount:0,walletMember:this.$route.params.id,walletMethod:"deposit",activeTab:"enroll",tabs:[{code:"enroll",icon:"book",shortname:"Enroll",name:"หลักสูตร",description:"Personal details and application."},{code:"order",icon:"shopping-cart",shortname:"Order",name:"คำสั่งซื้อ",description:"Asset details."},{code:"document",icon:"file",shortname:"File",name:"เอกสาร",description:"Admin settings."},{code:"profile",icon:"user",shortname:"Profile",name:"ข้อมูลส่วนตัว",description:"Storage information."}]}},components:{Loader:ee.A,Subhead:te.A,Image:se.A,Enroll:le.A,Document:de.A,Order:ce.A,Profile:ue.A},methods:{setActiveTab(e){this.activeTab=e,window.location.hash=`#${e}`},redirectToExternalUrl(){window.open("https://"+this.session.current.hostname+"/user/bypass/"+this.dataItem,"_blank")},toggleCertAreaList(e){this.showCertAreaList=!this.showCertAreaList,this.selectedAreaId=e},toggleCerAgeList(e){this.editingCertAge=!this.editingCertAge,this.selectedCertAge=e},editExamRound(e){this.editingExamRound=!this.editingExamRound,this.selectedExamRound=e},openPopup(e){this.imageUrl=e,this.originalImageUrl=e,this.showPopup=!0},closePopup(){this.showPopup=!1},handleFileUrlUpdated(e){this.updataData(e)},async updataData(e){const t=await fetch("https://gateway.cloudrestfulapi.com/api/user/"+this.profile._id,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{avatar_img:e},options:{}})});await t.json(),200===t.status&&(await this.getData(!0),console.log("Update Profile Image"))},async submitArea(e){try{e.activeBlock=!0,this.showCertAreaList=!1;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/editcert",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,area_cert:this.selectedAreaId})}),a=await s.json();this.updateEnroll(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async submitRound(e){try{this.editingExamRound=!1,e.activeBlock=!0;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/editround",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,exam_round:this.selectedExamRound})}),a=await s.json();this.updateEnrollRound(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async submitAge(e){try{this.editingCertAge=!1,e.activeBlock=!0;const t=new Headers;t.append("API-KEY","5CB584F5ECFD7"),t.append("SECRET-KEY","6A5891C7352197F8A5CE8A9B67EF3");const s=await fetch("https://api2.fti.academy/api/edit_certage",{method:"POST",headers:t,body:JSON.stringify({student:this.profile.token,cert_age:this.selectedCertAge})}),a=await s.json();this.updateEnrollAge(e._id),console.log("result",a)}catch(t){console.error("An error occurred:",t)}},async updateEnrollAge(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,cert_age:this.selectedCertAge}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},async updateEnrollRound(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,exam_round:this.selectedExamRound}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},async updateEnroll(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e),s=await t.json(),a={...s,analytics:{...s.analytics,option:{...s.analytics.option,cert_area:this.selectedAreaId}}};delete a._id;const o=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});await o.json(),await this.getData(!1),o.status}catch(t){console.log(t)}},getCertAreaValue(e){const t=this.cert_area.find((t=>t.id===e));return t?t.value:""},getCertAgeValue(e){const t=this.cert_age.find((t=>t.id===e));return t?t.value:""},openCertificatePage(e,t){window.open("https://doa.fti.or.th/certification-force?token="+e+"&session="+t,"_blank")},formatThaidate(e){return re.A.toThaiDatetime(e,"short")},dateTime(e){return ne()(e).format("DD/MM/YYYY hh:mm:ss")},async getData(e){if(oe.A.get("session","login"))try{let t=this.$route.params.id;e&&(this.loading_sources=!1);const s=[{$match:{_id:t}},{$project:{profile:"$$ROOT"}}],a=await fetch("https://gateway.cloudrestfulapi.com/api/user/aggregate",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({pipeline:s})}),o=await a.json();if(200===a.status){const t=o[0].profile;console.log("profileData",t),this.profile=t,this.profileLoaded=!0,this.credits=t&&t.point&&t.point.active?t.point.active:0,this.profile.avatar_img||(this.profile.avatar_img="https://doa-academy.sgp1.digitaloceanspaces.com/2023/12/1701849647875.png"),e&&(this.loading_sources=!0)}}catch(t){console.log(t)}},async deleteData(e){if(oe.A.get("session","login"))try{this.loading_sources=!1;let t=oe.A.get("session","token"),s=this.$route.params.id;const a=await fetch("https://asia-southeast2-elearning-6871c.cloudfunctions.net/schools/removeAdmin/"+s,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer "+t},body:JSON.stringify({userId:e})});console.log(await a),this.loading_sources=!0,await this.getData(!0)}catch(t){console.log(t)}},async getProfileData(e){if(oe.A.get("session","login"))try{const t=`https://faas-sgp1-18bc02ac.doserverless.co/api/v1/web/fn-3bf765c8-bb4f-4bac-ba41-9698000f7334/default/getstudentdata?id=${e}`,s=await fetch(t),a=await s.json();console.log(a)}catch(t){console.log(t)}},updated(){Z().replace()}},async mounted(){try{await this.getData(!0),await this.balanceTransactions();const e=new URLSearchParams(window.location.search),t=e.get("back");this.back=t}catch(e){console.log(Error)}},setup(){},created(){},computed:{showTaxInvoice(){return this.enroll.orderData.address.tax.address.taX_ID&&this.enroll.orderData.address.tax.address.owneR_NAME_TH},imageStyle(){return{transform:`translate(${this.imagePositionX}px, ${this.imagePositionY}px) scale(${this.zoomPercentage/100}) rotate(${this.rotationAngle}deg)`}}}},pe=s(64621);const ge=(0,pe.A)(me,[["render",q]]);var he=ge},76745:function(e,t,s){"use strict";s.d(t,{A:function(){return c}});var a=s(20641);const o={class:"bg-white shadow sm:rounded-lg"};function r(e,t,s,r,i,n){return(0,a.uX)(),(0,a.CE)("div",o,t[0]||(t[0]=[(0,a.Lk)("div",{class:"px-4 py-5 sm:px-6"},[(0,a.Lk)("h2",{id:"applicant-information-title",class:"text-lg font-bold leading-6 text-gray-900"},"เอกสาร")],-1),(0,a.Lk)("div",{class:"border-t border-gray-200 px-4 py-5 sm:px-6"},null,-1)]))}var i=s(63084),n={props:{member:Object},data(){return{message:"Document"}},mounted(){i.A.log("this.member.firstname:",this.member.firstname),i.A.log("this.member.lastname:",this.member.lastname);const e=this.member.firstname+" "+this.member.lastname+" / เอกสาร";i.A.log("pageTitle:",e),this.$setPageTitle(e)}},l=s(64621);const d=(0,l.A)(n,[["render",r],["__scopeId","data-v-222298fe"]]);var c=d},59328:function(e,t,s){"use strict";s.d(t,{A:function(){return Ve}});var a=s(20641),o=s(90033);const r={class:"flex flex-col lg:flex-row gap-6"},i={class:"w-full lg:w-80 space-y-4"},n={key:0,class:"bg-gradient-to-br from-purple-50 to-blue-50 rounded-xl p-4 border border-purple-100"},l={class:"flex items-center justify-between mb-3"},d={class:"text-sm font-semibold text-gray-900 flex items-center"},c={class:"text-xs text-gray-500"},u={class:"grid grid-cols-2 gap-2"},m={class:"bg-white/70 backdrop-blur-sm rounded-lg p-2.5 text-center"},p={class:"text-lg font-bold text-purple-600"},g={class:"bg-white/70 backdrop-blur-sm rounded-lg p-2.5 text-center"},h={class:"text-lg font-bold text-green-600"},f={class:"bg-white/70 backdrop-blur-sm rounded-lg p-2.5 text-center"},b={class:"text-lg font-bold text-blue-600"},x={class:"bg-white/70 backdrop-blur-sm rounded-lg p-2.5 text-center"},y={class:"text-lg font-bold text-amber-600"},k={key:1,class:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm"},v={class:"text-sm font-semibold text-gray-900 flex items-center mb-3"},w={class:"space-y-2"},L={class:"flex items-center justify-between text-xs"},C={class:"font-medium text-green-600"},_={class:"w-full bg-gray-100 rounded-full h-1.5"},E={class:"flex items-center justify-between text-xs"},D={class:"font-medium text-blue-600"},T={class:"w-full bg-gray-100 rounded-full h-1.5"},A={class:"flex items-center justify-between text-xs"},I={class:"font-medium text-gray-600"},P={class:"w-full bg-gray-100 rounded-full h-1.5"},$={key:2,class:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm"},S={class:"text-sm font-semibold text-gray-900 flex items-center mb-3"},X={class:"space-y-3"},F={class:"bg-emerald-50 rounded-lg p-2 border border-emerald-100"},U={class:"flex items-center justify-between"},j={class:"text-sm font-bold text-emerald-800"},W={class:"bg-red-50 rounded-lg p-2 border border-red-100"},R={class:"flex items-center justify-between"},B={class:"text-sm font-bold text-red-800"},M={class:"bg-gray-50 rounded-lg p-2 border border-gray-100"},H={class:"flex items-center justify-between"},O={class:"text-sm font-bold text-gray-800"},z={key:3,class:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm"},Q={class:"text-sm font-semibold text-gray-900 flex items-center mb-3"},N={class:"space-y-2"},Y={class:"flex items-center justify-between"},K={class:"text-xs font-medium text-amber-600"},J={class:"flex items-center justify-between"},G={class:"text-xs font-medium text-blue-600"},q={class:"flex items-center justify-between"},V={class:"text-xs font-medium text-gray-600"},Z={class:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm"},ee={class:"text-sm font-semibold text-gray-900 flex items-center mb-3"},te={class:"space-y-2"},se={key:0,class:"w-full flex items-center justify-between p-2 text-xs bg-blue-50 hover:bg-blue-100 rounded-lg border border-blue-200 transition-colors"},ae={key:1,class:"w-full flex items-center justify-between p-2 text-xs bg-amber-50 hover:bg-amber-100 rounded-lg border border-amber-200 transition-colors"},oe={class:"w-full flex items-center justify-between p-2 text-xs bg-purple-50 hover:bg-purple-100 rounded-lg border border-purple-200 transition-colors"},re={class:"flex-1 space-y-4"},ie={key:0,class:"text-center py-12 bg-gradient-to-b from-gray-50 to-white rounded-xl border border-gray-100"},ne={class:"w-16 h-16 bg-gradient-to-br from-purple-100 to-blue-100 rounded-full flex items-center justify-center mx-auto mb-4"},le={key:1,class:"space-y-3"},de={class:"p-4"},ce={class:"flex items-start space-x-3 mb-3"},ue={class:"flex-shrink-0 relative"},me={class:"w-14 h-14 rounded-xl overflow-hidden border-2 border-gray-100 group-hover:border-purple-200 transition-colors"},pe=["src","alt"],ge={class:"absolute -top-1 -right-1 w-6 h-6 rounded-full border-2 border-white bg-white shadow-sm flex items-center justify-center"},he={class:"flex-1 min-w-0"},fe={class:"flex items-start justify-between"},be={class:"flex-1 min-w-0"},xe={class:"text-sm font-semibold text-gray-900 truncate pr-2"},ye={class:"flex items-center space-x-2 mt-1"},ke={class:"flex-shrink-0"},ve={key:1,class:"inline-flex items-center px-2 py-1 border border-gray-200 rounded-lg text-xs font-medium text-gray-500 bg-gray-50"},we={key:0,class:"mt-2"},Le={class:"flex items-center justify-between text-xs text-gray-500 mb-1"},Ce={class:"font-medium"},_e={class:"w-full bg-gray-100 rounded-full h-1.5"},Ee={class:"grid grid-cols-6 gap-2 mb-3"},De={class:"col-span-3 bg-gradient-to-r from-slate-50 to-gray-50 rounded-lg p-2 border border-slate-100"},Te={class:"text-xs text-gray-500 mb-1 flex items-center"},Ae={class:"flex items-center justify-between text-xs"},Ie={class:"text-gray-600"},Pe={class:"text-blue-600"},$e={class:"text-green-600"},Se={class:"col-span-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-2 border border-blue-100"},Xe={class:"text-xs text-blue-600 mb-1 flex items-center"},Fe={class:"flex items-center justify-between text-xs"},Ue={class:"text-yellow-600"},je={class:"text-blue-600"},We={class:"text-orange-600"},Re={key:0,class:"bg-blue-50 rounded-lg p-2 border border-blue-100"},Be={class:"flex items-start space-x-2"},Me={class:"text-xs text-blue-700 leading-relaxed"};function He(e,t,s,He,Oe,ze){const Qe=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",i,[Oe.enrolls.length>0?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",l,[(0,a.Lk)("h3",d,[(0,a.bF)(Qe,{icon:["fas","chart-line"],class:"mr-2 text-purple-600"}),t[1]||(t[1]=(0,a.eW)(" สถิติรวม "))]),(0,a.Lk)("span",c,(0,o.v_)(Oe.enrolls.length)+" หลักสูตร",1)]),(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,(0,o.v_)(ze.overallStats.totalCourses),1),t[2]||(t[2]=(0,a.Lk)("div",{class:"text-xs text-gray-600"},"หลักสูตรทั้งหมด",-1))]),(0,a.Lk)("div",g,[(0,a.Lk)("div",h,(0,o.v_)(ze.overallStats.completedCourses),1),t[3]||(t[3]=(0,a.Lk)("div",{class:"text-xs text-gray-600"},"เรียนจบแล้ว",-1))]),(0,a.Lk)("div",f,[(0,a.Lk)("div",b,(0,o.v_)(Math.round(ze.overallStats.averageProgress))+"%",1),t[4]||(t[4]=(0,a.Lk)("div",{class:"text-xs text-gray-600"},"ความคืบหน้าเฉลี่ย",-1))]),(0,a.Lk)("div",x,[(0,a.Lk)("div",y,(0,o.v_)(ze.overallStats.certificatesAvailable),1),t[5]||(t[5]=(0,a.Lk)("div",{class:"text-xs text-gray-600"},"ใบรับรองได้รับ",-1))])])])):(0,a.Q3)("",!0),Oe.enrolls.length>0?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("h3",v,[(0,a.bF)(Qe,{icon:["fas","chart-pie"],class:"mr-2 text-indigo-600"}),t[6]||(t[6]=(0,a.eW)(" การกระจายความคืบหน้า "))]),(0,a.Lk)("div",w,[(0,a.Lk)("div",L,[t[7]||(t[7]=(0,a.Lk)("span",{class:"text-gray-600"},"เรียนจบ (100%)",-1)),(0,a.Lk)("span",C,(0,o.v_)(ze.progressDistribution.completed)+" หลักสูตร",1)]),(0,a.Lk)("div",_,[(0,a.Lk)("div",{class:"bg-green-500 h-1.5 rounded-full",style:(0,o.Tr)({width:ze.progressDistribution.completed/Oe.enrolls.length*100+"%"})},null,4)]),(0,a.Lk)("div",E,[t[8]||(t[8]=(0,a.Lk)("span",{class:"text-gray-600"},"กำลังเรียน (1-99%)",-1)),(0,a.Lk)("span",D,(0,o.v_)(ze.progressDistribution.inProgress)+" หลักสูตร",1)]),(0,a.Lk)("div",T,[(0,a.Lk)("div",{class:"bg-blue-500 h-1.5 rounded-full",style:(0,o.Tr)({width:ze.progressDistribution.inProgress/Oe.enrolls.length*100+"%"})},null,4)]),(0,a.Lk)("div",A,[t[9]||(t[9]=(0,a.Lk)("span",{class:"text-gray-600"},"ยังไม่เริ่ม (0%)",-1)),(0,a.Lk)("span",I,(0,o.v_)(ze.progressDistribution.notStarted)+" หลักสูตร",1)]),(0,a.Lk)("div",P,[(0,a.Lk)("div",{class:"bg-gray-400 h-1.5 rounded-full",style:(0,o.Tr)({width:ze.progressDistribution.notStarted/Oe.enrolls.length*100+"%"})},null,4)])])])):(0,a.Q3)("",!0),Oe.enrolls.length>0?((0,a.uX)(),(0,a.CE)("div",$,[(0,a.Lk)("h3",S,[(0,a.bF)(Qe,{icon:["fas","clipboard-check"],class:"mr-2 text-emerald-600"}),t[10]||(t[10]=(0,a.eW)(" ผลการสอบ "))]),(0,a.Lk)("div",X,[(0,a.Lk)("div",F,[(0,a.Lk)("div",U,[t[11]||(t[11]=(0,a.Lk)("span",{class:"text-xs text-emerald-700"},"ผ่านการสอบ",-1)),(0,a.Lk)("span",j,(0,o.v_)(ze.examStats.passed),1)])]),(0,a.Lk)("div",W,[(0,a.Lk)("div",R,[t[12]||(t[12]=(0,a.Lk)("span",{class:"text-xs text-red-700"},"ไม่ผ่านการสอบ",-1)),(0,a.Lk)("span",B,(0,o.v_)(ze.examStats.failed),1)])]),(0,a.Lk)("div",M,[(0,a.Lk)("div",H,[t[13]||(t[13]=(0,a.Lk)("span",{class:"text-xs text-gray-700"},"ยังไม่ได้สอบ",-1)),(0,a.Lk)("span",O,(0,o.v_)(ze.examStats.notTaken),1)])])])])):(0,a.Q3)("",!0),Oe.enrolls.length>0?((0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("h3",Q,[(0,a.bF)(Qe,{icon:["fas","award"],class:"mr-2 text-amber-600"}),t[14]||(t[14]=(0,a.eW)(" สถานะใบรับรอง "))]),(0,a.Lk)("div",N,[(0,a.Lk)("div",Y,[t[15]||(t[15]=(0,a.Lk)("div",{class:"flex items-center text-xs"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-amber-400 rounded-full mr-2"}),(0,a.Lk)("span",{class:"text-gray-600"},"ได้รับแล้ว")],-1)),(0,a.Lk)("span",K,(0,o.v_)(ze.certificateStats.available),1)]),(0,a.Lk)("div",J,[t[16]||(t[16]=(0,a.Lk)("div",{class:"flex items-center text-xs"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-blue-400 rounded-full mr-2"}),(0,a.Lk)("span",{class:"text-gray-600"},"กำลังดำเนินการ")],-1)),(0,a.Lk)("span",G,(0,o.v_)(ze.certificateStats.pending),1)]),(0,a.Lk)("div",q,[t[17]||(t[17]=(0,a.Lk)("div",{class:"flex items-center text-xs"},[(0,a.Lk)("div",{class:"w-2 h-2 bg-gray-400 rounded-full mr-2"}),(0,a.Lk)("span",{class:"text-gray-600"},"ไม่มีใบรับรอง")],-1)),(0,a.Lk)("span",V,(0,o.v_)(ze.certificateStats.none),1)])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",Z,[(0,a.Lk)("h3",ee,[(0,a.bF)(Qe,{icon:["fas","lightning-bolt"],class:"mr-2 text-yellow-600"}),t[18]||(t[18]=(0,a.eW)(" การดำเนินการด่วน "))]),(0,a.Lk)("div",te,[ze.inProgressCourses.length>0?((0,a.uX)(),(0,a.CE)("button",se,[t[19]||(t[19]=(0,a.Lk)("span",{class:"text-blue-700"},"ดูหลักสูตรที่กำลังเรียน",-1)),(0,a.bF)(Qe,{icon:["fas","arrow-right"],class:"text-blue-600"})])):(0,a.Q3)("",!0),ze.overallStats.certificatesAvailable>0?((0,a.uX)(),(0,a.CE)("button",ae,[t[20]||(t[20]=(0,a.Lk)("span",{class:"text-amber-700"},"ดาวน์โหลดใบรับรอง",-1)),(0,a.bF)(Qe,{icon:["fas","download"],class:"text-amber-600"})])):(0,a.Q3)("",!0),(0,a.Lk)("button",oe,[t[21]||(t[21]=(0,a.Lk)("span",{class:"text-purple-700"},"ส่งออกรายงาน",-1)),(0,a.bF)(Qe,{icon:["fas","file-export"],class:"text-purple-600"})])])])]),(0,a.Lk)("div",re,[0===Oe.enrolls.length?((0,a.uX)(),(0,a.CE)("div",ie,[(0,a.Lk)("div",ne,[(0,a.bF)(Qe,{icon:["fas","graduation-cap"],class:"text-purple-500 text-xl"})]),t[22]||(t[22]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"ยังไม่มีหลักสูตรที่ลงทะเบียน",-1)),t[23]||(t[23]=(0,a.Lk)("p",{class:"text-sm text-gray-500"},"เริ่มต้นการเรียนรู้ด้วยการลงทะเบียนหลักสูตรใหม่",-1))])):((0,a.uX)(),(0,a.CE)("div",le,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Oe.enrolls,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"group bg-white border border-gray-200 rounded-xl hover:shadow-lg hover:border-purple-200 transition-all duration-300"},[(0,a.Lk)("div",de,[(0,a.Lk)("div",ce,[(0,a.Lk)("div",ue,[(0,a.Lk)("div",me,[(0,a.Lk)("img",{src:e.course.cover,alt:e.course.name,class:"w-full h-full object-cover"},null,8,pe)]),(0,a.Lk)("div",ge,[(0,a.Lk)("div",{class:(0,o.C4)(["w-4 h-4 rounded-full flex items-center justify-center text-xs font-bold",100===ze.progressPercentage(e.analytics)?"bg-green-100 text-green-600":"bg-blue-100 text-blue-600"])},(0,o.v_)(ze.progressPercentage(e.analytics)),3)])]),(0,a.Lk)("div",he,[(0,a.Lk)("div",fe,[(0,a.Lk)("div",be,[(0,a.Lk)("h3",xe,(0,o.v_)(e.course.name),1),(0,a.Lk)("div",ye,[(0,a.Lk)("span",{class:(0,o.C4)([e.course.status?"bg-green-100 text-green-700":"bg-red-100 text-red-700","inline-flex items-center px-1.5 py-0.5 rounded-md text-xs font-medium"])},[(0,a.Lk)("div",{class:(0,o.C4)([e.course.status?"bg-green-400":"bg-red-400","w-1.5 h-1.5 rounded-full mr-1"])},null,2),(0,a.eW)(" "+(0,o.v_)(e.course.status?"Active":"Inactive"),1)],2),ze.hasResult(e.analytics)?((0,a.uX)(),(0,a.CE)("span",{key:0,class:(0,o.C4)([ze.calculateResult(e.analytics)?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700","inline-flex items-center px-1.5 py-0.5 rounded-md text-xs font-medium"])},[(0,a.bF)(Qe,{icon:["fas",ze.calculateResult(e.analytics)?"check":"times"],class:"mr-1 text-xs"},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(ze.calculateResult(e.analytics)?"ผ่าน":"ไม่ผ่าน"),1)],2)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",ke,["yes"===e.course.certification&&ze.calculateResult(e.analytics)?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[0]||(t[0]=e=>ze.openCertification("www.xxx.com/lesson/certification/yyy/zzzz")),class:"inline-flex items-center px-2 py-1 border border-amber-200 rounded-lg text-xs font-medium text-amber-700 bg-amber-50 hover:bg-amber-100 transition-colors"},[(0,a.bF)(Qe,{icon:["fas","award"],class:"mr-1"}),t[24]||(t[24]=(0,a.eW)(" ใบรับรอง "))])):"no"===e.course.certification?((0,a.uX)(),(0,a.CE)("span",ve,[(0,a.bF)(Qe,{icon:["fas","minus-circle"],class:"mr-1"}),t[25]||(t[25]=(0,a.eW)(" ไม่มีใบรับรอง "))])):(0,a.Q3)("",!0)])]),e.analytics?((0,a.uX)(),(0,a.CE)("div",we,[(0,a.Lk)("div",Le,[t[26]||(t[26]=(0,a.Lk)("span",null,"ความคืบหน้า",-1)),(0,a.Lk)("span",Ce,(0,o.v_)(ze.progressPercentage(e.analytics))+"%",1)]),(0,a.Lk)("div",_e,[(0,a.Lk)("div",{class:"bg-gradient-to-r from-purple-500 to-blue-500 h-1.5 rounded-full transition-all duration-500",style:(0,o.Tr)({width:ze.progressPercentage(e.analytics)+"%"})},null,4)])])):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",Ee,[(0,a.Lk)("div",De,[(0,a.Lk)("div",Te,[(0,a.bF)(Qe,{icon:["fas","book-open"],class:"mr-1"}),t[27]||(t[27]=(0,a.eW)(" การเรียน "))]),(0,a.Lk)("div",Ae,[(0,a.Lk)("span",Ie,[t[28]||(t[28]=(0,a.eW)("ทั้งหมด: ")),(0,a.Lk)("strong",null,(0,o.v_)(e.analytics?.total||"0"),1)]),(0,a.Lk)("span",Pe,[t[29]||(t[29]=(0,a.eW)("กำลัง: ")),(0,a.Lk)("strong",null,(0,o.v_)(e.analytics?.processing||"0"),1)]),(0,a.Lk)("span",$e,[t[30]||(t[30]=(0,a.eW)("จบ: ")),(0,a.Lk)("strong",null,(0,o.v_)(e.analytics?.complete||"0"),1)])])]),(0,a.Lk)("div",Se,[(0,a.Lk)("div",Xe,[(0,a.bF)(Qe,{icon:["fas","clipboard-check"],class:"mr-1"}),t[31]||(t[31]=(0,a.eW)(" คะแนนสอบ "))]),(0,a.Lk)("div",Fe,[(0,a.Lk)("span",Ue,[t[32]||(t[32]=(0,a.eW)("ก่อน: ")),(0,a.Lk)("strong",null,(0,o.v_)(ze.getScore(e.analytics?.pre)),1)]),(0,a.Lk)("span",je,[t[33]||(t[33]=(0,a.eW)("หลัง: ")),(0,a.Lk)("strong",null,(0,o.v_)(ze.getScore(e.analytics?.post)),1)]),(0,a.Lk)("span",We,[t[34]||(t[34]=(0,a.eW)("ซ่อม: ")),(0,a.Lk)("strong",null,(0,o.v_)(ze.getScore(e.analytics?.retest)),1)])])])]),e.analytics?.message?((0,a.uX)(),(0,a.CE)("div",Re,[(0,a.Lk)("div",Be,[(0,a.bF)(Qe,{icon:["fas","info-circle"],class:"text-blue-500 text-xs mt-0.5 flex-shrink-0"}),(0,a.Lk)("p",Me,(0,o.v_)(e.analytics.message),1)])])):(0,a.Q3)("",!0)])])))),128))]))])])}s(98992),s(54520),s(3949);var Oe=s(94614),ze=s(77823),Qe=s(40475),Ne=s(63084),Ye=s(40471);const Ke=new Ye.A(!1);var Je={props:{member:Object,tabs:Object},data(){return{config:Qe.A.get("configs"),session:Qe.A.get("session"),enrolls:[]}},computed:{overallStats(){if(!this.enrolls.length)return{totalCourses:0,completedCourses:0,averageProgress:0,certificatesAvailable:0};let e=0,t=0,s=0;return this.enrolls.forEach((a=>{const o=this.progressPercentage(a.analytics);e+=o,100===o&&t++,"yes"===a.course.certification&&this.calculateResult(a.analytics)&&s++})),{totalCourses:this.enrolls.length,completedCourses:t,averageProgress:this.enrolls.length>0?e/this.enrolls.length:0,certificatesAvailable:s}},progressDistribution(){if(!this.enrolls.length)return{completed:0,inProgress:0,notStarted:0};let e=0,t=0,s=0;return this.enrolls.forEach((a=>{const o=this.progressPercentage(a.analytics);100===o?e++:o>0?t++:s++})),{completed:e,inProgress:t,notStarted:s}},examStats(){if(!this.enrolls.length)return{passed:0,failed:0,notTaken:0};let e=0,t=0,s=0;return this.enrolls.forEach((a=>{this.hasResult(a.analytics)?this.calculateResult(a.analytics)?e++:t++:s++})),{passed:e,failed:t,notTaken:s}},certificateStats(){if(!this.enrolls.length)return{available:0,pending:0,none:0};let e=0,t=0,s=0;return this.enrolls.forEach((a=>{"no"===a.course.certification?s++:"yes"===a.course.certification&&(this.calculateResult(a.analytics)?e++:t++)})),{available:e,pending:t,none:s}},inProgressCourses(){return this.enrolls.filter((e=>{const t=this.progressPercentage(e.analytics);return t>0&&t<100}))}},methods:{calculateResult:Oe.E,checkProgress:Oe.l,async callbackFunction(){try{console.log("callbackFunction")}catch(e){console.error(e)}},progressPercentage(e){const t=e?.total||0,s=e?.complete||0;return t>0?Math.round(s/t*100):0},hasScore(e){return null!==e?.score&&void 0!==e?.score},getScore(e){return this.hasScore(e)?e.score:"-"},hasResult(e){return e?.post?.has||e?.retest?.has},openCertification(e){window.open(e,"_blank")},async getData(){try{this.toast=(0,ze.A)({type:"pending",message:"กำลังดึงข้อมูล.."});const e=[{$match:{$and:[{userID:this.member._id}]}},{$set:{courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},{$facet:{enroll:[{$skip:0},{$limit:100}],totalCount:[{$count:"count"}]}}],t=await Ke.POST("enroll/aggregate",{pipeline:e},this.config.key),s=t.data;this.toast.hide("ดึงข้อมูลเสร็จแล้ว.","success",30,(()=>{this.enrolls=s[0].enroll,this.$setPageTitle(this.member.firstname+" "+this.member.lastname+" / หลักสูตร"),this.activeBlock=!1}))}catch(e){Ne.A.log(e)}}},async mounted(){try{await this.getData()}catch(e){Ne.A.log(Error)}}},Ge=s(64621);const qe=(0,Ge.A)(Je,[["render",He],["__scopeId","data-v-175b8e26"]]);var Ve=qe},5293:function(e,t,s){"use strict";s.d(t,{A:function(){return Ye}});var a=s(20641),o=s(90033);const r={class:"flex flex-col lg:flex-row gap-6"},i={class:"w-full lg:w-80 space-y-4"},n={key:0,class:"bg-gradient-to-br from-emerald-50 to-green-50 rounded-xl p-4 border border-emerald-100"},l={class:"flex items-center justify-between mb-3"},d={class:"text-sm font-semibold text-gray-900 flex items-center"},c={class:"text-xs text-gray-500"},u={class:"grid grid-cols-2 gap-2"},m={class:"bg-white/70 backdrop-blur-sm rounded-lg p-2.5 text-center"},p={class:"text-lg font-bold text-emerald-600"},g={class:"bg-white/70 backdrop-blur-sm rounded-lg p-2.5 text-center"},h={class:"text-lg font-bold text-blue-600"},f={class:"bg-white/70 backdrop-blur-sm rounded-lg p-2.5 text-center"},b={class:"text-lg font-bold text-amber-600"},x={class:"bg-white/70 backdrop-blur-sm rounded-lg p-2.5 text-center"},y={class:"text-lg font-bold text-purple-600"},k={key:1,class:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm"},v={class:"text-sm font-semibold text-gray-900 flex items-center mb-3"},w={class:"space-y-2"},L={class:"flex items-center justify-between text-xs"},C={class:"text-gray-600"},_={class:"w-full bg-gray-100 rounded-full h-1.5"},E={key:2,class:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm"},D={class:"text-sm font-semibold text-gray-900 flex items-center mb-3"},T={class:"space-y-3"},A={class:"bg-green-50 rounded-lg p-2 border border-green-100"},I={class:"flex items-center justify-between"},P={class:"text-sm font-bold text-green-800"},$={class:"bg-amber-50 rounded-lg p-2 border border-amber-100"},S={class:"flex items-center justify-between"},X={class:"text-sm font-bold text-amber-800"},F={class:"bg-gray-50 rounded-lg p-2 border border-gray-100"},U={class:"flex items-center justify-between"},j={class:"text-sm font-bold text-gray-800"},W={key:3,class:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm"},R={class:"text-sm font-semibold text-gray-900 flex items-center mb-3"},B={class:"space-y-2"},M={class:"flex-1 min-w-0"},H={class:"text-gray-900 truncate"},O={class:"text-gray-500"},z={class:"text-blue-600 font-medium"},Q={class:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm"},N={class:"text-sm font-semibold text-gray-900 flex items-center mb-3"},Y={class:"space-y-2"},K={key:0,class:"w-full flex items-center justify-between p-2 text-xs bg-amber-50 hover:bg-amber-100 rounded-lg border border-amber-200 transition-colors"},J={key:1,class:"w-full flex items-center justify-between p-2 text-xs bg-green-50 hover:bg-green-100 rounded-lg border border-green-200 transition-colors"},G={class:"w-full flex items-center justify-between p-2 text-xs bg-purple-50 hover:bg-purple-100 rounded-lg border border-purple-200 transition-colors"},q={class:"flex-1 space-y-4"},V={key:0,class:"text-center py-12 bg-gradient-to-b from-gray-50 to-white rounded-xl border border-gray-100"},Z={class:"w-16 h-16 bg-gradient-to-br from-emerald-100 to-green-100 rounded-full flex items-center justify-center mx-auto mb-4"},ee={key:1,class:"space-y-3"},te={class:"p-4"},se={class:"flex items-start justify-between mb-3"},ae={class:"flex-1 min-w-0"},oe={class:"flex items-center space-x-3 mb-2"},re={class:"text-sm font-semibold text-gray-900"},ie={class:"text-sm text-gray-600 mb-1"},ne={class:"text-xs text-gray-500"},le={class:"flex items-center space-x-3"},de={class:"text-right"},ce={class:"text-lg font-bold text-gray-900"},ue=["onClick"],me={class:"grid grid-cols-2 gap-3 mb-3"},pe={class:"bg-gray-50 rounded-lg p-2 border border-gray-100"},ge={class:"text-sm font-medium text-gray-900"},he={class:"bg-gray-50 rounded-lg p-2 border border-gray-100"},fe={class:"text-sm font-medium text-gray-900"},be={key:0,class:"border-t border-gray-100 pt-3"},xe=["onClick"],ye={class:"text-gray-700"},ke={key:1,class:"mt-4 pt-4 border-t border-gray-100"},ve={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},we={class:"bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg p-3 border border-blue-100"},Le={class:"flex items-center mb-2"},Ce={class:"w-6 h-6 bg-blue-100 rounded-full flex items-center justify-center mr-2"},_e={class:"text-sm text-blue-800 leading-relaxed"},Ee={class:"bg-gradient-to-r from-emerald-50 to-green-50 rounded-lg p-3 border border-emerald-100"},De={class:"flex items-center mb-2"},Te={class:"w-6 h-6 bg-emerald-100 rounded-full flex items-center justify-center mr-2"},Ae={class:"text-sm text-emerald-800"},Ie={class:"font-medium"},Pe={class:"text-xs text-emerald-600 mt-1"},$e={class:"mt-4"},Se={class:"flex items-center mb-3"},Xe={class:"w-6 h-6 bg-purple-100 rounded-full flex items-center justify-center mr-2"},Fe={class:"bg-gradient-to-r from-purple-50 to-pink-50 rounded-xl p-4 border border-purple-100"},Ue={class:"compact-form-container"};function je(e,t,s,je,We,Re){const Be=(0,a.g2)("font-awesome-icon"),Me=(0,a.g2)("DataSetRender");return(0,a.uX)(),(0,a.CE)("div",r,[(0,a.Lk)("div",i,[We.order.length>0?((0,a.uX)(),(0,a.CE)("div",n,[(0,a.Lk)("div",l,[(0,a.Lk)("h3",d,[(0,a.bF)(Be,{icon:["fas","shopping-cart"],class:"mr-2 text-emerald-600"}),t[0]||(t[0]=(0,a.eW)(" สถิติคำสั่งซื้อ "))]),(0,a.Lk)("span",c,(0,o.v_)(We.order.length)+" รายการ",1)]),(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,(0,o.v_)(Re.orderStats.total),1),t[1]||(t[1]=(0,a.Lk)("div",{class:"text-xs text-gray-600"},"คำสั่งซื้อทั้งหมด",-1))]),(0,a.Lk)("div",g,[(0,a.Lk)("div",h,(0,o.v_)(Re.orderStats.paid),1),t[2]||(t[2]=(0,a.Lk)("div",{class:"text-xs text-gray-600"},"ชำระเงินแล้ว",-1))]),(0,a.Lk)("div",f,[(0,a.Lk)("div",b,(0,o.v_)(Re.orderStats.pending),1),t[3]||(t[3]=(0,a.Lk)("div",{class:"text-xs text-gray-600"},"รอชำระเงิน",-1))]),(0,a.Lk)("div",x,[(0,a.Lk)("div",y,(0,o.v_)(Re.orderStats.totalAmount)+"฿",1),t[4]||(t[4]=(0,a.Lk)("div",{class:"text-xs text-gray-600"},"มูลค่ารวม",-1))])])])):(0,a.Q3)("",!0),We.order.length>0?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("h3",v,[(0,a.bF)(Be,{icon:["fas","chart-bar"],class:"mr-2 text-indigo-600"}),t[5]||(t[5]=(0,a.eW)(" การแจกแจงสถานะ "))]),(0,a.Lk)("div",w,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Re.statusDistribution,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"space-y-1"},[(0,a.Lk)("div",L,[(0,a.Lk)("span",C,(0,o.v_)(e.name),1),(0,a.Lk)("span",{class:(0,o.C4)(["font-medium",e.color])},(0,o.v_)(e.count)+" รายการ",3)]),(0,a.Lk)("div",_,[(0,a.Lk)("div",{class:(0,o.C4)([e.bgColor,"h-1.5 rounded-full transition-all duration-300"]),style:(0,o.Tr)({width:e.count/We.order.length*100+"%"})},null,6)])])))),128))])])):(0,a.Q3)("",!0),We.order.length>0?((0,a.uX)(),(0,a.CE)("div",E,[(0,a.Lk)("h3",D,[(0,a.bF)(Be,{icon:["fas","credit-card"],class:"mr-2 text-green-600"}),t[6]||(t[6]=(0,a.eW)(" สรุปการชำระเงิน "))]),(0,a.Lk)("div",T,[(0,a.Lk)("div",A,[(0,a.Lk)("div",I,[t[7]||(t[7]=(0,a.Lk)("span",{class:"text-xs text-green-700"},"ชำระเงินแล้ว",-1)),(0,a.Lk)("span",P,(0,o.v_)(Re.paymentStats.paidAmount)+"฿",1)])]),(0,a.Lk)("div",$,[(0,a.Lk)("div",S,[t[8]||(t[8]=(0,a.Lk)("span",{class:"text-xs text-amber-700"},"รอชำระเงิน",-1)),(0,a.Lk)("span",X,(0,o.v_)(Re.paymentStats.pendingAmount)+"฿",1)])]),(0,a.Lk)("div",F,[(0,a.Lk)("div",U,[t[9]||(t[9]=(0,a.Lk)("span",{class:"text-xs text-gray-700"},"ราคาเฉลี่ย",-1)),(0,a.Lk)("span",j,(0,o.v_)(Math.round(Re.paymentStats.averageAmount))+"฿",1)])])])])):(0,a.Q3)("",!0),We.order.length>0?((0,a.uX)(),(0,a.CE)("div",W,[(0,a.Lk)("h3",R,[(0,a.bF)(Be,{icon:["fas","clock"],class:"mr-2 text-blue-600"}),t[10]||(t[10]=(0,a.eW)(" กิจกรรมล่าสุด "))]),(0,a.Lk)("div",B,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Re.recentOrders,(e=>((0,a.uX)(),(0,a.CE)("div",{key:e._id,class:"flex items-center space-x-2 text-xs"},[t[11]||(t[11]=(0,a.Lk)("div",{class:"w-2 h-2 bg-blue-400 rounded-full flex-shrink-0"},null,-1)),(0,a.Lk)("div",M,[(0,a.Lk)("p",H,(0,o.v_)(e.course.name),1),(0,a.Lk)("p",O,(0,o.v_)(Re.formatThaidate(e.createdAt)),1)]),(0,a.Lk)("span",z,(0,o.v_)(e.price)+"฿",1)])))),128))])])):(0,a.Q3)("",!0),(0,a.Lk)("div",Q,[(0,a.Lk)("h3",N,[(0,a.bF)(Be,{icon:["fas","lightning-bolt"],class:"mr-2 text-yellow-600"}),t[12]||(t[12]=(0,a.eW)(" การดำเนินการด่วน "))]),(0,a.Lk)("div",Y,[Re.pendingOrders.length>0?((0,a.uX)(),(0,a.CE)("button",K,[t[13]||(t[13]=(0,a.Lk)("span",{class:"text-amber-700"},"ดูคำสั่งซื้อรอชำระ",-1)),(0,a.bF)(Be,{icon:["fas","arrow-right"],class:"text-amber-600"})])):(0,a.Q3)("",!0),Re.orderStats.paid>0?((0,a.uX)(),(0,a.CE)("button",J,[t[14]||(t[14]=(0,a.Lk)("span",{class:"text-green-700"},"ดาวน์โหลดใบเสร็จ",-1)),(0,a.bF)(Be,{icon:["fas","download"],class:"text-green-600"})])):(0,a.Q3)("",!0),(0,a.Lk)("button",G,[t[15]||(t[15]=(0,a.Lk)("span",{class:"text-purple-700"},"ส่งออกรายงาน",-1)),(0,a.bF)(Be,{icon:["fas","file-export"],class:"text-purple-600"})])])])]),(0,a.Lk)("div",q,[0===We.order.length?((0,a.uX)(),(0,a.CE)("div",V,[(0,a.Lk)("div",Z,[(0,a.bF)(Be,{icon:["fas","shopping-bag"],class:"text-emerald-500 text-xl"})]),t[16]||(t[16]=(0,a.Lk)("h3",{class:"text-lg font-semibold text-gray-900 mb-2"},"ยังไม่มีคำสั่งซื้อ",-1)),t[17]||(t[17]=(0,a.Lk)("p",{class:"text-sm text-gray-500"},"เริ่มต้นลงทะเบียนหลักสูตรเพื่อสร้างคำสั่งซื้อแรก",-1))])):((0,a.uX)(),(0,a.CE)("div",ee,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(We.order,((e,s)=>((0,a.uX)(),(0,a.CE)("div",{key:e._id,class:"group bg-white border border-gray-200 rounded-xl hover:shadow-lg hover:border-emerald-200 transition-all duration-300"},[(0,a.Lk)("div",te,[(0,a.Lk)("div",se,[(0,a.Lk)("div",ae,[(0,a.Lk)("div",oe,[(0,a.Lk)("h3",re," #"+(0,o.v_)(e._id),1),(0,a.Lk)("span",{class:(0,o.C4)([Re.getStatusStyle(e.forms?.process,e.posts?.status),"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium"])},[(0,a.Lk)("div",{class:(0,o.C4)([Re.getStatusDotStyle(e.forms?.process,e.posts?.status),"w-1.5 h-1.5 rounded-full mr-1"])},null,2),(0,a.eW)(" "+(0,o.v_)(Re.findStatusByCode(e.forms?.process,e.posts?.status)?.name||"ไม่ทราบสถานะ"),1)],2)]),(0,a.Lk)("p",ie,(0,o.v_)(e.course.name),1),(0,a.Lk)("p",ne,(0,o.v_)(Re.formatThaidate(e.createdAt)),1)]),(0,a.Lk)("div",le,[(0,a.Lk)("div",de,[(0,a.Lk)("div",ce,(0,o.v_)(e.price)+"฿",1),t[18]||(t[18]=(0,a.Lk)("div",{class:"text-xs text-gray-500"},"ราคา",-1))]),(0,a.Lk)("button",{onClick:t=>Re.openNewTab(e._id),class:"inline-flex items-center px-3 py-2 border border-blue-200 rounded-lg text-xs font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 transition-colors"},[(0,a.bF)(Be,{icon:["fas","qrcode"],class:"mr-1"}),t[19]||(t[19]=(0,a.eW)(" ชำระเงิน "))],8,ue)])]),(0,a.Lk)("div",me,[(0,a.Lk)("div",pe,[t[20]||(t[20]=(0,a.Lk)("div",{class:"text-xs text-gray-500 mb-1"},"REF1",-1)),(0,a.Lk)("div",ge,(0,o.v_)(e.ref1),1)]),(0,a.Lk)("div",he,[t[21]||(t[21]=(0,a.Lk)("div",{class:"text-xs text-gray-500 mb-1"},"REF2",-1)),(0,a.Lk)("div",fe,(0,o.v_)(e.ref2),1)])]),e.forms?((0,a.uX)(),(0,a.CE)("div",be,[(0,a.Lk)("button",{onClick:e=>Re.toggleExpand(s),class:"w-full flex items-center justify-between p-2 text-xs bg-gray-50 hover:bg-gray-100 rounded-lg border border-gray-200 transition-colors"},[(0,a.Lk)("span",ye,[(0,a.bF)(Be,{icon:["fas","file-alt"],class:"mr-1"}),t[22]||(t[22]=(0,a.eW)(" รายละเอียดแบบฟอร์ม "))]),(0,a.bF)(Be,{icon:["fas",e.expanded?"chevron-up":"chevron-down"],class:"text-gray-600"},null,8,["icon"])],8,xe)])):(0,a.Q3)("",!0),e.expanded&&e.forms?((0,a.uX)(),(0,a.CE)("div",ke,[(0,a.Lk)("div",ve,[(0,a.Lk)("div",we,[(0,a.Lk)("div",Le,[(0,a.Lk)("div",Ce,[(0,a.bF)(Be,{icon:["fas","graduation-cap"],class:"text-blue-600 text-xs"})]),t[23]||(t[23]=(0,a.Lk)("h4",{class:"text-sm font-semibold text-blue-900"},"หลักสูตร",-1))]),(0,a.Lk)("p",_e,(0,o.v_)(e.course.name),1)]),(0,a.Lk)("div",Ee,[(0,a.Lk)("div",De,[(0,a.Lk)("div",Te,[(0,a.bF)(Be,{icon:["fas","info-circle"],class:"text-emerald-600 text-xs"})]),t[24]||(t[24]=(0,a.Lk)("h4",{class:"text-sm font-semibold text-emerald-900"},"สถานะปัจจุบัน",-1))]),(0,a.Lk)("div",Ae,[(0,a.Lk)("p",Ie,(0,o.v_)(Re.findStatusByCode(e.forms?.process,e.posts?.status)?.name||"ไม่ทราบสถานะ"),1),(0,a.Lk)("p",Pe,(0,o.v_)(Re.findStatusByCode(e.forms?.process,e.posts?.status)?.description||"ไม่มีรายละเอียด"),1)])])]),(0,a.Lk)("div",$e,[(0,a.Lk)("div",Se,[(0,a.Lk)("div",Xe,[(0,a.bF)(Be,{icon:["fas","id-card"],class:"text-purple-600 text-xs"})]),t[25]||(t[25]=(0,a.Lk)("h4",{class:"text-sm font-semibold text-gray-900"},"ข้อมูลใบสมัคร",-1)),t[26]||(t[26]=(0,a.Lk)("div",{class:"flex-1 border-t border-gray-200 ml-3"},null,-1))]),(0,a.Lk)("div",Fe,[(0,a.Lk)("div",Ue,[(0,a.bF)(Me,{formData:e,formID:e.forms._id},null,8,["formData","formID"])])])])])):(0,a.Q3)("",!0)])])))),128))]))])])}s(98992),s(54520),s(72577),s(3949);var We=s(63084),Re=s(40475),Be=s(9964),Me=s(40471),He=s(10300);const Oe=new Me.A(!1);var ze={props:{member:Object},components:{DataSetRender:He.A},data(){return{config:Re.A.get("configs"),profile:Re.A.get("session","user"),session:Re.A.get("session"),message:"Order",order:[]}},computed:{orderStats(){if(!this.order.length)return{total:0,paid:0,pending:0,totalAmount:0};let e=0,t=0,s=0;return this.order.forEach((a=>{s+=a.price||0;const o=this.findStatusByCode(a.forms?.process,a.posts?.status);o&&"ชำระเงินแล้ว"===o.name?e++:t++})),{total:this.order.length,paid:e,pending:t,totalAmount:s}},statusDistribution(){if(!this.order.length)return{};const e={};return this.order.forEach((t=>{const s=this.findStatusByCode(t.forms?.process,t.posts?.status),a=s?.name||"ไม่ทราบสถานะ";e[a]||(e[a]={name:a,count:0,color:this.getStatusTextColor(a),bgColor:this.getStatusBgColor(a)}),e[a].count++})),e},paymentStats(){if(!this.order.length)return{paidAmount:0,pendingAmount:0,averageAmount:0};let e=0,t=0,s=0;return this.order.forEach((a=>{const o=a.price||0;s+=o;const r=this.findStatusByCode(a.forms?.process,a.posts?.status);r&&"ชำระเงินแล้ว"===r.name?e+=o:t+=o})),{paidAmount:e,pendingAmount:t,averageAmount:this.order.length>0?s/this.order.length:0}},recentOrders(){return this.order.slice().sort(((e,t)=>new Date(t.createdAt)-new Date(e.createdAt))).slice(0,5)},pendingOrders(){return this.order.filter((e=>{const t=this.findStatusByCode(e.forms?.process,e.posts?.status);return!t||"ชำระเงินแล้ว"!==t.name}))}},methods:{findStatusByCode(e,t){return t?.find((t=>t.code===e))||null},getStatusStyle(e,t){const s=this.findStatusByCode(e,t),a=s?.name||"ไม่ทราบสถานะ";switch(a){case"ชำระเงินแล้ว":return"bg-green-100 text-green-700";case"รอชำระเงิน":return"bg-amber-100 text-amber-700";case"ยกเลิก":return"bg-red-100 text-red-700";default:return"bg-gray-100 text-gray-700"}},getStatusDotStyle(e,t){const s=this.findStatusByCode(e,t),a=s?.name||"ไม่ทราบสถานะ";switch(a){case"ชำระเงินแล้ว":return"bg-green-400";case"รอชำระเงิน":return"bg-amber-400";case"ยกเลิก":return"bg-red-400";default:return"bg-gray-400"}},getStatusTextColor(e){switch(e){case"ชำระเงินแล้ว":return"text-green-600";case"รอชำระเงิน":return"text-amber-600";case"ยกเลิก":return"text-red-600";default:return"text-gray-600"}},getStatusBgColor(e){switch(e){case"ชำระเงินแล้ว":return"bg-green-500";case"รอชำระเงิน":return"bg-amber-500";case"ยกเลิก":return"bg-red-500";default:return"bg-gray-500"}},toggleExpand(e){this.order[e].expanded=!this.order[e].expanded},openNewTab(e){window.open("https://"+this.session.current.hostname+"/lesson/pay/"+e,"_blank")},formatThaidate(e){return Be.A.toThaiDatetime(e)},countEnrollmentsByStatus(e=[],t){return e&&0!==e.length?e.filter((e=>e.analytics&&e.analytics.status&&e.analytics.status.trim()===t)).length:0},countTotalEnrollments(e=[]){return e?e.length:0},async getData(){try{this.activeBlock=!0;const e=[{$match:{$and:[{userID:this.member._id}]}},{$lookup:{from:"form",let:{userId:"$userID",courseId:"$courseID"},pipeline:[{$match:{$expr:{$and:[{$eq:["$userID","$$userId"]},{$eq:["$courseID","$$courseId"]}]}}},{$set:{formID:{$toObjectId:"$formID"}}}],as:"forms"}},{$set:{courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},{$unwind:"$forms"},{$set:{formID:"$forms.formID"}},{$lookup:{from:"post",localField:"formID",foreignField:"_id",as:"posts"}},{$unwind:"$posts"},{$set:{enrollID:{$toObjectId:"$forms.enrollID"}}},{$lookup:{from:"enroll",localField:"enrollID",foreignField:"_id",as:"enroll"}},{$unwind:{path:"$enroll",preserveNullAndEmptyArrays:!0}},{$sort:{"posts.createdAt":-1}},{$facet:{enroll:[{$skip:0},{$limit:100}],totalCount:[{$count:"count"}]}}],t=await Oe.POST("order/aggregate",{pipeline:e},this.config.key),s=t.data[0]["enroll"];this.order=s,this.activeBlock=!1}catch(e){console.log(e)}}},mounted(){this.getData(),We.A.log("this.member.firstname:",this.member.firstname),We.A.log("this.member.lastname:",this.member.lastname);const e=this.member.firstname+" "+this.member.lastname+" / เอกสาร";We.A.log("pageTitle:",e),this.$setPageTitle(e)}},Qe=s(64621);const Ne=(0,Qe.A)(ze,[["render",je],["__scopeId","data-v-32f5a320"]]);var Ye=Ne},58677:function(e,t,s){"use strict";s.d(t,{A:function(){return ye}});var a=s(20641),o=s(90033),r=s(53751);const i={class:"px-4 py-5 sm:px-6 flex items-center justify-between"},n={class:"border-t border-gray-200 px-4 py-5 sm:px-6"},l={class:"grid grid-cols-1 gap-3 gap-y-4 sm:grid-cols-2"},d={key:0,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},c={key:1},u={key:0,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},m={key:1},p={key:0,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},g={key:1},h={key:0,class:"text-red-500 text-sm mt-1"},f={key:0,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},b={key:1},x={key:0,class:"text-red-500 text-sm mt-1"},y={key:0,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},k={key:1},v={key:0,class:"text-red-500 text-sm mt-1"},w={key:0,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},L={key:1},C={key:0,class:"text-red-500 text-sm mt-1"},_={key:0,class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},E={key:1},D={key:0,class:"mt-6 border-t border-gray-200 pt-6"},T={key:1,class:"mt-6 border-t border-gray-200 pt-4"},A={class:"mb-3"},I={class:"text-sm font-medium text-gray-900 mb-1 flex items-center gap-2"},P={class:"text-xs text-gray-500 bg-gray-100 px-2 py-0.5 rounded-full"},$={class:"space-y-3"},S={class:"bg-gray-50 border-b border-gray-200 px-3 py-2"},X={class:"flex items-center justify-between"},F={class:"flex items-center gap-2"},U={class:"text-sm font-medium text-gray-800"},j={class:"text-xs text-gray-500"},W={key:0,class:"text-xs text-gray-400 bg-white px-2 py-0.5 rounded border"},R={class:"p-3 bg-white"},B={class:"flex flex-wrap gap-2"},M=["title"],H={key:0,class:"text-blue-500 ml-1"},O={class:"mt-3 flex items-center justify-between text-xs text-gray-500 bg-gray-50 px-3 py-2 rounded"},z={key:2,class:"mt-5"},Q={key:0,class:"fixed inset-0 z-50 overflow-auto bg-black bg-opacity-50 flex justify-center items-center p-4"},N={class:"bg-white rounded-xl shadow-2xl max-w-md w-full mx-auto transform transition-all duration-300 scale-100"},Y={class:"bg-gradient-to-r from-blue-500 to-blue-600 px-6 py-4 rounded-t-xl"},K={class:"flex items-center justify-between"},J={class:"p-6"},G={class:"mb-6"},q={class:"relative"},V={key:0,class:"mb-6"},Z={class:"flex items-center justify-between mb-1"},ee={class:"text-xs text-gray-500"},te={class:"w-full bg-gray-200 rounded-full h-2"},se={class:"flex space-x-3"},ae=["disabled"],oe={class:"border-t border-gray-300 bg-gray-200 py-4 px-6 flex items-center justify-center"},re={class:"flex space-x-4"};function ie(e,t,s,ie,ne,le){const de=(0,a.g2)("TaxonomySelector"),ce=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",{class:(0,o.C4)(["bg-white shadow sm:rounded-lg relative",[ne.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},[(0,a.Lk)("div",i,[t[21]||(t[21]=(0,a.Lk)("h2",{id:"applicant-information-title",class:"text-lg font-bold leading-6 text-gray-900"}," ข้อมูลส่วนตัวผู้สมัคร ",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>le.toggleEditMode&&le.toggleEditMode(...e)),class:"text-blue-600 hover:text-blue-500"},(0,o.v_)(ne.editMode?"ยกเลิก":"แก้ไขข้อมูลส่วนตัว"),1)]),(0,a.Lk)("div",n,[(0,a.Lk)("form",null,[(0,a.Lk)("div",l,[(0,a.Lk)("div",null,[t[22]||(t[22]=(0,a.Lk)("label",{for:"firstname",class:"text-sm font-medium text-gray-500"},"ชื่อ",-1)),ne.editMode?((0,a.uX)(),(0,a.CE)("span",c,[(0,a.bo)((0,a.Lk)("input",{type:"text",id:"firstname","onUpdate:modelValue":t[1]||(t[1]=e=>ne.formData.firstname=e),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[r.Jo,ne.formData.firstname]])])):((0,a.uX)(),(0,a.CE)("span",d,(0,o.v_)(ne.formData.firstname),1))]),(0,a.Lk)("div",null,[t[23]||(t[23]=(0,a.Lk)("label",{for:"lastname",class:"text-sm font-medium text-gray-500"},"นามสกุล",-1)),ne.editMode?((0,a.uX)(),(0,a.CE)("span",m,[(0,a.bo)((0,a.Lk)("input",{type:"text",id:"lastname","onUpdate:modelValue":t[2]||(t[2]=e=>ne.formData.lastname=e),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},null,512),[[r.Jo,ne.formData.lastname]])])):((0,a.uX)(),(0,a.CE)("span",u,(0,o.v_)(ne.formData.lastname),1))]),(0,a.Lk)("div",null,[t[24]||(t[24]=(0,a.Lk)("label",{for:"citizen",class:"text-sm font-medium text-gray-500"},"เลขประจำตัวประชาชน",-1)),ne.editMode?((0,a.uX)(),(0,a.CE)("span",g,[(0,a.bo)((0,a.Lk)("input",{type:"text",id:"citizen","onUpdate:modelValue":t[3]||(t[3]=e=>ne.formData.citizen=e),onInput:t[4]||(t[4]=(...e)=>le.checkCitizen&&le.checkCitizen(...e)),class:(0,o.C4)(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",{"border-red-500":ne.citizenExists}])},null,34),[[r.Jo,ne.formData.citizen]]),ne.citizenExists?((0,a.uX)(),(0,a.CE)("div",h," มีเลขประจำตัวประชาชนนี้ในระบบแล้ว ")):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("span",p,(0,o.v_)(ne.formData.citizen),1))]),(0,a.Lk)("div",null,[t[25]||(t[25]=(0,a.Lk)("label",{for:"phone",class:"text-sm font-medium text-gray-500"},"เบอร์โทรศัพท์",-1)),ne.editMode?((0,a.uX)(),(0,a.CE)("span",b,[(0,a.bo)((0,a.Lk)("input",{type:"text",id:"phone","onUpdate:modelValue":t[5]||(t[5]=e=>ne.formData.phone=e),onInput:t[6]||(t[6]=(...e)=>le.checkPhone&&le.checkPhone(...e)),class:(0,o.C4)(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",{"border-red-500":ne.phoneExists}])},null,34),[[r.Jo,ne.formData.phone]]),ne.phoneExists?((0,a.uX)(),(0,a.CE)("div",x," มีเบอร์โทรนี้ในระบบแล้ว ")):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("span",f,(0,o.v_)(ne.formData.phone),1))]),(0,a.Lk)("div",null,[t[26]||(t[26]=(0,a.Lk)("label",{for:"email",class:"text-sm font-medium text-gray-500"},"อีเมล",-1)),ne.editMode?((0,a.uX)(),(0,a.CE)("span",k,[(0,a.bo)((0,a.Lk)("input",{type:"email",id:"email","onUpdate:modelValue":t[7]||(t[7]=e=>ne.formData.email=e),onInput:t[8]||(t[8]=(...e)=>le.checkEmail&&le.checkEmail(...e)),class:(0,o.C4)(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",{"border-red-500":ne.emailExists}])},null,34),[[r.Jo,ne.formData.email]]),ne.emailExists?((0,a.uX)(),(0,a.CE)("div",v," มีอีเมลนี้ในระบบแล้ว ")):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("span",y,(0,o.v_)(ne.formData.email),1))]),(0,a.Lk)("div",null,[t[27]||(t[27]=(0,a.Lk)("label",{for:"username",class:"text-sm font-medium text-gray-500"},"ชื่อผู้ใช้",-1)),ne.editMode?((0,a.uX)(),(0,a.CE)("span",L,[(0,a.bo)((0,a.Lk)("input",{type:"text",id:"username","onUpdate:modelValue":t[9]||(t[9]=e=>ne.formData.username=e),onInput:t[10]||(t[10]=(...e)=>le.checkUsername&&le.checkUsername(...e)),class:(0,o.C4)(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50",{"border-red-500":ne.usernameExists}])},null,34),[[r.Jo,ne.formData.username]]),ne.usernameExists?((0,a.uX)(),(0,a.CE)("div",C," มีชื่อผู้ใช้นี้ในระบบแล้ว ")):(0,a.Q3)("",!0)])):((0,a.uX)(),(0,a.CE)("span",w,(0,o.v_)(ne.formData.username),1))]),(0,a.Lk)("div",null,[t[29]||(t[29]=(0,a.Lk)("label",{for:"status",class:"text-sm font-medium text-gray-500"},"สถานะ",-1)),ne.editMode?((0,a.uX)(),(0,a.CE)("span",E,[(0,a.bo)((0,a.Lk)("select",{id:"status","onUpdate:modelValue":t[11]||(t[11]=e=>ne.formData.status=e),class:"mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-blue-300 focus:ring focus:ring-blue-200 focus:ring-opacity-50"},t[28]||(t[28]=[(0,a.Lk)("option",{value:"active"},"เปิดใช้งาน",-1),(0,a.Lk)("option",{value:"unactive"},"ปิดใช้งาน",-1)]),512),[[r.u1,ne.formData.status]])])):((0,a.uX)(),(0,a.CE)("span",_,(0,o.v_)("active"===ne.formData.status?"เปิดใช้งาน":"ปิดใช้งาน"),1))])])]),ne.editMode?((0,a.uX)(),(0,a.CE)("div",D,[t[30]||(t[30]=(0,a.Lk)("div",{class:"mb-4"},[(0,a.Lk)("h3",{class:"text-lg font-medium text-gray-900 mb-2"},[(0,a.Lk)("i",{class:"fas fa-tags text-blue-600 mr-2"}),(0,a.eW)(" การจัดหมวดหมู่สมาชิก ")]),(0,a.Lk)("p",{class:"text-sm text-gray-600"},"เลือกหมวดหมู่ที่เหมาะสมสำหรับสมาชิกนี้")],-1)),(0,a.bF)(de,{modelValue:ne.selectedTaxonomyTerms,"onUpdate:modelValue":t[12]||(t[12]=e=>ne.selectedTaxonomyTerms=e),"content-type":"member","content-type-label":"สมาชิก","max-selections":10},null,8,["modelValue"])])):ne.selectedTaxonomyTerms.length>0?((0,a.uX)(),(0,a.CE)("div",T,[(0,a.Lk)("div",A,[(0,a.Lk)("h3",I,[t[31]||(t[31]=(0,a.Lk)("i",{class:"fas fa-tags text-blue-500 text-xs"},null,-1)),t[32]||(t[32]=(0,a.eW)(" หมวดหมู่ผู้สมัคร ")),(0,a.Lk)("span",P,(0,o.v_)(ne.selectedTaxonomyTerms.length),1)])]),(0,a.Lk)("div",$,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(le.getGroupedTaxonomyTerms(),(e=>((0,a.uX)(),(0,a.CE)("div",{key:e.groupId,class:"border border-gray-200 rounded-md"},[(0,a.Lk)("div",S,[(0,a.Lk)("div",X,[(0,a.Lk)("div",F,[t[33]||(t[33]=(0,a.Lk)("i",{class:"fas fa-folder text-gray-600 text-xs"},null,-1)),(0,a.Lk)("span",U,(0,o.v_)(e.groupName),1),(0,a.Lk)("span",j,"("+(0,o.v_)(e.terms.length)+")",1)]),e.groupCode?((0,a.uX)(),(0,a.CE)("span",W,(0,o.v_)(e.groupCode),1)):(0,a.Q3)("",!0)])]),(0,a.Lk)("div",R,[(0,a.Lk)("div",B,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.terms,(e=>((0,a.uX)(),(0,a.CE)("span",{key:e.termId,class:"inline-flex items-center gap-1 px-2 py-1 bg-blue-50 text-blue-700 rounded text-xs border border-blue-200 hover:bg-blue-100 transition-colors",title:e.description||e.displayName},[t[34]||(t[34]=(0,a.Lk)("i",{class:"fas fa-tag text-blue-500",style:{"font-size":"10px"}},null,-1)),(0,a.eW)(" "+(0,o.v_)(e.displayName)+" ",1),e.code?((0,a.uX)(),(0,a.CE)("span",H,"("+(0,o.v_)(e.code)+")",1)):(0,a.Q3)("",!0)],8,M)))),128))])])])))),128))]),(0,a.Lk)("div",O,[(0,a.Lk)("span",null,"จำนวนกลุ่ม: "+(0,o.v_)(le.getGroupedTaxonomyTerms().length),1),(0,a.Lk)("span",null,"รายการทั้งหมด: "+(0,o.v_)(ne.selectedTaxonomyTerms.length),1)])])):(0,a.Q3)("",!0),ne.editMode?((0,a.uX)(),(0,a.CE)("div",z,[(0,a.Lk)("button",{class:"bg-blue-500 hover:bg-blue-600 text-sm text-white py-2 px-4 rounded",onClick:t[13]||(t[13]=(...e)=>le.saveData&&le.saveData(...e))},[(0,a.bF)(ce,{icon:["fas","save"]}),t[35]||(t[35]=(0,a.eW)(" บันทึกข้อมูลส่วนตัว "))]),(0,a.Lk)("button",{class:"ml-2 bg-gray-500 hover:bg-gray-600 text-sm text-white py-2 px-4 rounded",onClick:t[14]||(t[14]=(...e)=>le.toggleEditMode&&le.toggleEditMode(...e))},[(0,a.bF)(ce,{icon:["fas","times"]}),t[36]||(t[36]=(0,a.eW)(" ยกเลิก "))])])):(0,a.Q3)("",!0)]),ne.showModal?((0,a.uX)(),(0,a.CE)("div",Q,[(0,a.Lk)("div",N,[(0,a.Lk)("div",Y,[(0,a.Lk)("div",K,[t[38]||(t[38]=(0,a.Fv)('<div class="flex items-center space-x-3" data-v-53634937><div class="w-10 h-10 bg-white bg-opacity-20 rounded-full flex items-center justify-center" data-v-53634937><i class="fas fa-key text-white text-lg" data-v-53634937></i></div><div data-v-53634937><h2 class="text-lg font-semibold text-white" data-v-53634937>กำหนดรหัสผ่านใหม่</h2><p class="text-blue-100 text-sm" data-v-53634937>สร้างรหัสผ่านใหม่สำหรับผู้ใช้งาน</p></div></div>',1)),(0,a.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>le.closeModal&&le.closeModal(...e)),class:"text-white hover:text-gray-200 transition-colors duration-200 p-1"},t[37]||(t[37]=[(0,a.Lk)("i",{class:"fas fa-times text-lg"},null,-1)]))])]),(0,a.Lk)("div",J,[(0,a.Lk)("form",{onSubmit:t[18]||(t[18]=(0,r.D$)(((...e)=>le.resetPasswordWithNewPassword&&le.resetPasswordWithNewPassword(...e)),["prevent"]))},[(0,a.Lk)("div",G,[t[40]||(t[40]=(0,a.Lk)("label",{for:"newPassword",class:"block text-sm font-medium text-gray-700 mb-2"}," รหัสผ่านใหม่ ",-1)),(0,a.Lk)("div",q,[(0,a.bo)((0,a.Lk)("input",{id:"newPassword",type:"password","onUpdate:modelValue":t[16]||(t[16]=e=>ne.newPassword=e),placeholder:"กรอกรหัสผ่านใหม่ (อย่างน้อย 6 ตัวอักษร)",class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-colors duration-200 pr-12",required:"",minlength:"6"},null,512),[[r.Jo,ne.newPassword]]),t[39]||(t[39]=(0,a.Lk)("div",{class:"absolute inset-y-0 right-0 pr-3 flex items-center"},[(0,a.Lk)("i",{class:"fas fa-lock text-gray-400"})],-1))]),t[41]||(t[41]=(0,a.Lk)("div",{class:"mt-2 text-xs text-gray-500"},[(0,a.Lk)("i",{class:"fas fa-info-circle mr-1"}),(0,a.eW)(" รหัสผ่านต้องมีความยาวอย่างน้อย 6 ตัวอักษร ")],-1))]),ne.newPassword?((0,a.uX)(),(0,a.CE)("div",V,[(0,a.Lk)("div",Z,[t[42]||(t[42]=(0,a.Lk)("span",{class:"text-xs font-medium text-gray-700"},"ความแข็งแกร่งของรหัสผ่าน",-1)),(0,a.Lk)("span",ee,(0,o.v_)(le.getPasswordStrength()),1)]),(0,a.Lk)("div",te,[(0,a.Lk)("div",{class:(0,o.C4)(["h-2 rounded-full transition-all duration-300",le.getPasswordStrengthColor()]),style:(0,o.Tr)({width:le.getPasswordStrengthWidth()})},null,6)])])):(0,a.Q3)("",!0),(0,a.Lk)("div",se,[(0,a.Lk)("button",{type:"button",onClick:t[17]||(t[17]=(...e)=>le.closeModal&&le.closeModal(...e)),class:"flex-1 bg-gray-100 hover:bg-gray-200 text-gray-700 font-medium py-3 px-4 rounded-lg transition-colors duration-200 flex items-center justify-center"},t[43]||(t[43]=[(0,a.Lk)("i",{class:"fas fa-times mr-2"},null,-1),(0,a.eW)(" ยกเลิก ")])),(0,a.Lk)("button",{type:"submit",disabled:!ne.newPassword||ne.newPassword.length<6,class:"flex-1 bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 disabled:from-gray-300 disabled:to-gray-400 disabled:cursor-not-allowed text-white font-medium py-3 px-4 rounded-lg transition-all duration-200 flex items-center justify-center transform hover:scale-105 disabled:hover:scale-100"},t[44]||(t[44]=[(0,a.Lk)("i",{class:"fas fa-check mr-2"},null,-1),(0,a.eW)(" เปลี่ยนรหัสผ่าน ")]),8,ae)])],32)]),t[45]||(t[45]=(0,a.Lk)("div",{class:"bg-gray-50 px-6 py-3 rounded-b-xl"},[(0,a.Lk)("div",{class:"flex items-center text-xs text-gray-500"},[(0,a.Lk)("i",{class:"fas fa-shield-alt text-blue-500 mr-2"}),(0,a.eW)(" รหัสผ่านจะถูกเข้ารหัสอย่างปลอดภัยก่อนบันทึก ")])],-1))])])):(0,a.Q3)("",!0),(0,a.Lk)("footer",oe,[(0,a.Lk)("div",re,[(0,a.Lk)("button",{class:"bg-blue-500 hover:bg-blue-600 text-sm text-white py-2 px-4 rounded",onClick:t[19]||(t[19]=(...e)=>le.resetPasswordByPhone&&le.resetPasswordByPhone(...e))},[(0,a.bF)(ce,{icon:["fas","key"]}),t[46]||(t[46]=(0,a.eW)(" แก้รหัสผ่าน (เบอร์โทร) "))]),(0,a.Lk)("button",{class:"bg-blue-500 hover:bg-blue-600 text-sm text-white py-2 px-4 rounded",onClick:t[20]||(t[20]=(...e)=>le.showPasswordModal&&le.showPasswordModal(...e))},[(0,a.bF)(ce,{icon:["fas","key"]}),t[47]||(t[47]=(0,a.eW)(" แก้รหัสผ่าน (กำหนดเอง) "))])])])],2)}s(44114),s(98992),s(72577),s(3949);var ne=s(40475),le=s(63084),de=s(40471),ce=s(73288),ue=s(21396),me=s.n(ue),pe=s(63112),ge=s(11480);const he=new de.A(!1);var fe={props:{member:Object},components:{TaxonomySelector:ge.A},setup(){const{taxonomy:e,state:t,loading:s,error:a,fetchTaxonomyData:o}=(0,pe.Di)();return{taxonomy:e,taxonomyState:t,taxonomyLoading:s,taxonomyError:a,fetchTaxonomyData:o}},data(){return{config:ne.A.get("configs"),session:ne.A.get("session"),enroll:[],activeBlock:!1,editMode:!1,emailExists:!1,phoneExists:!1,citizenExists:!1,usernameExists:!1,formData:{...this.member},message:"Profile",showModal:!1,newPassword:"",selectedTaxonomyTerms:[]}},methods:{loadTaxonomyTermsFromMember(e){e&&e.taxonomy_terms&&Array.isArray(e.taxonomy_terms)?(this.selectedTaxonomyTerms=e.taxonomy_terms,console.log("โหลด taxonomy terms จากสมาชิก:",this.selectedTaxonomyTerms)):this.selectedTaxonomyTerms=[]},resetPasswordByPhone(){this.resetPassword(this.member.phone)},showPasswordModal(){this.showModal=!0},closeModal(){this.showModal=!1,this.newPassword=""},async resetPasswordWithNewPassword(){!this.newPassword||this.newPassword.length<6?ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"กรุณากรอกรหัสผ่านที่มีความยาวอย่างน้อย 6 ตัวอักษร",confirm:async()=>{},cancel:()=>{}}):(await this.resetPassword(this.newPassword),this.closeModal())},toggleEditMode(){this.editMode&&(this.formData={...this.member},this.loadTaxonomyTermsFromMember(this.member)),this.editMode=!this.editMode},async checkEmail(){if(this.formData.email)try{const e={method:"find",args:[{$and:[{email:this.formData.email}]}]},{data:t}=await he.POST("user/query",e,this.config.key);this.emailExists=t.length>0&&t[0]._id!=this.formData._id}catch(e){console.error("Error checking email:",e)}else this.emailExists=!1},async checkPhone(){if(this.formData.phone)try{const e={method:"find",args:[{$and:[{phone:this.formData.phone}]}]},{data:t}=await he.POST("user/query",e,this.config.key);this.phoneExists=t.length>0&&t[0]._id!=this.formData._id}catch(e){console.error("Error checking phone:",e)}else this.phoneExists=!1},async checkCitizen(){if(this.formData.citizen)try{const e={method:"find",args:[{$and:[{citizen:this.formData.citizen}]}]},{data:t}=await he.POST("user/query",e,this.config.key);this.citizenExists=t.length>0&&t[0]._id!=this.formData._id}catch(e){console.error("Error checking citizen:",e)}else this.citizenExists=!1},async checkUsername(){if(this.formData.username)try{const e={method:"find",args:[{$and:[{username:this.formData.username}]}]},{data:t}=await he.POST("user/query",e,this.config.key);this.usernameExists=t.length>0&&t[0]._id!=this.formData._id}catch(e){console.error("Error checking username:",e)}else this.usernameExists=!1},async getData(){try{const e=[{$match:{$and:[{userID:this.member._id}]}},{$set:{courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},{$facet:{enroll:[{$skip:0},{$limit:100}],totalCount:[{$count:"count"}]}}],t=await he.POST("enroll/aggregate",{pipeline:e},this.config.key),s=t.data;this.enroll=s[0].enroll,this.activeBlock=!1}catch(e){le.A.log(e)}},async saveData(){try{if(!this.formData.firstname||!this.formData.lastname||!this.formData.citizen||!this.formData.phone||!this.formData.email||!this.formData.username)return void ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"กรอกข้อมูลไม่ครบ !",confirm:async()=>{},cancel:()=>{}});if(!/^\d{13}$/.test(this.formData.citizen))return console.error("Citizen number must be exactly 13 digits long and contain only numbers."),void ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"เลขประชาชนต้องมี 13 หลัก และเป็นตัวเลขเท่านั้น !",confirm:async()=>{},cancel:()=>{}});if(!/^\d{10}$/.test(this.formData.phone))return void ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"เบอร์โทรต้องมี 10 หลัก และเป็นตัวเลขเท่านั้น !",confirm:async()=>{},cancel:()=>{}});if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.formData.email))return void ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"รูปแบบอีเมล์ไม่ถูกต้อง !",confirm:async()=>{},cancel:()=>{}});if(await Promise.all([this.checkEmail(),this.checkPhone(),this.checkCitizen(),this.checkUsername()]),this.emailExists||this.phoneExists||this.citizenExists||this.usernameExists)return;const e={data:{firstname:this.formData.firstname,lastname:this.formData.lastname,citizen:this.formData.citizen,phone:this.formData.phone,email:this.formData.email,username:this.formData.username,status:this.formData.status,taxonomy_terms:this.selectedTaxonomyTerms}};this.activeBlock=!0;const{status:t}=await he.PUT(`user/${this.formData._id}`,e,this.config.key);console.log(t),this.activeBlock=!1,ce.A.prompt({title:"แก้ไขข้อมูล",message:"บันทึกข้อมูลสมาชิกเรียบร้อยแล้ว",confirm:async()=>{await this.getData(),this.editMode=!1,this.$emit("member-updated",{...this.formData,taxonomy_terms:this.selectedTaxonomyTerms})},cancel:()=>{}})}catch(e){this.activeBlock=!1,console.error("Error saving data:",e),ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"ไม่สามารถบันทึกข้อมูลได้ กรุณาลองอีกครั้ง",confirm:async()=>{},cancel:()=>{}})}},async resetPassword(e){try{if(!e||e.length<6)return void ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"รหัสผ่านต้องมีความยาวอย่างน้อย 6 ตัวอักษร",confirm:async()=>{},cancel:()=>{}});this.activeBlock=!0;const t=me().lib.WordArray.random(16),s=me().SHA256(e+t).toString(),a=/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(this.formData.username),o=a?this.formData.username.toLowerCase():this.formData.username,r={data:{password:s,email:this.formData.email.toLowerCase(),username:o,salt:t.toString()}},{status:i}=await he.PUT(`user/${this.formData._id}`,r,this.config.key);this.activeBlock=!1,200===i?ce.A.prompt({title:"รีเซ็ตรหัสผ่านเรียบร้อยแล้ว",message:"แจ้งผู้สมัครให้สามารถใช้รหัสผ่านใหม่ ในการเข้าสู่ระบบ !",confirm:async()=>{},cancel:()=>{}}):ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"ไม่สามารถรีเซ็ตรหัสผ่านได้ กรุณาลองอีกครั้ง",confirm:async()=>{},cancel:()=>{}})}catch(t){this.activeBlock=!1,console.error("Error resetting password:",t),ce.A.prompt({title:"เกิดข้อผิดพลาด",message:"ไม่สามารถรีเซ็ตรหัสผ่านได้ กรุณาลองอีกครั้ง",confirm:async()=>{},cancel:()=>{}})}},getTermDisplayName(e){if(console.log("Getting term display name for:",e),console.log("Taxonomy state:",this.taxonomyState),console.log("Available terms:",this.taxonomyState?.terms||[]),!this.taxonomyState?.isReady)return console.warn("Taxonomy not ready yet, returning fallback"),`รายการ ${e}`;const t=this.taxonomyState.terms.find((t=>t._id===e));if(!t)return console.warn(`⚠️ ไม่พบ term ID: ${e}`),`รายการ ${e}`;const s=t.customData?.name||t.customData?.ชื่อ||t.customData?.title||t.name||t.code||"ไม่มีชื่อ";return console.log(`📄 Display name for term '${e}':`,s),s},getTermGroupName(e){if(console.log("Getting group name for term:",e),console.log("Taxonomy state:",this.taxonomyState),!this.taxonomyState?.isReady)return console.warn("Taxonomy not ready yet, returning fallback"),"ไม่ระบุกลุ่ม";const t=this.taxonomyState.terms.find((t=>t._id===e));if(!t||!t.taxonomy)return console.warn(`⚠️ ไม่พบ term หรือ taxonomy group สำหรับ ID: ${e}`),"ไม่ระบุกลุ่ม";const s=this.taxonomyState.groups.find((e=>e._id===t.taxonomy));if(!s)return console.warn(`⚠️ ไม่พบ group ID: ${t.taxonomy}`),"ไม่ระบุกลุ่ม";const a=s.name||s.code||"ไม่ระบุกลุ่ม";return console.log(`📁 Group name for term '${e}':`,a),a},getPasswordStrength(){const e=this.newPassword;return e?e.length<6?"อ่อนแอ":e.length<10?"ปานกลาง":"แข็งแรง":""},getPasswordStrengthColor(){const e=this.getPasswordStrength();return"อ่อนแอ"===e?"bg-red-500":"ปานกลาง"===e?"bg-yellow-500":"bg-green-500"},getPasswordStrengthWidth(){const e=this.getPasswordStrength();return"อ่อนแอ"===e?"33%":"ปานกลาง"===e?"66%":"100%"},getGroupedTaxonomyTerms(){const e={};return this.selectedTaxonomyTerms.forEach((t=>{if(!this.taxonomyState?.isReady)return void console.warn("Taxonomy not ready yet for grouping");const s=this.taxonomyState.terms.find((e=>e._id===t));if(!s||!s.taxonomy)return void console.warn(`⚠️ ไม่พบ term หรือ taxonomy group สำหรับ ID: ${t}`);const a=this.taxonomyState.groups.find((e=>e._id===s.taxonomy));if(!a)return void console.warn(`⚠️ ไม่พบ group ID: ${s.taxonomy}`);const o=a.name||a.code||"ไม่ระบุกลุ่ม",r=a.code||"",i=s.customData?.name||s.customData?.ชื่อ||s.name||"ไม่มีชื่อ";e[a._id]||(e[a._id]={groupId:a._id,groupName:o,groupCode:r,terms:[]}),e[a._id].terms.push({termId:t,displayName:i,code:s.code||"",description:s.customData?.description||s.meta||""})})),Object.values(e).sort(((e,t)=>e.groupName.localeCompare(t.groupName)))},getTermGroupCode(e){if(console.log("Getting group code for term:",e),!this.taxonomyState?.isReady)return console.warn("Taxonomy not ready yet, returning fallback"),"";const t=this.taxonomyState.terms.find((t=>t._id===e));if(!t||!t.taxonomy)return console.warn(`⚠️ ไม่พบ term หรือ taxonomy group สำหรับ ID: ${e}`),"";const s=this.taxonomyState.groups.find((e=>e._id===t.taxonomy));return s?s.code||"":(console.warn(`⚠️ ไม่พบ group ID: ${t.taxonomy}`),"")}},async mounted(){try{console.log("🔄 กำลังโหลดระบบ Taxonomy..."),this.fetchTaxonomyData&&(await this.fetchTaxonomyData(!0),console.log("✅ โหลด Taxonomy เสร็จแล้ว")),await new Promise((e=>setTimeout(e,500))),await this.getData(),this.loadTaxonomyTermsFromMember(this.member),this.$setPageTitle(this.member.firstname+" "+this.member.lastname+" / ข้อมูลส่วนตัว")}catch(e){console.error("Error in mounted:",e)}}},be=s(64621);const xe=(0,be.A)(fe,[["render",ie],["__scopeId","data-v-53634937"]]);var ye=xe},61628:function(e,t,s){"use strict";s.d(t,{A:function(){return ye}});var a=s(20641),o=s(90033),r=s(53751);const i={class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"},n={class:"bg-white rounded-lg shadow-xl w-3/5 max-w-2xl h-auto max-h-[90vh] relative flex flex-col"},l={class:"bg-gray-300 px-3 py-2 rounded-t-lg flex justify-between items-center"},d={class:"flex items-center gap-2"},c=["disabled"],u={class:"bg-gray-200 px-3 py-2 border-b flex justify-between items-center"},m={class:"flex items-center gap-4"},p={class:"text-xs text-gray-600 flex items-center gap-3"},g={class:"font-medium"},h={class:"px-2 py-0.5 bg-gray-300 rounded"},f=["disabled"],b={class:"flex items-center gap-2"},x=["disabled"],y=["disabled"],k={key:0},v={key:1},w={key:0,class:"bg-red-100 border border-red-400 text-red-700 px-3 py-2 mx-3 mt-2 rounded text-xs"},L={key:1,class:"bg-blue-100 border border-blue-400 text-blue-700 px-3 py-2 mx-3 mt-2 rounded text-xs"},C={class:"flex items-center gap-2"},_={class:"flex-1 bg-gray-100 flex items-center justify-center p-3 overflow-hidden"},E=["src"],D=["src"],T={key:2,class:"w-full h-full flex items-center justify-center text-gray-400"},A={class:"absolute -top-6 left-0 bg-red-500 text-white text-xs px-2 py-1 rounded pointer-events-none"},I={class:"bg-gray-700 text-white p-2"},P={class:"grid grid-cols-4 gap-2 text-xs"},$={class:"space-y-1"},S={class:"grid grid-cols-2 gap-1"},X=["disabled"],F=["disabled"],U=["disabled"],j=["disabled"],W={class:"space-y-1"},R={class:"text-xs text-gray-300 font-medium"},B={class:"space-y-1"},M={class:"flex gap-1"},H=["disabled"],O=["disabled"],z={class:"flex gap-1"},Q=["disabled"],N=["disabled"],Y={class:"space-y-1"},K={class:"grid grid-cols-3 gap-0.5"},J=["disabled"],G=["disabled"],q=["disabled"],V=["disabled"],Z=["disabled"],ee=["disabled"],te=["disabled"],se=["disabled"],ae=["disabled"],oe={class:"space-y-1"},re={class:"space-y-1"},ie=["disabled"],ne={key:0,class:"text-xs text-gray-300 text-center"};function le(e,t,s,le,de,ce){return(0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",n,[(0,a.Lk)("header",l,[t[75]||(t[75]=(0,a.Lk)("div",{class:"flex items-center gap-4"},[(0,a.Lk)("h2",{class:"text-xs font-bold text-gray-800"},"Image Editor")],-1)),(0,a.Lk)("div",d,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>ce.handleClose&&ce.handleClose(...e)),class:"text-gray-600 hover:text-gray-800 transition-colors p-1",disabled:de.isProcessing},t[74]||(t[74]=[(0,a.Lk)("i",{class:"fas fa-times text-sm"},null,-1)]),8,c)])]),(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[(0,a.Lk)("div",p,[(0,a.Lk)("span",g,(0,o.v_)(ce.formattedImageSize),1),(0,a.Lk)("span",null,(0,o.v_)(ce.formattedImageDimensions),1),(0,a.Lk)("span",null,(0,o.v_)(ce.imageAspectRatio),1),(0,a.Lk)("span",null,(0,o.v_)(ce.imageMegapixels),1),(0,a.Lk)("span",h,(0,o.v_)(ce.imageOrientation),1),(0,a.Lk)("span",{class:(0,o.C4)(["px-2 py-0.5 rounded","แก้ไขแล้ว"===ce.editStatus?"bg-orange-200 text-orange-800":"bg-green-200 text-green-800"])},(0,o.v_)(ce.editStatus),3)]),0!==de.transform.rotation||100!==de.transform.zoom||0!==de.transform.positionX||0!==de.transform.positionY?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[1]||(t[1]=(...e)=>ce.resetTransform&&ce.resetTransform(...e)),class:"text-blue-600 hover:text-blue-800 text-xs px-2 py-0.5 rounded hover:bg-blue-50",disabled:de.isProcessing}," รีเซ็ต ",8,f)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",b,[(0,a.Lk)("input",{type:"file",onChange:t[2]||(t[2]=(...e)=>ce.handleFileChange&&ce.handleFileChange(...e)),class:"hidden",ref:"fileInput",accept:"image/*"},null,544),(0,a.Lk)("button",{onClick:t[3]||(t[3]=(...e)=>ce.handleFileInputClick&&ce.handleFileInputClick(...e)),class:"flex items-center justify-center gap-1 px-3 py-1 bg-blue-600 hover:bg-blue-500 text-white rounded transition-colors text-xs",disabled:de.isProcessing},t[76]||(t[76]=[(0,a.Lk)("i",{class:"fas fa-upload text-xs"},null,-1),(0,a.Lk)("span",null,"เลือกรูป",-1)]),8,x),(0,a.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>ce.saveAndUploadImage&&ce.saveAndUploadImage(...e)),class:"flex items-center justify-center gap-1 px-3 py-1 bg-green-600 hover:bg-green-500 text-white rounded transition-colors disabled:bg-gray-500 text-xs",disabled:!ce.canSave},[(0,a.Lk)("i",{class:(0,o.C4)(["fas fa-save text-xs",{"fa-spinner fa-spin":de.isProcessing}])},null,2),de.processingStatus?((0,a.uX)(),(0,a.CE)("span",k,(0,o.v_)(de.processingStatus),1)):((0,a.uX)(),(0,a.CE)("span",v,(0,o.v_)(de.isProcessing?"บันทึก...":"บันทึก"),1))],8,y)])]),de.error?((0,a.uX)(),(0,a.CE)("div",w,[(0,a.eW)((0,o.v_)(de.error)+" ",1),(0,a.Lk)("button",{onClick:t[5]||(t[5]=e=>de.error=null),class:"float-right font-bold"},"×")])):(0,a.Q3)("",!0),de.isProcessing?((0,a.uX)(),(0,a.CE)("div",L,[(0,a.Lk)("div",C,[t[77]||(t[77]=(0,a.Lk)("i",{class:"fas fa-spinner fa-spin"},null,-1)),(0,a.Lk)("span",null,(0,o.v_)(de.processingStatus||"กำลังประมวลผล..."),1)]),t[78]||(t[78]=(0,a.Lk)("div",{class:"w-full bg-blue-200 rounded-full h-1 mt-2"},[(0,a.Lk)("div",{class:"bg-blue-600 h-1 rounded-full animate-pulse",style:{width:"100%"}})],-1))])):(0,a.Q3)("",!0),(0,a.Lk)("main",_,[(0,a.Lk)("div",{class:"bg-white border border-gray-300 overflow-hidden shadow-inner",style:(0,o.Tr)({width:s.cropImageWidth,height:s.cropImageHeight})},[(0,a.Lk)("div",{ref:"imageContainer",class:"w-full h-full overflow-hidden relative",style:(0,o.Tr)({width:s.cropImageWidth,height:s.cropImageHeight})},[de.capturedImageSrc?((0,a.uX)(),(0,a.CE)("img",{key:0,src:de.capturedImageSrc,alt:"Captured Preview",class:"w-full h-full object-contain"},null,8,E)):de.currentImageUrl?((0,a.uX)(),(0,a.CE)("img",{key:1,src:de.currentImageUrl,alt:"Image Preview",class:"max-w-none",style:(0,o.Tr)(ce.imageStyle)},null,12,D)):((0,a.uX)(),(0,a.CE)("div",T,t[79]||(t[79]=[(0,a.Lk)("i",{class:"fas fa-image text-2xl"},null,-1)]))),de.crop.enabled&&de.currentImageUrl?((0,a.uX)(),(0,a.CE)("div",{key:3,class:"absolute border-2 border-red-500 bg-red-500 bg-opacity-20 cursor-move select-none",style:(0,o.Tr)({left:de.crop.x+"px",top:de.crop.y+"px",width:de.crop.width+"px",height:de.crop.height+"px"}),onMousedown:t[22]||(t[22]=e=>ce.startDrag(e,"move")),onTouchstart:t[23]||(t[23]=e=>ce.startDrag(e,"move"))},[(0,a.Lk)("div",A,(0,o.v_)(de.crop.width)+"×"+(0,o.v_)(de.crop.height),1),(0,a.Lk)("div",{class:"absolute w-3 h-3 bg-red-500 border border-white cursor-nw-resize",style:{top:"-4px",left:"-4px"},onMousedown:t[6]||(t[6]=(0,r.D$)((e=>ce.startDrag(e,"resize","nw")),["stop"])),onTouchstart:t[7]||(t[7]=(0,r.D$)((e=>ce.startDrag(e,"resize","nw")),["stop"]))},null,32),(0,a.Lk)("div",{class:"absolute w-3 h-3 bg-red-500 border border-white cursor-ne-resize",style:{top:"-4px",right:"-4px"},onMousedown:t[8]||(t[8]=(0,r.D$)((e=>ce.startDrag(e,"resize","ne")),["stop"])),onTouchstart:t[9]||(t[9]=(0,r.D$)((e=>ce.startDrag(e,"resize","ne")),["stop"]))},null,32),(0,a.Lk)("div",{class:"absolute w-3 h-3 bg-red-500 border border-white cursor-sw-resize",style:{bottom:"-4px",left:"-4px"},onMousedown:t[10]||(t[10]=(0,r.D$)((e=>ce.startDrag(e,"resize","sw")),["stop"])),onTouchstart:t[11]||(t[11]=(0,r.D$)((e=>ce.startDrag(e,"resize","sw")),["stop"]))},null,32),(0,a.Lk)("div",{class:"absolute w-3 h-3 bg-red-500 border border-white cursor-se-resize",style:{bottom:"-4px",right:"-4px"},onMousedown:t[12]||(t[12]=(0,r.D$)((e=>ce.startDrag(e,"resize","se")),["stop"])),onTouchstart:t[13]||(t[13]=(0,r.D$)((e=>ce.startDrag(e,"resize","se")),["stop"]))},null,32),(0,a.Lk)("div",{class:"absolute w-3 h-3 bg-red-500 border border-white cursor-n-resize",style:{top:"-4px",left:"50%",transform:"translateX(-50%)"},onMousedown:t[14]||(t[14]=(0,r.D$)((e=>ce.startDrag(e,"resize","n")),["stop"])),onTouchstart:t[15]||(t[15]=(0,r.D$)((e=>ce.startDrag(e,"resize","n")),["stop"]))},null,32),(0,a.Lk)("div",{class:"absolute w-3 h-3 bg-red-500 border border-white cursor-s-resize",style:{bottom:"-4px",left:"50%",transform:"translateX(-50%)"},onMousedown:t[16]||(t[16]=(0,r.D$)((e=>ce.startDrag(e,"resize","s")),["stop"])),onTouchstart:t[17]||(t[17]=(0,r.D$)((e=>ce.startDrag(e,"resize","s")),["stop"]))},null,32),(0,a.Lk)("div",{class:"absolute w-3 h-3 bg-red-500 border border-white cursor-w-resize",style:{left:"-4px",top:"50%",transform:"translateY(-50%)"},onMousedown:t[18]||(t[18]=(0,r.D$)((e=>ce.startDrag(e,"resize","w")),["stop"])),onTouchstart:t[19]||(t[19]=(0,r.D$)((e=>ce.startDrag(e,"resize","w")),["stop"]))},null,32),(0,a.Lk)("div",{class:"absolute w-3 h-3 bg-red-500 border border-white cursor-e-resize",style:{right:"-4px",top:"50%",transform:"translateY(-50%)"},onMousedown:t[20]||(t[20]=(0,r.D$)((e=>ce.startDrag(e,"resize","e")),["stop"])),onTouchstart:t[21]||(t[21]=(0,r.D$)((e=>ce.startDrag(e,"resize","e")),["stop"]))},null,32)],36)):(0,a.Q3)("",!0)],4)],4)]),(0,a.Lk)("section",I,[(0,a.Lk)("div",P,[(0,a.Lk)("div",$,[t[84]||(t[84]=(0,a.Lk)("h3",{class:"text-xs text-gray-300 font-medium"},"หมุน",-1)),(0,a.Lk)("div",S,[(0,a.Lk)("button",{onClick:t[24]||(t[24]=e=>ce.rotateImage(-90)),class:"flex items-center justify-center gap-1 px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors text-xs",disabled:de.isProcessing},t[80]||(t[80]=[(0,a.Lk)("i",{class:"fas fa-undo text-xs"},null,-1),(0,a.Lk)("span",null,"ซ้าย",-1)]),8,X),(0,a.Lk)("button",{onClick:t[25]||(t[25]=e=>ce.rotateImage(90)),class:"flex items-center justify-center gap-1 px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors text-xs",disabled:de.isProcessing},t[81]||(t[81]=[(0,a.Lk)("i",{class:"fas fa-redo text-xs"},null,-1),(0,a.Lk)("span",null,"ขวา",-1)]),8,F),(0,a.Lk)("button",{onClick:t[26]||(t[26]=e=>ce.flipImage("horizontal")),class:"flex items-center justify-center gap-1 px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors text-xs",disabled:de.isProcessing},t[82]||(t[82]=[(0,a.Lk)("i",{class:"fas fa-arrows-alt-h text-xs"},null,-1),(0,a.Lk)("span",null,"แนวนอน",-1)]),8,U),(0,a.Lk)("button",{onClick:t[27]||(t[27]=e=>ce.flipImage("vertical")),class:"flex items-center justify-center gap-1 px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors text-xs",disabled:de.isProcessing},t[83]||(t[83]=[(0,a.Lk)("i",{class:"fas fa-arrows-alt-v text-xs"},null,-1),(0,a.Lk)("span",null,"แนวตั้ง",-1)]),8,j)])]),(0,a.Lk)("div",W,[(0,a.Lk)("h3",R,"ซูม "+(0,o.v_)(de.transform.zoom)+"%",1),(0,a.Lk)("div",B,[(0,a.Lk)("div",M,[(0,a.Lk)("button",{onClick:t[28]||(t[28]=e=>ce.zoomImage("in")),class:"flex items-center justify-center gap-1 px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors text-xs",disabled:de.isProcessing},t[85]||(t[85]=[(0,a.Lk)("i",{class:"fas fa-search-plus text-xs"},null,-1),(0,a.Lk)("span",null,"+",-1)]),8,H),(0,a.Lk)("button",{onClick:t[29]||(t[29]=e=>ce.zoomImage("out")),class:"flex items-center justify-center gap-1 px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors text-xs",disabled:de.isProcessing||de.transform.zoom<=10},t[86]||(t[86]=[(0,a.Lk)("i",{class:"fas fa-search-minus text-xs"},null,-1),(0,a.Lk)("span",null,"-",-1)]),8,O)]),(0,a.Lk)("div",z,[(0,a.Lk)("button",{onClick:t[30]||(t[30]=(...e)=>ce.fitToContainer&&ce.fitToContainer(...e)),class:"flex items-center justify-center gap-1 px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors text-xs",disabled:de.isProcessing},t[87]||(t[87]=[(0,a.Lk)("i",{class:"fas fa-compress text-xs"},null,-1),(0,a.Lk)("span",null,"พอดี",-1)]),8,Q),(0,a.Lk)("button",{onClick:t[31]||(t[31]=(...e)=>ce.actualSize&&ce.actualSize(...e)),class:"flex items-center justify-center gap-1 px-2 py-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors text-xs",disabled:de.isProcessing},t[88]||(t[88]=[(0,a.Lk)("i",{class:"fas fa-expand-arrows-alt text-xs"},null,-1),(0,a.Lk)("span",null,"100%",-1)]),8,N)])])]),(0,a.Lk)("div",Y,[t[98]||(t[98]=(0,a.Lk)("h3",{class:"text-xs text-gray-300 font-medium"},"ตำแหน่ง",-1)),(0,a.Lk)("div",K,[(0,a.Lk)("button",{onMousedown:t[32]||(t[32]=e=>ce.startHold("up-left")),onMouseup:t[33]||(t[33]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onMouseleave:t[34]||(t[34]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onTouchstart:t[35]||(t[35]=e=>ce.startHold("up-left")),onTouchend:t[36]||(t[36]=(...e)=>ce.stopHold&&ce.stopHold(...e)),class:"flex items-center justify-center p-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors select-none",disabled:de.isProcessing},t[89]||(t[89]=[(0,a.Lk)("i",{class:"fas fa-arrow-up text-xs transform -rotate-45"},null,-1)]),40,J),(0,a.Lk)("button",{onMousedown:t[37]||(t[37]=e=>ce.startHold("up")),onMouseup:t[38]||(t[38]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onMouseleave:t[39]||(t[39]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onTouchstart:t[40]||(t[40]=e=>ce.startHold("up")),onTouchend:t[41]||(t[41]=(...e)=>ce.stopHold&&ce.stopHold(...e)),class:"flex items-center justify-center p-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors select-none",disabled:de.isProcessing},t[90]||(t[90]=[(0,a.Lk)("i",{class:"fas fa-arrow-up text-xs"},null,-1)]),40,G),(0,a.Lk)("button",{onMousedown:t[42]||(t[42]=e=>ce.startHold("up-right")),onMouseup:t[43]||(t[43]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onMouseleave:t[44]||(t[44]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onTouchstart:t[45]||(t[45]=e=>ce.startHold("up-right")),onTouchend:t[46]||(t[46]=(...e)=>ce.stopHold&&ce.stopHold(...e)),class:"flex items-center justify-center p-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors select-none",disabled:de.isProcessing},t[91]||(t[91]=[(0,a.Lk)("i",{class:"fas fa-arrow-up text-xs transform rotate-45"},null,-1)]),40,q),(0,a.Lk)("button",{onMousedown:t[47]||(t[47]=e=>ce.startHold("left")),onMouseup:t[48]||(t[48]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onMouseleave:t[49]||(t[49]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onTouchstart:t[50]||(t[50]=e=>ce.startHold("left")),onTouchend:t[51]||(t[51]=(...e)=>ce.stopHold&&ce.stopHold(...e)),class:"flex items-center justify-center p-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors select-none",disabled:de.isProcessing},t[92]||(t[92]=[(0,a.Lk)("i",{class:"fas fa-arrow-left text-xs"},null,-1)]),40,V),(0,a.Lk)("button",{onClick:t[52]||(t[52]=(...e)=>ce.fitToScreen&&ce.fitToScreen(...e)),class:"flex items-center justify-center p-1 bg-purple-600 hover:bg-purple-500 rounded transition-colors select-none",disabled:de.isProcessing||!de.currentImageUrl},t[93]||(t[93]=[(0,a.Lk)("i",{class:"fas fa-expand text-xs text-white"},null,-1)]),8,Z),(0,a.Lk)("button",{onMousedown:t[53]||(t[53]=e=>ce.startHold("right")),onMouseup:t[54]||(t[54]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onMouseleave:t[55]||(t[55]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onTouchstart:t[56]||(t[56]=e=>ce.startHold("right")),onTouchend:t[57]||(t[57]=(...e)=>ce.stopHold&&ce.stopHold(...e)),class:"flex items-center justify-center p-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors select-none",disabled:de.isProcessing},t[94]||(t[94]=[(0,a.Lk)("i",{class:"fas fa-arrow-right text-xs"},null,-1)]),40,ee),(0,a.Lk)("button",{onMousedown:t[58]||(t[58]=e=>ce.startHold("down-left")),onMouseup:t[59]||(t[59]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onMouseleave:t[60]||(t[60]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onTouchstart:t[61]||(t[61]=e=>ce.startHold("down-left")),onTouchend:t[62]||(t[62]=(...e)=>ce.stopHold&&ce.stopHold(...e)),class:"flex items-center justify-center p-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors select-none",disabled:de.isProcessing},t[95]||(t[95]=[(0,a.Lk)("i",{class:"fas fa-arrow-down text-xs transform rotate-45"},null,-1)]),40,te),(0,a.Lk)("button",{onMousedown:t[63]||(t[63]=e=>ce.startHold("down")),onMouseup:t[64]||(t[64]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onMouseleave:t[65]||(t[65]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onTouchstart:t[66]||(t[66]=e=>ce.startHold("down")),onTouchend:t[67]||(t[67]=(...e)=>ce.stopHold&&ce.stopHold(...e)),class:"flex items-center justify-center p-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors select-none",disabled:de.isProcessing},t[96]||(t[96]=[(0,a.Lk)("i",{class:"fas fa-arrow-down text-xs"},null,-1)]),40,se),(0,a.Lk)("button",{onMousedown:t[68]||(t[68]=e=>ce.startHold("down-right")),onMouseup:t[69]||(t[69]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onMouseleave:t[70]||(t[70]=(...e)=>ce.stopHold&&ce.stopHold(...e)),onTouchstart:t[71]||(t[71]=e=>ce.startHold("down-right")),onTouchend:t[72]||(t[72]=(...e)=>ce.stopHold&&ce.stopHold(...e)),class:"flex items-center justify-center p-1 bg-gray-600 hover:bg-gray-500 rounded transition-colors select-none",disabled:de.isProcessing},t[97]||(t[97]=[(0,a.Lk)("i",{class:"fas fa-arrow-down text-xs transform -rotate-45"},null,-1)]),40,ae)])]),(0,a.Lk)("div",oe,[t[103]||(t[103]=(0,a.Lk)("h3",{class:"text-xs text-gray-300 font-medium"},"ครอป",-1)),(0,a.Lk)("div",re,[(0,a.Lk)("button",{onClick:t[73]||(t[73]=(...e)=>ce.toggleCrop&&ce.toggleCrop(...e)),class:(0,o.C4)(["flex items-center justify-center gap-1 px-2 py-1 rounded transition-colors text-xs w-full",de.crop.enabled?"bg-red-600 hover:bg-red-500":"bg-gray-600 hover:bg-gray-500"]),disabled:de.isProcessing},[t[99]||(t[99]=(0,a.Lk)("i",{class:"fas fa-crop text-xs"},null,-1)),(0,a.Lk)("span",null,(0,o.v_)(de.crop.enabled?"ปิด":"เปิด"),1)],10,ie),de.crop.enabled?((0,a.uX)(),(0,a.CE)("div",ne,[(0,a.Lk)("div",null,(0,o.v_)(de.crop.width)+"×"+(0,o.v_)(de.crop.height),1),t[100]||(t[100]=(0,a.Lk)("div",{class:"text-gray-400 mt-1"},"ลากเพื่อย้าย",-1)),t[101]||(t[101]=(0,a.Lk)("div",{class:"text-gray-400"},"ลากมุมเพื่อปรับขนาด",-1)),t[102]||(t[102]=(0,a.Lk)("div",{class:"text-gray-400"},"(สี่เหลี่ยมจัตุรัส)",-1))])):(0,a.Q3)("",!0)])])])])])])}s(16573),s(78100),s(77936),s(37467),s(44732),s(79577);var de=s(40475),ce=s(57146),ue=s(30554),me=s(20354),pe=s.n(me);const ge=5,he=5;var fe={name:"ImageEditor",props:{imageUrl:{type:String,default:""},uploadPath:{type:String,required:!0},filePrefix:{type:String,default:"image"},cropImageWidth:{type:String,default:"400px"},cropImageHeight:{type:String,default:"300px"}},emits:["close-popup-event","fileUrlUpdated"],data(){return{s3Client:null,schoolSession:null,currentImageUrl:"",originalImageUrl:"",capturedImageSrc:null,base64Image:null,transform:{rotation:0,zoom:100,positionX:0,positionY:0,flipX:!1,flipY:!1},crop:{enabled:!1,x:0,y:0,width:200,height:200},drag:{isDragging:!1,isResizing:!1,startX:0,startY:0,startCropX:0,startCropY:0,startCropWidth:0,startCropHeight:0,resizeHandle:null},imageInfo:{size:null,width:null,height:null},isProcessing:!1,error:null,processingStatus:"",holdInterval:null,holdTimeout:null,isHolding:!1}},computed:{imageStyle(){const{positionX:e,positionY:t,zoom:s,rotation:a,flipX:o,flipY:r}=this.transform,i=o?-1:1,n=r?-1:1;return{transform:`translate(calc(-50% + ${e}px), calc(-50% + ${t}px)) scale(${s/100*i}, ${s/100*n}) rotate(${a}deg)`,transformOrigin:"center center",position:"absolute",top:"50%",left:"50%"}},formattedImageSize(){return this.imageInfo.size?`${Math.round(this.imageInfo.size/1024)}KB`:"N/A"},formattedImageDimensions(){const{width:e,height:t}=this.imageInfo;return`${e||"N/A"}X${t||"N/A"}`},imageAspectRatio(){const{width:e,height:t}=this.imageInfo;if(!e||!t)return"N/A";const s=(e,t)=>0===t?e:s(t,e%t),a=s(e,t),o=e/a,r=t/a;return`${o}:${r}`},imageMegapixels(){const{width:e,height:t}=this.imageInfo;if(!e||!t)return"N/A";const s=e*t/1e6;return`${s.toFixed(1)}MP`},imageOrientation(){const{width:e,height:t}=this.imageInfo;return e&&t?e===t?"สี่เหลี่ยมจัตุรัส":e>t?"แนวนอน":"แนวตั้ง":"N/A"},editStatus(){const{rotation:e,zoom:t,positionX:s,positionY:a,flipX:o,flipY:r}=this.transform,i=0!==e||100!==t||0!==s||0!==a||o||r;return i?"แก้ไขแล้ว":"ต้นฉบับ"},canSave(){return this.currentImageUrl&&!this.isProcessing}},async created(){await this.initializeS3Client(),await this.loadInitialImage(),document.addEventListener("mouseup",this.stopHold),document.addEventListener("touchend",this.stopHold)},beforeUnmount(){this.stopHold(),document.removeEventListener("mouseup",this.stopHold),document.removeEventListener("touchend",this.stopHold),this.stopDrag()},methods:{async initializeS3Client(){try{const e=de.A.get("session");this.schoolSession=e.current,this.s3Client=new ce.S3({forcePathStyle:!1,endpoint:this.schoolSession.s3EndpointDefault,region:this.schoolSession.s3Region,ResponseContentEncoding:"utf-8",credentials:{accessKeyId:this.schoolSession.s3Key,secretAccessKey:this.schoolSession.s3Secret},params:{CacheControl:"no-cache"}})}catch(e){this.handleError("Failed to initialize S3 client",e)}},async loadInitialImage(){this.imageUrl&&await this.processImageFromUrl(this.imageUrl)},handleClose(){this.$emit("close-popup-event")},async handleFileChange(e){const t=e.target.files[0];if(t)try{this.isProcessing=!0,await this.processImageFromFile(t)}catch(s){this.handleError("Failed to process image file",s)}finally{this.isProcessing=!1}},handleFileInputClick(){this.$refs.fileInput.click()},async processImageFromFile(e){const t=await this.fileToBase64(e),s=await this.getImageDimensions(t);this.updateImageState({url:t,size:e.size,dimensions:s})},async processImageFromUrl(e){try{const{base64Url:t,size:s,dimensions:a}=await this.urlToImageData(e);this.updateImageState({url:t,size:s,dimensions:a})}catch(t){this.handleError("Failed to load image from URL",t)}},updateImageState({url:e,size:t,dimensions:s}){this.currentImageUrl=e,this.base64Image=e,this.capturedImageSrc=null,this.imageInfo={size:t,width:s.width,height:s.height},this.resetTransform()},rotateImage(e){this.transform.rotation+=e,this.clearCapture()},flipImage(e){"horizontal"===e?this.transform.flipX=!this.transform.flipX:"vertical"===e&&(this.transform.flipY=!this.transform.flipY),this.clearCapture()},zoomImage(e){const t="in"===e?he:-he;this.transform.zoom=Math.max(10,this.transform.zoom+t),this.clearCapture()},moveImage(e){const{positionX:t,positionY:s}=this.transform;switch(e){case"up":this.transform.positionY=s-ge;break;case"down":this.transform.positionY=s+ge;break;case"left":this.transform.positionX=t-ge;break;case"right":this.transform.positionX=t+ge;break;case"up-left":this.transform.positionX=t-ge,this.transform.positionY=s-ge;break;case"up-right":this.transform.positionX=t+ge,this.transform.positionY=s-ge;break;case"down-left":this.transform.positionX=t-ge,this.transform.positionY=s+ge;break;case"down-right":this.transform.positionX=t+ge,this.transform.positionY=s+ge;break}this.clearCapture()},resetTransform(){let e=100;if(this.imageInfo.width&&this.imageInfo.height){const t=parseInt(this.cropImageWidth)||400,s=parseInt(this.cropImageHeight)||300,a=this.imageInfo.width,o=this.imageInfo.height,r=t/a,i=s/o,n=Math.min(r,i,1);e=Math.round(100*n)}this.transform={rotation:0,zoom:e,positionX:0,positionY:0,flipX:!1,flipY:!1},this.clearCapture()},clearCapture(){this.capturedImageSrc=null},fitToScreen(){if(console.log("fitToScreen called",{width:this.imageInfo.width,height:this.imageInfo.height,cropWidth:this.cropImageWidth,cropHeight:this.cropImageHeight}),!this.imageInfo.width||!this.imageInfo.height)return void console.warn("Image dimensions not available for fitToScreen");const e=parseInt(this.cropImageWidth)||400,t=parseInt(this.cropImageHeight)||300,s=this.imageInfo.width,a=this.imageInfo.height,o=e/s,r=t/a,i=Math.max(o,r),n=Math.round(100*i);console.log("fitToScreen calculation",{scaleX:o,scaleY:r,scale:i,newZoom:n,currentZoom:this.transform.zoom}),this.transform.zoom=n,this.transform.positionX=0,this.transform.positionY=0,this.clearCapture()},fitToContainer(){if(!this.imageInfo.width||!this.imageInfo.height)return;const e=parseInt(this.cropImageWidth)||400,t=parseInt(this.cropImageHeight)||300,s=this.imageInfo.width,a=this.imageInfo.height,o=e/s,r=t/a,i=Math.min(o,r,1);this.transform.zoom=Math.round(100*i),this.transform.positionX=0,this.transform.positionY=0,this.clearCapture()},actualSize(){this.transform.zoom=100,this.transform.positionX=0,this.transform.positionY=0,this.clearCapture()},async forceRefreshAndFit(){if(this.currentImageUrl)try{const e=new Image;e.crossOrigin="anonymous",await new Promise(((t,s)=>{e.onload=()=>{this.imageInfo.width=e.naturalWidth,this.imageInfo.height=e.naturalHeight,console.log("Image reloaded with dimensions:",{width:e.naturalWidth,height:e.naturalHeight}),t()},e.onerror=s,e.src=this.currentImageUrl})),await this.$nextTick(),await new Promise((e=>setTimeout(e,200))),this.fitToScreen()}catch(e){console.error("Failed to refresh image:",e)}},startHold(e){this.isProcessing||this.isHolding||(this.isHolding=!0,this.moveImage(e),this.holdTimeout=setTimeout((()=>{this.holdInterval=setInterval((()=>{this.isHolding&&this.moveImage(e)}),50)}),300))},stopHold(){this.isHolding=!1,this.holdTimeout&&(clearTimeout(this.holdTimeout),this.holdTimeout=null),this.holdInterval&&(clearInterval(this.holdInterval),this.holdInterval=null)},async captureImage(){const e=this.$refs.imageContainer;if(!e)throw new Error("Image container not found");try{return await this.captureImageWithCanvas()}catch(t){return console.error("Canvas capture failed, falling back to html2canvas:",t),await this.captureImageWithHtml2Canvas()}},async captureImageWithCanvas(){const e=this.$refs.imageContainer.querySelector("img");if(!e)throw new Error("No image found to capture");await e.decode();const t=document.createElement("canvas"),s=t.getContext("2d");this.crop.enabled?(t.width=this.crop.width,t.height=this.crop.height):(t.width=parseInt(this.cropImageWidth)||400,t.height=parseInt(this.cropImageHeight)||300),s.fillStyle="white",s.fillRect(0,0,t.width,t.height);const{positionX:a,positionY:o,zoom:r,rotation:i,flipX:n,flipY:l}=this.transform;if(s.save(),this.crop.enabled){const e=parseInt(this.cropImageWidth)||400,a=parseInt(this.cropImageHeight)||300,o=e/2,r=a/2,i=this.crop.x+this.crop.width/2,n=this.crop.y+this.crop.height/2,l=t.width/2+(o-i),d=t.height/2+(r-n);s.translate(l,d)}else s.translate(t.width/2,t.height/2);s.translate(a,o),s.scale(n?-r/100:r/100,l?-r/100:r/100),s.rotate(i*Math.PI/180);const d=e.naturalWidth,c=e.naturalHeight;return s.drawImage(e,-d/2,-c/2,d,c),s.restore(),t.toDataURL("image/png",.9)},async captureImageWithHtml2Canvas(){const e=this.$refs.imageContainer;try{const t=e.querySelector("img");t&&(await t.decode(),await new Promise((e=>setTimeout(e,100))));const s={useCORS:!0,allowTaint:!0,backgroundColor:"white",scale:1,width:parseInt(this.cropImageWidth)||400,height:parseInt(this.cropImageHeight)||300,logging:!1,timeout:5e3},a=pe()(e,s),o=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Html2canvas timeout - การจับภาพใช้เวลานานเกินไป"))),8e3)})),r=await Promise.race([a,o]);return r.toDataURL("image/png",.9)}catch(t){throw console.error("Html2canvas capture error:",t),new Error(`Failed to capture image: ${t.message}`)}},async saveAndUploadImage(){if(this.canSave)try{this.isProcessing=!0,this.error=null,this.processingStatus="กำลังจับภาพรูปภาพ...",console.log("เริ่มจับภาพรูปภาพ...");const e=await this.captureImage();this.processingStatus="กำลังอัปโหลดไปยัง S3...",console.log("เริ่มอัปโหลดไปยัง S3...");const t=await this.uploadToS3(e);this.processingStatus="บันทึกสำเร็จ!",console.log("อัปโหลดสำเร็จ:",t),await this.updateAfterUpload(t),this.$emit("fileUrlUpdated",t)}catch(e){console.error("Save error:",e),this.processingStatus="",this.handleError("Failed to save and upload image",e)}finally{setTimeout((()=>{this.isProcessing=!1,this.processingStatus=""}),1e3)}},async uploadToS3(e){try{const t=await fetch(e),s=await t.blob(),a=await s.arrayBuffer(),o=this.generateFilename(),r=`${this.uploadPath}${o}`,i={Bucket:this.schoolSession.s3Bucket,Key:r,Body:new Uint8Array(a),ACL:"public-read",ContentType:"image/png"},n=this.s3Client.send(new ue.w(i)),l=new Promise(((e,t)=>{setTimeout((()=>t(new Error("Upload timeout - การอัปโหลดใช้เวลานานเกินไป"))),3e4)}));return await Promise.race([n,l]),`https://${this.schoolSession.s3Bucket}.sgp1.digitaloceanspaces.com/${r}`}catch(t){throw console.error("S3 Upload error:",t),new Error(`การอัปโหลดล้มเหลว: ${t.message}`)}},async updateAfterUpload(e){this.base64Image=e,this.currentImageUrl=e,this.originalImageUrl=e,this.capturedImageSrc=null,this.crop.enabled=!1,await this.forceRefreshAndFit()},generateFilename(){const e=Date.now();return`${this.filePrefix}_${e}.png`},async fileToBase64(e){return new Promise(((t,s)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=s,a.readAsDataURL(e)}))},async getImageDimensions(e){return new Promise((t=>{const s=new Image;s.onload=()=>{t({width:s.width,height:s.height})},s.src=e}))},async urlToImageData(e){return new Promise(((t,s)=>{const a=new XMLHttpRequest;a.responseType="blob",a.overrideMimeType("image/png"),a.onload=async()=>{try{const e=a.response,s=await this.blobToBase64(e),o=await this.getImageDimensions(s);t({base64Url:s,size:e.size,dimensions:o})}catch(e){s(e)}},a.onerror=()=>s(new Error("Failed to load image")),a.open("GET",e),a.send()}))},async blobToBase64(e){return new Promise(((t,s)=>{const a=new FileReader;a.onload=()=>t(a.result),a.onerror=s,a.readAsDataURL(e)}))},handleError(e,t){console.error(e,t),this.error=e},toggleCrop(){if(this.crop.enabled=!this.crop.enabled,this.crop.enabled){const e=parseInt(this.cropImageWidth)||400,t=parseInt(this.cropImageHeight)||300;this.crop.x=(e-this.crop.width)/2,this.crop.y=(t-this.crop.height)/2}this.clearCapture()},startDrag(e,t="move",s=null){if(!this.crop.enabled)return;e.preventDefault(),e.stopPropagation();const a=this.$refs.imageContainer.getBoundingClientRect(),o=e.clientX||e.touches&&e.touches[0].clientX,r=e.clientY||e.touches&&e.touches[0].clientY;this.drag.startX=o-a.left,this.drag.startY=r-a.top,this.drag.startCropX=this.crop.x,this.drag.startCropY=this.crop.y,this.drag.startCropWidth=this.crop.width,this.drag.startCropHeight=this.crop.height,"resize"===t?(this.drag.isResizing=!0,this.drag.resizeHandle=s):this.drag.isDragging=!0,document.addEventListener("mousemove",this.handleDrag),document.addEventListener("mouseup",this.stopDrag),document.addEventListener("touchmove",this.handleDrag),document.addEventListener("touchend",this.stopDrag)},handleDrag(e){if(!this.drag.isDragging&&!this.drag.isResizing)return;e.preventDefault();const t=this.$refs.imageContainer.getBoundingClientRect(),s=e.clientX||e.touches&&e.touches[0].clientX,a=e.clientY||e.touches&&e.touches[0].clientY,o=s-t.left,r=a-t.top,i=o-this.drag.startX,n=r-this.drag.startY,l=parseInt(this.cropImageWidth)||400,d=parseInt(this.cropImageHeight)||300;if(this.drag.isDragging){let e=this.drag.startCropX+i,t=this.drag.startCropY+n;e=Math.max(0,Math.min(e,l-this.crop.width)),t=Math.max(0,Math.min(t,d-this.crop.height)),this.crop.x=e,this.crop.y=t}else if(this.drag.isResizing){let e=Math.min(this.drag.startCropWidth,this.drag.startCropHeight),t=this.drag.startCropX,s=this.drag.startCropY;const a=this.drag.resizeHandle,o=50;let r=0;r=a.includes("e")||a.includes("w")?Math.abs(i):a.includes("n")||a.includes("s")?Math.abs(n):Math.max(Math.abs(i),Math.abs(n));let c=!1;a.includes("e")&&i>0&&(c=!0),a.includes("w")&&i<0&&(c=!0),a.includes("s")&&n>0&&(c=!0),a.includes("n")&&n<0&&(c=!0),"se"===a&&(i>0||n>0)&&(c=!0),"sw"===a&&(i<0||n>0)&&(c=!0),"ne"===a&&(i>0||n<0)&&(c=!0),"nw"===a&&(i<0||n<0)&&(c=!0),e=c?this.drag.startCropWidth+r:this.drag.startCropWidth-r,e=Math.max(o,e),a.includes("w")&&(t=this.drag.startCropX-(e-this.drag.startCropWidth)),a.includes("n")&&(s=this.drag.startCropY-(e-this.drag.startCropHeight));const u=Math.min(l-t,d-s,l,d);e=Math.min(e,u),t<0&&(e=Math.min(e,e+t),t=0),s<0&&(e=Math.min(e,e+s),s=0),t+e>l&&(e=l-t),s+e>d&&(e=d-s),this.crop.x=t,this.crop.y=s,this.crop.width=e,this.crop.height=e}this.clearCapture()},stopDrag(){this.drag.isDragging=!1,this.drag.isResizing=!1,this.drag.resizeHandle=null,document.removeEventListener("mousemove",this.handleDrag),document.removeEventListener("mouseup",this.stopDrag),document.removeEventListener("touchmove",this.handleDrag),document.removeEventListener("touchend",this.stopDrag)}}},be=s(64621);const xe=(0,be.A)(fe,[["render",le],["__scopeId","data-v-338856f6"]]);var ye=xe},87814:function(e,t,s){"use strict";s.d(t,{A:function(){return A}});var a=s(20641),o=s(90033),r=s(53751);const i={class:"py-2 bg-white border-l border-r border-b border-1 border-gray-200"},n={class:"mx-auto px-2 sm:px-6 lg:px-6 xl:flex xl:items-center xl:justify-between"},l={class:"min-w-0 flex-1"},d={class:"mt-1 text-[18px] font-semibold leading-8 text-gray-700"},c={key:0,class:"text-sm text-gray-500"},u={class:"mt-5 flex xl:mt-0 xl:ml-4"},m={class:"flex items-center space-x-2"},p={class:"text-sm text-gray-400"},g=["onUpdate:modelValue","placeholder","onChange"],h={value:"",disabled:""},f=["value"],b=["onClick"],x={class:"text-sm hidden sm:inline-block ml-1"},y=["onClick"],k={class:"text-sm hidden sm:inline-block ml-1"};function v(e,t,s,v,w,L){const C=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("header",i,[(0,a.Lk)("div",n,[(0,a.Lk)("div",l,[(0,a.Lk)("h1",d,[(0,a.bF)(C,{icon:["fas",this.PageIcon],class:"text-gray-500 text-[18px]"},null,8,["icon"]),(0,a.eW)(" "+(0,o.v_)(s.pageTitle?s.pageTitle:this.PageName),1)]),s.subhead?((0,a.uX)(),(0,a.CE)("p",c,(0,o.v_)(s.subhead),1)):(0,a.Q3)("",!0)]),(0,a.Lk)("div",u,[(0,a.Lk)("div",m,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.navigation,((t,s)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:s},["select"===t.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.Lk)("label",p,(0,o.v_)(t.placeholder),1),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":e=>t.value=e,class:"block w-36 py-2 px-3 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-md",placeholder:t.placeholder,onChange:s=>e.$emit("toggleStatus",t.value)},[(0,a.Lk)("option",h,"-- "+(0,o.v_)(t.placeholder)+" --",1),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.options,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:e.value},(0,o.v_)(e.name),9,f)))),128))],40,g),[[r.u1,t.value]])],64)):"call-function"===t.type?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[!1!==t.visible?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:s=>e.$emit(t.function),type:"button",class:(0,o.C4)(L.getClasses(t.class))},[(0,a.bF)(C,{icon:["fas",`${t.style}`],class:(0,o.C4)({"text-gray-500 mr-2":"icon-btn"===t.class,"text-white":"primary-btn"===t.class})},null,8,["icon","class"]),(0,a.Lk)("span",x,(0,o.v_)(t.name),1)],10,b)):(0,a.Q3)("",!0)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[!1!==t.visible?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e=>L.handleNavigationClick(t),type:"button",class:(0,o.C4)(L.getClasses(t.class))},[(0,a.bF)(C,{icon:["fas",`${t.style}`],class:(0,o.C4)({"text-gray-500 mr-2":"icon-btn"===t.class,"text-white":"primary-btn"===t.class})},null,8,["icon","class"]),(0,a.Lk)("span",k,(0,o.v_)(t.name),1)],10,y)):(0,a.Q3)("",!0)],64))],64)))),128))])])])])}s(44114);var w=s(75220),L=s(52968),C=s(23264),_=s(93426),E={props:{navigation:{type:Array,default:()=>[]},pageTitle:{type:String,default:()=>null},subhead:{type:String,default:()=>null}},data(){const e=(0,w.lq)();return console.log("Translate",(0,_.Tl)("router-"+e.meta.parent+"-"+e.meta.key)),{PageName:(0,_.iX)(),PageIcon:e.meta.icon,PagePath:e.meta.path,ParentName:e.meta.parent,ParentPage:e.meta.page}},setup(){(0,L.K7)((0,_.iX)())},methods:{getClasses(e){const t=(0,C.c)(e);return`${t}`},handleNavigationClick(e){e.function?this.$emit(e.eventName||e.function):this.$router.push(e.link)}}},D=s(64621);const T=(0,D.A)(E,[["render",v]]);var A=T},23199:function(e,t,s){"use strict";s.d(t,{A:function(){return d}});var a=s(20641);const o=["innerHTML"];function r(e,t,s,r,i,n){return(0,a.uX)(),(0,a.CE)("button",{onClick:t[0]||(t[0]=(...e)=>n.copyToClipboard&&n.copyToClipboard(...e)),class:"text-xs"},[(0,a.Lk)("span",{innerHTML:n.buttonTextWithIcon},null,8,o)])}var i={props:{text:{type:String,required:!0},buttonText:{type:String,required:!0},buttonTextDone:{type:String,required:!0}},data(){return{currentButtonText:this.buttonText,clipboardIcon:'<i class="far fa-clipboard"></i>',checkIcon:'<i class="fas fa-check"></i>'}},computed:{buttonTextWithIcon(){return this.currentButtonText===this.buttonText?this.clipboardIcon+" "+this.currentButtonText:this.checkIcon+" "+this.currentButtonText}},methods:{copyToClipboard(){navigator.clipboard.writeText(this.text).then((()=>{this.currentButtonText=this.buttonTextDone,setTimeout((()=>{this.currentButtonText=this.buttonText}),1e3)})).catch((e=>{console.error("Failed to copy: ",e)}))}}},n=s(64621);const l=(0,n.A)(i,[["render",r]]);var d=l},88061:function(e,t,s){"use strict";s(98992),s(8872);var a=s(40475),o=s(77823),r=s(40471);const i=new r.A(!1),n=a.A.get("configs"),l=(e,t="Unknown error")=>{throw console.error(t),e},d={credits:0,apiUrl:"wallet",apiKey:n.key,initialize(e=0){this.credits=e},async api(e,t){try{const s=t?this.apiUrl+t:this.apiUrl,a=t?e:{data:e,options:{}},o=await i.POST(s,a,this.apiKey),r=o.status;if(200===!o.status)throw new Error(`API request failed with status: ${r}`);const n=o.data;return n.status=r,n}catch(s){l(s)}},async adjusts(e,t,s,a){try{const o=await this.balance(e),r=(new Date).toISOString(),n=await i.PUT(`user/${e}`,{data:{point:{active:o,history:{type:t,point:s,date:r,remark:a}}},options:{}},this.apiKey);if(200===n.status)return await this.balance(e),{status:200,message:"Points updated successfully."};throw new Error(`Failed to update user credits via API (${t}).`)}catch(o){return l(o,`Error while updating credits (${t}).`)}},async balance(e){try{if(!e.trim())throw new Error("Please enter a valid member ID.");const t={method:"find",args:[{$and:[{user:e}]}],paging:{page:1,limit:200}},s=await this.api(t,"/query");if(s&&s.data&&s.data.length>0){const e=s.data,t=e.reduce(((e,t)=>"in"===t.type?e+t.point:"out"===t.type?e-t.point:e),0);return this.credits=t,t}throw new Error("No data returned from API.")}catch(t){return l(t,"Error while fetching balance.")}},async deposit(e,t){try{if(this.toast=(0,o.A)({type:"pending",message:"กำลังเพิ่มคะแนน"}),t<=0)throw new Error("Deposit amount must be greater than zero.");const s={user:e,point:t,type:"in",mode:"deposit"},a=await this.api(s);if(200!==a.status)throw new Error("Failed to deposit credits via API.");const r=await this.adjusts(e,"deposit",t);return this.toast.hide("เพิ่มคะแนนเสร็จแล้ว","success",300,(()=>{})),r}catch(s){return l(s,"Error while adding credits.")}},async withdraw(e,t){try{if(this.toast=(0,o.A)({type:"pending",message:"กำลังถอนคะแนน"}),t<=0)throw new Error("Withdrawal amount must be greater than zero.");const s=await this.balance(e);if(t>s)throw new Error("Withdrawal amount exceeds the current credits.");const a={user:e,point:t,type:"out",mode:"withdraw"},r=await this.api(a);if(200!==r.status)throw new Error("Failed to withdraw credits via API.");const i=await this.adjusts(e,"withdraw",t);return this.toast.hide("ถอนคะแนนเสร็จแล้ว","success",300,(()=>{})),i}catch(s){return l(s,"Error while removing credits.")}},async transfer(e,t,s){try{if(this.toast=(0,o.A)({type:"pending",message:"กำลังโอนคะแนน"}),s<=0||!t)throw new Error("Please enter a valid point amount and target member ID.");const a=await this.balance(e);if(s>a)throw new Error("Transfer amount exceeds the current credits.");const r={user:t,point:s,type:"in",mode:"receive",remark:e},i=await this.api(r);if(200!==i.status)throw new Error("Failed to receive credits via API.");await this.adjusts(t,"receive",s,e);const n={user:e,point:s,type:"out",mode:"send",remark:t},l=await this.api(n);if(200!==l.status)throw new Error("Failed to send credits via API.");const d=await this.adjusts(e,"send",s,t);return this.toast.hide("โอนคะแนนเสร็จแล้ว","success",300,(()=>{})),d}catch(a){return l(a,"Error while transferring credits.")}},async transaction(e,t){try{if(!e.trim())throw new Error("Please enter a valid member ID.");const s={method:"find",args:[{$and:[{user:e}]}],paging:{page:1,limit:t},sort:{createdAt:-1}},a=await this.api(s,"/query");if(a&&a.data&&a.data.length>0)return(0,o.A)({type:"success",message:"Get Transaction Success",autohide:!0}),a.data;throw new Error("No transaction log data returned from API.")}catch(s){return l(s,"Error while fetching transaction log.")}},async reset(e){try{this.toast=(0,o.A)({type:"pending",message:"กำลังรีเซ็ตคะแนน"});const t=await this.balance(e),s={user:e,point:t,type:"out",mode:"reset"},a=await this.api(s);if(200===a.status){this.credits=0;const s=await this.adjusts(e,"reset",t);return this.toast.hide("รีเซ็ตคะแนนเสร็จแล้ว","success",300,(()=>{})),s}throw new Error("Failed to reset credits via API.")}catch(t){return l(t,"Error while resetting credits.")}}};t.A=d},94614:function(e,t,s){"use strict";function a(e){if(e?.post?.has){if(null!==e.post.score&&null!==e.post.measure&&e.post.score>=e.post.measure)return!0;if(null!==e.post.score&&null!==e.post.measure&&e.post.score<e.post.measure)return!!e.retest?.has&&(null!==e.retest.score&&null!==e.retest.measure&&e.retest.score>=e.retest.measure)}return!1}function o(e){return e.complete===e.total}s.d(t,{E:function(){return a},l:function(){return o}})},23264:function(e,t,s){"use strict";function a(e){switch(e){case"input-plaintext":return"pl-0 focus:outline-none focus:ring-0 shadow-none border-0";case"primary-btn":return"px-4 py-2 text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"icon-btn":return"px-4 py-2 text-gray-700 bg-transparent hover:bg-transparent hover:text-gray-800";case"default-btn":return"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"danger-btn":return"px-4 py-2 text-white bg-red-600 rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"success-btn":return"px-4 py-2 text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-50";default:return""}}s.d(t,{c:function(){return a}})},87596:function(e,t,s){var a={"./Single-DOA.vue":42992,"./Single-SACRED.vue":44196,"./Single-STD.vue":24743,"./Single.vue":21605};function o(e){var t=r(e);return s(t)}function r(e){if(!s.o(a,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return a[e]}o.keys=function(){return Object.keys(a)},o.resolve=r,e.exports=o,o.id=87596}}]);
//# sourceMappingURL=7596.951f43b4.js.map