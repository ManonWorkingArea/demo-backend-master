"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[7949],{31359:function(e,t,o){o.r(t),o.d(t,{default:function(){return L}});var s=o(20641),n=o(90033),a=o(53751);const i={class:"bg-gray-50"},r={class:"flex min-h-full flex-col justify-center py-12 sm:px-6 lg:px-8"},l={class:"sm:mx-auto sm:w-full sm:max-w-lg"},c=["src"],d={class:"mt-2 text-center text-sm text-gray-600"},u={class:"bg-white px-4 py-8 shadow sm:rounded-lg sm:px-10"},m={class:"relative mt-2"},g={key:0,class:"col-span-2"},f={class:"items-center px-3 py-1 rounded-md bg-red-100 text-sm text-black pb-5 mb-5"},p={class:"w-full"},b=["disabled"];function h(e,t,o,h,x,y){const v=(0,s.g2)("router-link"),k=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("div",r,[(0,s.Lk)("div",l,[this.showModal?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("img",{key:0,class:"mx-auto h-16 w-auto",src:this.config.siteLogo,alt:"Your Company"},null,8,c)),t[4]||(t[4]=(0,s.Lk)("h2",{class:"mt-6 text-center text-2xl font-bold tracking-tight text-gray-900"},"ลืมรหัสผ่าน",-1)),(0,s.Lk)("p",d,[t[3]||(t[3]=(0,s.eW)(" หรือ ")),(0,s.bF)(v,{to:"/user/register",class:"font-medium text-indigo-600 hover:text-indigo-500"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" ลงทะเบียนสมาชิกใหม่ ")]))),_:1})])]),(0,s.Lk)("div",{class:(0,n.C4)(["mt-8 sm:mx-auto sm:w-full sm:max-w-md relative",[e.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},[(0,s.Lk)("div",u,[(0,s.Lk)("form",{class:"space-y-6",onSubmit:t[1]||(t[1]=(0,a.D$)(((...e)=>y.resetPassword&&y.resetPassword(...e)),["prevent"]))},[(0,s.Lk)("div",null,[(0,s.Lk)("div",m,[t[5]||(t[5]=(0,s.Lk)("span",{class:"input-label"},[(0,s.eW)("อีเมล์ที่ลงทะเบียน "),(0,s.Lk)("small",{class:"text-red-400"},"(*จำเป็นต้องกรอก)")],-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>x.email=e),type:"text",placeholder:"อีเมล์ที่ลงทะเบียน",class:"w-full p-4 border border-gray-200 text-sm"},null,512),[[a.Jo,x.email]])])]),t[8]||(t[8]=(0,s.Lk)("div",null,[(0,s.Lk)("strong",null,"*หมายเหตุ*"),(0,s.Lk)("br"),(0,s.eW)(' กรอกเลขที่บัตรประชาชนที่ลงทะเบียนไว้ในระบบ หลังจากคลิ๊ก "ตั้งค่ารหัสผ่าน" เรียบร้อยแล้ว ระบบจะทำการสร้างรหัสผ่านเป็นเบอร์โทรที่ลงทะเบียนไว้ในระบบ หากจำเบอร์โทรไม่ได้ กรุณาแจ้งทีมงานที่ @doacer ')],-1)),(0,s.Lk)("div",null,[x.errorStage?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("div",f,[t[6]||(t[6]=(0,s.Lk)("div",{class:"font-semibold pt-3 pb-3"},"เกิดข้อผิดพลาด",-1)),(0,s.Lk)("div",p,(0,n.v_)(x.errorMessage),1)])])):(0,s.Q3)("",!0),(0,s.Lk)("button",{type:"submit",disabled:e.buttonDisabled,class:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-4 text-md font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[(0,s.bF)(k,{icon:["fas","refresh"],class:"mr-2"}),(0,s.eW)(" "+(0,n.v_)(x.buttonText),1)],8,b),(0,s.bF)(v,{to:"/user/login",class:"flex w-full justify-center rounded-md bg-gray-300 text-md font-semibold text-gray-700 shadow-sm hover:bg-gray-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600 mt-4 py-2"},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)(" ย้อนกลับ ")]))),_:1})])],32)])],2)])])}o(44114);var x=o(40475),y=o(25747),v={name:"Login",components:{},props:{showModal:{type:Boolean,default:!1}},data(){return{config:x.A.get("configs"),email:"",errorStage:!1,errorMessage:"",buttonText:"ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่"}},methods:{async resetPassword(){try{if(!this.email)return this.errorStage=!0,this.errorMessage="โปรดกรอกอีเมล์",void(this.activeBlock=!1);this.activeBlock=!0,this.errorStage=!1,this.buttonText="กำลังดำเนินการ...";const e=await fetch("https://gateway.cloudrestfulapi.com/api/user/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.config.key},body:JSON.stringify({method:"find",args:[{$and:[{email:this.email}]}]})}),t=await e.json();console.log(t);const o=t.length>0?t[0]:null;if(!t||0===t.length)return this.errorStage=!0,this.errorMessage="ไม่พบอีเมล์นี้ในระบบ กรุณาตรวจสอบหรือติดต่อทีมงาน",this.activeBlock=!1,this.buttonText="ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่",void(this.buttonDisabled=!1);{const e={email:o.email,name:o.firstname+""+o.lastname};await(0,y.Z)(e,"reset-password"),this.$swal({icon:"success",title:"การรีเซ็ตรหัสผ่านใหม่เรียบร้อยแล้ว",text:"ระบบได้ทำการรีเซ็ตและจัดส่งรหัสผ่านใหม่ให้ทางอีเมล์แล้ว กรุณาตรวจสอบอีเมล์และเข้าสู่ระบบด้วยวรหัสผ่านใหม่ เมื่อเข้าสู่ระบบครั้งแรก กรุณาเปลี่ยนรหัสผ่านใหม่อีกครั้งเพื่อความปลอดภัย",showCancelButton:!1,confirmButtonText:"ตกลง"}).then((()=>{this.$router.push("/user/login")}))}this.activeBlock=!1}catch(e){console.log(e),this.buttonText="ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่",this.buttonDisabled=!1}}}},k=o(64621);const w=(0,k.A)(v,[["render",h],["__scopeId","data-v-0d07628c"]]);var L=w},86539:function(e,t,o){o.r(t),o.d(t,{default:function(){return L}});var s=o(20641),n=o(90033),a=o(53751);const i={class:"bg-gray-50"},r={class:"flex min-h-full flex-col justify-center py-12 sm:px-6 lg:px-8"},l={class:"sm:mx-auto sm:w-full sm:max-w-lg"},c=["src"],d={class:"mt-2 text-center text-sm text-gray-600"},u={class:"bg-white px-4 py-8 shadow sm:rounded-lg sm:px-10"},m={class:"relative mt-2"},g={key:0,class:"col-span-2"},f={class:"items-center px-3 py-1 rounded-md bg-red-100 text-sm text-black pb-5 mb-5"},p={class:"w-full"},b=["disabled"];function h(e,t,o,h,x,y){const v=(0,s.g2)("router-link"),k=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("div",i,[(0,s.Lk)("div",r,[(0,s.Lk)("div",l,[this.showModal?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("img",{key:0,class:"mx-auto h-16 w-auto",src:this.config.siteLogo,alt:"Your Company"},null,8,c)),t[4]||(t[4]=(0,s.Lk)("h2",{class:"mt-6 text-center text-2xl font-bold tracking-tight text-gray-900"},"ลืมรหัสผ่าน",-1)),(0,s.Lk)("p",d,[t[3]||(t[3]=(0,s.eW)(" หรือ ")),(0,s.bF)(v,{to:"/user/register",class:"font-medium text-indigo-600 hover:text-indigo-500"},{default:(0,s.k6)((()=>t[2]||(t[2]=[(0,s.eW)(" ลงทะเบียนสมาชิกใหม่ ")]))),_:1})])]),(0,s.Lk)("div",{class:(0,n.C4)(["mt-8 sm:mx-auto sm:w-full sm:max-w-md relative",[e.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},[(0,s.Lk)("div",u,[(0,s.Lk)("form",{class:"space-y-6",onSubmit:t[1]||(t[1]=(0,a.D$)(((...e)=>y.resetPassword&&y.resetPassword(...e)),["prevent"]))},[(0,s.Lk)("div",null,[(0,s.Lk)("div",m,[t[5]||(t[5]=(0,s.Lk)("span",{class:"input-label"},[(0,s.eW)("อีเมล์ที่ลงทะเบียน "),(0,s.Lk)("small",{class:"text-red-400"},"(*จำเป็นต้องกรอก)")],-1)),(0,s.bo)((0,s.Lk)("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>x.email=e),type:"text",placeholder:"อีเมล์ที่ลงทะเบียน",class:"w-full p-4 border border-gray-200 text-sm"},null,512),[[a.Jo,x.email]])])]),t[8]||(t[8]=(0,s.Lk)("div",null,[(0,s.Lk)("strong",null,"*หมายเหตุ*"),(0,s.Lk)("br"),(0,s.eW)(' กรอกเลขที่บัตรประชาชนที่ลงทะเบียนไว้ในระบบ หลังจากคลิ๊ก "ตั้งค่ารหัสผ่าน" เรียบร้อยแล้ว ระบบจะทำการสร้างรหัสผ่านเป็นเบอร์โทรที่ลงทะเบียนไว้ในระบบ หากจำเบอร์โทรไม่ได้ กรุณาแจ้งทีมงานที่ @thesacredTH ')],-1)),(0,s.Lk)("div",null,[x.errorStage?((0,s.uX)(),(0,s.CE)("div",g,[(0,s.Lk)("div",f,[t[6]||(t[6]=(0,s.Lk)("div",{class:"font-semibold pt-3 pb-3"},"เกิดข้อผิดพลาด",-1)),(0,s.Lk)("div",p,(0,n.v_)(x.errorMessage),1)])])):(0,s.Q3)("",!0),(0,s.Lk)("button",{type:"submit",disabled:e.buttonDisabled,class:"flex w-full justify-center rounded-md bg-indigo-600 px-3 py-4 text-md font-semibold text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600"},[(0,s.bF)(k,{icon:["fas","refresh"],class:"mr-2"}),(0,s.eW)(" "+(0,n.v_)(x.buttonText),1)],8,b),(0,s.bF)(v,{to:"/user/login",class:"flex w-full justify-center rounded-md bg-gray-300 text-md font-semibold text-gray-700 shadow-sm hover:bg-gray-400 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-gray-600 mt-4 py-2"},{default:(0,s.k6)((()=>t[7]||(t[7]=[(0,s.eW)(" ย้อนกลับ ")]))),_:1})])],32)])],2)])])}o(44114);var x=o(40475),y=o(25747),v={name:"Login",components:{},props:{showModal:{type:Boolean,default:!1}},data(){return{config:x.A.get("configs"),email:"",errorStage:!1,errorMessage:"",buttonText:"ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่"}},methods:{async resetPassword(){try{if(!this.email)return this.errorStage=!0,this.errorMessage="โปรดกรอกอีเมล์",void(this.activeBlock=!1);this.activeBlock=!0,this.errorStage=!1,this.buttonText="กำลังดำเนินการ...";const e=await fetch("https://gateway.cloudrestfulapi.com/api/user/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.config.key},body:JSON.stringify({method:"find",args:[{$and:[{email:this.email}]}]})}),t=await e.json();console.log(t);const o=t.length>0?t[0]:null;if(!t||0===t.length)return this.errorStage=!0,this.errorMessage="ไม่พบอีเมล์นี้ในระบบ กรุณาตรวจสอบหรือติดต่อทีมงาน",this.activeBlock=!1,this.buttonText="ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่",void(this.buttonDisabled=!1);{const e={email:o.email,name:o.firstname+""+o.lastname};await(0,y.Z)(e,"reset-password"),this.$swal({icon:"success",title:"การรีเซ็ตรหัสผ่านใหม่เรียบร้อยแล้ว",text:"ระบบได้ทำการรีเซ็ตและจัดส่งรหัสผ่านใหม่ให้ทางอีเมล์แล้ว กรุณาตรวจสอบอีเมล์และเข้าสู่ระบบด้วยวรหัสผ่านใหม่ เมื่อเข้าสู่ระบบครั้งแรก กรุณาเปลี่ยนรหัสผ่านใหม่อีกครั้งเพื่อความปลอดภัย",showCancelButton:!1,confirmButtonText:"ตกลง"}).then((()=>{this.$router.push("/user/login")}))}this.activeBlock=!1}catch(e){console.log(e),this.buttonText="ส่งข้อมูลเพื่อขอรับรหัสผ่านใหม่",this.buttonDisabled=!1}}}},k=o(64621);const w=(0,k.A)(v,[["render",h],["__scopeId","data-v-9684051a"]]);var L=w},25747:function(e,t,o){o.d(t,{Z:function(){return m}});var s=o(40475);const n=`\n<!DOCTYPE html>\n<html lang="en">\n<head>\n  <meta charset="UTF-8">\n  <meta name="viewport" content="width=device-width, initial-scale=1.0">\n  <title>Email Template</title>\n  <style>\n    /* Add your custom CSS styles here */\n    /* For example: */\n    * {\n      margin: 0;\n      padding: 0;\n      box-sizing: border-box;\n      text-align: center;\n    }\n    body {\n      font-family: Arial, sans-serif;\n      line-height: 1.5;\n      background-color: #f2f2f2;\n      color: #ffffff;\n    }\n    .container {\n      max-width: 600px;\n      margin: 0px auto;\n      padding: 20px;\n      background-color: #ffffff;\n      border-radius: 5px;\n      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\n    }\n    .header {\n      text-align: center;\n      margin-bottom: 20px;\n    }\n    .header img {\n      max-width: 150px;\n      height: auto;\n    }\n    .content {\n      padding: 20px;\n      border-top: 1px solid #e6e6e6;\n      border-bottom: 1px solid #e6e6e6;\n    }\n    .heading {\n      font-size: 18px;\n      margin-bottom: 20px;\n      color: #000000;\n      text-align: center;\n    }\n    .text {\n      margin-bottom: 20px;\n      color: #000000;\n      text-align: left;\n      font-size: 16px;\n    }\n    .container p {\n      margin-bottom: 20px;\n      color: #000000;\n      text-align: left;\n      font-size: 16px;\n    }\n    .text p {\n      margin-bottom: 20px;\n      color: #000000;\n      text-align: left;\n      font-size: 16px;\n    }\n    .footer {\n      text-align: center;\n      margin-top: 20px;\n      color: #888888;\n      font-size: 14px;\n    }\n    .footer a {\n      color: #888888;\n      text-decoration: none;\n      transition: color 0.3s ease;\n    }\n    .footer a:hover {\n      color: #ffffff;\n    }\n  </style>\n</head>\n<body>\n  <div class="container" style="margin-top:20px;">\n    <div class="header">\n      <img src="https://vue-project.sgp1.digitaloceanspaces.com/Logo/color-logopng.png" alt="Logo">\n    </div>\n    <div class="content">\n      <h2 class="heading">{{ subject }}</h2>\n      <p class="text">{{ content }}</p>\n    </div>\n    <div class="footer">\n      &copy; ${(new Date).getFullYear()} {{ provider }}. All rights reserved.</a>\n    </div>\n  </div>\n</body>\n</html>\n`;var a=o(21396),i=o.n(a),r=o(40471);const l=new r.A(!1),c="https://gateway.cloudrestfulapi.com/email/send",d=s.A.get("session"),u=s.A.get("configs");async function m(e,t=""){let o;"frontend"===d.interface?({email_provider:o}=u):({email_provider:o}=d.current);const{name:s,email:a,subject:i,body:r}=e;try{let d,m;"welcome"===t?({emailBody:d,emailSubject:m}=b(e)):"reset-password"===t?({emailBody:d,emailSubject:m}=await x(e)):"change-password"===t?({emailBody:d,emailSubject:m}=await h(e)):"new-template"===t?({emailBody:d,emailSubject:m}=p(e)):(d=r,m=i),d=n.replace("{{ content }}",d).replace("{{ subject }}",m).replace("{{ provider }}",o);const y=await g(s,a,m,d),v=await l.POST(c,{subject:m,text:d,html:d,fromEmail:"noreply@fti.academy",fromName:"Academy Customer Support",toEmail:a,toName:s},u.key);if(200===v.status){const e=v.data;return console.log(e.message),await f(y._id,"confirm"),e}{console.log("Failed to send email");const e="Failed to send email";return await f(y._id,"fail",e),e}}catch(m){return console.error("Error sending email:",m),m.message}}async function g(e,t,o,s){try{const n={data:{name:e,email:t,subject:o,body:s,status:"submit"},options:{fieldType:[],uniqueFields:[]}},{status:a,data:i}=await l.POST("message/",n,u.key);return 200===a?(console.log("Email data recorded successfully"),i):"Failed to record email data"}catch(n){return console.error("Error recording email data:",n),n.message}}async function f(e,t,o=""){try{const s={data:{status:t,error:o}},{status:n}=await l.PUT(`message/${e}`,s,u.key);if(200!==n)return"Failed to update email status";console.log("Email status updated successfully")}catch(o){return console.error("Error updating email status:",o),o.message}}function p(e){const t=`Hello ${e.name},\n\nThis is your custom email body.\n\nYour custom data: ${e.content}`,o="Custom Email";return{emailBody:t,emailSubject:o}}function b(){const e="Welcome to our website!",t="Welcome Email";return{emailBody:e,emailSubject:t}}function h(){const e="\n  <p>สวัสดีค่ะ,</p>\n  <p>ขอแจ้งให้ทราบว่าบัญชีของคุณได้รับการเปลี่ยนแปลงรหัสผ่านเรียบร้อยแล้วค่ะ</p>\n  <p>หากคุณไม่ได้ดำเนินการเปลี่ยนรหัสผ่านนี้ กรุณาติดต่อทีมงานเพื่อรายงานให้ทราบค่ะ</p></br></br>\n  <p>ขอบคุณค่ะ</p>\n  ",t="แจ้งเตือน: บัญชีของคุณได้รับการเปลี่ยนรหัสผ่าน";return{emailBody:e,emailSubject:t}}async function x(e){try{const o={method:"find",args:[{$and:[{email:e.email}]}]},{data:s}=await l.POST("user/query",o,u.key);if(s.length>0){const e=y(6),o=i().lib.WordArray.random(16),n=i().SHA256(e+o).toString();try{const e={data:{password:n,salt:o.toString(),req_reset:!0}},{status:t}=await l.PUT(`user/${s[0]._id}`,e,u.key);if(200!==t)return"Failed to update email status";console.log("Email status updated successfully")}catch(t){return console.error("Error updating email status:",t),t.message}const a="แจ้งเตือน: รีเซ็ตรหัสผ่าน",r=`\n        <p>สวัสดีค่ะ,</p>\n        <p>ขอแจ้งให้ทราบว่าบัญชีของคุณได้รับการเปลี่ยนแปลงรหัสผ่านเรียบร้อยแล้วค่ะ</p>\n        <p>รหัสผ่านใหม่ของคุณคือ: <strong>${e}</strong></p>\n        <p>โปรดจำรหัสผ่านใหม่นี้ไว้เพื่อเข้าสู่ระบบในครั้งถัดไปค่ะ</p>\n        <p>หากคุณไม่ได้ดำเนินการเปลี่ยนรหัสผ่านนี้ กรุณาติดต่อทีมงานเพื่อรายงานให้ทราบค่ะ</p></br></br>\n        <p>ขอบคุณค่ะ</p>\n      `;return{emailBody:r,emailSubject:a}}return console.log("No User"),"User not found"}catch(t){return console.error("Error retrieving user information:",t),t.message}}function y(e){const t="0123456789";let o="";for(let s=0;s<e;s++){const e=Math.floor(Math.random()*t.length);o+=t[e]}return o}}}]);
//# sourceMappingURL=7949.0e02165c.js.map