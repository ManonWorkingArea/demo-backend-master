"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[8158],{68158:function(e,t,a){a.r(t),a.d(t,{default:function(){return ie}});var s=a(20641);function o(e,t,a,o,r,n){return(0,s.uX)(),(0,s.Wv)((0,s.$y)(n.componentName))}var r=a(52968),n=a(75220),i=a(40475);function d(e,t){return(0,s.uX)(),(0,s.CE)("div")}var l=a(64621);const c={},u=(0,l.A)(c,[["render",d]]);var m=u,g=a(90033);const p={key:0,class:"bg-gray-100",id:"payment_slip"},f={class:"bg-gray-100 py-6"},b={class:"mx-auto sm:w-2/6 w-full p-3 grid grid-cols-2 gap-4"},h={class:"col-span-1 pt-2 text-sm text-right"},k={class:"flex pt-2 pb-2 justify-content-between align-items-center"},y={class:"text-xl font-semibold text-gray-800 mb-3"},v={key:0,class:"mb-0 ml-auto"},x={class:"p-1 pl-2 pr-2 text-sm rounded-md bg-indigo-600 text-white"},L={class:"rounded-md border border-gray-200"},D={class:"mb-2 p-3 border-b border-gray-200"},w={class:"flex justify-between pt-2 text-gray-900"},C={class:"text-sm"},$={key:0},_={key:1,class:"text-gray-500 mt-1"},A={class:"mb-2 p-3 border-b border-gray-200"},I={class:"flex justify-between pt-2 text-gray-900"},P={class:"text-sm"},E={key:0},j={key:1},Q={class:"mb-2 p-3 border-b border-gray-200"},T={class:"flex justify-between pt-2 text-gray-600"},M={class:"text-sm"},R={class:"font-bold"},F={class:"flex justify-between text-gray-600"},W={class:"text-sm"},X={class:"font-bold"},B={class:"mb-2 p-3 pt-1 border-b border-gray-200"},S={class:""},O={class:"flex justify-between text-gray-900"},q={class:"text-base font-bold"},U={class:"mb-2 p-3 border-b border-gray-200"},V={class:"flex items-center justify-center mb-4"},z=["src"],N={class:"mt-2 mb-2 pt-2 text-center border-t border-gray-200"};function G(e,t,a,o,r,n){const i=(0,s.g2)("font-awesome-icon");return r.formattedData&&r.formattedData.data?((0,s.uX)(),(0,s.CE)("div",p,[(0,s.Lk)("div",f,[(0,s.Lk)("div",b,[t[4]||(t[4]=(0,s.Lk)("div",{class:"col-span-1"},[(0,s.Lk)("img",{src:"https://vue-project.sgp1.digitaloceanspaces.com/Logo/color-logopng.png",class:"relative",style:{width:"120px"}})],-1)),(0,s.Lk)("div",h,[t[1]||(t[1]=(0,s.Lk)("strong",null,"Code",-1)),(0,s.eW)(" : "+(0,g.v_)(r.order._id),1),t[2]||(t[2]=(0,s.Lk)("br",null,null,-1)),t[3]||(t[3]=(0,s.Lk)("strong",null,"Date",-1)),(0,s.eW)(" : "+(0,g.v_)(n.formatThaidate(r.formattedData.data.order.createdAt)),1)])]),(0,s.Lk)("div",{class:(0,g.C4)(["mx-auto sm:w-2/6 w-full bg-white p-3 rounded-lg shadow-md relative",[r.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},[(0,s.Lk)("div",k,[(0,s.Lk)("h2",y,[(0,s.bF)(i,{icon:["fas","shopping-bag"]}),t[5]||(t[5]=(0,s.eW)(" ชำระเงิน "))]),r.formattedData.data.order?((0,s.uX)(),(0,s.CE)("div",v,[(0,s.Lk)("span",x,(0,g.v_)(r.formattedData.data.order.status),1)])):(0,s.Q3)("",!0)]),(0,s.Lk)("div",L,[(0,s.Lk)("div",D,[t[6]||(t[6]=(0,s.Lk)("h2",{class:"text-md font-bold text-indigo-800"},"รายละเอียดการสั่งซื้อ",-1)),(0,s.Lk)("div",w,[(0,s.Lk)("dt",C,[r.formattedData.data.course?((0,s.uX)(),(0,s.CE)("p",$,(0,g.v_)(r.formattedData.data.course.name),1)):(0,s.Q3)("",!0),r.formattedData.data.order?((0,s.uX)(),(0,s.CE)("p",_,(0,g.v_)(n.formatThaidate(r.formattedData.data.order.createdAt)),1)):(0,s.Q3)("",!0)])])]),(0,s.Lk)("div",A,[t[7]||(t[7]=(0,s.Lk)("h2",{class:"text-md font-bold text-indigo-800"},"ผู้สั่งซื้อ",-1)),(0,s.Lk)("div",I,[(0,s.Lk)("dt",P,[r.formattedData.data.user?((0,s.uX)(),(0,s.CE)("p",E,(0,g.v_)(r.formattedData.data.user.firstname)+" "+(0,g.v_)(r.formattedData.data.user.lastname),1)):(0,s.Q3)("",!0),r.formattedData.data.user?((0,s.uX)(),(0,s.CE)("p",j,(0,g.v_)(r.formattedData.data.user.phone)+" "+(0,g.v_)(r.formattedData.data.user.email),1)):(0,s.Q3)("",!0)])])]),(0,s.Lk)("div",Q,[t[10]||(t[10]=(0,s.Lk)("h2",{class:"text-md font-bold text-indigo-800"},"ข้อมูลการชำระเงิน",-1)),(0,s.Lk)("div",T,[(0,s.Lk)("dt",M,[t[8]||(t[8]=(0,s.eW)("Ref1 : ")),(0,s.Lk)("span",R,(0,g.v_)(r.order.ref1),1)])]),(0,s.Lk)("div",F,[(0,s.Lk)("dt",W,[t[9]||(t[9]=(0,s.eW)("Ref2 : ")),(0,s.Lk)("span",X,(0,g.v_)(r.order.ref2),1)])])]),(0,s.Lk)("div",B,[(0,s.Lk)("div",S,[(0,s.Lk)("div",O,[t[11]||(t[11]=(0,s.Lk)("dt",{class:"text-base"},"ยอดชำระรวม",-1)),(0,s.Lk)("dd",q,(0,g.v_)(r.order.price)+" ฿",1)])])]),(0,s.Lk)("div",U,[(0,s.Lk)("div",V,[this.formattedData?((0,s.uX)(),(0,s.CE)("img",{key:0,src:n.generateQRCodeUrl(),alt:"QR Code",class:"w-32 h-32"},null,8,z)):(0,s.Q3)("",!0)])]),t[13]||(t[13]=(0,s.Fv)('<div class="mb-2 p-3"><h2 class="text-md font-bold text-indigo-800">ช่องทางการชำระเงิน</h2><div class="space-y-2"><span class="text-red-500 font-bold block">กรุณาส่งหลักฐานการชำระเงินมาที่ @doacer</span><span class="text-red-500 block pb-5">ห้ามนำ QR Code ของผู้อื่นมาชำระเงิน</span><span class="text-gray-600"> - ชำระเงินผ่านตู้ ATM,Mobile application ด้วยวิธีการสแกน QR Code จากใบแจ้งชำระเงิน ที่พิมพ์ออกมาหรือที่ปรากฏในจออุปกรณ์ที่ใช้งานเท่านั้น<br> - กรุณาเก็บหลักฐานการชำระเงิน (Slip) เอาไว้สำหรับใช้อ้างอิง ในกรณีที่เกิดปัญหาในการตรวจสอบข้อมูล<br> - ใช้เวลาในการตรวจสอบยอดการชำระประมาณ 2 วันทำการ ระบบจะแจ้งเตือนอีกครั้งเมื่อการชำระเงินได้รับการอนุมัติ<br></span></div></div>',1)),(0,s.Lk)("div",N,[(0,s.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>n.backCourse&&n.backCourse(...e)),class:"bg-black hover:bg-gray-700 text-white py-3 px-6 rounded-md font-semibold focus:outline-none focus:ring focus:border-indigo-700"},[(0,s.bF)(i,{icon:["fas","check-circle"]}),t[12]||(t[12]=(0,s.eW)(" ย้อนกลับ "))])])])],2)])])):(0,s.Q3)("",!0)}a(44114),a(98992),a(72577),a(37550);var K=a(20354),H=a.n(K),J=a(9964),Y=a(57313),Z=a(40471);const ee=new Z.A(!1),te=[{name:"pending",label:"รอเรียน",styleClass:"bg-gray-300 text-gray-600",icon:"hourglass-start"},{name:"processing",label:"กำลังเรียน",styleClass:"bg-yellow-300 text-yellow-800",icon:"spinner"},{name:"complete",label:"เรียนจบแล้ว",styleClass:"bg-green-300 text-green-800",icon:"check"}];var ae={name:"Lesson Detail",components:{},data(){return{defaultCoverUrl:"https://vue-project.sgp1.digitaloceanspaces.com/default-coverjpg.jpg",uniqueVisitors:null,pageViewsPerDay:null,pageViewsPerWeek:null,pageViewsPerMonth:null,activeBlock:!1,login:i.A.get("session","login"),configs:i.A.get("configs"),session:i.A.get("session"),dataItem:this.$route.params.id,enroll:i.A.get("session","enroll"),deviceType:Y.A.deviceDetect(),lesson:[],order:[],paymentMethods:[{code:"bill_payment",name:"Bill Payment",description:"ชำระผ่าน QR Code (อนุมัติ 1-2 วันทำการ)"},{code:"transfer",name:"Bank Transfer",description:"โอนเงินเข้าบัญชีธนาคาร (อนุมัติ 2-4 วันทำการ)"}],selectedPaymentMethod:"bill_payment",showCustomerData:!1,firstname:"",lastname:"",phone:"",email:"",address:"",province:"",zipcode:"",limitItem:100,limitOptions:[1,10,50,100,200,500,1e3,2e3,3e3,4e3],currentPage:1,totalPages:0,totalItems:0,formattedData:[]}},methods:{async captureAndDownloadImage(){const e=document.getElementById("payment_slip");if(e)try{await new Promise((e=>setTimeout(e,1e3)));const t=await H()(e),a=t.toDataURL("image/png"),s=document.createElement("a");s.href=a,s.download="captured_image.png",s.click()}catch(t){console.error("Error capturing or downloading image:",t)}else console.error("Target element not found.")},backCourse(){this.$router.push("/user/profile")},formatThaidate(e){return J.A.toThaiDatetime(e,"short")},generateQRCodeUrl(){if(this.order&&void 0!==this.order.price&&null!==this.order.price){const e=String(this.order.price).padEnd(5,"0");return`https://qrcode.tec-it.com/API/QRCode?data=%7c099300013225402%0a${this.order.ref1}%0a${this.order.ref2}%0a${e}&backcolor=%23ffffff`}return"default_qr_code_url_here"},selectPaymentMethod(e){this.selectedPaymentMethod=this.paymentMethods[e].name},handleLoginSuccess(){console.log("Login Success")},getStatus(e){const t=te.find((t=>t.name===e));return t?`<p class="inline-flex rounded-full px-2 text-xs font-semibold leading-5 capitalize ${t.styleClass}">\n                <i class="fa fa-${t.icon} mr-1 mt-1"></i>${t.label}\n                </p>`:""},checkExam(e){return this.exam.some((t=>t.type===e))},formatSeconds(e){return J.A.secondsToTime(e)},formatPrice(e,t){return J.A.formatPrice(e,t)},finalPrice(e,t){const a=t||e;return a},async getData(){try{this.loading_sources=!1;const e=await ee.GET(`order/${this.dataItem}`,this.configs.key),t=e.data;200===e.status&&(this.order=t,await this.getAllData())}catch(e){console.log(e)}},async getAllData(){try{const e={_id:this.dataItem},t=[{$match:e},{$set:{userID:{$toObjectId:"$userID"},courseID:{$toObjectId:"$courseID"}}},{$lookup:{from:"user",localField:"userID",foreignField:"_id",as:"user"}},{$unwind:"$user"},{$lookup:{from:"course",localField:"courseID",foreignField:"_id",as:"course"}},{$unwind:"$course"},{$facet:{paginatedData:[{$skip:0},{$limit:1},{$project:{order:"$$ROOT",user:"$user",course:"$course"}}],totalCount:[{$count:"count"}]}}],a=await ee.POST("order/aggregate",{pipeline:t},this.configs.key),s=a.data;if(s){const e=s[0].paginatedData[0],t=s[0].totalCount[0].count;this.formattedData={data:{order:e.order,course:e.course,user:e.user},total:t,paging:{page:this.currentPage,limit:this.limitItem,totalPages:Math.ceil(t/this.limitItem)}},console.log("formattedData",this.formattedData)}}catch(e){console.log(e)}finally{this.loading=!1,this.activeBlock=!1}}},async mounted(){try{await this.getData()}catch(e){console.log(Error)}},setup(){},computed:{loggedInComputed(){const e=i.A.get("session","login"),t=i.A.get("session","enroll");return e?{enrollAccess(e){if(!t||0===t.length)return!1;const a=t.find((t=>t.courseID===e));return!!a}}:{enrollAccess(){return!1}}}}};const se=(0,l.A)(ae,[["render",G]]);var oe=se,re={name:"Lesson Payment",components:{Backend:m,Frontend:oe},data(){return{session:i.A.get("session")}},setup(){const e=(0,n.lq)(),t=e.meta.title;(0,r.K7)(t)},computed:{componentName(){return"backend"===this.session.interface?"Backend":"frontend"===this.session.interface?"Frontend":(console.error("Invalid interface:",this.session.interface),null)}}};const ne=(0,l.A)(re,[["render",o]]);var ie=ne},57313:function(e,t){class a{isMobile(){return window.innerWidth<=768}deviceDetect(){return this.isMobile()?"mobile":"desktop"}}const s=new a;t.A=s}}]);
//# sourceMappingURL=8158.f655eac5.js.map