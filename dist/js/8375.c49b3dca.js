"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[8375],{28375:function(t,e,n){n.r(e),n.d(e,{default:function(){return C}});var r=n(20641);function i(t,e,n,i,o,s){const l=(0,r.g2)("Edit");return this.login?((0,r.uX)(),(0,r.Wv)(l,{key:0})):(0,r.Q3)("",!0)}var o=n(52968),s=n(75220),l=n(53751),a=n(90033);const u={class:"bg-white border-b border-gray-200"},c={class:"mx-auto max-w-3xl px-4 sm:px-6 lg:max-w-7xl lg:px-8"},d={class:"pt-3"},f={key:1,class:"table mt-3"},h=["onClick"],g={key:2},p={key:3,class:"pagination-controls"},m=["disabled"],v=["disabled"];function k(t,e,n,i,o,s){return(0,r.uX)(),(0,r.CE)("div",u,[(0,r.Lk)("div",c,[(0,r.Lk)("div",d,[e[9]||(e[9]=(0,r.Lk)("label",{for:"pageInput"},"Page: ",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"pageInput","onUpdate:modelValue":e[0]||(e[0]=t=>o.currentPage=t),placeholder:"Enter page number",min:"1",onChange:e[1]||(e[1]=(...t)=>s.getEnrollments&&s.getEnrollments(...t))},null,544),[[l.Jo,o.currentPage]]),e[10]||(e[10]=(0,r.Lk)("br",null,null,-1)),e[11]||(e[11]=(0,r.Lk)("label",{for:"limitInput"},"Limit: ",-1)),(0,r.bo)((0,r.Lk)("input",{type:"number",id:"limitInput","onUpdate:modelValue":e[2]||(e[2]=t=>o.limitItem=t),placeholder:"Enter limit per page",min:"1",onChange:e[3]||(e[3]=(...t)=>s.getEnrollments&&s.getEnrollments(...t))},null,544),[[l.Jo,o.limitItem]]),e[12]||(e[12]=(0,r.Lk)("br",null,null,-1)),(0,r.Lk)("button",{onClick:e[4]||(e[4]=(...t)=>s.getEnrollments&&s.getEnrollments(...t))},"Get Enrollments"),o.enrollments.length>0?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:e[5]||(e[5]=(...t)=>s.deleteAllEnrollments&&s.deleteAllEnrollments(...t))},"Delete All")):(0,r.Q3)("",!0),(0,r.Lk)("div",null,[(0,r.Lk)("p",null,"Duplicate Items: "+(0,a.v_)(s.duplicateCount),1),(0,r.Lk)("p",null,"Unique Items: "+(0,a.v_)(s.uniqueCount),1)]),o.enrollments.length>0?((0,r.uX)(),(0,r.CE)("table",f,[e[8]||(e[8]=(0,r.Lk)("thead",null,[(0,r.Lk)("tr",null,[(0,r.Lk)("th",null,"#"),(0,r.Lk)("th",null,"ID"),(0,r.Lk)("th",null,"User ID"),(0,r.Lk)("th",null,"Course ID"),(0,r.Lk)("th",null,"Form ID"),(0,r.Lk)("th",null,"Unit"),(0,r.Lk)("th",null,"Created At"),(0,r.Lk)("th",null,"Actions")])],-1)),(0,r.Lk)("tbody",null,[((0,r.uX)(!0),(0,r.CE)(r.FK,null,(0,r.pI)(o.enrollments,((t,e)=>((0,r.uX)(),(0,r.CE)("tr",{key:t._id,class:(0,a.C4)({highlight:s.isDuplicate(t.userID)&&!s.isMaster(t)})},[(0,r.Lk)("td",null,(0,a.v_)((o.currentPage-1)*o.limitItem+e+1),1),(0,r.Lk)("td",null,(0,a.v_)(t._id),1),(0,r.Lk)("td",null,(0,a.v_)(t.userID),1),(0,r.Lk)("td",null,(0,a.v_)(t.courseID),1),(0,r.Lk)("td",null,(0,a.v_)(t.formID),1),(0,r.Lk)("td",null,(0,a.v_)(t.unit),1),(0,r.Lk)("td",null,(0,a.v_)(new Date(t.createdAt).toLocaleString()),1),(0,r.Lk)("td",null,[s.isDuplicate(t.userID)&&!s.isMaster(t)?((0,r.uX)(),(0,r.CE)("button",{key:0,onClick:e=>s.deleteEnrollment(t._id)},"Delete",8,h)):(0,r.Q3)("",!0)])],2)))),128))])])):((0,r.uX)(),(0,r.CE)("div",g," No enrollments data available. ")),o.paging.totalPages>1?((0,r.uX)(),(0,r.CE)("div",p,[(0,r.Lk)("button",{onClick:e[6]||(e[6]=(...t)=>s.prevPage&&s.prevPage(...t)),disabled:1===o.currentPage},"Previous",8,m),(0,r.Lk)("span",null,"Page "+(0,a.v_)(o.currentPage)+" of "+(0,a.v_)(o.paging.totalPages),1),(0,r.Lk)("button",{onClick:e[7]||(e[7]=(...t)=>s.nextPage&&s.nextPage(...t)),disabled:o.currentPage===o.paging.totalPages},"Next",8,v)])):(0,r.Q3)("",!0)])])])}n(17642),n(58004),n(33853),n(45876),n(32475),n(15024),n(31698),n(98992),n(54520),n(3949),n(81454);var I=n(40475),E=n(40471);const L=new E.A(!1);var D={data(){return{session:I.A.get("session"),configs:I.A.get("configs"),enrollments:[],currentPage:1,limitItem:10,paging:{totalPages:1,total:0},duplicates:new Set,masters:{}}},computed:{duplicateCount(){return this.enrollments.filter((t=>this.isDuplicate(t.userID)&&!this.isMaster(t))).length},uniqueCount(){return this.enrollments.length-this.duplicateCount}},methods:{async getEnrollments(){try{const t={method:"find",args:[{$and:[{courseID:"668c94ea7fb1dd8057b5f360"}]}],paging:{page:this.currentPage,limit:this.limitItem}},e=await L.POST("enroll/query",t,this.configs.key);console.log("Enrollments",e.data.data),this.enrollments=e.data.data,this.paging=e.data.paging,this.findDuplicates()}catch(t){console.error("Failed to fetch enrollments data:",t)}},findDuplicates(){const t={},e={};this.enrollments.forEach((n=>{t[n.userID]?(t[n.userID]++,e[n.userID]||(e[n.userID]=this.enrollments.findIndex((t=>t.userID===n.userID)))):t[n.userID]=1})),this.duplicates=new Set(Object.keys(t).filter((e=>t[e]>1))),this.masters=e},isDuplicate(t){return this.duplicates.has(t)},isMaster(t){return this.enrollments[this.masters[t.userID]]._id===t._id},async deleteEnrollment(t){try{console.log(t),await L.DELETE(`enroll/${t}`,"",this.configs.key)}catch(e){console.error("Failed to delete enrollment:",e)}},async deleteAllEnrollments(){const t=this.enrollments.filter((t=>this.isDuplicate(t.userID)&&!this.isMaster(t))).map((t=>this.deleteEnrollment(t._id)));await Promise.all(t),this.getEnrollments()},prevPage(){this.currentPage>1&&(this.currentPage--,this.getEnrollments())},nextPage(){this.currentPage<this.paging.totalPages&&(this.currentPage++,this.getEnrollments())}},mounted(){this.getEnrollments()}},b=n(64621);const y=(0,b.A)(D,[["render",k],["__scopeId","data-v-5d19a6cc"]]);var x=y,w={name:"Lesson Edit",components:{Edit:x},data(){return{login:I.A.get("session","login")}},methods:{},setup(){const t=(0,s.lq)(),e=t.meta.title;(0,o.K7)(e)}};const P=(0,b.A)(w,[["render",i]]);var C=P},97080:function(t,e,n){var r=n(94402).has;t.exports=function(t){return r(t),t}},83789:function(t,e,n){var r=n(79306),i=n(28551),o=n(69565),s=n(91291),l=n(1767),a="Invalid size",u=RangeError,c=TypeError,d=Math.max,f=function(t,e){this.set=t,this.size=d(e,0),this.has=r(t.has),this.keys=r(t.keys)};f.prototype={getIterator:function(){return l(i(o(this.keys,this.set)))},includes:function(t){return o(this.has,this.set,t)}},t.exports=function(t){i(t);var e=+t.size;if(e!==e)throw new c(a);var n=s(e);if(n<0)throw new u(a);return new f(t,n)}},40507:function(t,e,n){var r=n(69565);t.exports=function(t,e,n){var i,o,s=n?t:t.iterator,l=t.next;while(!(i=r(l,s)).done)if(o=e(i.value),void 0!==o)return o}},89286:function(t,e,n){var r=n(94402),i=n(38469),o=r.Set,s=r.add;t.exports=function(t){var e=new o;return i(t,(function(t){s(e,t)})),e}},83440:function(t,e,n){var r=n(97080),i=n(94402),o=n(89286),s=n(25170),l=n(83789),a=n(38469),u=n(40507),c=i.has,d=i.remove;t.exports=function(t){var e=r(this),n=l(t),i=o(e);return s(e)<=n.size?a(e,(function(t){n.includes(t)&&d(i,t)})):u(n.getIterator(),(function(t){c(e,t)&&d(i,t)})),i}},94402:function(t,e,n){var r=n(79504),i=Set.prototype;t.exports={Set:Set,add:r(i.add),has:r(i.has),remove:r(i["delete"]),proto:i}},68750:function(t,e,n){var r=n(97080),i=n(94402),o=n(25170),s=n(83789),l=n(38469),a=n(40507),u=i.Set,c=i.add,d=i.has;t.exports=function(t){var e=r(this),n=s(t),i=new u;return o(e)>n.size?a(n.getIterator(),(function(t){d(e,t)&&c(i,t)})):l(e,(function(t){n.includes(t)&&c(i,t)})),i}},64449:function(t,e,n){var r=n(97080),i=n(94402).has,o=n(25170),s=n(83789),l=n(38469),a=n(40507),u=n(9539);t.exports=function(t){var e=r(this),n=s(t);if(o(e)<=n.size)return!1!==l(e,(function(t){if(n.includes(t))return!1}),!0);var c=n.getIterator();return!1!==a(c,(function(t){if(i(e,t))return u(c,"normal",!1)}))}},53838:function(t,e,n){var r=n(97080),i=n(25170),o=n(38469),s=n(83789);t.exports=function(t){var e=r(this),n=s(t);return!(i(e)>n.size)&&!1!==o(e,(function(t){if(!n.includes(t))return!1}),!0)}},28527:function(t,e,n){var r=n(97080),i=n(94402).has,o=n(25170),s=n(83789),l=n(40507),a=n(9539);t.exports=function(t){var e=r(this),n=s(t);if(o(e)<n.size)return!1;var u=n.getIterator();return!1!==l(u,(function(t){if(!i(e,t))return a(u,"normal",!1)}))}},38469:function(t,e,n){var r=n(79504),i=n(40507),o=n(94402),s=o.Set,l=o.proto,a=r(l.forEach),u=r(l.keys),c=u(new s).next;t.exports=function(t,e,n){return n?i({iterator:u(t),next:c},e):a(t,e)}},84916:function(t,e,n){var r=n(97751),i=function(t){return{size:t,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},o=function(t){return{size:t,has:function(){return!0},keys:function(){throw new Error("e")}}};t.exports=function(t,e){var n=r("Set");try{(new n)[t](i(0));try{return(new n)[t](i(-1)),!1}catch(l){if(!e)return!0;try{return(new n)[t](o(-1/0)),!1}catch(a){var s=new n;return s.add(1),s.add(2),e(s[t](o(1/0)))}}}catch(a){return!1}}},25170:function(t,e,n){var r=n(46706),i=n(94402);t.exports=r(i.proto,"size","get")||function(t){return t.size}},83650:function(t,e,n){var r=n(97080),i=n(94402),o=n(89286),s=n(83789),l=n(40507),a=i.add,u=i.has,c=i.remove;t.exports=function(t){var e=r(this),n=s(t).getIterator(),i=o(e);return l(n,(function(t){u(e,t)?c(i,t):a(i,t)})),i}},44204:function(t,e,n){var r=n(97080),i=n(94402).add,o=n(89286),s=n(83789),l=n(40507);t.exports=function(t){var e=r(this),n=s(t).getIterator(),a=o(e);return l(n,(function(t){i(a,t)})),a}},17642:function(t,e,n){var r=n(46518),i=n(83440),o=n(84916),s=!o("difference",(function(t){return 0===t.size}));r({target:"Set",proto:!0,real:!0,forced:s},{difference:i})},58004:function(t,e,n){var r=n(46518),i=n(79039),o=n(68750),s=n(84916),l=!s("intersection",(function(t){return 2===t.size&&t.has(1)&&t.has(2)}))||i((function(){return"3,2"!==String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))}));r({target:"Set",proto:!0,real:!0,forced:l},{intersection:o})},33853:function(t,e,n){var r=n(46518),i=n(64449),o=n(84916),s=!o("isDisjointFrom",(function(t){return!t}));r({target:"Set",proto:!0,real:!0,forced:s},{isDisjointFrom:i})},45876:function(t,e,n){var r=n(46518),i=n(53838),o=n(84916),s=!o("isSubsetOf",(function(t){return t}));r({target:"Set",proto:!0,real:!0,forced:s},{isSubsetOf:i})},32475:function(t,e,n){var r=n(46518),i=n(28527),o=n(84916),s=!o("isSupersetOf",(function(t){return!t}));r({target:"Set",proto:!0,real:!0,forced:s},{isSupersetOf:i})},15024:function(t,e,n){var r=n(46518),i=n(83650),o=n(84916);r({target:"Set",proto:!0,real:!0,forced:!o("symmetricDifference")},{symmetricDifference:i})},31698:function(t,e,n){var r=n(46518),i=n(44204),o=n(84916);r({target:"Set",proto:!0,real:!0,forced:!o("union")},{union:i})}}]);
//# sourceMappingURL=8375.c49b3dca.js.map