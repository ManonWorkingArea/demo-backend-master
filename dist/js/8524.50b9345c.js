"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[8524],{33773:function(e,t,a){a.d(t,{A:function(){return N}});var o=a(20641),s=a(90033),n=a(53751);const c={class:"mx-auto"},i={class:"flex justify-between items-center mb-4 border-b pb-2 pt-2 pl-2 pr-2 border-gray-200"},l={class:"p-4"},r={class:"grid grid-cols-1 md:grid-cols-2 gap-2"},d={class:"flex items-center justify-between"},g={class:"text-md font-semibold"},u={class:"text-xs text-gray-500 mt-1"},k={class:"text-sm text-gray-600 mt-1"},p={class:"mt-4 flex justify-between"},m={class:"space-x-2"},h=["onClick"],f=["onClick"],y={class:"space-x-2"},b=["onClick"],v=["onClick"],x={key:0,class:"fixed inset-0 flex items-center justify-center"},w={class:"bg-white rounded p-5 z-10"},P={class:"flex flex-col space-y-2"},L={class:"flex justify-end mt-6 space-x-4"},A={key:1,class:"fixed inset-0 flex items-center justify-center z-50"},C={class:"bg-white rounded p-5 z-10"},D={class:"flex justify-end mt-6 space-x-4"};function _(e,t,a,_,R,E){const T=(0,o.g2)("font-awesome-icon");return(0,o.uX)(),(0,o.CE)("div",c,[(0,o.Lk)("div",null,[(0,o.Lk)("div",i,[t[8]||(t[8]=(0,o.Lk)("h3",{class:"text-md font-bold"},"Packages",-1)),(0,o.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>E.addPackage&&E.addPackage(...e)),class:"primary-btn px-4 py-2 bg-blue-500 text-white rounded shadow-sm hover:bg-blue-600"}," เพิ่ม Package ")]),(0,o.Lk)("div",l,[(0,o.Lk)("div",r,[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(R.packages,(e=>((0,o.uX)(),(0,o.CE)("div",{key:e._id,class:"bg-white p-5 rounded-sm shadow-sm"},[(0,o.Lk)("div",d,[(0,o.Lk)("h3",g,(0,s.v_)(E.getPackageIndex(e))+"."+(0,s.v_)(e.name),1)]),(0,o.Lk)("p",u,(0,s.v_)(e.code),1),(0,o.Lk)("p",k,(0,s.v_)(e.description),1),(0,o.Lk)("div",p,[(0,o.Lk)("div",m,[(0,o.Lk)("button",{onClick:t=>E.movePackageUp(e),class:"text-sm text-gray-500 hover:text-gray-700"},[(0,o.bF)(T,{icon:["fas","chevron-up"],class:"pr-2 pl-2"})],8,h),(0,o.Lk)("button",{onClick:t=>E.movePackageDown(e),class:"text-sm text-gray-500 hover:text-gray-700"},[(0,o.bF)(T,{icon:["fas","chevron-down"],class:"pr-2 pl-2"})],8,f)]),(0,o.Lk)("div",y,[(0,o.Lk)("button",{onClick:t=>E.openRenameDialog(e),class:"text-sm text-gray-500 hover:text-gray-700"},[(0,o.bF)(T,{icon:["fas","edit"],class:"pl-2"}),t[9]||(t[9]=(0,o.eW)(" เปลี่ยนชื่อ "))],8,b),(0,o.Lk)("button",{onClick:t=>E.removePackageConfirmation(e),class:"text-sm text-red-500 hover:text-red-700"},[(0,o.bF)(T,{icon:["fas","trash"],class:"pl-2"}),t[10]||(t[10]=(0,o.eW)(" ลบ "))],8,v)])])])))),128))])])]),R.showRenameDialog?((0,o.uX)(),(0,o.CE)("div",x,[t[15]||(t[15]=(0,o.Lk)("div",{class:"absolute inset-0 bg-black opacity-75",style:{"z-index":"10"}},null,-1)),(0,o.Lk)("div",w,[t[14]||(t[14]=(0,o.Lk)("h4",{class:"text-xl font-semibold mb-4"},"เปลี่ยนชื่อ Package",-1)),(0,o.Lk)("div",P,[t[11]||(t[11]=(0,o.Lk)("label",{for:"newName",class:"font-medium"},"ชื่อใหม่",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[1]||(t[1]=e=>R.selectedPackage.name=e),type:"text",id:"newName",placeholder:"Enter the new name",class:"px-4 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring focus:border-blue-500"},null,512),[[n.Jo,R.selectedPackage.name]]),t[12]||(t[12]=(0,o.Lk)("label",{for:"newCode",class:"font-medium"},"รหัสใหม่",-1)),(0,o.bo)((0,o.Lk)("input",{"onUpdate:modelValue":t[2]||(t[2]=e=>R.selectedPackage.code=e),type:"text",id:"newCode",placeholder:"Enter the new code",class:"px-4 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring focus:border-blue-500"},null,512),[[n.Jo,R.selectedPackage.code]]),t[13]||(t[13]=(0,o.Lk)("label",{for:"newDescription",class:"font-medium"},"คำอธิบาย",-1)),(0,o.bo)((0,o.Lk)("textarea",{"onUpdate:modelValue":t[3]||(t[3]=e=>R.selectedPackage.description=e),id:"newDescription",placeholder:"Enter the new description",class:"px-4 py-2 border border-gray-300 rounded-sm focus:outline-none focus:ring focus:border-blue-500"},null,512),[[n.Jo,R.selectedPackage.description]])]),(0,o.Lk)("div",L,[(0,o.Lk)("button",{onClick:t[4]||(t[4]=e=>E.renamePackage(R.selectedPackage)),class:"px-6 py-2 text-sm font-medium text-white bg-blue-500 rounded-sm hover:bg-blue-600"},"Rename"),(0,o.Lk)("button",{onClick:t[5]||(t[5]=(...e)=>E.closeRenameDialog&&E.closeRenameDialog(...e)),class:"px-6 py-2 text-sm font-medium text-gray-500 hover:text-gray-700"},"Cancel")])])])):(0,o.Q3)("",!0),R.showConfirmationPopup?((0,o.uX)(),(0,o.CE)("div",A,[t[18]||(t[18]=(0,o.Lk)("div",{class:"absolute inset-0 bg-black opacity-75"},null,-1)),(0,o.Lk)("div",C,[t[16]||(t[16]=(0,o.Lk)("h4",{class:"text-xl font-semibold mb-4"},"Confirm Remove Package",-1)),t[17]||(t[17]=(0,o.Lk)("p",null,"Are you sure you want to remove the package?",-1)),(0,o.Lk)("div",D,[(0,o.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>E.confirmRemovePackage&&E.confirmRemovePackage(...e)),class:"px-6 py-2 text-sm font-medium text-white bg-red-500 rounded-sm"},"Remove"),(0,o.Lk)("button",{onClick:t[7]||(t[7]=(...t)=>e.cancelRemovePackage&&e.cancelRemovePackage(...t)),class:"px-6 py-2 text-sm font-medium text-gray-500 hover:text-gray-700"},"Cancel")])])])):(0,o.Q3)("",!0)])}var R=a(40475),E={name:"PackageList",props:{eventDetails:{type:Object,required:!0}},data(){return{session:R.A.get("session"),configs:R.A.get("configs"),packages:[],showRenameDialog:!1,selectedPackage:null,showConfirmationPopup:!1,packageToRemove:null}},computed:{getPackageIndex(){return e=>this.packages.findIndex((t=>t._id===e._id))+1}},async mounted(){try{console.log("Event Details:",this.eventDetails),await this.getPackageData()}catch(e){console.log(e)}},methods:{async getPackageData(){try{const e=await fetch("https://gateway.cloudrestfulapi.com/api/vote_package/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({method:"find",args:[{unit:this.session.current._id,eventID:this.eventDetails._id}],paging:{page:1,limit:200}})});if(e.ok){const t=await e.json();this.packages=t.data}}catch(e){console.error(e)}},async addPackage(){try{const e={unit:this.session.current._id,name:"New Package",code:"package-code",description:"Description for New Package",eventID:this.eventDetails._id,visible:!0},t=await fetch("https://gateway.cloudrestfulapi.com/api/vote_package/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:e,options:{}})});t.ok&&await this.getPackageData()}catch(e){console.error(e)}},async updatePackage(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/vote_package/"+e._id,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{name:e.name,code:e.code,description:e.description,visible:e.visible},options:{}})});t.ok&&await this.getPackageData()}catch(t){console.error(t)}},async deletePackage(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/vote_package/"+e._id,{method:"DELETE",headers:{"Content-Type":"application/json","client-token-key":this.configs.key}});t.ok&&await this.getPackageData()}catch(t){console.error(t)}},movePackageUp(e){const t=this.packages.findIndex((t=>t._id===e._id));if(t>0){const e=this.packages.splice(t,1)[0];this.packages.splice(t-1,0,e)}},movePackageDown(e){const t=this.packages.findIndex((t=>t._id===e._id));if(t<this.packages.length-1){const e=this.packages.splice(t,1)[0];this.packages.splice(t+1,0,e)}},async removePackageConfirmation(e){this.packageToRemove=e,this.showConfirmationPopup=!0},async confirmRemovePackage(){try{await this.deletePackage(this.packageToRemove),this.packageToRemove=null,this.showConfirmationPopup=!1}catch(e){console.error(e)}},openRenameDialog(e){this.selectedPackage=e,this.showRenameDialog=!0},async renamePackage(e){try{await this.updatePackage(e),this.selectedPackage=null,this.showRenameDialog=!1}catch(t){console.error(t)}},closeRenameDialog(){this.selectedPackage=null,this.showRenameDialog=!1}}},T=a(64621);const j=(0,T.A)(E,[["render",_],["__scopeId","data-v-5a56faf5"]]);var N=j},58524:function(e,t,a){a.r(t),a.d(t,{default:function(){return k}});var o=a(20641);function s(e,t,a,s,n,c){const i=(0,o.g2)("Authen"),l=(0,o.g2)("Dashboard");return(0,o.uX)(),(0,o.CE)(o.FK,null,[(0,o.bF)(i),this.login?((0,o.uX)(),(0,o.Wv)(l,{key:0})):(0,o.Q3)("",!0)],64)}var n=a(52968),c=a(75220),i=a(33773),l=a(74284),r=a(40475),d={name:"Home",components:{Dashboard:i.A,Authen:l.A},data(){return{login:r.A.get("session","login")}},methods:{},mounted(){},setup(){const e=(0,c.lq)(),t=e.meta.title;(0,n.K7)(t),console.log("Dashboard")}},g=a(64621);const u=(0,g.A)(d,[["render",s]]);var k=u},74284:function(e,t,a){a.d(t,{A:function(){return g}});var o=a(20641);function s(e,t,a,s,n,c){return(0,o.uX)(),(0,o.CE)("div")}var n=a(75220),c=a(63084),i=a(40475),l={name:"Authen",data(){return{configs:i.A.get("configs"),session:i.A.get("session")}},created(){c.A.option(this.$route)},computed:{},components:{},mounted(){this.checkAuth()},updated(){},methods:{async checkAuth(){const e=(0,n.lq)(),t=e.meta.auth,a=e.name,o=i.A.get("session");let s=o.token,l=o.login,r=o.current;c.A.log("hasLogin",l),c.A.log("Page -> Auth:",t),c.A.log("User -> Token:",s),c.A.log("User -> Login:",l),"frontend"===this.session.interface?c.A.log("Front-End"):"backend"===this.session.interface&&(c.A.log("Back-End"),l?("Login"==a||void 0==r?(c.A.log("Not Login Again"),this.$router.replace({path:"/"})):(c.A.log("Has School Active"),t?(c.A.log("This page is : Authen Request"),""===s||null===s||void 0==s?c.A.log("Your Cannot Access"):c.A.log("Your Can Access")):c.A.log("This page is : No Authen Request")),c.A.log("Login")):(c.A.log("Not Login"),"Login"!=a?(window.location.href="/member/login",c.A.log("Not Login Page",a)):c.A.log("Login Page",a)))}},setup(){}},r=a(64621);const d=(0,r.A)(l,[["render",s]]);var g=d}}]);
//# sourceMappingURL=8524.50b9345c.js.map