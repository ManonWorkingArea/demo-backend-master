"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[8589],{98589:function(e,t,s){s.d(t,{A:function(){return wa}});s(44114),s(98992),s(37550);var a=s(20641),o=s(90033),r=s(53751);const i={key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"},l={class:"bg-white p-6 rounded-lg shadow-lg"},n={class:"text-gray-800 text-lg"},c={key:1,class:"fixed inset-0 flex items-center justify-center bg-black bg-opacity-50 z-50"},d={class:"w-full max-w-6xl mx-4 bg-white rounded-lg shadow-lg relative max-h-[90vh] flex flex-col"},u={class:"flex items-center justify-between p-4 border-b"},p={class:"overflow-auto flex-1 p-4"},g={class:"min-w-full text-sm"},h={class:"bg-gray-50"},m={class:"p-4 border-t"},y={key:2,class:"relative z-10","aria-labelledby":"slide-over-title",role:"dialog","aria-modal":"true"},f={class:"fixed inset-0 overflow-hidden"},x={class:"absolute inset-0 overflow-hidden"},b={class:"pointer-events-none fixed inset-y-0 right-0 flex max-w-full pl-10"},k={class:"pointer-events-auto w-screen max-w-md"},v={class:"flex h-full flex-col bg-white shadow-xl"},w={class:"flex items-center justify-between p-4 border-b"},C={class:"flex-1 p-4"},L={class:"space-y-2"},_={key:3,class:"text-center py-8"},I={class:"bg-white rounded-lg shadow-sm border border-gray-200"},T={class:"px-4 py-3 border-b border-gray-200"},E={class:"flex items-center justify-between"},S={class:"flex items-center space-x-3"},A={class:"w-8 h-8 bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg flex items-center justify-center"},D={class:"text-base font-semibold text-gray-900"},$={class:"text-xs text-gray-500"},P={class:"flex items-center space-x-2"},O={class:"bg-blue-50 border-l-4 border-blue-400 p-3"},M={class:"flex"},X={class:"flex-shrink-0"},j={class:"p-4"},F={key:0,class:"fixed inset-0 flex items-center justify-center z-50"},V={class:"modal-container bg-white z-50 w-full max-w-6xl mx-4 max-h-[90vh] flex flex-col rounded-lg shadow-lg"},U={class:"border-b bg-gray-50 p-4"},R={class:"flex space-x-1"},N={class:"overflow-y-auto flex-grow p-4"},Q={key:0,class:"space-y-4"},H={class:"bg-gray-50 rounded-lg p-4"},W={class:"flex items-center justify-between mb-3"},B={class:"bg-white rounded-lg border p-4"},z={class:"flex items-center"},J={class:"cursor-pointer bg-blue-50 text-blue-600 px-3 py-1.5 rounded text-sm hover:bg-blue-100"},q={key:0,class:"ml-3 text-sm text-gray-500"},K={key:1,class:"ml-3 text-sm text-gray-700"},G={key:0,class:"mt-4"},Z={class:"overflow-x-auto bg-gray-50 rounded border max-h-64"},Y={class:"min-w-full text-xs"},ee=["onClick"],te=["onUpdate:modelValue","onBlur","onKeyup"],se={key:1,class:"space-y-4"},ae={class:"flex justify-between items-center"},oe={class:"overflow-x-auto"},re={class:"min-w-full text-sm"},ie={class:"bg-white divide-y divide-gray-200"},le={class:"hover:bg-gray-50"},ne={class:"px-2 py-1 text-gray-500"},ce={class:"px-2 py-1"},de=["onUpdate:modelValue"],ue=["value"],pe={class:"px-2 py-1"},ge=["onUpdate:modelValue"],he={class:"px-2 py-1"},me=["onUpdate:modelValue"],ye={class:"px-2 py-1"},fe=["onUpdate:modelValue"],xe={class:"px-2 py-1"},be=["onUpdate:modelValue"],ke={class:"px-2 py-1"},ve=["onUpdate:modelValue"],we={class:"px-2 py-1"},Ce={class:"flex items-center space-x-1"},Le=["onUpdate:modelValue"],_e=["onClick"],Ie={class:"px-2 py-1"},Te={class:"flex items-center space-x-1"},Ee=["onClick"],Se={key:0,xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},Ae={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},De=["onClick"],$e={key:0,class:"bg-gray-50"},Pe={colspan:"8",class:"px-2 py-2"},Oe={class:"grid grid-cols-2 md:grid-cols-4 gap-2"},Me=["onUpdate:modelValue"],Xe=["value"],je=["onUpdate:modelValue"],Fe=["onUpdate:modelValue"],Ve=["onUpdate:modelValue"],Ue={key:2,class:"text-center py-8 text-gray-500"},Re={class:"border-t p-4 flex justify-end space-x-2"},Ne={class:"bg-white shadow-sm border border-gray-200 rounded-lg"},Qe={class:"bg-gray-50 border-b p-3"},He={class:"flex justify-between flex-col lg:flex-row gap-3"},We={class:"flex flex-col sm:flex-row gap-2"},Be={key:0,class:"text-sm text-gray-600 flex items-center"},ze={class:"text-black font-semibold mx-1"},Je={class:"flex items-center gap-2"},qe={class:"flex items-center space-x-4 text-sm"},Ke={class:"flex items-center space-x-2"},Ge=["value"],Ze={class:"flex items-center cursor-pointer"},Ye={class:"flex items-center cursor-pointer"},et={class:"bg-gray-100 border-b p-2"},tt={class:"flex gap-4 text-sm"},st={class:"flex items-center cursor-pointer"},at={class:"flex items-center cursor-pointer"},ot={key:0},rt={key:1,class:"flex items-center justify-center py-20"},it={class:"text-center"},lt={class:"w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-6"},nt={class:"space-y-3"},ct={class:"text-sm text-gray-400"},dt={class:"grid grid-cols-12 border-b border-gray-100 text-sm hover:bg-gray-50 transition-colors"},ut={class:"col-span-1 py-4 flex items-center justify-center bg-gray-50"},pt={class:"text-gray-600 font-medium text-base"},gt={class:"col-span-3 py-4 px-3"},ht={class:"flex items-center"},mt={class:"relative"},yt=["src","onError","onLoad"],ft={key:2,class:"absolute -bottom-1 -right-1 w-4 h-4 bg-green-400 rounded-full border-2 border-white",title:"เรียนจบแล้ว"},xt={key:3,class:"absolute -bottom-1 -right-1 w-4 h-4 bg-yellow-400 rounded-full border-2 border-white",title:"กำลังเรียน"},bt={key:4,class:"absolute -bottom-1 -right-1 w-4 h-4 bg-gray-400 rounded-full border-2 border-white",title:"ยังไม่เริ่มเรียน"},kt={class:"min-w-0 flex-1"},vt={class:"font-medium text-gray-900 group-hover:text-blue-600 transition-colors"},wt={class:"text-xs text-gray-500 truncate"},Ct={class:"col-span-2 py-4 px-3 hidden lg:block"},Lt={class:"flex items-center text-gray-600"},_t={class:"font-mono text-sm"},It={class:"col-span-2 py-4 px-3 hidden md:block"},Tt={class:"space-y-1"},Et={class:"flex items-center text-gray-600"},St={class:"text-sm"},At={class:"flex items-center text-gray-600"},Dt=["title"],$t={class:"col-span-1 py-4 px-3 hidden lg:block text-center"},Pt={class:"inline-flex items-center"},Ot={class:"font-semibold text-lg text-blue-600"},Mt={class:"col-span-1 py-4 px-3 hidden xl:block text-center"},Xt={class:"text-xs text-gray-600"},jt={class:"col-span-2 py-4 px-3"},Ft={class:"flex items-center justify-center space-x-1"},Vt={class:"flex items-center space-x-1"},Ut=["onClick"],Rt=["onClick"],Nt={class:"relative"},Qt=["onClick"],Ht={key:0,class:"absolute right-0 z-20 mt-1 w-48 bg-white rounded-lg shadow-lg border border-gray-200 py-1"},Wt=["onClick"],Bt=["onClick"],zt=["onClick"],Jt=["onClick"],qt={class:"md:hidden border-b border-gray-200 bg-gray-50"},Kt={class:"p-3"},Gt={class:"space-y-2 mb-3"},Zt={class:"lg:hidden flex items-center text-gray-600"},Yt={class:"font-mono text-sm"},es={class:"md:hidden flex items-center text-gray-600"},ts={class:"text-sm"},ss={class:"md:hidden flex items-center text-gray-600"},as={class:"text-sm truncate"},os={class:"flex flex-wrap gap-2"},rs=["onClick"],is=["onClick"],ls={key:0,class:"border-b border-gray-200 bg-gray-50"},ns={class:"p-3"},cs={key:0,class:"space-y-3"},ds={class:"grid grid-cols-2 md:grid-cols-5 gap-2"},us={class:"bg-white p-3 border border-gray-200"},ps={class:"text-lg font-semibold text-gray-900"},gs={class:"bg-white p-3 border border-gray-200"},hs={class:"mt-2 flex gap-1"},ms=["onClick"],ys={class:"relative"},fs={key:0,class:"absolute right-0 z-10 mt-1 w-44 bg-white border border-gray-200 text-xs"},xs=["onClick"],bs=["onClick"],ks={class:"bg-white p-3 border border-gray-200"},vs={class:"bg-white p-3 border border-gray-200"},ws={class:"bg-white p-3 border border-gray-200"},Cs={class:"bg-white p-3 border border-gray-200"},Ls={class:"flex items-center justify-between"},_s={class:"flex gap-2"},Is=["onClick"],Ts=["onClick"],Es={key:3,class:"border-t border-gray-200 bg-white"},Ss={class:"p-4 flex items-center justify-center space-x-4"},As={key:0,class:"flex items-center space-x-2 text-blue-600"},Ds={key:2,class:"text-sm text-green-600"},$s={key:0,class:"fixed bottom-6 left-1/2 transform -translate-x-1/2 z-40 pointer-events-none"},Ps={class:"bg-blue-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center space-x-3 pointer-events-auto"},Os={class:"flex items-center space-x-2"},Ms={class:"text-sm font-medium"},Xs={class:"w-20 bg-blue-500 rounded-full h-1.5"},js={class:"text-xs text-blue-200 font-medium"},Fs={key:1,class:"bg-white border-t border-gray-200 px-4 py-3"};function Vs(e,t,s,Vs,Us,Rs){const Ns=(0,a.g2)("Loader"),Qs=(0,a.g2)("batch-progress"),Hs=(0,a.g2)("font-awesome-icon"),Ws=(0,a.g2)("router-link"),Bs=(0,a.g2)("Limit"),zs=(0,a.g2)("Pagination");return(0,a.uX)(),(0,a.CE)(a.FK,null,[Us.isExporting?((0,a.uX)(),(0,a.CE)("div",i,[(0,a.Lk)("div",l,[(0,a.Lk)("div",n,(0,o.v_)(Us.progressMessage),1)])])):(0,a.Q3)("",!0),Us.showPreviewModal?((0,a.uX)(),(0,a.CE)("div",c,[(0,a.Lk)("div",d,[(0,a.Lk)("div",u,[t[35]||(t[35]=(0,a.Lk)("h2",{class:"text-lg font-semibold"},"ตัวอย่างข้อมูล",-1)),(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>Us.showPreviewModal=!1),class:"text-gray-400 hover:text-gray-600"},t[34]||(t[34]=[(0,a.Lk)("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),(0,a.Lk)("div",p,[(0,a.Lk)("table",g,[(0,a.Lk)("thead",h,[(0,a.Lk)("tr",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Us.extractedData[0],((e,t)=>((0,a.uX)(),(0,a.CE)("th",{key:t,class:"px-3 py-2 text-left font-medium text-gray-700 border-b"},(0,o.v_)(t),1)))),128))])]),(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Us.extractedData,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t,class:"hover:bg-gray-50"},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e,((e,t)=>((0,a.uX)(),(0,a.CE)("td",{key:t,class:"px-3 py-2 border-b text-gray-600"},(0,o.v_)(e),1)))),128))])))),128))])])]),(0,a.Lk)("div",m,[(0,a.Lk)("button",{onClick:t[1]||(t[1]=e=>Rs.downloadCSV(Us.allData)),class:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-md text-sm font-medium"}," ดาวน์โหลด CSV ")])])])):(0,a.Q3)("",!0),Us.open?((0,a.uX)(),(0,a.CE)("div",y,[t[38]||(t[38]=(0,a.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)),(0,a.Lk)("div",f,[(0,a.Lk)("div",x,[(0,a.Lk)("div",b,[(0,a.Lk)("div",k,[(0,a.Lk)("div",v,[(0,a.Lk)("div",w,[t[37]||(t[37]=(0,a.Lk)("h2",{class:"text-lg font-semibold text-gray-900"},"เครื่องมือ",-1)),(0,a.Lk)("button",{onClick:t[2]||(t[2]=(...e)=>Rs.closePanel&&Rs.closePanel(...e)),class:"text-gray-400 hover:text-gray-600"},t[36]||(t[36]=[(0,a.Lk)("svg",{class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),(0,a.Lk)("div",C,[(0,a.Lk)("div",L,[(0,a.Lk)("button",{class:"w-full text-left p-2 text-blue-600 hover:bg-blue-50 rounded",onClick:t[3]||(t[3]=(...e)=>Rs.renderData&&Rs.renderData(...e))},"Render Data"),(0,a.Lk)("button",{class:"w-full text-left p-2 text-blue-600 hover:bg-blue-50 rounded",onClick:t[4]||(t[4]=(...e)=>Rs.renderBilling&&Rs.renderBilling(...e))},"Render Billing"),(0,a.Lk)("button",{class:"w-full text-left p-2 text-blue-600 hover:bg-blue-50 rounded",onClick:t[5]||(t[5]=e=>Rs.renderEnroll())},"Render Enroll"),(0,a.Lk)("button",{class:"w-full text-left p-2 text-blue-600 hover:bg-blue-50 rounded",onClick:t[6]||(t[6]=(...e)=>Rs.renderProfile&&Rs.renderProfile(...e))},"Render Profile")])])])])])])])])):(0,a.Q3)("",!0),Us.loading_sources?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",_,[(0,a.bF)(Ns)])),(0,a.bF)(Qs,{processName:Us.processName,progressText:Us.progressText,progressTotal:Us.progressTotal,progressCurrent:Us.progressCurrent,isVisible:Us.isProcessing,startTime:Us.startTime,endTime:Us.endTime,onClose:Rs.closeProgress},null,8,["processName","progressText","progressTotal","progressCurrent","isVisible","startTime","endTime","onClose"]),(0,a.Lk)("div",I,[(0,a.Lk)("div",T,[(0,a.Lk)("div",E,[(0,a.Lk)("div",S,[(0,a.Lk)("div",A,[(0,a.bF)(Hs,{icon:["fas","users"],class:"text-white text-sm"})]),(0,a.Lk)("div",null,[(0,a.Lk)("h2",D,(0,o.v_)(s.pageTitle),1),(0,a.Lk)("p",$,"จัดการผู้ลงทะเบียนหลักสูตร ("+(0,o.v_)(Us.totalItems)+" รายการ)",1)])]),(0,a.Lk)("div",P,[(0,a.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>Rs.exportToCSV&&Rs.exportToCSV(...e)),type:"button",class:"inline-flex items-center rounded-lg border border-transparent bg-green-600 px-3 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition-colors"},[(0,a.bF)(Hs,{icon:["fas","download"],class:"mr-1.5"}),t[39]||(t[39]=(0,a.eW)(" Export "))]),(0,a.Lk)("button",{onClick:t[8]||(t[8]=(...e)=>Rs.assignUserModal&&Rs.assignUserModal(...e)),type:"button",class:"inline-flex items-center rounded-lg border border-transparent bg-blue-600 px-3 py-1.5 text-sm font-medium text-white shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors"},[(0,a.bF)(Hs,{icon:["fas","plus"],class:"mr-1.5"}),t[40]||(t[40]=(0,a.eW)(" Enroll "))]),(0,a.Lk)("button",{onClick:t[9]||(t[9]=(...e)=>Rs.togglePanel&&Rs.togglePanel(...e)),type:"button",class:"inline-flex items-center rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"},[(0,a.bF)(Hs,{icon:["fas","cogs"],class:"mr-1.5"}),t[41]||(t[41]=(0,a.eW)(" เครื่องมือ "))]),(0,a.Lk)("button",{onClick:t[10]||(t[10]=(...e)=>Rs.getData&&Rs.getData(...e)),type:"button",class:"inline-flex items-center rounded-lg border border-gray-300 bg-white px-3 py-1.5 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-colors"},[(0,a.bF)(Hs,{icon:["fas","refresh"],class:"mr-1.5"}),t[42]||(t[42]=(0,a.eW)(" รีเฟรช "))])])])]),(0,a.Lk)("div",O,[(0,a.Lk)("div",M,[(0,a.Lk)("div",X,[(0,a.bF)(Hs,{icon:["fas","info-circle"],class:"text-blue-400 text-sm"})]),t[43]||(t[43]=(0,a.Lk)("div",{class:"ml-2"},[(0,a.Lk)("p",{class:"text-xs text-blue-700"},[(0,a.Lk)("strong",null,"หมายเหตุ:"),(0,a.eW)(" ผู้ลงทะเบียนทั้งหมดในหลักสูตรนี้ สามารถจัดการข้อมูล ส่งออกรายงาน และติดตามความคืบหน้าการเรียนได้ที่นี่ ")])],-1))])]),(0,a.Lk)("div",j,[Us.isModalOpen?((0,a.uX)(),(0,a.CE)("div",F,[t[65]||(t[65]=(0,a.Lk)("div",{class:"modal-overlay bg-black opacity-50 absolute inset-0"},null,-1)),(0,a.Lk)("div",V,[(0,a.Lk)("div",U,[t[44]||(t[44]=(0,a.Lk)("h2",{class:"text-lg font-semibold mb-3"},"เพิ่มผู้ลงทะเบียนหลักสูตร",-1)),(0,a.Lk)("div",R,[(0,a.Lk)("button",{onClick:t[11]||(t[11]=e=>Rs.selectTab("csv")),class:(0,o.C4)([{"bg-white text-gray-800 border border-gray-300":"csv"===Us.selectedTab,"bg-gray-200 text-gray-600":"csv"!==Us.selectedTab},"px-3 py-1.5 text-sm rounded"])},"Upload CSV",2),(0,a.Lk)("button",{onClick:t[12]||(t[12]=e=>Rs.selectTab("manual")),class:(0,o.C4)([{"bg-white text-gray-800 border border-gray-300":"manual"===Us.selectedTab,"bg-gray-200 text-gray-600":"manual"!==Us.selectedTab},"px-3 py-1.5 text-sm rounded"])},"Input Manual",2),(0,a.Lk)("button",{onClick:t[13]||(t[13]=e=>Rs.selectTab("assign")),class:(0,o.C4)([{"bg-white text-gray-800 border border-gray-300":"assign"===Us.selectedTab,"bg-gray-200 text-gray-600":"assign"!==Us.selectedTab},"px-3 py-1.5 text-sm rounded"])},"Select User",2)])]),(0,a.Lk)("div",N,["csv"===Us.selectedTab?((0,a.uX)(),(0,a.CE)("div",Q,[(0,a.Lk)("div",H,[(0,a.Lk)("div",W,[t[46]||(t[46]=(0,a.Lk)("h3",{class:"font-medium"},"ตัวอย่างไฟล์ CSV",-1)),(0,a.Lk)("button",{onClick:t[14]||(t[14]=(...e)=>Rs.downloadSampleCSV&&Rs.downloadSampleCSV(...e)),class:"flex items-center gap-2 bg-blue-50 text-blue-600 px-3 py-1.5 rounded text-sm hover:bg-blue-100"},t[45]||(t[45]=[(0,a.Lk)("svg",{class:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),(0,a.eW)(" ดาวน์โหลดตัวอย่าง ")]))]),t[47]||(t[47]=(0,a.Fv)('<div class="bg-white rounded border overflow-x-auto" data-v-45f1cc93><table class="min-w-full text-xs" data-v-45f1cc93><thead class="bg-gray-100" data-v-45f1cc93><tr data-v-45f1cc93><th class="px-2 py-1 text-left" data-v-45f1cc93>bu_name</th><th class="px-2 py-1 text-left" data-v-45f1cc93>bu_type</th><th class="px-2 py-1 text-left" data-v-45f1cc93>prefix</th><th class="px-2 py-1 text-left" data-v-45f1cc93>firstname</th><th class="px-2 py-1 text-left" data-v-45f1cc93>lastname</th><th class="px-2 py-1 text-left" data-v-45f1cc93>position</th><th class="px-2 py-1 text-left" data-v-45f1cc93>phone</th><th class="px-2 py-1 text-left" data-v-45f1cc93>email</th></tr></thead><tbody data-v-45f1cc93><tr class="border-t" data-v-45f1cc93><td class="px-2 py-1" data-v-45f1cc93>บริษัท เอบีซี จำกัด</td><td class="px-2 py-1" data-v-45f1cc93>เอกชน</td><td class="px-2 py-1" data-v-45f1cc93>นาย</td><td class="px-2 py-1" data-v-45f1cc93>สมชาย</td><td class="px-2 py-1" data-v-45f1cc93>ใจดี</td><td class="px-2 py-1" data-v-45f1cc93>ผู้จัดการ</td><td class="px-2 py-1" data-v-45f1cc93>0891234567</td><td class="px-2 py-1" data-v-45f1cc93>user1@example.com</td></tr></tbody></table></div>',1))]),(0,a.Lk)("div",B,[t[50]||(t[50]=(0,a.Lk)("h3",{class:"font-medium mb-3"},"อัพโหลดไฟล์ CSV",-1)),(0,a.Lk)("div",z,[(0,a.Lk)("label",J,[t[48]||(t[48]=(0,a.eW)(" เลือกไฟล์ ")),(0,a.Lk)("input",{type:"file",onChange:t[15]||(t[15]=(...e)=>Rs.handleFileUpload&&Rs.handleFileUpload(...e)),accept:".csv",class:"hidden"},null,32)]),Us.selectedFileName?((0,a.uX)(),(0,a.CE)("span",K,(0,o.v_)(Us.selectedFileName),1)):((0,a.uX)(),(0,a.CE)("span",q,"ยังไม่ได้เลือกไฟล์"))]),Us.csvData.length>0?((0,a.uX)(),(0,a.CE)("div",G,[t[49]||(t[49]=(0,a.Lk)("h4",{class:"font-medium mb-2"},"ข้อมูลที่อัพโหลด",-1)),(0,a.Lk)("div",Z,[(0,a.Lk)("table",Y,[(0,a.Lk)("tbody",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Us.csvData,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:t,class:"border-b last:border-b-0"},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e,((e,s)=>((0,a.uX)(),(0,a.CE)("td",{key:s,class:"px-2 py-1"},[Rs.isEditing(t,s)?(0,a.bo)(((0,a.uX)(),(0,a.CE)("input",{key:1,type:"text","onUpdate:modelValue":e=>Us.csvData[t][s]=e,onBlur:e=>Rs.stopEditing(t,s),onKeyup:(0,r.jR)((e=>Rs.stopEditing(t,s)),["enter"]),class:"border rounded px-1 py-0.5 w-full text-xs focus:outline-none focus:ring-1 focus:ring-blue-500"},null,40,te)),[[r.Jo,Us.csvData[t][s]]]):((0,a.uX)(),(0,a.CE)("span",{key:0,onClick:e=>Rs.startEditing(t,s),class:"cursor-pointer hover:bg-gray-100 px-1 py-0.5 rounded"},(0,o.v_)(e),9,ee))])))),128))])))),128))])])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0),"manual"===Us.selectedTab?((0,a.uX)(),(0,a.CE)("div",se,[(0,a.Lk)("div",ae,[t[52]||(t[52]=(0,a.Lk)("div",null,[(0,a.Lk)("h3",{class:"font-medium text-gray-800"},"เพิ่มผู้ใช้งานด้วยตนเอง"),(0,a.Lk)("p",{class:"text-sm text-gray-600"},"กรอกข้อมูลผู้ใช้งานในตารางด้านล่าง")],-1)),(0,a.Lk)("button",{onClick:t[16]||(t[16]=(...e)=>Rs.addManualInputRow&&Rs.addManualInputRow(...e)),class:"bg-green-500 hover:bg-green-600 text-white px-3 py-1.5 rounded text-sm flex items-center"},t[51]||(t[51]=[(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M12 4v16m8-8H4"})],-1),(0,a.eW)(" เพิ่มผู้ใช้ ")]))]),(0,a.Lk)("div",oe,[(0,a.Lk)("table",re,[t[63]||(t[63]=(0,a.Lk)("thead",{class:"bg-gray-50"},[(0,a.Lk)("tr",null,[(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"#"),(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"คำนำหน้า"),(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"ชื่อ"),(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"นามสกุล"),(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"โทรศัพท์"),(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"อีเมล"),(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"ผู้ใช้งาน"),(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"รหัสผ่าน"),(0,a.Lk)("th",{class:"px-2 py-2 text-left text-xs font-medium text-gray-500"},"จัดการ")])],-1)),(0,a.Lk)("tbody",ie,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Us.manualInput,((e,s)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:s},[(0,a.Lk)("tr",le,[(0,a.Lk)("td",ne,(0,o.v_)(s+1),1),(0,a.Lk)("td",ce,[(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.info.prefix=t,class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},[t[53]||(t[53]=(0,a.Lk)("option",{value:""},"เลือก",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Us.prefixMapping,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:t},(0,o.v_)(e),9,ue)))),128))],8,de),[[r.u1,e.info.prefix]])]),(0,a.Lk)("td",pe,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.firstname=t,placeholder:"ชื่อ",class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,ge),[[r.Jo,e.firstname]])]),(0,a.Lk)("td",he,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.lastname=t,placeholder:"นามสกุล",class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,me),[[r.Jo,e.lastname]])]),(0,a.Lk)("td",ye,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.phone=t,placeholder:"โทรศัพท์",class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,fe),[[r.Jo,e.phone]])]),(0,a.Lk)("td",xe,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.email=t,placeholder:"อีเมล",class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,be),[[r.Jo,e.email]])]),(0,a.Lk)("td",ke,[(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.username=t,placeholder:"ผู้ใช้งาน",class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,ve),[[r.Jo,e.username]])]),(0,a.Lk)("td",we,[(0,a.Lk)("div",Ce,[(0,a.bo)((0,a.Lk)("input",{type:"password","onUpdate:modelValue":t=>e.password=t,placeholder:"รหัสผ่าน",class:"flex-grow px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,Le),[[r.Jo,e.password]]),(0,a.Lk)("button",{onClick:e=>Rs.generateRandomPassword(s),type:"button",title:"สร้างรหัสผ่าน",class:"p-1 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded"},t[54]||(t[54]=[(0,a.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-3 w-3",viewBox:"0 0 20 20",fill:"currentColor"},[(0,a.Lk)("path",{"fill-rule":"evenodd",d:"M4 2a1 1 0 011 1v2.101a7.002 7.002 0 0111.601 2.566 1 1 0 11-1.885.666A5.002 5.002 0 005.999 7H9a1 1 0 010 2H4a1 1 0 01-1-1V3a1 1 0 011-1zm1 9.899a7.002 7.002 0 0111.601-2.566 1 1 0 111.885-.666A5.002 5.002 0 0014.001 13H11a1 1 0 110-2h5a1 1 0 011 1v5a1 1 0 11-2 0v-2.101a7.002 7.002 0 01-11.601-2.566 1 1 0 111.885.666A5.002 5.002 0 005.999 13H9a1 1 0 110-2H4a1 1 0 01-1-1V3a1 1 0 011-1z","clip-rule":"evenodd"})],-1)]),8,_e)])]),(0,a.Lk)("td",Ie,[(0,a.Lk)("div",Te,[(0,a.Lk)("button",{onClick:e=>Rs.toggleShowMore(s),type:"button",title:"ตัวเลือกเพิ่มเติม",class:"p-1 bg-gray-100 hover:bg-gray-200 text-gray-600 rounded"},[Us.manualInputShowMore[s]?((0,a.uX)(),(0,a.CE)("svg",Ae,t[56]||(t[56]=[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M5 15l7-7 7 7"},null,-1)]))):((0,a.uX)(),(0,a.CE)("svg",Se,t[55]||(t[55]=[(0,a.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)])))],8,Ee),Us.manualInput.length>1?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e=>Rs.removeManualInputRow(s),type:"button",class:"bg-red-500 hover:bg-red-600 text-white px-2 py-1 rounded text-xs"}," ลบ ",8,De)):(0,a.Q3)("",!0)])])]),Us.manualInputShowMore[s]?((0,a.uX)(),(0,a.CE)("tr",$e,[t[62]||(t[62]=(0,a.Lk)("td",null,null,-1)),(0,a.Lk)("td",Pe,[(0,a.Lk)("div",Oe,[(0,a.Lk)("div",null,[t[58]||(t[58]=(0,a.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"เพศ",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t=>e.info.sex=t,class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},[t[57]||(t[57]=(0,a.Lk)("option",{value:""},"เลือก",-1)),((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Us.sexMapping,((e,t)=>((0,a.uX)(),(0,a.CE)("option",{key:t,value:t},(0,o.v_)(e),9,Xe)))),128))],8,Me),[[r.u1,e.info.sex]])]),(0,a.Lk)("div",null,[t[59]||(t[59]=(0,a.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ประเภทหน่วยงาน",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.info.bu_type=t,placeholder:"ประเภทหน่วยงาน",class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,je),[[r.Jo,e.info.bu_type]])]),(0,a.Lk)("div",null,[t[60]||(t[60]=(0,a.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ชื่อหน่วยงาน",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.info.bu_name=t,placeholder:"ชื่อหน่วยงาน",class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,Fe),[[r.Jo,e.info.bu_name]])]),(0,a.Lk)("div",null,[t[61]||(t[61]=(0,a.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ตำแหน่ง",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t=>e.info.position=t,placeholder:"ตำแหน่ง",class:"w-full px-2 py-1 text-xs border rounded focus:ring-1 focus:ring-blue-500 focus:outline-none"},null,8,Ve),[[r.Jo,e.info.position]])])])])])):(0,a.Q3)("",!0)],64)))),128))])])])])):(0,a.Q3)("",!0),"assign"===Us.selectedTab?((0,a.uX)(),(0,a.CE)("div",Ue,t[64]||(t[64]=[(0,a.Lk)("p",null,"Select User Content (Placeholder)",-1)]))):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Re,[(0,a.Lk)("button",{onClick:t[17]||(t[17]=(...e)=>Rs.closeModal&&Rs.closeModal(...e)),class:"bg-gray-300 hover:bg-gray-400 text-gray-800 px-4 py-2 rounded text-sm"}," ปิด "),"csv"===Us.selectedTab?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[18]||(t[18]=(...e)=>Rs.processCSV&&Rs.processCSV(...e)),class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm"}," ดำเนินการ ")):(0,a.Q3)("",!0),"manual"===Us.selectedTab&&Us.manualInput.length>0?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t[19]||(t[19]=(...e)=>Rs.processManualInput&&Rs.processManualInput(...e)),class:"bg-blue-500 hover:bg-blue-600 text-white px-4 py-2 rounded text-sm"}," ดำเนินการ ")):(0,a.Q3)("",!0)])])])):(0,a.Q3)("",!0),(0,a.Lk)("div",Ne,[(0,a.Lk)("div",Qe,[(0,a.Lk)("div",He,[(0,a.Lk)("div",We,[(0,a.bo)((0,a.Lk)("input",{type:"text",class:"px-3 py-2 text-sm border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500 w-full sm:w-64",placeholder:"ค้นหา...","onUpdate:modelValue":t[20]||(t[20]=e=>Us.searchQuery=e)},null,512),[[r.Jo,Us.searchQuery]]),Us.searchQuery.length>0?((0,a.uX)(),(0,a.CE)("div",Be,[t[66]||(t[66]=(0,a.eW)(" ผลการค้นหา ")),(0,a.Lk)("span",ze,(0,o.v_)(Us.totalItems),1),t[67]||(t[67]=(0,a.eW)(" รายการ ")),(0,a.Lk)("button",{onClick:t[21]||(t[21]=(...e)=>Rs.clearSearchQuery&&Rs.clearSearchQuery(...e)),class:"ml-2 text-blue-500 hover:underline"}," ล้าง ")])):(0,a.Q3)("",!0)]),(0,a.Lk)("div",Je,[(0,a.Lk)("div",qe,[(0,a.Lk)("div",Ke,[t[68]||(t[68]=(0,a.Lk)("span",{class:"text-gray-600"},"แสดง:",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[22]||(t[22]=e=>Us.limitItem=e),onChange:t[23]||(t[23]=(...e)=>Rs.handleLimitChange&&Rs.handleLimitChange(...e)),class:"px-2 py-1 border border-gray-300 rounded text-sm"},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Us.limitOptions,(e=>((0,a.uX)(),(0,a.CE)("option",{key:e,value:e},(0,o.v_)(e),9,Ge)))),128))],544),[[r.u1,Us.limitItem]])]),Rs.hasMoreItems?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[24]||(t[24]=(...e)=>Rs.showAllItems&&Rs.showAllItems(...e)),class:"text-xs px-2 py-1 bg-orange-500 text-white rounded hover:bg-orange-600"}," แสดงทั้งหมดเลย ")):(0,a.Q3)("",!0),(0,a.Lk)("label",Ze,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[25]||(t[25]=e=>Us.layoutVisibility.order=e),class:"mr-2 rounded"},null,512),[[r.lH,Us.layoutVisibility.order]]),t[69]||(t[69]=(0,a.eW)(" คำสั่งซื้อ "))]),(0,a.Lk)("label",Ye,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[26]||(t[26]=e=>Us.layoutVisibility.enroll=e),class:"mr-2 rounded"},null,512),[[r.lH,Us.layoutVisibility.enroll]]),t[70]||(t[70]=(0,a.eW)(" การเรียน "))])])])])]),(0,a.Lk)("div",et,[(0,a.Lk)("div",tt,[(0,a.Lk)("label",st,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[27]||(t[27]=e=>Us.layoutVisibility.order=e),class:"mr-1 rounded"},null,512),[[r.lH,Us.layoutVisibility.order]]),t[71]||(t[71]=(0,a.eW)(" คำสั่งซื้อ "))]),(0,a.Lk)("label",at,[(0,a.bo)((0,a.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[28]||(t[28]=e=>Us.layoutVisibility.enroll=e),class:"mr-1 rounded"},null,512),[[r.lH,Us.layoutVisibility.enroll]]),t[72]||(t[72]=(0,a.eW)(" การเรียน "))])])]),t[95]||(t[95]=(0,a.Fv)('<div class="bg-gray-200 border-b" data-v-45f1cc93><div class="grid grid-cols-12 text-sm font-medium text-gray-700" data-v-45f1cc93><div class="col-span-1 py-3 px-3 text-center" data-v-45f1cc93>#</div><div class="col-span-3 py-3 px-3" data-v-45f1cc93>ชื่อ-นามสกุล</div><div class="col-span-2 py-3 px-3 hidden lg:block" data-v-45f1cc93>เลขบัตรประชาชน</div><div class="col-span-2 py-3 px-3 hidden md:block" data-v-45f1cc93>การติดต่อ</div><div class="col-span-1 py-3 px-3 hidden lg:block text-center" data-v-45f1cc93>หลักสูตร</div><div class="col-span-1 py-3 px-3 hidden xl:block text-center" data-v-45f1cc93>วันที่ลงทะเบียน</div><div class="col-span-2 py-3 px-3 text-center" data-v-45f1cc93>จัดการ</div></div></div>',1)),Us.isModalOpen?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,o.C4)(["min-h-[400px] relative",[Us.activeBlock?"isblock":"isunblock"]])},[Us.loading?((0,a.uX)(),(0,a.CE)("div",ot,[t[74]||(t[74]=(0,a.Lk)("div",{class:"flex items-center justify-center py-8 border-b border-gray-100"},[(0,a.Lk)("div",{class:"flex items-center space-x-2"},[(0,a.Lk)("div",{class:"inline-block animate-spin w-5 h-5 border-2 border-blue-500 border-t-transparent rounded-full"}),(0,a.Lk)("span",{class:"text-gray-600"},"กำลังโหลดข้อมูล...")])],-1)),((0,a.uX)(),(0,a.CE)(a.FK,null,(0,a.pI)(5,(e=>(0,a.Lk)("div",{key:e,class:"grid grid-cols-12 border-b border-gray-100 text-sm"},t[73]||(t[73]=[(0,a.Fv)('<div class="col-span-1 py-4 flex items-center justify-center bg-gray-50" data-v-45f1cc93><div class="w-6 h-4 skeleton rounded" data-v-45f1cc93></div></div><div class="col-span-3 py-4 px-3" data-v-45f1cc93><div class="flex items-center" data-v-45f1cc93><div class="w-10 h-10 skeleton rounded-full mr-3" data-v-45f1cc93></div><div class="flex-1" data-v-45f1cc93><div class="w-32 h-4 skeleton rounded mb-1" data-v-45f1cc93></div><div class="w-20 h-3 skeleton rounded" data-v-45f1cc93></div></div></div></div><div class="col-span-2 py-4 px-3 hidden lg:block" data-v-45f1cc93><div class="w-40 h-4 skeleton rounded" data-v-45f1cc93></div></div><div class="col-span-2 py-4 px-3 hidden md:block" data-v-45f1cc93><div class="space-y-2" data-v-45f1cc93><div class="w-28 h-3 skeleton rounded" data-v-45f1cc93></div><div class="w-36 h-3 skeleton rounded" data-v-45f1cc93></div></div></div><div class="col-span-1 py-4 px-3 hidden lg:block text-center" data-v-45f1cc93><div class="w-8 h-4 skeleton rounded mx-auto" data-v-45f1cc93></div></div><div class="col-span-1 py-4 px-3 hidden xl:block text-center" data-v-45f1cc93><div class="w-20 h-3 skeleton rounded mx-auto" data-v-45f1cc93></div></div><div class="col-span-2 py-4 px-3" data-v-45f1cc93><div class="flex items-center justify-center space-x-1" data-v-45f1cc93><div class="w-8 h-8 skeleton rounded-lg" data-v-45f1cc93></div><div class="w-8 h-8 skeleton rounded-lg" data-v-45f1cc93></div><div class="w-8 h-8 skeleton rounded-lg" data-v-45f1cc93></div></div></div>',7)])))),64))])):0===Us.listItems.length?((0,a.uX)(),(0,a.CE)("div",rt,[(0,a.Lk)("div",it,[(0,a.Lk)("div",lt,[(0,a.bF)(Hs,{icon:["fas","users"],class:"text-gray-400 text-3xl"})]),t[77]||(t[77]=(0,a.Lk)("h3",{class:"text-xl font-semibold text-gray-900 mb-2"},"ยังไม่มีผู้ลงทะเบียน",-1)),t[78]||(t[78]=(0,a.Lk)("p",{class:"text-gray-500 mb-8 max-w-md mx-auto"},[(0,a.eW)(" ยังไม่มีผู้ใดลงทะเบียนเรียนในหลักสูตรนี้ "),(0,a.Lk)("br"),(0,a.eW)("เริ่มต้นเพิ่มผู้ลงทะเบียนคนแรกได้เลย ")],-1)),(0,a.Lk)("div",nt,[(0,a.Lk)("button",{onClick:t[29]||(t[29]=(...e)=>Rs.assignUserModal&&Rs.assignUserModal(...e)),type:"button",class:"inline-flex items-center px-6 py-3 border border-transparent bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 transition-colors shadow-sm"},[(0,a.bF)(Hs,{icon:["fas","plus"],class:"mr-2"}),t[75]||(t[75]=(0,a.eW)(" เพิ่มผู้ลงทะเบียนคนแรก "))]),(0,a.Lk)("div",ct,[t[76]||(t[76]=(0,a.eW)(" หรือ ")),(0,a.Lk)("a",{href:"#",onClick:t[30]||(t[30]=(...e)=>Rs.exportToCSV&&Rs.exportToCSV(...e)),class:"text-blue-600 hover:underline"},"นำเข้าจาก CSV")])])])])):((0,a.uX)(!0),(0,a.CE)(a.FK,{key:2},(0,a.pI)(Rs.visibleItems,((s,i)=>((0,a.uX)(),(0,a.CE)(a.FK,{key:s.user._id},[(0,a.Lk)("div",dt,[(0,a.Lk)("div",ut,[(0,a.Lk)("span",pt,(0,o.v_)(Rs.leadingZero((Us.currentPage-1)*Us.limitItem+i+1)),1)]),(0,a.Lk)("div",gt,[(0,a.bF)(Ws,{to:"/student/detail/"+s.user._id+"?back=/lesson/detail/"+this.dataItem+"/enroll",class:"group"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",ht,[(0,a.Lk)("div",mt,[Rs.shouldShowInitials(s.user)?((0,a.uX)(),(0,a.CE)("div",{key:0,class:(0,o.C4)(["w-10 h-10 mr-3 rounded-full ring-2 ring-gray-100 group-hover:ring-blue-200 transition-all flex items-center justify-center text-white font-semibold text-sm",Rs.getAvatarBgColor(s.user.firstname,s.user.lastname)])},(0,o.v_)(Rs.getInitials(s.user.firstname,s.user.lastname)),3)):((0,a.uX)(),(0,a.CE)("img",{key:1,src:s.user.avatar_img,class:"w-10 h-10 mr-3 rounded-full bg-gray-200 ring-2 ring-gray-100 group-hover:ring-blue-200 transition-all",alt:"Profile",onError:e=>Rs.onImageError(s.user._id),onLoad:e=>Rs.onImageLoad(s.user._id)},null,40,yt)),"complete"===s.enroll?.analytics?.status?((0,a.uX)(),(0,a.CE)("div",ft)):"processing"===s.enroll?.analytics?.status?((0,a.uX)(),(0,a.CE)("div",xt)):((0,a.uX)(),(0,a.CE)("div",bt))]),(0,a.Lk)("div",kt,[(0,a.Lk)("div",vt,(0,o.v_)(s.user.firstname)+" "+(0,o.v_)(s.user.lastname),1),(0,a.Lk)("div",wt," ID: "+(0,o.v_)(s.user._id.slice(-8)),1)])])])),_:2},1032,["to"])]),(0,a.Lk)("div",Ct,[(0,a.Lk)("div",Lt,[(0,a.bF)(Hs,{icon:["fas","id-card"],class:"mr-2 text-xs text-gray-400"}),(0,a.Lk)("span",_t,(0,o.v_)(s.user.citizen||"-"),1)])]),(0,a.Lk)("div",It,[(0,a.Lk)("div",Tt,[(0,a.Lk)("div",Et,[(0,a.bF)(Hs,{icon:["fas","phone"],class:"mr-2 text-xs text-gray-400"}),(0,a.Lk)("span",St,(0,o.v_)(s.user.phone||"-"),1)]),(0,a.Lk)("div",At,[(0,a.bF)(Hs,{icon:["fas","envelope"],class:"mr-2 text-xs text-gray-400"}),(0,a.Lk)("span",{class:"text-sm truncate max-w-[180px]",title:s.user.email},(0,o.v_)(s.user.email||"-"),9,Dt)])])]),(0,a.Lk)("div",$t,[(0,a.Lk)("div",Pt,[(0,a.Lk)("span",Ot,(0,o.v_)(s.user.enroll&&s.user.enroll.length>0?s.user.enroll.length:"0"),1),(0,a.bF)(Hs,{icon:["fas","book"],class:"ml-1 text-gray-400 text-xs"})])]),(0,a.Lk)("div",Mt,[(0,a.Lk)("div",Xt,(0,o.v_)(s.enroll.createdAt?Rs.formatThaidate(s.enroll.createdAt):"-"),1)]),(0,a.Lk)("div",jt,[(0,a.Lk)("div",Ft,[(0,a.Lk)("div",Vt,[(0,a.Lk)("button",{onClick:t=>e.$router.push("/student/detail/"+s.user._id),class:"p-2 text-blue-600 bg-blue-50 hover:bg-blue-100 rounded-lg transition-colors group",title:"ดูรายละเอียด"},[(0,a.bF)(Hs,{icon:["fas","eye"],class:"text-xs group-hover:scale-110 transition-transform"})],8,Ut),(0,a.Lk)("button",{onClick:t=>e.$router.push("/lesson/edit/"+s.user._id),class:"p-2 text-green-600 bg-green-50 hover:bg-green-100 rounded-lg transition-colors group",title:"แก้ไขข้อมูล"},[(0,a.bF)(Hs,{icon:["fas","edit"],class:"text-xs group-hover:scale-110 transition-transform"})],8,Rt),(0,a.Lk)("div",Nt,[(0,a.Lk)("button",{onClick:e=>Rs.toggleActionDropdown(s.user._id),class:"p-2 text-gray-600 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors group",title:"ตัวเลือกเพิ่มเติม"},[(0,a.bF)(Hs,{icon:["fas","ellipsis-vertical"],class:"text-xs group-hover:scale-110 transition-transform"})],8,Qt),Us.activeDropdown===s.user._id?((0,a.uX)(),(0,a.CE)("div",Ht,[(0,a.Lk)("button",{onClick:e=>Rs.sendNotification(s.user._id),class:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center"},[(0,a.bF)(Hs,{icon:["fas","bell"],class:"mr-2 text-xs"}),t[79]||(t[79]=(0,a.eW)(" ส่งการแจ้งเตือน "))],8,Wt),(0,a.Lk)("button",{onClick:e=>Rs.resetProgress(s.user._id),class:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center"},[(0,a.bF)(Hs,{icon:["fas","redo"],class:"mr-2 text-xs"}),t[80]||(t[80]=(0,a.eW)(" รีเซ็ตความคืบหน้า "))],8,Bt),"complete"===s.enroll?.analytics?.status?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:e=>Rs.generateCertificate(s.user._id),class:"w-full text-left px-3 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center"},[(0,a.bF)(Hs,{icon:["fas","certificate"],class:"mr-2 text-xs"}),t[81]||(t[81]=(0,a.eW)(" สร้างใบรับรอง "))],8,zt)):(0,a.Q3)("",!0),t[83]||(t[83]=(0,a.Lk)("hr",{class:"my-1"},null,-1)),(0,a.Lk)("button",{onClick:e=>Rs.removeEnrollment(s.user._id),class:"w-full text-left px-3 py-2 text-sm text-red-600 hover:bg-red-50 flex items-center"},[(0,a.bF)(Hs,{icon:["fas","trash"],class:"mr-2 text-xs"}),t[82]||(t[82]=(0,a.eW)(" ลบออกจากหลักสูตร "))],8,Jt)])):(0,a.Q3)("",!0)])])])])]),(0,a.Lk)("div",qt,[(0,a.Lk)("div",Kt,[(0,a.Lk)("div",Gt,[(0,a.Lk)("div",Zt,[(0,a.bF)(Hs,{icon:["fas","id-card"],class:"mr-2 text-xs text-gray-400"}),(0,a.Lk)("span",Yt,(0,o.v_)(s.user.citizen||"-"),1)]),(0,a.Lk)("div",es,[(0,a.bF)(Hs,{icon:["fas","phone"],class:"mr-2 text-xs text-gray-400"}),(0,a.Lk)("span",ts,(0,o.v_)(s.user.phone||"-"),1)]),(0,a.Lk)("div",ss,[(0,a.bF)(Hs,{icon:["fas","envelope"],class:"mr-2 text-xs text-gray-400"}),(0,a.Lk)("span",as,(0,o.v_)(s.user.email||"-"),1)])]),(0,a.Lk)("div",os,[(0,a.Lk)("button",{onClick:t=>e.$router.push("/student/detail/"+s.user._id),class:"flex-1 bg-blue-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-blue-700 transition-colors"},[(0,a.bF)(Hs,{icon:["fas","eye"],class:"mr-1"}),t[84]||(t[84]=(0,a.eW)(" ดูรายละเอียด "))],8,rs),(0,a.Lk)("button",{onClick:t=>e.$router.push("/lesson/edit/"+s.user._id),class:"flex-1 bg-green-600 text-white px-3 py-2 rounded-lg text-sm font-medium hover:bg-green-700 transition-colors"},[(0,a.bF)(Hs,{icon:["fas","edit"],class:"mr-1"}),t[85]||(t[85]=(0,a.eW)(" แก้ไข "))],8,is)])])]),Object.values(Us.layoutVisibility).some((e=>e))?((0,a.uX)(),(0,a.CE)("div",ls,[(0,a.Lk)("div",ns,[Us.layoutVisibility.enroll?((0,a.uX)(),(0,a.CE)("div",cs,[(0,a.Lk)("div",ds,[(0,a.Lk)("div",us,[t[86]||(t[86]=(0,a.Lk)("div",{class:"text-xs text-gray-600 mb-1"},"ความคืบหน้า",-1)),(0,a.Lk)("div",ps,["complete"===s.enroll?.analytics?.status?((0,a.uX)(),(0,a.CE)(a.FK,{key:0},[(0,a.eW)((0,o.v_)(s.enroll?.analytics?.complete||"N/A"),1)],64)):"processing"===s.enroll?.analytics?.status?((0,a.uX)(),(0,a.CE)(a.FK,{key:1},[(0,a.eW)((0,o.v_)(s.enroll?.analytics?.complete||"0")+" / "+(0,o.v_)(s.enroll?.analytics?.total||""),1)],64)):((0,a.uX)(),(0,a.CE)(a.FK,{key:2},[(0,a.eW)(" 0 / "+(0,o.v_)(s.enroll?.analytics?.total||""),1)],64))])]),(0,a.Lk)("div",gs,[t[87]||(t[87]=(0,a.Lk)("div",{class:"text-xs text-gray-600 mb-1"},"ก่อนเรียน",-1)),(0,a.Lk)("div",{class:(0,o.C4)(["text-lg font-semibold",[s.enroll?.analytics?.pre?.score>=33?"text-green-600":"text-red-600"]])},(0,o.v_)(s.enroll?.analytics?.pre?.score||"N/A"),3),(0,a.Lk)("div",hs,[(0,a.Lk)("button",{onClick:e=>Rs.resetScore(s.enroll?.examPre[0]?._id,s.user._id,s.enroll._id),class:"text-xs bg-gray-100 text-gray-700 px-2 py-1 hover:bg-gray-200"}," รีเซ็ต ",8,ms),(0,a.Lk)("div",ys,[(0,a.Lk)("button",{onClick:t[31]||(t[31]=(...e)=>Rs.toggleDropdown&&Rs.toggleDropdown(...e)),class:"text-xs bg-gray-100 text-gray-700 px-2 py-1 hover:bg-gray-200"}," ข้าม "),Us.dropdownVisible?((0,a.uX)(),(0,a.CE)("div",fs,[(0,a.Lk)("a",{href:"#",onClick:(0,r.D$)((e=>Rs.bypassVerified(s.enroll._id,"pre",s.enroll.verified)),["prevent"]),class:"block px-3 py-2 text-gray-700 hover:bg-gray-100"}," ข้าม Verified (ก่อนเรียน) ",8,xs),(0,a.Lk)("a",{href:"#",onClick:(0,r.D$)((e=>Rs.bypassVerified(s.enroll._id,"post",s.enroll.verified)),["prevent"]),class:"block px-3 py-2 text-gray-700 hover:bg-gray-100"}," ข้าม Verified (หลังเรียน) ",8,bs)])):(0,a.Q3)("",!0)])])]),(0,a.Lk)("div",ks,[t[88]||(t[88]=(0,a.Lk)("div",{class:"text-xs text-gray-600 mb-1"},"หลังเรียน",-1)),(0,a.Lk)("div",{class:(0,o.C4)(["text-lg font-semibold",[s.enroll?.analytics?.post?.score>32?"text-green-600":"text-red-600"]])},(0,o.v_)(s.enroll?.analytics?.post?.score||"N/A"),3)]),(0,a.Lk)("div",vs,[t[89]||(t[89]=(0,a.Lk)("div",{class:"text-xs text-gray-600 mb-1"},"สอบซ่อม",-1)),(0,a.Lk)("div",{class:(0,o.C4)(["text-lg font-semibold",[s.enroll?.analytics?.retest?.score>32?"text-green-600":"text-red-600"]])},(0,o.v_)(s.enroll?.analytics?.retest?.score||"N/A"),3)]),(0,a.Lk)("div",ws,[t[90]||(t[90]=(0,a.Lk)("div",{class:"text-xs text-gray-600 mb-1"},"สถานะ",-1)),(0,a.Lk)("div",{class:(0,o.C4)(["text-sm font-medium",["ผ่านการรับรอง"===s.enroll?.analytics?.post?.message?"text-green-600":"text-red-600"]])},(0,o.v_)(s.enroll?.analytics?.post?.message||"N/A"),3)])]),(0,a.Lk)("div",Cs,[(0,a.Lk)("div",Ls,[t[93]||(t[93]=(0,a.Lk)("h4",{class:"text-sm font-medium text-gray-900"},"เครื่องมือเพิ่มเติม",-1)),(0,a.Lk)("div",_s,[(0,a.Lk)("button",{onClick:e=>Rs.generateDetailReport(s.user._id),class:"inline-flex items-center px-3 py-1.5 text-xs text-blue-600 bg-gray-100 border border-gray-300 hover:bg-gray-200"},[(0,a.bF)(Hs,{icon:["fas","file-alt"],class:"mr-1"}),t[91]||(t[91]=(0,a.eW)(" รายงานรายละเอียด "))],8,Is),(0,a.Lk)("button",{onClick:e=>Rs.sendProgressUpdate(s.user._id),class:"inline-flex items-center px-3 py-1.5 text-xs text-green-600 bg-gray-100 border border-gray-300 hover:bg-gray-200"},[(0,a.bF)(Hs,{icon:["fas","paper-plane"],class:"mr-1"}),t[92]||(t[92]=(0,a.eW)(" ส่งรายงานความคืบหน้า "))],8,Ts),(0,a.bF)(Bs)])])])])):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)],64)))),128)),Us.lazy?((0,a.uX)(),(0,a.CE)("div",Es,[(0,a.Lk)("div",Ss,[Us.isLoadingMore?((0,a.uX)(),(0,a.CE)("div",As,t[94]||(t[94]=[(0,a.Lk)("svg",{class:"animate-spin h-4 w-4",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},[(0,a.Lk)("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),(0,a.Lk)("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})],-1),(0,a.Lk)("span",{class:"text-sm"},"กำลังโหลดเพิ่ม...",-1)]))):Rs.hasMoreItems?((0,a.uX)(),(0,a.CE)("button",{key:1,onClick:t[32]||(t[32]=(...e)=>Rs.loadMoreItems&&Rs.loadMoreItems(...e)),class:"inline-flex items-center px-4 py-2 border border-blue-300 rounded-md text-sm font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 transition-colors"},[(0,a.bF)(Hs,{icon:["fas","plus"],class:"mr-2"}),(0,a.eW)(" โหลดเพิ่ม ("+(0,o.v_)(Rs.progressiveLoadingStats?.remaining||0)+" รายการ) ",1)])):((0,a.uX)(),(0,a.CE)("div",Ds,[(0,a.bF)(Hs,{icon:["fas","check-circle"],class:"mr-1"}),(0,a.eW)(" แสดงครบทั้งหมดแล้ว ("+(0,o.v_)(Rs.progressiveLoadingStats?.total||0)+" รายการ) ",1)]))])])):(0,a.Q3)("",!0),(0,a.bF)(r.eB,{name:"toast-slide"},{default:(0,a.k6)((()=>[Us.showProgressToast&&Rs.progressiveLoadingStats&&Rs.progressiveLoadingStats.percentage<100?((0,a.uX)(),(0,a.CE)("div",$s,[(0,a.Lk)("div",Ps,[(0,a.Lk)("div",Os,[(0,a.bF)(Hs,{icon:["fas","list"],class:"text-blue-200"}),(0,a.Lk)("span",Ms," แสดง "+(0,o.v_)(Rs.progressiveLoadingStats.showing)+" / "+(0,o.v_)(Rs.progressiveLoadingStats.total)+" รายการ ",1)]),(0,a.Lk)("div",Xs,[(0,a.Lk)("div",{class:"bg-white h-1.5 rounded-full transition-all duration-300",style:(0,o.Tr)(`width: ${Rs.progressiveLoadingStats.percentage}%`)},null,4)]),(0,a.Lk)("span",js,(0,o.v_)(Rs.progressiveLoadingStats.percentage)+"%",1),Rs.hasMoreItems?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[33]||(t[33]=(...e)=>Rs.showAllItems&&Rs.showAllItems(...e)),class:"text-xs px-2 py-1 bg-white bg-opacity-20 rounded hover:bg-opacity-30 transition-colors"}," ทั้งหมด ")):(0,a.Q3)("",!0)])])):(0,a.Q3)("",!0)])),_:1})],2)),Us.listItems.length>0?((0,a.uX)(),(0,a.CE)("div",Fs,[(0,a.bF)(zs,{"current-page":Us.currentPage,"total-items":Us.totalItems,"total-pages":Us.totalPages,"limit-items":Us.limitItem,"data-loading":Us.loading,"display-mode":"summary",onPageChanged:Rs.handlePageChanged},null,8,["current-page","total-items","total-pages","limit-items","data-loading","onPageChanged"])])):(0,a.Q3)("",!0)])])])],64)}s(54520),s(72577),s(3949),s(81454),s(14603),s(47566),s(98721);var Us=s(40475),Rs=s(75435),Ns=s(38558),Qs=s(86530),Hs=s(9964),Ws=s(63084),Bs=s(21396),zs=s.n(Bs),Js=s(73288);const qs={class:"bg-white p-6 rounded-lg shadow-lg max-w-3xl w-full relative"},Ks={class:"flex items-center justify-between border-b pb-2 mb-4"},Gs={class:"flex items-center"},Zs={class:"flex items-center mb-2"},Ys=["id","onUpdate:modelValue","onChange"],ea=["for"],ta={key:0},sa={class:"flex items-center mb-2"},aa=["id","onUpdate:modelValue","onChange"],oa=["for"],ra={key:0,class:"ml-4"},ia={class:"flex items-center"},la=["id","onUpdate:modelValue","onChange"],na=["for"],ca={key:0,class:"ml-4"},da={class:"flex items-center"},ua=["id","onUpdate:modelValue","onChange"],pa=["for"],ga={key:0,class:"ml-4"};function ha(e,t,s,i,l,n){const c=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)(a.FK,null,[(0,a.Lk)("button",{onClick:t[0]||(t[0]=e=>l.showModal=!0),class:"mr-2 inline-flex justify-center rounded-md border border-gray-300 bg-white px-1 py-1 text-xs font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2"},[(0,a.bF)(c,{icon:["fas","key"],class:"text-black mt-[3px] mr-2 text-md"}),t[3]||(t[3]=(0,a.Lk)("span",null,"สิทธิ์การใช้งาน",-1))]),l.showModal?((0,a.uX)(),(0,a.CE)("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50",onClick:t[2]||(t[2]=(0,r.D$)((e=>l.showModal=!1),["self"]))},[(0,a.Lk)("div",qs,[(0,a.Lk)("div",Ks,[(0,a.Lk)("div",Gs,[(0,a.bF)(c,{icon:["fas","key"],class:"text-black mt-[3px] mr-2 text-md"}),t[4]||(t[4]=(0,a.Lk)("h2",{class:"text-lg font-semibold"},"จำกัดสิทธิ์ในการใช้งานของผู้เรียน : Limitation",-1))]),(0,a.Lk)("span",{class:"text-xl cursor-pointer",onClick:t[1]||(t[1]=e=>l.showModal=!1)},"×")]),(0,a.Lk)("div",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(l.limitation,((e,t)=>((0,a.uX)(),(0,a.CE)("div",{key:t,class:"mb-4"},[(0,a.Lk)("div",Zs,[(0,a.bo)((0,a.Lk)("input",{id:n.getItemId(e),"onUpdate:modelValue":t=>e.checked=t,onChange:t=>n.checkAll(e,e.checked),type:"checkbox",class:"mr-2"},null,40,Ys),[[r.lH,e.checked]]),(0,a.Lk)("label",{for:n.getItemId(e),class:"font-semibold"},(0,o.v_)(e.name),9,ea)]),e.hasSub?((0,a.uX)(),(0,a.CE)("div",ta,[(0,a.Lk)("div",{class:(0,o.C4)("exam"===e.code&&e.subItems.length>2?"grid grid-cols-4 gap-4 ml-4":"ml-4")},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.subItems,((t,s)=>((0,a.uX)(),(0,a.CE)("div",{key:s,class:"mb-2"},[(0,a.Lk)("div",sa,[(0,a.bo)((0,a.Lk)("input",{id:n.getItemId(t,e),"onUpdate:modelValue":e=>t.checked=e,onChange:e=>n.checkAll(t,t.checked),type:"checkbox",class:"mr-2"},null,40,aa),[[r.lH,t.checked]]),(0,a.Lk)("label",{for:n.getItemId(t,e)},(0,o.v_)(t.name),9,oa)]),t.hasSub?((0,a.uX)(),(0,a.CE)("div",ra,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(t.subItems,((s,i)=>((0,a.uX)(),(0,a.CE)("div",{key:i,class:"mb-2"},[(0,a.Lk)("div",ia,[(0,a.bo)((0,a.Lk)("input",{id:n.getItemId(s,t,e),"onUpdate:modelValue":e=>s.checked=e,onChange:e=>n.checkAll(s,s.checked),type:"checkbox",class:"mr-2"},null,40,la),[[r.lH,s.checked]]),(0,a.Lk)("label",{for:n.getItemId(s,t,e)},(0,o.v_)(s.name),9,na)]),s.hasSub?((0,a.uX)(),(0,a.CE)("div",ca,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(s.subItems,((i,l)=>((0,a.uX)(),(0,a.CE)("div",{key:l,class:"mb-2"},[(0,a.Lk)("div",da,[(0,a.bo)((0,a.Lk)("input",{id:n.getItemId(i,s,t,e),"onUpdate:modelValue":e=>i.checked=e,onChange:e=>n.checkAll(i,i.checked),type:"checkbox",class:"mr-2"},null,40,ua),[[r.lH,i.checked]]),(0,a.Lk)("label",{for:n.getItemId(i,s,t,e)},(0,o.v_)(i.name),9,pa)]),i.hasSub?((0,a.uX)(),(0,a.CE)("div",ga)):(0,a.Q3)("",!0)])))),128))])):(0,a.Q3)("",!0)])))),128))])):(0,a.Q3)("",!0)])))),128))],2)])):(0,a.Q3)("",!0)])))),128)),(0,a.Lk)("div",null,[t[5]||(t[5]=(0,a.Lk)("h3",{class:"font-bold mb-2"},"Check Path Result:",-1)),(0,a.Lk)("p",null,'Path "lesson.create": '+(0,o.v_)(n.checkPathResult("lesson.access")),1),(0,a.Lk)("p",null,'Path "exam.pretest.create": '+(0,o.v_)(n.checkPathResult("exam.pretest.take")),1)])])])])):(0,a.Q3)("",!0)],64)}function ma(e,t){const s=e.find((e=>e.path===t));return!!s&&!!s.checked}var ya={data(){return{showModal:!1,limitation:[{code:"lesson",name:"หลักสูตร (Lesson)",hasSub:!0,subItems:[{code:"access",name:"เข้าเรียน"},{code:"access_not_record",name:"เข้าเรียนไม่บันทึกความคืบหน้า"},{code:"view",name:"ดูเนื้อหาเข้าเรียนไม่ได้"}]},{code:"exam",name:"การวัดผล (Exam)",hasSub:!0,subItems:[{code:"pretest",name:"แบบทดสอบก่อนเรียน",hasSub:!0,subItems:[{code:"take",name:"ทำแบบทดสอบ"},{code:"score",name:"แสดงคะแนน"},{code:"cert",name:"แสดงใบรับรอง"},{code:"download",name:"ดาวน์โหลดใบรับรอง"}]},{code:"posttest",name:"แบบทดสอบวัดผล",hasSub:!0,subItems:[{code:"take",name:"ทำแบบทดสอบ"},{code:"score",name:"แสดงคะแนน"},{code:"cert",name:"แสดงใบรับรอง"},{code:"download",name:"ดาวน์โหลดใบรับรอง"}]},{code:"retest",name:"สอบซ่อม",hasSub:!0,subItems:[{code:"take",name:"ทำแบบทดสอบ"},{code:"score",name:"แสดงคะแนน"},{code:"cert",name:"แสดงใบรับรอง"},{code:"download",name:"ดาวน์โหลดใบรับรอง"}]}]}],checkedItems:[]}},watch:{limitation:{handler(){this.updateCheckedItems()},deep:!0}},methods:{getItemId(e,t,s,a){let o=e.code;return t&&(o=t.code+"-"+o),s&&(o=s.code+"-"+o),a&&(o=a.code+"-"+o),o},checkAll(e,t){e.hasSub&&e.subItems&&e.subItems.forEach((e=>{e.checked=t,this.checkAll(e,t)})),this.updateCheckedItems()},updateCheckedItems(){const e=[],t=(s,a="")=>{s.forEach((s=>{const o=a?`${a}.${s.code}`:s.code;s.hasSub||e.push({path:o,checked:s.checked}),s.hasSub&&s.subItems&&t(s.subItems,o)}))};t(this.limitation),this.checkedItems=e},checkPathResult(e){return ma(this.checkedItems,e)}}},fa=s(64621);const xa=(0,fa.A)(ya,[["render",ha],["__scopeId","data-v-4252b3b6"]]);var ba=xa,ka={props:{pageTitle:{type:String,default:()=>""},courseData:Object,callParentFunctionProp:Function,tabs:Object,updateTabs:Object},data(){const e=Us.A.get("session");return{lazy:!0,initialDisplayCount:20,loadMoreCount:10,currentDisplayCount:20,isLoadingMore:!1,scrollCleanup:null,showProgressToast:!1,scrollTimeout:null,open:!1,dropdownVisible:!1,manualInputShowMore:[],dataItem:this.$route.params.id,school:e.current.id,login:e.login,isModalOpen:!1,csvData:[],editingCell:null,listItems:[],listItems_chunk:[],categoryData:[],loading_sources:!0,endpoint:"",master:e.master,accessToken:Us.A.get("session","token"),configs:Us.A.get("configs"),session:Us.A.get("session"),limitItem:100,limitOptions:[1,10,50,100,200,500,1e3,2e3,3e3,4e3],currentPage:1,totalPages:0,totalItems:0,loading:!1,showingOverlay:!1,searchQuery:"",statusFilter:"all",isCreatingUser:!1,isShowingOverlay:!1,loadingMessage:"",processingCount:"",debounceTimer:null,activeBlock:!1,scb:[],isProcessing:!1,selectedTab:"csv",manualInput:[{firstname:"",lastname:"",citizen:null,phone:"",email:"",username:"",password:"",parent:e.current._id,salt:"",role:"user",info:{prefix:"",sex:"",bu_type:"",bu_name:"",position:""}}],prefixMapping:{mrs:"นาง",mis:"นางสาว",mr:"นาย"},sexMapping:{male:"ชาย",female:"หญิง",other:"ไม่ระบุ"},educationMapping:{standard_bachelor:"ปริญญาตรี",upper_bachelor:"สูงกว่าปริญญาตรี",under_bachelor:"ต่ำกว่าปริญญาตรี"},processName:"Enroll Processing",progressText:"",progressTotal:0,progressCurrent:0,startTime:null,endTime:null,layoutVisibility:{order:!0,enroll:!0},cert_area:[{id:"1",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 1"},{id:"2",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 2"},{id:"3",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 3"},{id:"4",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 4"},{id:"5",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 5"},{id:"6",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 6"},{id:"7",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 7"},{id:"8",value:"สำนักวิจัยและพัฒนาการเกษตรเขตที่ 8"},{id:"9",value:"สำนักควบคุมพืชและวัสดุการเกษตร กรุงเทพมหานคร"}],cert_age:[{id:"3",value:"จำหน่ายสารไกลโฟเซต"},{id:"5",value:"ไม่จำหน่ายสารไกลโฟเซต"}],allData:[],chunkSize:100,showPreviewModal:!1,isExporting:!1,progressMessage:"",extractedData:[],selectedFileName:"",activeDropdown:null,imageErrors:{}}},components:{Loader:Rs.A,Pagination:Ns.A,BatchProgress:Qs.A,Limit:ba},methods:{toggleDropdown(){this.dropdownVisible=!this.dropdownVisible},async loadMoreItems(){!this.isLoadingMore&&this.hasMoreItems&&(this.isLoadingMore=!0,await new Promise((e=>setTimeout(e,300))),this.currentDisplayCount=Math.min(this.currentDisplayCount+this.loadMoreCount,this.listItems.length),this.isLoadingMore=!1)},setupScrollDetection(){if(!this.lazy)return;const e=this.debounce((()=>{if(this.isLoadingMore||!this.hasMoreItems)return;const e=[window,document.documentElement,document.body];for(const t of e){const e=t===window?Math.max(document.documentElement.scrollHeight,document.body.scrollHeight):t.scrollHeight,s=t===window?window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop,a=t===window?window.innerHeight:t.clientHeight;if(s+a>=.8*e){this.loadMoreItems();break}}}),100),t=["scroll","wheel"],s=[window,document,document.body];s.forEach((s=>{t.forEach((t=>{s.addEventListener(t,e,{passive:!0})}))})),this.scrollCleanup=()=>{s.forEach((s=>{t.forEach((t=>{s.removeEventListener(t,e)}))}))}},resetDisplayCount(){const e=this.listItems.length;this.limitItem<=50?this.initialDisplayCount=Math.min(25,e):this.limitItem<=100?this.initialDisplayCount=Math.min(50,e):this.limitItem<=500?this.initialDisplayCount=Math.min(100,e):this.initialDisplayCount=Math.min(200,e),this.currentDisplayCount=this.initialDisplayCount,this.$nextTick((()=>{this.setupScrollDetection(),this.setupScrollToastDetection()}))},setupScrollToastDetection(){const e=()=>{!this.progressiveLoadingStats||this.progressiveLoadingStats.percentage>=100||(this.showProgressToast=!0,this.scrollTimeout&&clearTimeout(this.scrollTimeout),this.scrollTimeout=setTimeout((()=>{this.showProgressToast=!1}),2e3))},t=[window,document,document.body];t.forEach((t=>{t.addEventListener("scroll",e,{passive:!0})}));const s=()=>{t.forEach((t=>{t.removeEventListener("scroll",e)})),this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null)},a=this.scrollCleanup;this.scrollCleanup=()=>{a&&a(),s()}},showAllItems(){this.currentDisplayCount=this.listItems.length,this.scrollCleanup&&(this.scrollCleanup(),this.scrollCleanup=null)},debounce(e,t){let s;return function(...a){const o=()=>{clearTimeout(s),e(...a)};clearTimeout(s),s=setTimeout(o,t)}},resetProgressToast(){this.showProgressToast=!1,this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null)},addManualInputRow(){const e=Us.A.get("session");this.manualInput.push({firstname:"",lastname:"",citizen:null,phone:"",email:"",username:"",password:"",parent:e.current._id,salt:"",role:"user",info:{prefix:"",sex:"",bu_type:"",bu_name:"",position:""}})},removeManualInputRow(e){this.manualInput.length>1&&this.manualInput.splice(e,1)},async batchProcess(){try{this.isProcessing=!0,this.progressTotal=this.totalItems,this.startTime=(new Date).toISOString(),this.endTime=null;while(this.currentPage<=this.totalPages){for(const e of this.listItems){console.log("User",e.user._id);const t=await this.fetchAdditionalData(e.user);if(t&&t[0]){const s=t[0].formData["upload-33-13-13"]?.value?.[0];s&&(console.log("Form",s),await this.updateAvatarImg(e.user,s))}}if(this.progressCurrent+=this.listItems.length,this.progressText=`Processing: ${this.progressCurrent}/${this.progressTotal}`,!(this.currentPage<this.totalPages))break;this.currentPage++,await this.getData()}this.progressText="All Process: Done",this.endTime=(new Date).toISOString(),this.isProcessing=!1}catch(e){console.error("Error during batch processing:",e),this.isProcessing=!1}},async updateAvatarImg(e,t){const s={data:{avatar_img:t},options:{}};try{const{data:t,status:a}=await this.$Request.PUT(`user/${e._id}`,s,this.configs.key);200===a?console.log(`Avatar updated for user ${e._id} ${t}`):console.error(`Failed to update avatar for user ${e._id}`)}catch(a){console.error(`Error updating avatar for user ${e._id}:`,a)}},async fetchAdditionalData(e){try{const t=await this.$Request.POST("form/query",{method:"find",args:[{$and:[{userID:e._id}]}]},this.configs.key);return t.data}catch(t){return console.error("Error fetching additional data:",t),null}},async callbackFunction(){try{Ws.A.log("callbackFunction"),await this.getData()}catch(e){console.error(e)}},updateBadge(e){Ws.A.log(e),this.$emit("update-badge",{code:this.tabs.code,badge:e})},isEditing(e,t){return null!==this.editingCell&&this.editingCell.rowIndex===e&&this.editingCell.cellIndex===t},startEditing(e,t){this.editingCell={rowIndex:e,cellIndex:t}},stopEditing(e,t){this.editingCell=null,Ws.A.log(e,t)},selectTab(e){this.selectedTab=e},assignUserModal(){this.isModalOpen=!0},closeModal(){document.body.classList.remove("body-scroll-lock"),this.isModalOpen=!1},handleFileUpload(e){const t=e.target.files[0];if(t){this.selectedFileName=t.name;const e=new FileReader;e.onload=e=>{const t=e.target.result;this.parseCSV(t)},e.readAsText(t)}},parseCSV(e){const t=e.split("\n"),s=[];for(let a=0;a<t.length;a++){const e=t[a].split(",");s.push(e)}this.csvData=s},openCSVModal(){document.body.classList.add("body-scroll-lock"),this.csvModalOpen=!0},async processManualInput(){try{for(const e of this.manualInput){const t=zs().lib.WordArray.random(16),s=zs().SHA256(e.password+t).toString(),a={firstname:e.firstname,lastname:e.lastname,citizen:null,phone:e.phone,email:e.email,username:e.username,password:s,parent:this.session.current._id,salt:t.toString(),role:"user",info:{prefix:e.info.prefix,bu_type:e.info.bu_type,bu_name:e.info.bu_name,position:e.info.position}},o=await fetch("https://gateway.cloudrestfulapi.com/api/user/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});if(200===o.status){const e=await o.json(),t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{userID:e._id,courseID:this.dataItem,analytics:{total:0,pending:0,processing:0,complete:0,status:"pending",message:"Not started",post:{req:!1,has:!1,measure:null,score:null,result:!1,message:null},pre:{req:!1,has:!1,measure:null,result:!1,message:null},retest:{req:!1,has:!1,measure:null,result:!1,message:null},option:{cert_area:null,exam_round:null},percent:0}},options:{}})});if(200===t.status){const e=await t.json();await fetch("https://gateway.cloudrestfulapi.com/api/course/"+this.dataItem+"/enroll",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({action:"add",element:e._id,type:"string"})})}}}this.isModalOpen=!1,this.manualInput=[{firstname:"",lastname:"",citizen:null,phone:"",email:"",username:"",password:"",parent:this.session.current._id,salt:"",role:"user",info:{prefix:"",sex:"",bu_type:"",bu_name:"",position:""}}],await this.getData(),await this.getCourse(),this.fetchData()}catch(e){console.error("Error processing manual input:",e)}},async processCSV(){try{for(const e of this.csvData){const t=zs().lib.WordArray.random(16),s=zs().SHA256(e[6]+t).toString(),a={firstname:e[3],lastname:e[4],citizen:null,phone:e[6],email:e[7].trim(),username:e[7].trim(),password:s,parent:this.session.current._id,salt:t.toString(),role:"user",info:{}};e[2]&&(a.info.prefix=e[2]),e[1]&&(a.info.bu_type=e[1]),e[0]&&(a.info.bu_name=e[0]),e[5]&&(a.info.position=e[5]);const o=await fetch("https://gateway.cloudrestfulapi.com/api/user/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:a})});if(200===o.status){const e=await o.json(),t=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{userID:e._id,courseID:this.dataItem,analytics:{total:0,pending:0,processing:0,complete:0,status:"pending",message:"Not started",post:{req:!1,has:!1,measure:null,score:null,result:!1,message:null},pre:{req:!1,has:!1,measure:null,result:!1,message:null},retest:{req:!1,has:!1,measure:null,result:!1,message:null},option:{cert_area:null,exam_round:null},percent:0}},options:{}})});if(200===t.status){const e=await t.json();await fetch("https://gateway.cloudrestfulapi.com/api/course/"+this.dataItem+"/enroll",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({action:"add",element:e._id,type:"string"})})}}}this.isModalOpen=!1,await this.getData(),await this.getCourse(),this.fetchData()}catch(e){console.error("Error processing CSV:",e)}},togglePanel(){this.open=!this.open},closePanel(){this.open=!1},leadingZero(e){return e<10?"0"+e:e.toString()},getCertAreaValue(e){const t=this.cert_area.find((t=>t.id===e));return t?t.value:""},getCertAgeValue(e){const t=this.cert_age.find((t=>t.id===e));return t?t.value:""},async fetchData(){try{const e=await fetch("https://vue-project.sgp1.digitaloceanspaces.com/Demo3/convertcsv_3155.json");if(!e.ok)throw new Error("Network response was not ok");const t=await e.json();this.scb=t}catch(e){console.error("Error fetching data:",e.message)}},searchData(e,t){const s=e,a=this.searchSCBData(s);a&&this.updateOrderStatus(t),Ws.A.log("Result:",a)},searchSCBData(e){const t=this.scb.some((t=>t.id1===e));return t},async exportToCSV(){this.isExporting=!0,this.allData=[];let e=1,t=!0,s=0;while(t){const a=await this.getDataChunk(e,this.chunkSize);s+=a.length,this.progressMessage=`Processing ${s} / ${this.totalItems} items`,0===a.length?t=!1:(this.allData=this.allData.concat(a),e++)}this.isExporting=!1,this.extractedData=this.extractData(this.allData),this.showPreviewModal=!0},async getDataChunk(e,t){await this.getData(e,t,"silence");const s=[...this.listItems_chunk];return s},downloadCSV(e){const t=this.extractData(e),s=this.convertToCSV(t),a=this.courseData.name||"course",o=new Date,r=`${o.getFullYear()}${(o.getMonth()+1).toString().padStart(2,"0")}${o.getDate().toString().padStart(2,"0")}_${o.getHours().toString().padStart(2,"0")}${o.getMinutes().toString().padStart(2,"0")}`,i=`${a}_รายชื่อผู้ลงทะเบียนหลักสูตร_${r}.csv`,l=new Blob([s],{type:"text/csv;charset=utf-8;"}),n=document.createElement("a"),c=URL.createObjectURL(l);n.setAttribute("href",c),n.setAttribute("download",i),n.style.visibility="hidden",document.body.appendChild(n),n.click(),document.body.removeChild(n)},extractData(e){return e.map((e=>({"ชื่อจริง":e.user?.firstname??"","นามสกุล":e.user?.lastname??"","เลขบัตรประชาชน":e.user?.citizen??"","เบอร์โทร":e.user?.phone??"","อีเมล":e.user?.email??"","ชื่อหลักสูตร":e.enroll?.course?.name??"","บทเรียนทั้งหมด":e.enroll?.analytics?.total??0,"รอเรียน":e.enroll?.analytics?.pending??0,"กำลังเรียน":e.enroll?.analytics?.processing??0,"เรียบจบแล้ว":e.enroll?.analytics?.complete??0,"คะแนนสอบหลังเรียน":e.enroll?.analytics?.post?.score??0,"วันที่ลงทะเบียน":e.enroll?.createdAt??"","วันที่เข้าเรียนล่าสุด":e.enroll?.updatedAt??""})))},convertToCSV(e){if(!e||!e.length)return"";const t=Object.keys(e[0]).join(","),s=e.map((e=>Object.values(e).map((e=>("string"===typeof e&&/[",\n]/.test(e)&&(e=`"${e.replace(/"/g,'""')}"`),e))).join(",")));return[t,...s].join("\n")},formatDeliveryAddress(e){const t={mailinG_NO:"เลขที่",mailinG_MOO:"หมู่ที่",mailinG_ROAD_TH:"ถนน",mailinG_SOI_TH:"ซอย",mailinG_BUILDING_TH:"อาคาร/ตึก",mailinG_SUB_DISTRICT_TH:"ตำบล/แขวง",mailinG_DISTRICT_TH:"อำเภอ/เขต"};return this.getAddressString(e,t)},formatInvoiceAddress(e){Ws.A.log(e);const t={officE_NO:"เลขที่",officE_MOO:"หมู่ที่",officE_ROAD_TH:"ถนน",officE_SOI_TH:"ซอย",officE_BUILDING_TH:"อาคาร/ตึก",officE_SUB_DISTRICT_TH:"ตำบล/แขวง",officE_DISTRICT_TH:"อำเภอ/เขต"};return this.getAddressString(e,t)},formatTaxAddress(e){const t={taX_NO:"เลขที่",taX_MOO:"หมู่ที่",taX_ROAD_TH:"ถนน",taX_SOI_TH:"ซอย",taX_BUILDING_TH:"อาคาร/ตึก",taX_SUB_DISTRICT_TH:"ตำบล/แขวง",taX_DISTRICT_TH:"อำเภอ/เขต"};return this.getAddressString(e,t)},getAddressString(e,t){const s=[];Object.keys(t).forEach((a=>{if(e&&a in e&&e[a])if("object"===typeof e[a]){const o=Object.values(e[a]).join(" ");o.trim().length>0&&s.push(`${t[a]} ${o}`)}else s.push(`${t[a]} ${e[a]}`)}));const a=s.join(" ");return a.length>0?a:"ไม่มีข้อมูลที่อยู่"},formatThaidate(e){return Hs.A.toThaiDatetime(e,"short")},handleLimitChange(){const e=Us.A.get("session");e.limitItem=this.limitItem,Us.A.set("session",e),this.currentPage=1,e.currentPage=this.currentPage,Us.A.set("session",e);const t=new URLSearchParams(window.location.search);t.set("page",e.currentPage);const s=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",s),Ws.A.log("getdata","handleLimitChange"),this.getData(),this.resetProgressToast(),this.$nextTick((()=>{this.resetDisplayCount()}))},handlePageChanged(e){if(e!==this.currentPage){window.scrollTo(0,0),this.currentPage=e;const t=Us.A.get("session");t.currentPage=this.currentPage,Us.A.set("session",t),Ws.A.log("getdata","handlePageChanged"),this.getData(),this.resetProgressToast(),this.$nextTick((()=>{this.resetDisplayCount()}))}},clearSearchQuery(){this.searchQuery="";const e=Us.A.get("session");e.searchQuery="",Us.A.set("session",e),Ws.A.log("getdata","clearSearchQuery"),this.getData()},async callAPI(e){try{const t=`https://faas-sgp1-18bc02ac.doserverless.co/api/v1/web/fn-3bf765c8-bb4f-4bac-ba41-9698000f7334/default/getstudentdata?id=${e}`,s=await fetch(t),a=await s.json();Ws.A.log(a)}catch(t){Ws.A.log(t)}},async getCourse(){try{const e=await fetch(`https://gateway.cloudrestfulapi.com/api/course/${this.dataItem}`,{method:"GET",headers:{"Content-Type":"application/json","client-token-key":this.configs.key}}),t=await e.json();200===e.status&&Ws.A.log(t)}catch(e){console.error(e)}},async executeCustomQueries(e,t){const s=`\n          SELECT *\n          FROM transaction\n          WHERE transaction.transaction_token = '${e}'\n        `,a="",o={query:{mainQuery:s,countQuery:a}};try{const e=await fetch("https://multisource-api-edsdv.ondigitalocean.app/api/GOLqSG7QyA10uoasyN9x/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify(o)}),s=await e.json();let a=s.data[0];Ws.A.log("responseData",s.data[0]),await this.updateOrder(t,a.get_bill,a.receipt_type)}catch(r){console.error(r)}},async executemarketplaceQueries(e,t){const s=`\n          SELECT *\n          FROM marketplace\n          WHERE marketplace.order_ref_no = '${e}'\n        `,a="",o={query:{mainQuery:s,countQuery:a}};try{const e=await fetch("https://multisource-api-edsdv.ondigitalocean.app/api/04ZQdW5sGA9C9eXXXk6x/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify(o)}),s=await e.json();let a=s.data[0];Ws.A.log("responseData",s.data[0]);const r={delivery:{province:a.order_delivery_province},invoice:{province:a.order_invoice_province},tax:{province:a.order_tax_province}};await this.updateProvince(t,r)}catch(r){console.error(r)}},async executemarketplaceQueriesPersonal(e,t){const s=`\n          SELECT *\n          FROM marketplace\n          WHERE marketplace.order_ref_no = '${e}'\n        `,a="",o={query:{mainQuery:s,countQuery:a}};try{const e=await fetch("https://multisource-api-edsdv.ondigitalocean.app/api/04ZQdW5sGA9C9eXXXk6x/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify(o)}),s=await e.json();let a=s.data[0];Ws.A.log("responseData",s.data[0]);const r={delivery:{province:a.order_delivery_province},invoice:{province:a.order_invoice_province},tax:{province:a.order_invoice_province,zipcode:a.order_invoice_zipcode}};await this.updateProvince(t,r)}catch(r){console.error(r)}},isImageValid(e){const t=new Image;return t.src=e,t.complete&&0!==t.naturalWidth},modifyURL(e){return e.includes("https://doa-academy.sgp1.digitaloceanspaces.com/https://doa-academy.sgp1.digitaloceanspaces.com/https://doa-academy.sgp1.digitaloceanspaces.com/Upload/")?e.replace("https://doa-academy.sgp1.digitaloceanspaces.com/https://doa-academy.sgp1.digitaloceanspaces.com/https://doa-academy.sgp1.digitaloceanspaces.com/Upload/","https://doa-academy.sgp1.digitaloceanspaces.com/Upload/"):e.includes("https://doa-academy.sgp1.digitaloceanspaces.com/https://doa-academy.sgp1.digitaloceanspaces.com/1639435666414290693/")?e.replace("https://doa-academy.sgp1.digitaloceanspaces.com/https://doa-academy.sgp1.digitaloceanspaces.com/1639435666414290693/","https://content.fti.academy/doa-academy/1639435666414290693/"):e.includes("1639435666414290693/")&&e.includes("https://doa-academy.sgp1.digitaloceanspaces.com")?e.replace("https://doa-academy.sgp1.digitaloceanspaces.com","https://content.fti.academy/doa-academy"):e.includes("1639435666414290693/")&&!e.includes("https://doa-academy.sgp1.digitaloceanspaces.com")?`https://content.fti.academy/doa-academy/${e}`:(e=`https://doa-academy.sgp1.digitaloceanspaces.com/${e}`,e)},async executUserQueries(e,t){const s=`\n        SELECT  student_idcard AS Card,student_avatar AS Profile\n        FROM    student\n        WHERE   student_id = '${e}'\n        `,a="",o={query:{mainQuery:s,countQuery:a}};try{const e=await fetch("https://multisource-api-edsdv.ondigitalocean.app/api/04ZQdW5sGA9C9eXXXk6x/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify(o)}),s=await e.json();Ws.A.log("responseData",s.data[0]);let a=this.modifyURL(s.data[0].Profile),r=this.modifyURL(s.data[0].Card);await this.updateProfile(t,r,a),Ws.A.log("id",t)}catch(r){console.error(r)}},async createUserCourse(e,t,s){const a={student:e,lesson:t};try{const e=await fetch("https://api.fti.academy/api/firebase/setup",{method:"POST",headers:{"API-KEY":"5CB584F5ECFD7","SECRET-KEY":"6A5891C7352197F8A5CE8A9B67EF3","Content-Type":"application/json"},body:JSON.stringify(a)});await e.json(),await this.confirmTransaction(s),this.status=!0}catch(o){console.error("Error creating user course:",o)}},async confirmTransaction(e){const t=`https://api.fti.academy/api/connection/confirm/${e}`,s={"API-KEY":"5CB584F5ECFD7","SECRET-KEY":"6A5891C7352197F8A5CE8A9B67EF3","Content-Type":"application/json"};try{const e=await fetch(t,{method:"GET",headers:s});await e.json()}catch(a){console.error("Error confirming transaction:",a)}},async updateOrderStatus(e){try{const t=await fetch("https://gateway.cloudrestfulapi.com/api/order/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{status:"ชำระเงินแล้ว"},options:{}})}),s=await t.json();Ws.A.log(s),200===t.status&&Ws.A.log("order : "+e+" Update Success!!")}catch(t){Ws.A.log(t)}},async updateOrder(e,t,s){try{const a=await fetch("https://gateway.cloudrestfulapi.com/api/order/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{bill:t,receipt:s},options:{}})}),o=await a.json();Ws.A.log(o),200===a.status&&Ws.A.log("order : "+e+" Update Success!!")}catch(a){Ws.A.log(a)}},async updateProfile(e,t,s){try{const a=await fetch("https://gateway.cloudrestfulapi.com/api/user/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{card_img:t,avatar_img:s},options:{}})});await a.json(),200===a.status&&Ws.A.log("user : "+e+" Update Success!!")}catch(a){Ws.A.log(a)}},async updateOrderEnroll(e,t){try{const s=await fetch("https://gateway.cloudrestfulapi.com/api/order/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{enrollID:t},options:{}})});await s.json(),200===s.status&&Ws.A.log("order : "+e+" Update Success!!")}catch(s){Ws.A.log(s)}},async updateProvince(e,t){try{const s=["delivery","invoice","tax"];for(const a of s){const s=t[a],o=s.province,r=s.zipcode;if(void 0!==o&&null!==o&&""!==o){const t=await fetch(`https://gateway.cloudrestfulapi.com/api/order/${e}`,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{[`address.${a}.province`]:o,[`address.${a}.zipcode`]:r},options:{}})}),s=await t.json();Ws.A.log(s),200===t.status&&Ws.A.log(`Province (${a}) for order ${e} updated successfully!!`)}}}catch(s){Ws.A.log(s)}},async resetScore(e,t,s){try{const a=await this.$Request.POST("score/query",{method:"find",hidden:["userID"],args:[{$and:[{userID:t,examID:e}]}]},this.configs.key),{data:o,status:r}=a;200===r&&o.length>0?Js.A.confirm({title:"คุณต้องการลบการสอบ?",message:"ลบข้อสอบออกจากผู้อบรม !",confirm:async()=>{try{const e=await this.$Request.DELETE(`score/${o[0]._id}`,null,this.configs.key),{data:t}=e;if(t){Ws.A.log(t);const e={data:{verified:{pre:{}}}},{status:a}=await this.$Request.PUT(`enroll/${s}`,e,this.configs.key);Ws.A.log(a),await this.getData()}}catch(e){Ws.A.log(e)}},cancel:()=>{}}):Js.A.prompt({title:"เกิดข้อผิดพลาด",message:"ไม่สามารถลบได้ !",confirm:async()=>{},cancel:()=>{}})}catch(a){console.error("Error confirming transaction:",a)}},async bypassVerified(e,t,s){try{const a=new Date;console.log("verified",s);const o=a.toISOString();Js.A.confirm({title:"คุณต้องการ Bypass ระบบ Verified?",message:"ตั้งให้ผู้อบรมไม่ต้อง Verified !",confirm:async()=>{try{const a={...s,[t]:{status:!0,url:`bypass-${o}`}},r={data:{verified:a}},{status:i}=await this.$Request.PUT(`enroll/${e}`,r,this.configs.key);Ws.A.log(i),await this.getData()}catch(a){Ws.A.log(a)}},cancel:()=>{}})}catch(a){console.error("Error confirming transaction:",a)}},async getData(e=this.currentPage,t=this.limitItem,s="normal"){try{if(this.login){"normal"===s&&(this.loading=!0,this.activeBlock=!0,this.listItems=[]);let a=[{courseID:this.dataItem}];"all"!==this.statusFilter&&a.push({status:this.statusFilter});const o=[{$match:{$and:a}},{$set:{userID:{$convert:{input:"$userID",to:"objectId",onError:null,onNull:null}},courseID:{$convert:{input:"$courseID",to:"objectId",onError:null,onNull:null}}}},...this.searchQuery?[{$lookup:{from:"user",localField:"userID",foreignField:"_id",pipeline:[{$match:{$or:[{name:{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{citizen:{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{email:{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{firstname:{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{lastname:{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{old_id:{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{phone:{$regex:`.*${this.searchQuery}.*`,$options:"i"}},{token:{$regex:`.*${this.searchQuery}.*`,$options:"i"}}]}},{$project:{_id:1,firstname:1,lastname:1,citizen:1,phone:1,email:1,token:1,old_id:1,createdAt:1,card_img:1,avatar_img:1,enroll:1}}],as:"user"}},{$match:{user:{$ne:[]}}},{$unwind:"$user"}]:[{$lookup:{from:"user",localField:"userID",foreignField:"_id",pipeline:[{$project:{_id:1,firstname:1,lastname:1,citizen:1,phone:1,email:1,token:1,old_id:1,createdAt:1,card_img:1,avatar_img:1,enroll:1}}],as:"user"}},{$unwind:"$user"}],{$lookup:{from:"course",localField:"courseID",foreignField:"_id",pipeline:[{$project:{_id:1,master:1,name:1,lesson_old_id:1}}],as:"course"}},{$unwind:"$course"},{$lookup:{from:"exam",let:{masterID:"$course.master"},pipeline:[{$match:{$expr:{$eq:["$courseId","$$masterID"]}}},{$project:{_id:1,courseId:1,type:1,name:1}},{$facet:{pre:[{$match:{type:"pre"}},{$limit:1}],post:[{$match:{type:"post"}},{$limit:1}]}}],as:"exams"}},{$set:{examPre:{$arrayElemAt:["$exams.pre",0]},examPost:{$arrayElemAt:["$exams.post",0]}}},{$unset:"exams"},{$sort:{createdAt:-1}},{$facet:{paginatedData:[{$skip:(e-1)*t},{$limit:t},{$project:{enroll:{_id:"$$ROOT._id",userID:"$$ROOT.userID",courseID:"$$ROOT.courseID",analytics:"$$ROOT.analytics",verified:"$$ROOT.verified",capture:"$$ROOT.capture",certification:"$$ROOT.certification",status:"$$ROOT.status",createdAt:"$$ROOT.createdAt",updatedAt:"$$ROOT.updatedAt",examPre:"$$ROOT.examPre",examPost:"$$ROOT.examPost"},user:"$user"}}],totalCount:[{$count:"count"}]}}],r={method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({pipeline:o})},i=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/aggregate",r),l=await i.json();if(l){const e=l[0].paginatedData,t=l[0].totalCount[0].count,a={data:e.map((e=>({user:e.user,enroll:e.enroll}))),total:t,paging:{page:this.currentPage,limit:this.limitItem,totalPages:Math.ceil(t/this.limitItem)}};"normal"===s?(this.loading=!1,this.activeBlock=!1,this.listItems=a.data):(this.listItems_chunk=a.data,this.totalItems=a.total),this.totalItems=a.total,this.totalPages=a.paging.totalPages,this.updateBadge(t),"normal"===s&&this.resetProgressToast()}}}catch(a){Ws.A.log(a)}},async getEnrollData(e,t,s,a){try{if(this.login){let o=[{courseID:e,userID:t}];const r=[{$match:{$and:o}},{$facet:{paginatedData:[{$skip:0},{$limit:1},{$project:{enroll:"$$ROOT"}}],totalCount:[{$count:"count"}]}}],i={method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({pipeline:r})},l=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/aggregate",i),n=await l.json();if(n){const e=n[0].paginatedData,t=n[0].totalCount[0].count,o={data:e.map((e=>({enroll:e.enroll}))),total:t,paging:{page:this.currentPage,limit:this.limitItem,totalPages:Math.ceil(t/this.limitItem)}};Ws.A.log("Enroll Local Data",o.data[0].enroll._id),await this.getEnrollRemote(s,o.data[0].enroll._id,a)}}}catch(o){Ws.A.log(o)}finally{this.loading=!1,this.activeBlock=!1}},async getEnrollRemote(e,t,s){const a=`\n        SELECT\n        MAX(CASE WHEN data_type = 'cert_area' THEN data_value END) AS cert_area,\n        MAX(CASE WHEN data_type = 'cert_age' THEN data_value END) AS cert_age,\n        MAX(CASE WHEN data_type = 'exam_round' THEN data_value END) AS exam_round,\n        MAX(CASE WHEN data_type = 'get_receipt' THEN data_value END) AS get_receipt,\n\n        MAX(CASE WHEN data_type = 'progress' THEN data_value END) AS progress,\n        MAX(CASE WHEN data_type = 'pretest' THEN data_value END) AS pretest,\n        MAX(CASE WHEN data_type = 'posttest' THEN data_value END) AS posttest,\n        MAX(CASE WHEN data_type = 'retest' THEN data_value END) AS retest\n        FROM student_adddition_data\n        WHERE data_target = '${this.courseData.lesson_old_id}' AND student_id = '${e}'\n        AND data_type IN ('cert_area','cert_age','exam_round','get_receipt','progress', 'pretest', 'posttest', 'retest');\n        `,o="",r={query:{mainQuery:a,countQuery:o}};try{const e=await fetch("https://multisource-api-edsdv.ondigitalocean.app/api/04ZQdW5sGA9C9eXXXk6x/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify(r)}),a=await e.json();Ws.A.log("Enroll Remote Data",a.data[0]);const o=a.data[0];let i=parseInt(o.progress),l=0,n=0,c=0,d="",u="",p=33;i<13?(n=13-i,l=i,c=i,d="processing",u="กำลังเรียน"):0===i||null===i||void 0===i?(n=13,l=0,c=0,d="pending",u="ยังไม่ได้เรียน"):13===i&&(l=0,c=13,n=0,d="complete",u="เรียนจบแล้ว");const g={analytics:{total:13,pending:n,processing:l,complete:c,status:d,message:u,post:{req:!0,has:!0,measure:p,score:o.posttest,result:o.posttest>=p,message:null===o.posttest||void 0===o.posttest?"ยังไม่ได้สอบวัดผล":o.posttest>=p?"ผ่านการรับรอง":"ไม่ผ่านการรับรอง"},pre:{req:!0,has:!0,measure:p,score:o.pretest,result:o.pretest>=p,message:null===o.pretest||void 0===o.pretest?"ยังไม่ได้สอบก่อนเรียน":o.pretest>=p?"สอบก่อนเรียนผ่าน":"สอบก่อนเรียนไม่ผ่าน"},retest:{req:!0,has:!0,measure:p,result:o.retest>=p,score:o.retest,message:null===o.retest||void 0===o.retest?"ยังไม่ได้สอบวัดผล":o.retest>=p?"ผ่านการรับรอง":"ไม่ผ่านการรับรอง"},option:{cert_age:o.cert_age,cert_area:o.cert_area,exam_round:o.exam_round,get_receipt:o.get_receipt}},certification:[]};Ws.A.log("updateEnroll",t,g),await this.updateEnroll(t,g),Ws.A.log("updateOrderEnroll",s),await this.updateOrderEnroll(s,t)}catch(i){console.error(i)}},async updateEnroll(e,t){try{const s=await fetch("https://gateway.cloudrestfulapi.com/api/enroll/"+e,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:t})});await s.json(),200===s.status&&Ws.A.log("Enroll "+e+" updated successfully!")}catch(s){Ws.A.log(s)}},toggleStatus(e){Ws.A.log("Toggle Status",e),this.statusFilter=e,this.getData()},async renderStatus(){Ws.A.log("renderStatus");for(const e of this.listItems)Ws.A.log(e.order.ref3),"สั่งซื้อ"===e.order.status&&(Ws.A.log("searchData"),await this.searchData(e.order.ref3,e.order._id))},async renderProvince(){Ws.A.log("renderProvince");for(const e of this.listItems)Ws.A.log(e.order.ref_no),await this.executemarketplaceQueriesPersonal(e.order.ref_no,e.order._id)},async renderProfile(){const e=this.listItems.length;let t=0;this.isProcessing=!0,this.processName="Render Profile Image",this.progressTotal=e,this.startTime=(new Date).toISOString(),this.endTime=null;for(const s of this.listItems)t++,this.progressText=`Processing : ${t}/${e}`,this.progressCurrent=t,await this.executUserQueries(s.user.old_id,s.user._id);this.progressText="All Process : Done",this.endTime=(new Date).toISOString()},closeProgress(){this.isProcessing=!1},async makePosttest(e){if(this.open=!1,e){const t=1;let s=0;this.isProcessing=!0,this.processName="Render Single Posttest",this.progressTotal=t,this.startTime=(new Date).toISOString(),this.endTime=null,this.progressText=`Processing : ${s}/${t}`,this.progressCurrent=0,Ws.A.log("single",e);const a=Math.floor(4*Math.random())+33;await this.executeInsertQueries(e,a),await this.saveExamRecord(e,a),await this.renderEnroll(e),this.progressCurrent=1}else{const e=this.listItems.length;let t=0;this.isProcessing=!0,this.processName="Render Posttest",this.progressTotal=e,this.startTime=(new Date).toISOString(),this.endTime=null;for(const s of this.listItems)t++,this.progressText=`Processing : ${t}/${e}`,this.progressCurrent=t,Ws.A.log("item",s)}this.progressText="All Process : Done",this.endTime=(new Date).toISOString()},async executeInsertQueries(e,t){const s=`\n          INSERT INTO student_adddition_data (student_id, student_token, data_type, data_value, data_target, data_method, data_status)\n          VALUES ('${e.user.old_id}', '${e.user.token}', 'posttest', '${t}', '224', 'edit', 'active')\n        `,a="",o={query:{mainQuery:s,countQuery:a}};try{const e=await fetch("https://multisource-api-edsdv.ondigitalocean.app/api/04ZQdW5sGA9C9eXXXk6x/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify(o)}),t=await e.json();Ws.A.log("responseData",t.data[0])}catch(r){console.error(r)}},async saveExamRecord(e,t){const s={user:e.user.token,course:"224",score:"posttest",data:{result:t}};try{const e=await fetch("https://asia-southeast1-academy-f0925.cloudfunctions.net/api/user/course/score",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),t=await e.json();Ws.A.log("API response:",t)}catch(a){console.error(a)}},async renderEnroll(e){if(this.open=!1,e){const t=1;let s=0;this.isProcessing=!0,this.processName="Render Single Enroll",this.progressTotal=t,this.startTime=(new Date).toISOString(),this.endTime=null,this.progressText=`Processing : ${s}/${t}`,this.progressCurrent=0,await this.getEnrollData(e.order.courseID,e.order.userID,e.user.old_id,e.order._id),await this.getData(),this.progressCurrent=1}else{const e=this.listItems.length;let t=0;this.isProcessing=!0,this.processName="Render Enroll",this.progressTotal=e,this.startTime=(new Date).toISOString(),this.endTime=null;for(const s of this.listItems)t++,this.progressText=`Processing : ${t}/${e}`,this.progressCurrent=t,await this.getEnrollData(s.order.courseID,s.order.userID,s.user.old_id,s.order._id)}this.progressText="All Process : Done",this.endTime=(new Date).toISOString()},async renderEnrollFirebase(){Ws.A.log("########## Render Firebase");const e=this.listItems.length;let t=0;for(const s of this.listItems)t++,await this.createUserCourse(s.user.token,"20",s.order.ref_no),Ws.A.log(`Processing ${t}/${e}`)},async renderData(){this.open=!1;const e=this.listItems.length;let t=0;this.isProcessing=!0,this.processName="Render Billing",this.progressTotal=e,this.startTime=(new Date).toISOString(),this.endTime=null;for(const s of this.listItems)t++,this.progressText=`Processing : ${t}/${e}`,this.progressCurrent=t,Ws.A.log("item",s);this.progressText="All Process : Done",this.endTime=(new Date).toISOString()},async renderBilling(){this.open=!1;const e=this.listItems.length;let t=0;this.isProcessing=!0,this.processName="Render Billing",this.progressTotal=e,this.startTime=(new Date).toISOString(),this.endTime=null;for(const s of this.listItems)t++,this.progressText=`Processing : ${t}/${e}`,this.progressCurrent=t,await this.executeCustomQueries(s.order.ref,s.order._id);this.progressText="All Process : Done",this.endTime=(new Date).toISOString()},downloadSampleCSV(){const e="bu_name,bu_type,prefix,firstname,lastname,position,phone,email\n",t=["บริษัท เอบีซี จำกัด,เอกชน,นาย,สมชาย,ใจดี,ผู้จัดการ,0891234567,user1@example.com","บริษัท เอ็กซ์วาย จำกัด,รัฐวิสาหกิจ,นางสาว,สมหญิง,รักเรียน,พนักงาน,0891234568,user2@example.com"].join("\n"),s=e+t,a=new Blob([s],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a"),r=URL.createObjectURL(a);o.setAttribute("href",r),o.setAttribute("download","enroll_template.csv"),o.style.visibility="hidden",document.body.appendChild(o),o.click(),document.body.removeChild(o)},generateRandomPassword(e){const t=12,s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%&";let a="";for(let o=0;o<t;o++){const e=Math.floor(Math.random()*s.length);a+=s[e]}this.manualInput[e].password=a},toggleShowMore(e){this.manualInputShowMore[e]=!this.manualInputShowMore[e]},toggleActionDropdown(e){this.activeDropdown=this.activeDropdown===e?null:e},sendNotification(e){Js.A.confirm({title:"ส่งการแจ้งเตือน",message:"คุณต้องการส่งการแจ้งเตือนให้ผู้ใช้งานคนนี้หรือไม่?",confirm:async()=>{try{console.log("Sending notification to:",e),Js.A.prompt({title:"สำเร็จ",message:"ส่งการแจ้งเตือนเรียบร้อยแล้ว",confirm:()=>{},cancel:()=>{}})}catch(t){console.error("Error sending notification:",t)}},cancel:()=>{}}),this.activeDropdown=null},resetProgress(e){Js.A.confirm({title:"รีเซ็ตความคืบหน้า",message:"คุณต้องการรีเซ็ตความคืบหน้าการเรียนของผู้ใช้งานคนนี้หรือไม่? การดำเนินการนี้ไม่สามารถย้อนกลับได้",confirm:async()=>{try{console.log("Resetting progress for:",e),await this.getData(),Js.A.prompt({title:"สำเร็จ",message:"รีเซ็ตความคืบหน้าเรียบร้อยแล้ว",confirm:()=>{},cancel:()=>{}})}catch(t){console.error("Error resetting progress:",t)}},cancel:()=>{}}),this.activeDropdown=null},generateCertificate(e){Js.A.confirm({title:"สร้างใบรับรอง",message:"คุณต้องการสร้างใบรับรองสำหรับผู้ใช้งานคนนี้หรือไม่?",confirm:async()=>{try{console.log("Generating certificate for:",e),Js.A.prompt({title:"สำเร็จ",message:"สร้างใบรับรองเรียบร้อยแล้ว",confirm:()=>{},cancel:()=>{}})}catch(t){console.error("Error generating certificate:",t)}},cancel:()=>{}}),this.activeDropdown=null},removeEnrollment(e){Js.A.confirm({title:"ลบออกจากหลักสูตร",message:"คุณแน่ใจหรือไม่ที่จะลบผู้ใช้งานคนนี้ออกจากหลักสูตร? การดำเนินการนี้ไม่สามารถย้อนกลับได้",confirm:async()=>{try{console.log("Removing enrollment for:",e),await this.getData(),Js.A.prompt({title:"สำเร็จ",message:"ลบผู้ใช้งานออกจากหลักสูตรเรียบร้อยแล้ว",confirm:()=>{},cancel:()=>{}})}catch(t){console.error("Error removing enrollment:",t)}},cancel:()=>{}}),this.activeDropdown=null},generateDetailReport(e){try{console.log("Generating detailed report for:",e),this.$router.push(`/student/report/${e}?course=${this.dataItem}`)}catch(t){console.error("Error generating detailed report:",t)}},sendProgressUpdate(e){Js.A.confirm({title:"ส่งรายงานความคืบหน้า",message:"คุณต้องการส่งรายงานความคืบหน้าการเรียนให้ผู้ใช้งานคนนี้หรือไม่?",confirm:async()=>{try{console.log("Sending progress update to:",e),Js.A.prompt({title:"สำเร็จ",message:"ส่งรายงานความคืบหน้าเรียบร้อยแล้ว",confirm:()=>{},cancel:()=>{}})}catch(t){console.error("Error sending progress update:",t)}},cancel:()=>{}})},handleClickOutside(e){e.target.closest(".relative")||(this.activeDropdown=null)},getInitials(e,t){const s=e?e.charAt(0).toUpperCase():"",a=t?t.charAt(0).toUpperCase():"";return s+a},getAvatarBgColor(e,t){const s=["bg-red-500","bg-blue-500","bg-green-500","bg-yellow-500","bg-purple-500","bg-pink-500","bg-indigo-500","bg-teal-500","bg-orange-500","bg-cyan-500","bg-emerald-500","bg-violet-500"],a=(e||"")+(t||"");let o=0;for(let r=0;r<a.length;r++)o=a.charCodeAt(r)+((o<<5)-o);return s[Math.abs(o)%s.length]},onImageError(e){this.imageErrors[e]=!0},onImageLoad(e){this.imageErrors[e]=!1},shouldShowInitials(e){return!e.avatar_img||""===e.avatar_img||null===e.avatar_img||void 0===e.avatar_img||this.imageErrors[e._id]}},async mounted(){try{const e=new URLSearchParams(window.location.search),t=e.get("page");if(t&&/^\d+$/.test(t))this.currentPage=parseInt(t);else{const e=Us.A.get("session");if(e&&e.currentPage){this.currentPage=e.currentPage;const t=new URLSearchParams(window.location.search);t.set("page",e.currentPage);const s=`${window.location.pathname}?${t.toString()}`;window.history.replaceState({},"",s)}}const s=Us.A.get("session");s&&s.searchQuery&&(this.searchQuery=s.searchQuery);const a=s.limitItem;a&&(this.limitItem=a),await this.getData(),await this.getCourse(),this.fetchData(),document.addEventListener("click",this.handleClickOutside),this.$nextTick((()=>{this.resetDisplayCount()}))}catch(e){Ws.A.log(Error)}},beforeUnmount(){document.removeEventListener("click",this.handleClickOutside),this.scrollCleanup&&(this.scrollCleanup(),this.scrollCleanup=null),this.scrollTimeout&&(clearTimeout(this.scrollTimeout),this.scrollTimeout=null)},setup(){Ws.A.log("Setup")},watch:{searchQuery(){clearTimeout(this.debounceTimer),this.debounceTimer=setTimeout((()=>{this.getData();const e=Us.A.get("session");e.searchQuery=this.searchQuery,Us.A.set("session",e),this.currentPage=1}),500)}},computed:{visibleItems(){if(!this.lazy)return this.listItems;const e=this.listItems.slice(0,this.currentDisplayCount);return e},hasMoreItems(){return this.lazy&&this.currentDisplayCount<this.listItems.length},progressiveLoadingStats(){return this.lazy?{showing:Math.min(this.currentDisplayCount,this.listItems.length),total:this.listItems.length,remaining:Math.max(0,this.listItems.length-this.currentDisplayCount),percentage:Math.round(this.currentDisplayCount/this.listItems.length*100)}:null},filteredListItems(){return"All"===this.selectedStatus?this.listItems:this.listItems.filter((e=>e.status===this.selectedStatus))}}};const va=(0,fa.A)(ka,[["render",Vs],["__scopeId","data-v-45f1cc93"]]);var wa=va}}]);
//# sourceMappingURL=8589.c4bf6dc8.js.map