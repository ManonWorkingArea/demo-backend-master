"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[8812],{58812:function(e,t,s){s.r(t),s.d(t,{default:function(){return $e}});var n=s(20641);function i(e,t,s,i,o,a){return(0,n.uX)(),(0,n.Wv)((0,n.$y)(a.componentName))}var o=s(52968),a=s(75220),r=s(40475),l=s(90033),d=s(53751);const u={class:"flex min-h-screen bg-gray-50"},c={class:"w-1/3 min-w-[480px] bg-white shadow-lg border-r border-gray-200 flex flex-col"},m={class:"flex-1 overflow-y-auto p-4"},b={class:"mb-6"},g={key:0,class:"py-3 px-3 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300"},p={key:1,class:"grid grid-cols-2 gap-2"},f={class:"flex flex-col"},h={class:"flex items-center justify-between mb-1"},x={class:"flex items-center min-w-0 flex-1"},y={class:"font-medium text-gray-900 text-xs truncate"},k=["onClick"],v={class:"text-xs text-gray-500 ml-4 truncate"},w={class:"space-y-1"},L={key:0,class:"py-3 px-3 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300"},C={class:"flex items-center justify-between"},M={class:"flex-1 min-w-0"},I={class:"flex items-center mb-1"},E={class:"font-medium text-gray-900 text-xs truncate"},S={class:"text-xs text-gray-500 ml-4 truncate"},F=["onClick"],X={class:"flex-1 flex flex-col"},D={class:"bg-white border-b border-gray-200 px-6 py-4"},_={class:"flex items-center justify-between"},U={class:"text-2xl font-bold text-gray-900 mb-1"},P={class:"text-base text-gray-500"},T={class:"flex-1 p-6 overflow-y-auto"},j={class:"max-w-4xl"},A={class:"flex items-center justify-between mb-6"},$={class:"space-y-3"},K={key:0,class:"py-8 text-center"},N={class:"w-12 h-12 bg-gray-100 rounded-full flex items-center justify-center mx-auto mb-3"},O={class:"p-4 border-b border-gray-100"},V={class:"flex items-center justify-between"},q={class:"flex-1"},Q={key:0,class:"flex items-center"},R={class:"text-base font-semibold text-gray-900"},B={class:"text-xs text-gray-500 mt-1"},H={key:1,class:"space-y-3"},W={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},J=["onUpdate:modelValue"],z=["onUpdate:modelValue"],G=["onUpdate:modelValue","onChange"],Y=["value"],Z={class:"flex space-x-2"},ee=["onClick"],te=["onClick"],se={key:0,class:"flex items-center space-x-1 ml-4"},ne=["onClick"],ie=["onClick"],oe=["onClick","disabled"],ae=["onClick","disabled"],re=["onClick"],le={key:0,class:"bg-gray-50 p-4"},de={class:"space-y-2"},ue={class:"flex items-center justify-between"},ce={class:"flex-1"},me={key:0,class:"flex items-center"},be={class:"font-medium text-gray-900 text-sm"},ge={class:"text-xs text-gray-500 mt-1"},pe={key:1,class:"space-y-3"},fe={class:"grid grid-cols-1 md:grid-cols-3 gap-3"},he=["onUpdate:modelValue"],xe=["onUpdate:modelValue"],ye=["onUpdate:modelValue","onChange"],ke=["value"],ve={class:"flex space-x-2"},we=["onClick"],Le=["onClick"],Ce={key:0,class:"flex items-center space-x-1 ml-3"},Me=["onClick"],Ie=["onClick","disabled"],Ee=["onClick","disabled"],Se=["onClick"];function Fe(e,t,s,i,o,a){const r=(0,n.g2)("Subhead"),Fe=(0,n.g2)("custom-confirmation"),Xe=(0,n.g2)("font-awesome-icon"),De=(0,n.g2)("router-link");return(0,n.uX)(),(0,n.CE)(n.FK,null,[(0,n.bF)(r,{navigation:[{name:"บันทึกข้อมูล",function:"updateData",style:"save",class:"primary-btn",visible:!0,type:"button"},{name:"ย้อนกลับ",link:"/cms/content",style:"chevron-left",class:"default-btn",visible:!0,type:"button"}],onUpdateData:a.updateData},null,8,["onUpdateData"]),o.showConfirmation?((0,n.uX)(),(0,n.Wv)(Fe,{key:0,message:o.confirmationMessage,header:o.confirmationHeader,onConfirm:a.handleConfirmation,onCancel:a.handleConfirmCancel},null,8,["message","header","onConfirm","onCancel"])):(0,n.Q3)("",!0),(0,n.Lk)("div",u,[(0,n.Lk)("div",c,[t[6]||(t[6]=(0,n.Lk)("div",{class:"p-4 border-b border-gray-200"},[(0,n.Lk)("h2",{class:"text-lg font-semibold text-gray-900 mb-1"},"เพิ่มรายการเมนู"),(0,n.Lk)("p",{class:"text-xs text-gray-600"},"เลือกรายการที่ต้องการเพิ่มเข้าเมนู")],-1)),(0,n.Lk)("div",m,[(0,n.Lk)("div",b,[t[3]||(t[3]=(0,n.Lk)("div",{class:"flex items-center mb-3"},[(0,n.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full mr-2"}),(0,n.Lk)("h3",{class:"text-base font-medium text-gray-900"},"รายการหน้า")],-1)),0===a.filteredMenuItems.length?((0,n.uX)(),(0,n.CE)("div",g,t[2]||(t[2]=[(0,n.Lk)("p",{class:"text-center text-gray-500 text-xs"},"ไม่มีรายการที่สามารถใช้ได้",-1)]))):((0,n.uX)(),(0,n.CE)("div",p,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.filteredMenuItems,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"group bg-white border border-gray-200 rounded-md p-2 hover:border-blue-300 hover:bg-blue-50 transition-all duration-200 cursor-pointer"},[(0,n.Lk)("div",f,[(0,n.Lk)("div",h,[(0,n.Lk)("div",x,[(0,n.bF)(Xe,{icon:["fas","file"],class:"text-gray-400 mr-1 flex-shrink-0 text-xs"}),(0,n.Lk)("span",y,(0,l.v_)(e.title),1)]),(0,n.Lk)("button",{onClick:t=>a.addToEditMenu(e),class:"ml-1 w-5 h-5 rounded-full bg-blue-500 text-white hover:bg-blue-600 transition-colors duration-200 flex items-center justify-center opacity-0 group-hover:opacity-100 flex-shrink-0"},[(0,n.bF)(Xe,{icon:["fas","plus"],class:"w-2 h-2"})],8,k)]),(0,n.Lk)("p",v,(0,l.v_)(e.target),1)])])))),128))]))]),(0,n.Lk)("div",null,[t[5]||(t[5]=(0,n.Lk)("div",{class:"flex items-center mb-3"},[(0,n.Lk)("div",{class:"w-2 h-2 bg-purple-500 rounded-full mr-2"}),(0,n.Lk)("h3",{class:"text-base font-medium text-gray-900"},"รายการปลั๊กอิน")],-1)),(0,n.Lk)("div",w,[0===a.filteredPluginItems.length?((0,n.uX)(),(0,n.CE)("div",L,t[4]||(t[4]=[(0,n.Lk)("p",{class:"text-center text-gray-500 text-xs"},"ไม่มีปลั๊กอินที่สามารถใช้ได้",-1)]))):((0,n.uX)(!0),(0,n.CE)(n.FK,{key:1},(0,n.pI)(a.filteredPluginItems,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"group bg-white border border-gray-200 rounded-md p-2 hover:border-purple-300 hover:bg-purple-50 transition-all duration-200 cursor-pointer"},[(0,n.Lk)("div",C,[(0,n.Lk)("div",M,[(0,n.Lk)("div",I,[(0,n.bF)(Xe,{icon:["fas","puzzle-piece"],class:"text-gray-400 mr-1 flex-shrink-0 text-xs"}),(0,n.Lk)("span",E,(0,l.v_)(e.title),1)]),(0,n.Lk)("p",S,(0,l.v_)(e.target),1)]),(0,n.Lk)("button",{onClick:t=>a.addToEditMenu(e),class:"ml-2 w-6 h-6 rounded-full bg-purple-500 text-white hover:bg-purple-600 transition-colors duration-200 flex items-center justify-center opacity-0 group-hover:opacity-100 flex-shrink-0"},[(0,n.bF)(Xe,{icon:["fas","plus"],class:"w-2 h-2"})],8,F)])])))),128))])])])]),(0,n.Lk)("div",X,[(0,n.Lk)("div",D,[(0,n.Lk)("div",_,[(0,n.Lk)("div",null,[(0,n.Lk)("h1",U,(0,l.v_)(o.post.title),1),(0,n.Lk)("p",P,(0,l.v_)(o.post.slug),1)]),(0,n.bF)(De,{to:"/cms/edit/"+o.post._id,class:"inline-flex items-center px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-white text-xs font-medium text-gray-700 hover:bg-gray-50 transition-colors duration-200"},{default:(0,n.k6)((()=>[(0,n.bF)(Xe,{icon:["fas","pencil"],class:"w-3 h-3 mr-1"}),t[7]||(t[7]=(0,n.eW)(" แก้ไข "))])),_:1},8,["to"])])]),(0,n.Lk)("div",T,[(0,n.Lk)("div",j,[(0,n.Lk)("div",A,[t[9]||(t[9]=(0,n.Lk)("div",null,[(0,n.Lk)("h2",{class:"text-xl font-bold text-gray-900 mb-1"},"จัดการเมนู"),(0,n.Lk)("p",{class:"text-sm text-gray-600"},"จัดเรียงและแก้ไขรายการเมนูของคุณ")],-1)),(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>a.addEmptyItem&&a.addEmptyItem(...e)),class:"inline-flex items-center px-3 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors duration-200 shadow-sm text-sm"},[(0,n.bF)(Xe,{icon:["fas","plus"],class:"w-3 h-3 mr-1"}),t[8]||(t[8]=(0,n.eW)(" เพิ่มเมนูใหม่ "))])]),(0,n.Lk)("div",$,[0===o.editMenu.length?((0,n.uX)(),(0,n.CE)("div",K,[(0,n.Lk)("div",N,[(0,n.bF)(Xe,{icon:["fas","list"],class:"w-6 h-6 text-gray-400"})]),t[11]||(t[11]=(0,n.Lk)("h3",{class:"text-base font-medium text-gray-900 mb-2"},"ยังไม่มีเมนู",-1)),t[12]||(t[12]=(0,n.Lk)("p",{class:"text-sm text-gray-500 mb-4"},"เริ่มต้นสร้างเมนูโดยการเพิ่มรายการจากด้านซ้าย",-1)),(0,n.Lk)("button",{onClick:t[1]||(t[1]=(...e)=>a.addEmptyItem&&a.addEmptyItem(...e)),class:"inline-flex items-center px-3 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200 text-sm"},[(0,n.bF)(Xe,{icon:["fas","plus"],class:"w-3 h-3 mr-1"}),t[10]||(t[10]=(0,n.eW)(" เพิ่มเมนูแรก "))])])):(0,n.Q3)("",!0),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(o.editMenu,(e=>((0,n.uX)(),(0,n.CE)("div",{key:e.id,class:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden"},[(0,n.Lk)("div",O,[(0,n.Lk)("div",V,[(0,n.Lk)("div",q,[e.isEditing?((0,n.uX)(),(0,n.CE)("div",H,[(0,n.Lk)("div",W,[(0,n.Lk)("div",null,[t[14]||(t[14]=(0,n.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ชื่อเมนู",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.title=t,placeholder:"ชื่อเมนู",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,J),[[d.Jo,e.title]])]),(0,n.Lk)("div",null,[t[15]||(t[15]=(0,n.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ลิงก์",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":t=>e.target=t,placeholder:"ลิงก์หรือ URL",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,z),[[d.Jo,e.target]])]),(0,n.Lk)("div",null,[t[17]||(t[17]=(0,n.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ย้ายไปใต้เมนู",-1)),(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":t=>e.mainMenu=t,onChange:t=>a.moveToSubMenu(e),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[t[16]||(t[16]=(0,n.Lk)("option",{value:""},"เลือกเมนูหลัก",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.filteredEditMenu(e.id),(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id},(0,l.v_)(e.title),9,Y)))),128))],40,G),[[d.u1,e.mainMenu]])])]),(0,n.Lk)("div",Z,[(0,n.Lk)("button",{onClick:t=>a.updateItem(e),class:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200 text-sm"}," บันทึก ",8,ee),(0,n.Lk)("button",{onClick:t=>a.cancelEdit(e),class:"px-3 py-1 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors duration-200 text-sm"}," ยกเลิก ",8,te)])])):((0,n.uX)(),(0,n.CE)("div",Q,[t[13]||(t[13]=(0,n.Lk)("div",{class:"w-2 h-2 bg-blue-500 rounded-full mr-3"},null,-1)),(0,n.Lk)("div",null,[(0,n.Lk)("h3",R,(0,l.v_)(e.title),1),(0,n.Lk)("p",B,(0,l.v_)(e.target),1)])]))]),e.isEditing?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",se,[(0,n.Lk)("button",{onClick:t=>a.addSubmenuItem(e),class:"p-1 text-gray-400 hover:text-green-600 hover:bg-green-50 rounded-md transition-colors duration-200"},[(0,n.bF)(Xe,{icon:["fas","plus"],class:"w-3 h-3"})],8,ne),(0,n.Lk)("button",{onClick:t=>a.editItem(e),class:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-md transition-colors duration-200"},[(0,n.bF)(Xe,{icon:["fas","pencil"],class:"w-3 h-3"})],8,ie),(0,n.Lk)("button",{onClick:t=>a.moveUpItem(e),disabled:a.isFirstItem(e),class:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-md transition-colors duration-200 disabled:opacity-30 disabled:cursor-not-allowed"},[(0,n.bF)(Xe,{icon:["fas","chevron-up"],class:"w-3 h-3"})],8,oe),(0,n.Lk)("button",{onClick:t=>a.moveDownItem(e),disabled:a.isLastItem(e),class:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-md transition-colors duration-200 disabled:opacity-30 disabled:cursor-not-allowed"},[(0,n.bF)(Xe,{icon:["fas","chevron-down"],class:"w-3 h-3"})],8,ae),(0,n.Lk)("button",{onClick:t=>a.deleteItem(e),class:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors duration-200"},[(0,n.bF)(Xe,{icon:["fas","trash"],class:"w-3 h-3"})],8,re)]))])]),e.subMenu&&e.subMenu.length>0?((0,n.uX)(),(0,n.CE)("div",le,[(0,n.Lk)("div",de,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(e.subMenu,(s=>((0,n.uX)(),(0,n.CE)("div",{key:s.id,class:"bg-white rounded-md border border-gray-200 p-3"},[(0,n.Lk)("div",ue,[(0,n.Lk)("div",ce,[s.isEditing?((0,n.uX)(),(0,n.CE)("div",pe,[(0,n.Lk)("div",fe,[(0,n.Lk)("div",null,[t[19]||(t[19]=(0,n.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ชื่อเมนูย่อย",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":e=>s.title=e,placeholder:"ชื่อเมนูย่อย",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,he),[[d.Jo,s.title]])]),(0,n.Lk)("div",null,[t[20]||(t[20]=(0,n.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ลิงก์",-1)),(0,n.bo)((0,n.Lk)("input",{"onUpdate:modelValue":e=>s.target=e,placeholder:"ลิงก์หรือ URL",class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},null,8,xe),[[d.Jo,s.target]])]),(0,n.Lk)("div",null,[t[22]||(t[22]=(0,n.Lk)("label",{class:"block text-xs font-medium text-gray-700 mb-1"},"ย้ายไป",-1)),(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":e=>s.newParentId=e,onChange:t=>a.moveSubItemToNewParent(e,s),class:"w-full px-2 py-1 text-sm border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500"},[t[21]||(t[21]=(0,n.Lk)("option",{value:""},"ย้ายไปเมนูหลัก",-1)),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(a.filteredEditMenu(e.id),(e=>((0,n.uX)(),(0,n.CE)("option",{key:e.id,value:e.id}," ย้ายไป "+(0,l.v_)(e.title),9,ke)))),128))],40,ye),[[d.u1,s.newParentId]])])]),(0,n.Lk)("div",ve,[(0,n.Lk)("button",{onClick:t=>a.updateSubItem(e,s),class:"px-3 py-1 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors duration-200 text-sm"}," บันทึก ",8,we),(0,n.Lk)("button",{onClick:e=>a.cancelEditSubItem(s),class:"px-3 py-1 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors duration-200 text-sm"}," ยกเลิก ",8,Le)])])):((0,n.uX)(),(0,n.CE)("div",me,[t[18]||(t[18]=(0,n.Lk)("div",{class:"w-1 h-1 bg-gray-400 rounded-full mr-2"},null,-1)),(0,n.Lk)("div",null,[(0,n.Lk)("h4",be,(0,l.v_)(s.title),1),(0,n.Lk)("p",ge,(0,l.v_)(s.target),1)])]))]),s.isEditing?(0,n.Q3)("",!0):((0,n.uX)(),(0,n.CE)("div",Ce,[(0,n.Lk)("button",{onClick:t=>a.editSubItem(e,s),class:"p-1 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-md transition-colors duration-200"},[(0,n.bF)(Xe,{icon:["fas","pencil"],class:"w-2 h-2"})],8,Me),(0,n.Lk)("button",{onClick:t=>a.moveUpSubItem(e,s),disabled:a.isFirstSubItem(e,s),class:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-md transition-colors duration-200 disabled:opacity-30 disabled:cursor-not-allowed"},[(0,n.bF)(Xe,{icon:["fas","chevron-up"],class:"w-2 h-2"})],8,Ie),(0,n.Lk)("button",{onClick:t=>a.moveDownSubItem(e,s),disabled:a.isLastSubItem(e,s),class:"p-1 text-gray-400 hover:text-gray-600 hover:bg-gray-50 rounded-md transition-colors duration-200 disabled:opacity-30 disabled:cursor-not-allowed"},[(0,n.bF)(Xe,{icon:["fas","chevron-down"],class:"w-2 h-2"})],8,Ee),(0,n.Lk)("button",{onClick:t=>a.deleteSubItem(e,s),class:"p-1 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-md transition-colors duration-200"},[(0,n.bF)(Xe,{icon:["fas","trash"],class:"w-2 h-2"})],8,Se)]))])])))),128))])])):(0,n.Q3)("",!0)])))),128))])])])])])],64)}s(44114),s(98992),s(54520),s(72577),s(3949),s(81454),s(37550);var Xe=s(87814),De=s(77528),_e={data(){return{dataItem:this.$route.params.id,post:[],menuItems:[],editMenu:[],session:r.A.get("session"),navigation:r.A.get("navigation"),configs:r.A.get("configs"),confirmationMessage:"",confirmationHeader:"",showConfirmation:!1,deletionData:null}},async mounted(){try{await this.getData()}catch(e){console.log(e)}},components:{Subhead:Xe.A,CustomConfirmation:De.A},computed:{filteredMenuItems(){const e=[...this.editMenu,...this.getAllSubMenuItems(this.editMenu)];return this.menuItems.filter((t=>!e.some((e=>e.id===t.id))))},filteredEditMenu(){return e=>this.editMenu.filter((t=>t.id!==e))},filteredPluginItems(){const e=this.editMenu.map((e=>e.id));return this.navigation.filter((e=>e.submenu&&e.submenu.some((e=>!0===e.front)))).map((e=>({id:e.slug,title:e.name,target:e.href,auth:!0}))).filter((t=>!e.includes(t.id)))}},methods:{moveSubItemToNewParent(e,t){const s=t.newParentId;if(s){const e=this.editMenu.find((e=>e.id===s));e&&(e.subMenu=e.subMenu||[],e.subMenu.push(t))}else this.editMenu.push(t);const n=e.subMenu.indexOf(t);n>-1&&e.subMenu.splice(n,1),t.newParentId=""},addSubmenuItem(e){const t={id:this.generateUniqueId(),title:"New Submenu",target:"#",isEditing:!0};e.subMenu=e.subMenu||[],e.subMenu.push(t)},getAllSubMenuItems(e){let t=[];return e.forEach((e=>{e.subMenu&&e.subMenu.length>0&&(t.push(...e.subMenu),t.push(...this.getAllSubMenuItems(e.subMenu)))})),t},showSubMenu(e){e.showSubMenu=!0},closeSubMenu(e){e.showSubMenu=!1},moveToSubMenu(e){const t=e.mainMenu;if(t){const s=this.editMenu.find((e=>e.id===t));s&&(s.subMenu=s.subMenu||[],s.subMenu.push(e),this.editMenu=this.editMenu.filter((t=>t!==e)),e.showSubMenu=!1,e.mainMenu="")}},async getData(){if(r.A.get("session","login"))try{const e=await fetch("https://gateway.cloudrestfulapi.com/api/post/query",{method:"POST",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({method:"find",args:[{$and:[{owner:this.session.current._id},{type:{$in:["page","form"]}}]}],paging:{page:this.currentPage,limit:this.limitItem}})}),t=await e.json();200===e.status&&(await this.getPostData(),this.menuItems=t.data.map((e=>({id:e._id,title:e.title,target:`/cms/page/${e.slug}`,auth:!0}))))}catch(e){console.log(e)}},async getPostData(){try{const e=await fetch(`https://gateway.cloudrestfulapi.com/api/post/${this.dataItem}`,{method:"GET",headers:{"Content-Type":"application/json","client-token-key":this.configs.key}}),t=await e.json(),s=t;this.$setPageTitle(t.title),s&&(this.post=s,this.editMenu=s.builder)}catch(e){console.log(e)}},async updateData(){try{const e=await fetch("https://gateway.cloudrestfulapi.com/api/post/"+this.dataItem,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.configs.key},body:JSON.stringify({data:{builder:this.editMenu},options:{}})}),t=await e.json();console.log(t),200===e.status&&this.$swal({toast:!0,position:"bottom-end",showConfirmButton:!1,timer:3e3,icon:"success",title:"บันทึกข้อมูลหน้าเว็บ",text:"บันทึกข้อมูลสำหรับหน้าเว็บนี้ สำเร็จแล้ว"})}catch(e){console.error(e)}},confirmRemoveItem(){const{item:e}=this.deletionData,t=this.editMenu.indexOf(e);t>-1&&this.editMenu.splice(t,1),this.handleConfirmCancel()},confirmRemoveSubItem(){const{parentItem:e,subitem:t}=this.deletionData,s=e.subMenu.indexOf(t);s>-1&&e.subMenu.splice(s,1),this.handleConfirmCancel()},handleConfirmation(){if(this.deletionData){const{type:e}=this.deletionData;"item"===e?this.confirmRemoveItem():"subitem"===e&&this.confirmRemoveSubItem()}},handleConfirmCancel(){this.deletionData=null,this.confirmationMessage="",this.confirmationHeader="",this.showConfirmation=!1},deleteItem(e){this.confirmationMessage="คุณต้องการลบเนื้อหา (Content) นี้ ?",this.confirmationHeader="ยืนยันการทำรายการ",this.deletionData={type:"item",item:e},this.showConfirmation=!0},deleteSubItem(e,t){this.confirmationMessage="คุณต้องการลบเนื้อหา (Content) นี้ ?",this.confirmationHeader="ยืนยันการทำรายการ",this.deletionData={type:"subitem",subitem:t,parentItem:e},this.showConfirmation=!0},addToEditMenu(e){this.editMenu.push(e)},moveUpItem(e){const t=this.editMenu.indexOf(e);t>0&&(this.editMenu.splice(t,1),this.editMenu.splice(t-1,0,e))},moveDownItem(e){const t=this.editMenu.indexOf(e);t<this.editMenu.length-1&&(this.editMenu.splice(t,1),this.editMenu.splice(t+1,0,e))},isFirstItem(e){return 0===this.editMenu.indexOf(e)},isLastItem(e){return this.editMenu.indexOf(e)===this.editMenu.length-1},editItem(e){e.isEditing=!0},updateItem(e){e.isEditing=!1},cancelEdit(e){e.isEditing=!1,e.newAttribute=""},moveUpSubItem(e,t){const s=e.subMenu.indexOf(t);s>0&&(e.subMenu.splice(s,1),e.subMenu.splice(s-1,0,t))},moveDownSubItem(e,t){const s=e.subMenu.indexOf(t);s<e.subMenu.length-1&&(e.subMenu.splice(s,1),e.subMenu.splice(s+1,0,t))},isFirstSubItem(e,t){return 0===e.subMenu.indexOf(t)},isLastSubItem(e,t){return e.subMenu.indexOf(t)===e.subMenu.length-1},editSubItem(e,t){t.isEditing=!0},updateSubItem(e,t){t.isEditing=!1},cancelEditSubItem(e){e.isEditing=!1,e.newAttribute=""},generateUniqueId(){const e=(new Date).getTime();return`item_${e}`},addEmptyItem(){const e={id:this.generateUniqueId(),title:"New Menu Item",target:"#",auth:!0};this.editMenu.push(e)}}},Ue=s(64621);const Pe=(0,Ue.A)(_e,[["render",Fe]]);var Te=Pe,je={name:"Page Index",components:{Backend:Te},data(){return{session:r.A.get("session")}},setup(){const e=(0,a.lq)(),t=e.meta.title;(0,o.K7)(t)},computed:{componentName(){return"Backend"}}};const Ae=(0,Ue.A)(je,[["render",i]]);var $e=Ae},87814:function(e,t,s){s.d(t,{A:function(){return F}});var n=s(20641),i=s(90033),o=s(53751);const a={class:"py-2 bg-white border-l border-r border-b border-1 border-gray-200"},r={class:"mx-auto px-2 sm:px-6 lg:px-6 xl:flex xl:items-center xl:justify-between"},l={class:"min-w-0 flex-1"},d={class:"mt-1 text-[18px] font-semibold leading-8 text-gray-700"},u={key:0,class:"text-sm text-gray-500"},c={class:"mt-5 flex xl:mt-0 xl:ml-4"},m={class:"flex items-center space-x-2"},b={class:"text-sm text-gray-400"},g=["onUpdate:modelValue","placeholder","onChange"],p={value:"",disabled:""},f=["value"],h=["onClick"],x={class:"text-sm hidden sm:inline-block ml-1"},y=["onClick"],k={class:"text-sm hidden sm:inline-block ml-1"};function v(e,t,s,v,w,L){const C=(0,n.g2)("font-awesome-icon");return(0,n.uX)(),(0,n.CE)("header",a,[(0,n.Lk)("div",r,[(0,n.Lk)("div",l,[(0,n.Lk)("h1",d,[(0,n.bF)(C,{icon:["fas",this.PageIcon],class:"text-gray-500 text-[18px]"},null,8,["icon"]),(0,n.eW)(" "+(0,i.v_)(s.pageTitle?s.pageTitle:this.PageName),1)]),s.subhead?((0,n.uX)(),(0,n.CE)("p",u,(0,i.v_)(s.subhead),1)):(0,n.Q3)("",!0)]),(0,n.Lk)("div",c,[(0,n.Lk)("div",m,[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(s.navigation,((t,s)=>((0,n.uX)(),(0,n.CE)(n.FK,{key:s},["select"===t.type?((0,n.uX)(),(0,n.CE)(n.FK,{key:0},[(0,n.Lk)("label",b,(0,i.v_)(t.placeholder),1),(0,n.bo)((0,n.Lk)("select",{"onUpdate:modelValue":e=>t.value=e,class:"block w-36 py-2 px-3 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-md",placeholder:t.placeholder,onChange:s=>e.$emit("toggleStatus",t.value)},[(0,n.Lk)("option",p,"-- "+(0,i.v_)(t.placeholder)+" --",1),((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.options,((e,t)=>((0,n.uX)(),(0,n.CE)("option",{key:t,value:e.value},(0,i.v_)(e.name),9,f)))),128))],40,g),[[o.u1,t.value]])],64)):"call-function"===t.type?((0,n.uX)(),(0,n.CE)(n.FK,{key:1},[!1!==t.visible?((0,n.uX)(),(0,n.CE)("button",{key:0,onClick:s=>e.$emit(t.function),type:"button",class:(0,i.C4)(L.getClasses(t.class))},[(0,n.bF)(C,{icon:["fas",`${t.style}`],class:(0,i.C4)({"text-gray-500 mr-2":"icon-btn"===t.class,"text-white":"primary-btn"===t.class})},null,8,["icon","class"]),(0,n.Lk)("span",x,(0,i.v_)(t.name),1)],10,h)):(0,n.Q3)("",!0)],64)):((0,n.uX)(),(0,n.CE)(n.FK,{key:2},[!1!==t.visible?((0,n.uX)(),(0,n.CE)("button",{key:0,onClick:e=>L.handleNavigationClick(t),type:"button",class:(0,i.C4)(L.getClasses(t.class))},[(0,n.bF)(C,{icon:["fas",`${t.style}`],class:(0,i.C4)({"text-gray-500 mr-2":"icon-btn"===t.class,"text-white":"primary-btn"===t.class})},null,8,["icon","class"]),(0,n.Lk)("span",k,(0,i.v_)(t.name),1)],10,y)):(0,n.Q3)("",!0)],64))],64)))),128))])])])])}s(44114);var w=s(75220),L=s(52968),C=s(23264),M=s(93426),I={props:{navigation:{type:Array,default:()=>[]},pageTitle:{type:String,default:()=>null},subhead:{type:String,default:()=>null}},data(){const e=(0,w.lq)();return console.log("Translate",(0,M.Tl)("router-"+e.meta.parent+"-"+e.meta.key)),{PageName:(0,M.iX)(),PageIcon:e.meta.icon,PagePath:e.meta.path,ParentName:e.meta.parent,ParentPage:e.meta.page}},setup(){(0,L.K7)((0,M.iX)())},methods:{getClasses(e){const t=(0,C.c)(e);return`${t}`},handleNavigationClick(e){e.function?this.$emit(e.eventName||e.function):this.$router.push(e.link)}}},E=s(64621);const S=(0,E.A)(I,[["render",v]]);var F=S},77528:function(e,t,s){s.d(t,{A:function(){return h}});var n=s(20641),i=s(53751),o=s(90033);const a={class:"w-[420px] bg-white shadow-xl border border-gray-200 rounded-lg overflow-hidden confirmation-modal",tabindex:"0"},r={class:"bg-white border-b border-gray-200 px-4 py-3"},l={class:"flex items-center space-x-2"},d={class:"text-base font-semibold text-gray-900"},u={class:"px-4 py-4"},c=["innerHTML"],m={class:"bg-gray-50 border-t border-gray-200 px-4 py-3 flex items-center justify-end space-x-2"};function b(e,t,s,b,g,p){const f=(0,n.g2)("font-awesome-icon");return(0,n.uX)(),(0,n.CE)("div",{class:"z-20 fixed inset-0 flex items-center justify-center",onKeydown:[t[2]||(t[2]=(0,i.jR)(((...e)=>p.confirmDeletion&&p.confirmDeletion(...e)),["enter"])),t[3]||(t[3]=(0,i.jR)(((...e)=>p.cancelDeletion&&p.cancelDeletion(...e)),["esc"]))],ref:"popupContainer",tabindex:"0"},[t[6]||(t[6]=(0,n.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-50"},null,-1)),(0,n.Lk)("div",a,[(0,n.Lk)("div",r,[(0,n.Lk)("div",l,[(0,n.Lk)("div",{class:(0,o.C4)(["w-6 h-6 rounded-md flex items-center justify-center",p.iconBadgeClass])},[(0,n.bF)(f,{icon:p.iconType,class:"h-3 w-3 text-white"},null,8,["icon"])],2),(0,n.Lk)("div",null,[(0,n.Lk)("h2",d,(0,o.v_)(s.header),1),t[4]||(t[4]=(0,n.Lk)("p",{class:"text-xs text-gray-500"},"โปรดยืนยันการดำเนินการ",-1))])])]),(0,n.Lk)("div",u,[(0,n.Lk)("div",{class:"text-sm text-gray-700 leading-relaxed",innerHTML:s.message},null,8,c)]),(0,n.Lk)("div",m,[(0,n.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>p.cancelDeletion&&p.cancelDeletion(...e)),class:"px-3 py-1.5 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 transition-colors"}," ยกเลิก "),(0,n.Lk)("button",{class:(0,o.C4)([p.confirmButtonClass,"px-3 py-1.5 text-sm font-medium text-white border border-transparent rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors"]),onClick:t[1]||(t[1]=(...e)=>p.confirmDeletion&&p.confirmDeletion(...e))},[(0,n.bF)(f,{icon:["fas","check"],class:"h-3.5 w-3.5 mr-1.5"}),t[5]||(t[5]=(0,n.eW)(" ตกลง "))],2)])])],544)}var g={props:{header:{type:String,required:!0},message:{type:String,required:!0},type:{type:String,default:"default"}},mounted(){this.$refs.popupContainer.focus()},computed:{iconType(){return"warning"===this.type?["fas","exclamation-triangle"]:"success"===this.type?["fas","check-circle"]:"information"===this.type?["fas","info-circle"]:["fas","question-circle"]},iconBadgeClass(){return"warning"===this.type?"bg-red-500":"success"===this.type?"bg-green-500":"information"===this.type?"bg-blue-500":"bg-gray-500"},confirmButtonClass(){return"warning"===this.type?"bg-red-600 hover:bg-red-700 focus:ring-red-500":"success"===this.type?"bg-green-600 hover:bg-green-700 focus:ring-green-500":"information"===this.type?"bg-blue-600 hover:bg-blue-700 focus:ring-blue-500":"bg-gray-600 hover:bg-gray-700 focus:ring-gray-500"}},methods:{confirmDeletion(){this.$emit("confirm")},cancelDeletion(){this.$emit("cancel")}}},p=s(64621);const f=(0,p.A)(g,[["render",b],["__scopeId","data-v-9ba66394"]]);var h=f},23264:function(e,t,s){function n(e){switch(e){case"input-plaintext":return"pl-0 focus:outline-none focus:ring-0 shadow-none border-0";case"primary-btn":return"px-4 py-2 text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"icon-btn":return"px-4 py-2 text-gray-700 bg-transparent hover:bg-transparent hover:text-gray-800";case"default-btn":return"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"danger-btn":return"px-4 py-2 text-white bg-red-600 rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"success-btn":return"px-4 py-2 text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-50";default:return""}}s.d(t,{c:function(){return n}})}}]);
//# sourceMappingURL=8812.70ec4568.js.map