"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[9287],{29287:function(e,t,n){n.r(t),n.d(t,{default:function(){return z}});var s=n(20641);function a(e,t,n,a,o,l){const r=(0,s.g2)("Authen"),i=(0,s.g2)("Dashboard");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(r),this.login?((0,s.uX)(),(0,s.Wv)(i,{key:0})):(0,s.Q3)("",!0)],64)}var o=n(52968),l=n(75220),r=n(90033),i=n(53751);const u={class:"flex-1 pb-8 bg-gray-100 pt-2 pb-5 border-t"},d={class:"mt-8"},m={class:"mx-auto max-w-7xl px-6 sm:px-6 lg:px-6"},c={class:"mt-8 flex flex-col"},g={class:"-my-2 -mx-4 overflow-x-auto sm:-mx-6 lg:-mx-8"},p={class:"inline-block min-w-full py-2 align-middle md:px-6 lg:px-8"},h={class:"overflow-hidden ring-1 ring-black ring-opacity-5 md:rounded-lg"},b={class:"divide-y divide-gray-200 overflow-hidden rounded-lg bg-gray-200 sm:grid sm:grid-cols-2 sm:gap-px sm:divide-y-0"},f={class:"rounded-tl-lg rounded-tr-lg sm:rounded-tr-none relative group bg-white p-3"},y={class:"mt-4"},k={class:"column menu"},v=["onDragstart"],x={key:0,class:"popup"},w={class:"popup-content"},I={class:"sm:rounded-tr-lg relative group bg-white p-3"},A={class:"mt-4"},C={key:0},L=["onDragstart","onDragend","onDrop"],D={class:"flex w-full"},T={class:"w-4/5"},M={class:"item-title font-medium text-black"},E={key:0,class:"item-old-title"},H={class:"w-1/5 flex justify-end items-center"},X=["onClick"],F=["onClick"],P=["onDrop"],S={key:0,class:"bg-gray-100 py-3 px-3 text-center text-xs text-gray-400"},$=["onDragstart"],K={class:"flex w-full"},N={class:"w-4/5"},_={class:"w-1/5 flex justify-end items-center"},j=["onClick"],Q=["onClick"];function U(e,t,n,a,o,l){const U=(0,s.g2)("Subhead"),q=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)(s.FK,null,[(0,s.bF)(U,{navigation:[{name:"ปรับแต่งเมนู",link:"/school/menu/"+this.dataItem,style:"list",class:"primary-btn",visible:!0,type:"button"},{name:"ย้อนกลับ",link:"/school/edit/"+this.dataItem,style:"chevron-left",class:"primary-btn",visible:!0,type:"button"}]},null,8,["navigation"]),(0,s.Lk)("div",u,[(0,s.Lk)("div",d,[(0,s.Lk)("div",m,[(0,s.Lk)("div",c,[(0,s.Lk)("div",g,[(0,s.Lk)("div",p,[(0,s.Lk)("div",h,[(0,s.Lk)("div",b,[(0,s.Lk)("div",f,[(0,s.Lk)("div",y,[(0,s.Lk)("div",k,[t[17]||(t[17]=(0,s.Lk)("div",{class:"title"},"Plugin",-1)),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.menuItems,(e=>((0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(["w-full py-2 px-2 border border-gray-200",{auth:e.auth}]),key:e.id,draggable:!0,onDragstart:t=>l.dragStartHandler(e)},[(0,s.Lk)("p",null,(0,r.v_)(e.title),1)],42,v)))),128)),(0,s.Lk)("button",{class:"mt-5 mb-5 mr-2 inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2",onClick:t[0]||(t[0]=(...e)=>l.showAddMenuItemPopup&&l.showAddMenuItemPopup(...e))},[(0,s.bF)(q,{icon:["fas","plus"],class:"mr-1 h-4 w-4 text-gray-600"}),t[12]||(t[12]=(0,s.eW)(" Add Menu Item "))]),o.showAddMenuItem?((0,s.uX)(),(0,s.CE)("div",x,[(0,s.Lk)("div",w,[t[13]||(t[13]=(0,s.Lk)("h2",null,"Add Menu Item",-1)),t[14]||(t[14]=(0,s.Lk)("label",null,"Title",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>o.newMenuItemTitle=e)},null,512),[[i.Jo,o.newMenuItemTitle]]),t[15]||(t[15]=(0,s.Lk)("label",null,"Target",-1)),(0,s.bo)((0,s.Lk)("input",{type:"text","onUpdate:modelValue":t[2]||(t[2]=e=>o.newMenuItemTarget=e)},null,512),[[i.Jo,o.newMenuItemTarget]]),t[16]||(t[16]=(0,s.Lk)("label",null,"Requires Auth",-1)),(0,s.bo)((0,s.Lk)("input",{type:"checkbox","onUpdate:modelValue":t[3]||(t[3]=e=>o.newMenuItemAuth=e)},null,512),[[i.lH,o.newMenuItemAuth]]),(0,s.Lk)("button",{onClick:t[4]||(t[4]=(...e)=>l.addMenuItemHandler&&l.addMenuItemHandler(...e))},"Add"),(0,s.Lk)("button",{onClick:t[5]||(t[5]=(...t)=>e.hideAddMenuItemPopup&&e.hideAddMenuItemPopup(...t))},"Cancel")])])):(0,s.Q3)("",!0)])])]),(0,s.Lk)("div",I,[(0,s.Lk)("div",A,[(0,s.Lk)("div",{class:"column main p-3",onDragover:t[10]||(t[10]=(0,i.D$)((()=>{}),["prevent"])),onDrop:t[11]||(t[11]=(...e)=>l.dropHandler&&l.dropHandler(...e))},[t[19]||(t[19]=(0,s.Lk)("div",{class:"title"},"Main Menu",-1)),o.droppedItems&&0!==o.droppedItems.length?(0,s.Q3)("",!0):((0,s.uX)(),(0,s.CE)("div",C,"Drop items here")),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(o.droppedItems,((e,n)=>((0,s.uX)(),(0,s.CE)("div",{key:e.id,draggable:!0,class:(0,r.C4)([{dragging:o.itemDragging===n},"w-full py-2 px-2 border border-gray-200 p-2 mb-2"]),onDragstart:t=>l.dragStartHandler(e,n),onDragend:e=>l.dragEndHandler(n),onDragover:t[8]||(t[8]=(0,i.D$)((()=>{}),["prevent"])),onDrop:e=>l.dropItemHandler(n)},[(0,s.Lk)("div",D,[(0,s.Lk)("div",T,[(0,s.Lk)("div",M,(0,r.v_)(e.title),1),e.oldTitle?((0,s.uX)(),(0,s.CE)("div",E,(0,r.v_)(e.oldTitle),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",H,[(0,s.Lk)("button",{class:"mr-1",onClick:e=>l.renameHandler(n)},[(0,s.bF)(q,{icon:["fas","pencil"],class:"mx-auto h-3 w-3 text-gray-600"})],8,X),(0,s.Lk)("button",{class:"ml-1",onClick:e=>l.deleteHandler(n)},[(0,s.bF)(q,{icon:["fas","trash"],class:"mx-auto h-3 w-3 text-gray-600"})],8,F)])]),(0,s.Lk)("div",{class:"submenu bg-gray-100 mt-2 p-2",onDragover:t[7]||(t[7]=(0,i.D$)((()=>{}),["prevent"])),onDrop:e=>l.dropSubmenuHandler(n,e)},[0===e.submenu.length?((0,s.uX)(),(0,s.CE)("div",S,"Drag items here to create a submenu")):(0,s.Q3)("",!0),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(e.submenu,((e,a)=>((0,s.uX)(),(0,s.CE)("div",{class:(0,r.C4)(["submenu-item py-1 px-1 bg-white border border-gray-200 text-[15px]",{dragging:o.submenuDragging===a}]),key:e.id,draggable:!0,onDragstart:t=>l.submenuDragStartHandler(e,a),onDragend:t[6]||(t[6]=(...e)=>l.submenuDragEndHandler&&l.submenuDragEndHandler(...e))},[(0,s.Lk)("div",K,[(0,s.Lk)("div",N,(0,r.v_)(e.title),1),(0,s.Lk)("div",_,[(0,s.Lk)("button",{class:"rename-submenu-btn mr-1",onClick:e=>l.renameSubmenuHandler(n,a)},[(0,s.bF)(q,{icon:["fas","pencil"],class:"mx-auto h-3 w-3 text-gray-600"})],8,j),(0,s.Lk)("button",{class:"delete-submenu-btn ml-1",onClick:e=>l.deleteSubmenuHandler(n,a)},[(0,s.bF)(q,{icon:["fas","trash"],class:"mx-auto h-3 w-3 text-gray-600"})],8,Q)])])],42,$)))),128))],40,P)],42,L)))),128)),(0,s.Lk)("button",{class:"mt-5 mb-5 mr-2 inline-flex justify-center rounded-md border border-gray-300 bg-white px-2 py-2 text-sm font-medium text-gray-700 shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-900 focus:ring-offset-2",onClick:t[9]||(t[9]=(...e)=>l.viewAllHandler&&l.viewAllHandler(...e))},[(0,s.bF)(q,{icon:["fas","save"],class:"mr-1 h-4 w-4 text-gray-600"}),t[18]||(t[18]=(0,s.eW)(" Save "))])],32)])])])])])])])])])])],64)}n(44114),n(98992),n(54520),n(72577),n(81454);var q=n(40475),V=n(87814),W={data(){return{hostkey:this.$Key,menuItems:[{id:1,title:"Menu Item 1",target:"#url1",auth:!0},{id:2,title:"Menu Item 2",target:"#url2",auth:!1},{id:3,title:"Menu Item 3",target:"#url3",auth:!0}],menuData:[],droppedItems:[],itemDragging:null,submenuDragging:null,newMenuItemTitle:"",newMenuItemTarget:"",newMenuItemAuth:!1,showAddMenuItem:!1,dataItem:this.$route.params.id,configs:q.A.get("configs")}},components:{Subhead:V.A},mounted(){this.fetchData()},methods:{async fetchData(){try{let e=this.$route.params.id;const t=await fetch("https://gateway.cloudrestfulapi.com/api/hostname/"+e,{method:"GET",headers:{"Content-Type":"application/json","client-token-key":this.hostkey}}),n=await t.json();n.menu?this.droppedItems=n.menu:this.droppedItems=[]}catch(e){console.error(e)}},async updateData(){try{this.activeBlock=!0;const e=await fetch("https://gateway.cloudrestfulapi.com/api/hostname/"+this.dataItem,{method:"PUT",headers:{"Content-Type":"application/json","client-token-key":this.hostkey},body:JSON.stringify({data:{menu:this.menuData}})}),t=await e.json();console.log(t)}catch(e){console.error(e)}},showAddMenuItemPopup(){this.showAddMenuItem=!0},dragStartHandler(e,t){event.dataTransfer.setData("text/plain",e.id),event.dataTransfer.effectAllowed="move",this.itemDragging=t},dropHandler(e){const t=e.dataTransfer.getData("text/plain"),n=this.menuItems.find((e=>e.id===Number(t)));if(n){const e={...n,oldTitle:n.title,id:Date.now(),submenu:[]};this.menuItems=this.menuItems.filter((e=>e.id!==n.id)),this.droppedItems.push(e)}},dragEndHandler(){this.itemDragging=null,this.submenuDragging=null},dropItemHandler(e){null!==this.itemDragging&&this.itemDragging!==e&&this.droppedItems.splice(e,0,this.droppedItems.splice(this.itemDragging,1)[0])},deleteHandler(e){const t=this.droppedItems.splice(e,1)[0];t.oldTitle&&(t.title=t.oldTitle,delete t.oldTitle),this.menuItems.push(t)},renameHandler(e){const t=this.droppedItems[e].title,n=prompt("Enter new name:",t);n&&(this.droppedItems[e].oldTitle=t,this.droppedItems[e].title=n)},renameSubmenuHandler(e,t){const n=this.droppedItems[e].submenu[t].title,s=prompt("Enter new name:",n);s&&(this.droppedItems[e].submenu[t].oldTitle=n,this.droppedItems[e].submenu[t].title=s)},viewAllHandler(){this.menuData=this.droppedItems.map((e=>({title:e.title,target:e.target,auth:e.auth,submenu:e.submenu.map((e=>({title:e.title,target:e.target})))}))),this.updateData(),console.log(this.droppedItems.map((e=>({title:e.title,target:e.target,auth:e.auth,submenu:e.submenu.map((e=>({title:e.title,target:e.target})))}))))},addMenuItemHandler(){if(this.newMenuItemTitle){const e={id:Date.now(),title:this.newMenuItemTitle,target:this.newMenuItemTarget,auth:this.newMenuItemAuth};this.menuItems.push(e),this.newMenuItemTitle="",this.newMenuItemTarget="",this.newMenuItemAuth=!1,this.showAddMenuItem=!1}},dropSubmenuHandler(e,t){const n=t.dataTransfer.getData("text/plain"),s=this.menuItems.find((e=>e.id===Number(n)));if(s){const t={...s,oldTitle:s.title,id:Date.now()};this.menuItems=this.menuItems.filter((e=>e.id!==s.id)),this.droppedItems[e].submenu.push(t)}},submenuDragStartHandler(e,t){event.dataTransfer.setData("text/plain",e.id),event.dataTransfer.effectAllowed="move",this.submenuDragging=t},submenuDragEndHandler(){this.submenuDragging=null},deleteSubmenuHandler(e,t){const n=this.droppedItems[e].submenu.splice(t,1)[0];n.oldTitle&&(n.title=n.oldTitle,delete n.oldTitle),this.menuItems.push(n)}}},J=n(64621);const R=(0,J.A)(W,[["render",U]]);var B=R,Y=n(74284),G={name:"Home",components:{Dashboard:B,Authen:Y.A},data(){return{login:q.A.get("session","login")}},methods:{},mounted(){},setup(){const e=(0,l.lq)(),t=e.meta.title;(0,o.K7)(t),console.log("Dashboard")}};const O=(0,J.A)(G,[["render",a]]);var z=O},87814:function(e,t,n){n.d(t,{A:function(){return M}});var s=n(20641),a=n(90033),o=n(53751);const l={class:"py-2 bg-white border-l border-r border-b border-1 border-gray-200"},r={class:"mx-auto px-2 sm:px-6 lg:px-6 xl:flex xl:items-center xl:justify-between"},i={class:"min-w-0 flex-1"},u={class:"mt-1 text-[18px] font-semibold leading-8 text-gray-700"},d={key:0,class:"text-sm text-gray-500"},m={class:"mt-5 flex xl:mt-0 xl:ml-4"},c={class:"flex items-center space-x-2"},g={class:"text-sm text-gray-400"},p=["onUpdate:modelValue","placeholder","onChange"],h={value:"",disabled:""},b=["value"],f=["onClick"],y={class:"text-sm hidden sm:inline-block ml-1"},k=["onClick"],v={class:"text-sm hidden sm:inline-block ml-1"};function x(e,t,n,x,w,I){const A=(0,s.g2)("font-awesome-icon");return(0,s.uX)(),(0,s.CE)("header",l,[(0,s.Lk)("div",r,[(0,s.Lk)("div",i,[(0,s.Lk)("h1",u,[(0,s.bF)(A,{icon:["fas",this.PageIcon],class:"text-gray-500 text-[18px]"},null,8,["icon"]),(0,s.eW)(" "+(0,a.v_)(n.pageTitle?n.pageTitle:this.PageName),1)]),n.subhead?((0,s.uX)(),(0,s.CE)("p",d,(0,a.v_)(n.subhead),1)):(0,s.Q3)("",!0)]),(0,s.Lk)("div",m,[(0,s.Lk)("div",c,[((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(n.navigation,((t,n)=>((0,s.uX)(),(0,s.CE)(s.FK,{key:n},["select"===t.type?((0,s.uX)(),(0,s.CE)(s.FK,{key:0},[(0,s.Lk)("label",g,(0,a.v_)(t.placeholder),1),(0,s.bo)((0,s.Lk)("select",{"onUpdate:modelValue":e=>t.value=e,class:"block w-36 py-2 px-3 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-md",placeholder:t.placeholder,onChange:n=>e.$emit("toggleStatus",t.value)},[(0,s.Lk)("option",h,"-- "+(0,a.v_)(t.placeholder)+" --",1),((0,s.uX)(!0),(0,s.CE)(s.FK,null,(0,s.pI)(t.options,((e,t)=>((0,s.uX)(),(0,s.CE)("option",{key:t,value:e.value},(0,a.v_)(e.name),9,b)))),128))],40,p),[[o.u1,t.value]])],64)):"call-function"===t.type?((0,s.uX)(),(0,s.CE)(s.FK,{key:1},[!1!==t.visible?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:n=>e.$emit(t.function),type:"button",class:(0,a.C4)(I.getClasses(t.class))},[(0,s.bF)(A,{icon:["fas",`${t.style}`],class:(0,a.C4)({"text-gray-500 mr-2":"icon-btn"===t.class,"text-white":"primary-btn"===t.class})},null,8,["icon","class"]),(0,s.Lk)("span",y,(0,a.v_)(t.name),1)],10,f)):(0,s.Q3)("",!0)],64)):((0,s.uX)(),(0,s.CE)(s.FK,{key:2},[!1!==t.visible?((0,s.uX)(),(0,s.CE)("button",{key:0,onClick:e=>I.handleNavigationClick(t),type:"button",class:(0,a.C4)(I.getClasses(t.class))},[(0,s.bF)(A,{icon:["fas",`${t.style}`],class:(0,a.C4)({"text-gray-500 mr-2":"icon-btn"===t.class,"text-white":"primary-btn"===t.class})},null,8,["icon","class"]),(0,s.Lk)("span",v,(0,a.v_)(t.name),1)],10,k)):(0,s.Q3)("",!0)],64))],64)))),128))])])])])}n(44114);var w=n(75220),I=n(52968),A=n(23264),C=n(93426),L={props:{navigation:{type:Array,default:()=>[]},pageTitle:{type:String,default:()=>null},subhead:{type:String,default:()=>null}},data(){const e=(0,w.lq)();return console.log("Translate",(0,C.Tl)("router-"+e.meta.parent+"-"+e.meta.key)),{PageName:(0,C.iX)(),PageIcon:e.meta.icon,PagePath:e.meta.path,ParentName:e.meta.parent,ParentPage:e.meta.page}},setup(){(0,I.K7)((0,C.iX)())},methods:{getClasses(e){const t=(0,A.c)(e);return`${t}`},handleNavigationClick(e){e.function?this.$emit(e.eventName||e.function):this.$router.push(e.link)}}},D=n(64621);const T=(0,D.A)(L,[["render",x]]);var M=T},74284:function(e,t,n){n.d(t,{A:function(){return m}});var s=n(20641);function a(e,t,n,a,o,l){return(0,s.uX)(),(0,s.CE)("div")}var o=n(75220),l=n(63084),r=n(40475),i={name:"Authen",data(){return{configs:r.A.get("configs"),session:r.A.get("session")}},created(){l.A.option(this.$route)},computed:{},components:{},mounted(){this.checkAuth()},updated(){},methods:{async checkAuth(){const e=(0,o.lq)(),t=e.meta.auth,n=e.name,s=r.A.get("session");let a=s.token,i=s.login,u=s.current;l.A.log("hasLogin",i),l.A.log("Page -> Auth:",t),l.A.log("User -> Token:",a),l.A.log("User -> Login:",i),"frontend"===this.session.interface?l.A.log("Front-End"):"backend"===this.session.interface&&(l.A.log("Back-End"),i?("Login"==n||void 0==u?(l.A.log("Not Login Again"),this.$router.replace({path:"/"})):(l.A.log("Has School Active"),t?(l.A.log("This page is : Authen Request"),""===a||null===a||void 0==a?l.A.log("Your Cannot Access"):l.A.log("Your Can Access")):l.A.log("This page is : No Authen Request")),l.A.log("Login")):(l.A.log("Not Login"),"Login"!=n?(window.location.href="/member/login",l.A.log("Not Login Page",n)):l.A.log("Login Page",n)))}},setup(){}},u=n(64621);const d=(0,u.A)(i,[["render",a]]);var m=d},23264:function(e,t,n){function s(e){switch(e){case"input-plaintext":return"pl-0 focus:outline-none focus:ring-0 shadow-none border-0";case"primary-btn":return"px-4 py-2 text-white bg-blue-600 rounded-md shadow-sm hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"icon-btn":return"px-4 py-2 text-gray-700 bg-transparent hover:bg-transparent hover:text-gray-800";case"default-btn":return"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-md shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-yellow-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"danger-btn":return"px-4 py-2 text-white bg-red-600 rounded-md shadow-sm hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 focus:ring-offset-gray-50";case"success-btn":return"px-4 py-2 text-white bg-green-600 rounded-md shadow-sm hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 focus:ring-offset-gray-50";default:return""}}n.d(t,{c:function(){return s}})}}]);
//# sourceMappingURL=9287.7199891f.js.map