"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[2733],{40687:function(e,l,t){t.d(l,{A:function(){return b}});var i=t(20641),s=t(50953),a=t(90033),o=t(94232),d=t(10797),n=t(55372);const c={key:0,class:"fixed inset-0 overflow-y-auto"},r={class:"flex min-h-full items-center justify-center p-4 text-center"},m={class:"font-medium"},u={class:"bg-black w-8 h-8 right-2 top-2 leading-8 hover:bg-gray-500"},p={props:["isWindowsOpen","allowFileType","callbackFunction"],data(){return console.log("FileBrowser props:",this.isWindowsOpen,this.allowFileType,this.callbackFunction),{SessionList:[],loading_sources:!0,activeBlock:!1,schoolId:"",isOpen:this.isWindowsOpen,isAllow:this.allowFileType,isCallback:this.callbackFunction,mode:"popup"}},components:{FileManager:n.A},watch:{isWindowsOpen(e){console.log("isWindowsOpen changed to:",e),this.isOpen=e}},methods:{selectFileTrigger(e){this.selectFileTrigger=e,this.closeModal(),this.selectFile(e)},closeModal(){this.isOpen=!1,this.$emit("fileBrowserTrigger",!1)},selectFile(e){this.$emit("fileBrowserCallback",e)}},async mounted(){console.log("FileBrowser mounted with isOpen:",this.isOpen,"isWindowsOpen:",this.isWindowsOpen)},setup(){}};var g=Object.assign(p,{__name:"FileBrowser",setup(e){return(l,t)=>{const p=(0,i.g2)("font-awesome-icon");return(0,i.uX)(),(0,i.Wv)((0,s.R1)(o.O),{appear:"",show:l.isOpen,as:"template"},{default:(0,i.k6)((()=>[(0,i.bF)((0,s.R1)(d.lG),{as:"div",onClose:l.closeModal,class:"relative z-10"},{default:(0,i.k6)((()=>[(0,i.bF)((0,s.R1)(o._),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0","enter-to":"opacity-100",leave:"duration-200 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:(0,i.k6)((()=>t[1]||(t[1]=[(0,i.Lk)("div",{class:"fixed inset-0 bg-black bg-opacity-25"},null,-1)]))),_:1}),l.loading_sources?((0,i.uX)(),(0,i.CE)("div",c,[(0,i.Lk)("div",r,[(0,i.bF)((0,s.R1)(o._),{as:"template",enter:"duration-300 ease-out","enter-from":"opacity-0 scale-95","enter-to":"opacity-100 scale-100",leave:"duration-200 ease-in","leave-from":"opacity-100 scale-100","leave-to":"opacity-0 scale-95"},{default:(0,i.k6)((()=>[(0,i.bF)((0,s.R1)(d.Lj),{class:(0,a.C4)(["w-[60rem] z-40 transform overflow-hidden bg-white p-3 text-left align-middle shadow-xl transition-all blocking relative",[l.activeBlock?"isblock":"isunblock"]]),"data-content":"กำลังติดต่อฐานข้อมูล กรุณารอสักครู่....."},{default:(0,i.k6)((()=>[(0,i.bF)((0,s.R1)(d.L3),{as:"h3",class:"text-lg pb-2 font-bold leading-6 text-gray-900 border-b"},{default:(0,i.k6)((()=>[t[3]||(t[3]=(0,i.eW)("เลือกไฟล์ (Select File) ")),(0,i.Lk)("p",m,[t[2]||(t[2]=(0,i.eW)("อนุญาติเฉพาะไฟล์ ")),((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(e.allowFileType,(e=>((0,i.uX)(),(0,i.CE)("span",{key:e.code,class:"text-xs font-medium bg-indigo-600 pl-2 pr-2 pt-1 mr-1 rounded text-white"},(0,a.v_)(e),1)))),128))]),(0,i.Lk)("button",{onClick:t[0]||(t[0]=(...e)=>l.closeModal&&l.closeModal(...e)),type:"button",class:"z-50 absolute top-2 right-2"},[(0,i.Lk)("div",u,[(0,i.bF)(p,{icon:["fas","times"],class:"text-white mt-[7px] font-sm"})])])])),_:1}),(0,i.Lk)("div",null,[(0,i.bF)(n.A,{onSelectFileTrigger:l.selectFileTrigger,Mode:l.mode,AllowFile:l.isAllow,CallbackFunc:l.isCallback},null,8,["onSelectFileTrigger","Mode","AllowFile","CallbackFunc"])])])),_:1},8,["class"])])),_:1})])])):(0,i.Q3)("",!0)])),_:1},8,["onClose"])])),_:1},8,["show"])}}});const h=g;var b=h},59109:function(e,l,t){t.r(l),t.d(l,{default:function(){return G}});var i=t(20641),s=t(90033),a=t(53751);const o={key:0,class:"p-2 border rounded-md shadow-sm"},d={class:"flex items-center space-x-2"},n={class:"flex-shrink-0"},c=["src"],r={key:1,class:"w-16 h-10 bg-gray-200 rounded-md flex items-center justify-center text-gray-400"},m={class:"flex-grow min-w-0"},u={class:"text-xs text-gray-500"},p=["title"],g={class:"content-editor overflow-auto bg-white rounded-lg h-full"},h={class:"px-6 py-4 space-y-6"},b={class:"bg-white border border-gray-200 rounded-lg shadow-sm p-4"},k=["onClick"],y={key:0,class:"thumbnail-wrapper h-24 w-24 relative overflow-hidden rounded border bg-gray-100"},x=["src"],w={class:"upload-icon absolute inset-0 flex items-center justify-center opacity-0 hover:opacity-75 bg-black bg-opacity-25 transition-opacity"},f={key:1,class:"thumbnail-placeholder flex items-center justify-center h-24 w-24 bg-gray-200 border border-gray-300 rounded hover:bg-gray-300"},v={class:"slide-details-container w-4/5 ml-4"},I={key:0,class:"slide-summary"},S={class:"slide-content"},F={class:"font-semibold text-base"},C={class:"text-gray-600 text-sm"},L={class:"text-gray-600 text-xs italic"},O={class:"slide-actions flex items-center mt-2 space-x-1"},_=["onClick"],B=["onClick"],E=["onClick","disabled"],A=["onClick","disabled"],U=["onClick"],J={key:1,class:"slide-action-panel space-y-2"},T=["onUpdate:modelValue"],X=["onUpdate:modelValue"],N=["onUpdate:modelValue"],j={class:"grid grid-cols-2 gap-x-4"},V={class:"inline-flex items-center"},W=["onUpdate:modelValue"],M={class:"inline-flex items-center"},R=["onUpdate:modelValue"],Q={class:"slide-action-buttons flex space-x-2 mt-2"},z={class:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 mt-4 grid grid-cols-1 md:grid-cols-2 gap-4"},D={class:"flex items-center pt-5"};function H(e,l,t,H,K,P){const $=(0,i.g2)("FileBrowser"),q=(0,i.g2)("font-awesome-icon");return(0,i.uX)(),(0,i.CE)("div",null,["preview"===t.mode?((0,i.uX)(),(0,i.CE)("div",o,[(0,i.Lk)("div",d,[(0,i.Lk)("div",n,[K.localItem.slides&&K.localItem.slides.length>0&&K.localItem.slides[0].image?((0,i.uX)(),(0,i.CE)("img",{key:0,src:K.localItem.slides[0].image,alt:"First slide",class:"w-16 h-10 object-cover rounded-md bg-gray-200"},null,8,c)):((0,i.uX)(),(0,i.CE)("div",r,l[5]||(l[5]=[(0,i.Lk)("svg",{xmlns:"http://www.w3.org/2000/svg",class:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor","stroke-width":"2"},[(0,i.Lk)("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)])))]),(0,i.Lk)("div",m,[l[6]||(l[6]=(0,i.Lk)("p",{class:"text-sm font-medium text-gray-900 truncate"},"Slideshow",-1)),(0,i.Lk)("p",u,(0,s.v_)(K.localItem.slides?K.localItem.slides.length:0)+" slides",1),K.localItem.slides&&K.localItem.slides.length>0&&K.localItem.slides[0].title?((0,i.uX)(),(0,i.CE)("p",{key:0,class:"text-xs text-gray-500 truncate",title:K.localItem.slides[0].title}," First: "+(0,s.v_)(K.localItem.slides[0].title),9,p)):(0,i.Q3)("",!0)])])])):(0,i.Q3)("",!0),"edit"===t.mode?((0,i.uX)(),(0,i.CE)(i.FK,{key:1},[null!==K.slideImageBrowserOpenForIndex?((0,i.uX)(),(0,i.Wv)($,{key:0,class:"z-[9999]",isWindowsOpen:!0,callbackFunction:"slideshow_image_"+K.slideImageBrowserOpenForIndex,allowFileType:["jpg","gif","png","jpeg"],onFileBrowserTrigger:P.handleSlideFileBrowserClose,onFileBrowserCallback:P.handleSlideImageSelected},null,8,["callbackFunction","onFileBrowserTrigger","onFileBrowserCallback"])):(0,i.Q3)("",!0),(0,i.Lk)("div",g,[l[12]||(l[12]=(0,i.Fv)('<div class="bg-white border-b border-gray-200 px-6 py-4 sticky top-0 z-10" data-v-b3991fee><div class="flex items-center space-x-3" data-v-b3991fee><div class="w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center" data-v-b3991fee><i class="fas fa-images text-blue-600 h-4 w-4" data-v-b3991fee></i></div><div data-v-b3991fee><h3 class="text-lg font-semibold text-gray-900" data-v-b3991fee>Slideshow Configuration</h3><p class="text-sm text-gray-500" data-v-b3991fee>ตั้งค่าการแสดงผลของสไลด์โชว์</p></div></div></div>',1)),(0,i.Lk)("div",h,[(0,i.Lk)("div",b,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(K.localItem.slides,((e,t)=>((0,i.uX)(),(0,i.CE)("div",{key:t,class:"slide-item flex items-start border-b border-gray-200 py-4 pr-4"},[(0,i.Lk)("div",{class:"slide-thumbnail w-1/5 relative mr-3 cursor-pointer",onClick:e=>P.openSlideImageBrowser(t)},[e.image?((0,i.uX)(),(0,i.CE)("div",y,[(0,i.Lk)("img",{src:e.image,alt:"Slide Thumbnail",class:"w-full h-full object-cover"},null,8,x),(0,i.Lk)("div",w,[(0,i.bF)(q,{icon:["fas","upload"],class:"h-6 w-6 text-white"})])])):((0,i.uX)(),(0,i.CE)("div",f,[(0,i.bF)(q,{icon:["fas","image"],class:"h-8 w-8 text-gray-400"})]))],8,k),(0,i.Lk)("div",v,[K.editingSlideIndex!==t?((0,i.uX)(),(0,i.CE)("div",I,[(0,i.Lk)("div",S,[(0,i.Lk)("h3",F,(0,s.v_)(e.title||"Untitled Slide"),1),(0,i.Lk)("p",C,(0,s.v_)(e.subtitle),1),(0,i.Lk)("p",L,(0,s.v_)(e.link),1)]),(0,i.Lk)("div",O,[(0,i.Lk)("button",{onClick:e=>P.showSlideActionPanel(t),class:"p-1 bg-gray-200 hover:bg-gray-300 rounded",title:"Edit Slide"},[(0,i.bF)(q,{icon:["fas","pencil"],class:"h-3 w-3 text-gray-700"})],8,_),(0,i.Lk)("button",{onClick:e=>P.cloneSlide(t),class:"p-1 bg-gray-200 hover:bg-gray-300 rounded",title:"Clone Slide"},[(0,i.bF)(q,{icon:["fas","clone"],class:"h-3 w-3 text-gray-700"})],8,B),(0,i.Lk)("button",{onClick:e=>P.moveSlideUp(t),disabled:0===t,class:"p-1 bg-gray-200 hover:bg-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Move Up"},[(0,i.bF)(q,{icon:["fas","chevron-up"],class:"h-3 w-3 text-gray-700"})],8,E),(0,i.Lk)("button",{onClick:e=>P.moveSlideDown(t),disabled:t===K.localItem.slides.length-1,class:"p-1 bg-gray-200 hover:bg-gray-300 rounded disabled:opacity-50 disabled:cursor-not-allowed",title:"Move Down"},[(0,i.bF)(q,{icon:["fas","chevron-down"],class:"h-3 w-3 text-gray-700"})],8,A),(0,i.Lk)("button",{onClick:e=>P.deleteSlide(t),class:"p-1 bg-red-200 hover:bg-red-300 rounded ml-auto",title:"Delete Slide"},[(0,i.bF)(q,{icon:["fas","times"],class:"h-3 w-3 text-red-700"})],8,U)])])):(0,i.Q3)("",!0),K.editingSlideIndex===t?((0,i.uX)(),(0,i.CE)("div",J,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":l=>e.title=l,type:"text",class:"slide-input text-base border border-gray-300 rounded-md w-full p-2",placeholder:"Slide Title"},null,8,T),[[a.Jo,e.title]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":l=>e.subtitle=l,type:"text",class:"slide-input text-sm border border-gray-300 rounded-md w-full p-2",placeholder:"Slide Subtitle"},null,8,X),[[a.Jo,e.subtitle]]),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":l=>e.link=l,type:"text",class:"slide-input text-sm border border-gray-300 rounded-md w-full p-2",placeholder:"Slide URL (e.g., https://example.com)"},null,8,N),[[a.Jo,e.link]]),(0,i.Lk)("div",j,[(0,i.Lk)("label",V,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":l=>e.button=l,type:"checkbox",class:"form-checkbox rounded"},null,8,W),[[a.lH,e.button]]),l[7]||(l[7]=(0,i.Lk)("span",{class:"ml-2 text-sm"},"Show Button",-1))]),(0,i.Lk)("label",M,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":l=>e.content=l,type:"checkbox",class:"form-checkbox rounded"},null,8,R),[[a.lH,e.content]]),l[8]||(l[8]=(0,i.Lk)("span",{class:"ml-2 text-sm"},"Show Content Text",-1))])]),(0,i.Lk)("div",Q,[(0,i.Lk)("button",{onClick:l[0]||(l[0]=(...e)=>P.saveSlideChanges&&P.saveSlideChanges(...e)),class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 text-sm"},"Save"),(0,i.Lk)("button",{onClick:l[1]||(l[1]=(...e)=>P.cancelSlideEdit&&P.cancelSlideEdit(...e)),class:"px-3 py-1 bg-gray-300 text-gray-700 rounded hover:bg-gray-400 text-sm"},"Cancel")])])):(0,i.Q3)("",!0)])])))),128)),(0,i.Lk)("button",{onClick:l[2]||(l[2]=(...e)=>P.addSlide&&P.addSlide(...e)),class:"w-full border pt-2 pb-2 border-gray-300 hover:bg-gray-100 text-center add-slide-btn mt-4 text-gray-600 rounded flex items-center justify-center text-sm"},[(0,i.bF)(q,{icon:["fas","plus"],class:"mr-2 h-3 w-3"}),l[9]||(l[9]=(0,i.eW)("Add Slide "))])]),(0,i.Lk)("div",z,[(0,i.Lk)("div",null,[l[10]||(l[10]=(0,i.Lk)("label",{class:"popup-label text-sm font-semibold"},"Interval (ms):",-1)),(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":l[3]||(l[3]=e=>K.localItem.interval=e),type:"number",class:"popup-input border border-gray-300 rounded-md w-full p-2 text-sm",placeholder:"e.g., 4000"},null,512),[[a.Jo,K.localItem.interval,void 0,{number:!0}]])]),(0,i.Lk)("div",D,[(0,i.bo)((0,i.Lk)("input",{"onUpdate:modelValue":l[4]||(l[4]=e=>K.localItem.autoplay=e),type:"checkbox",class:"form-checkbox rounded",id:"slideshow_autoplay"},null,512),[[a.lH,K.localItem.autoplay]]),l[11]||(l[11]=(0,i.Lk)("label",{for:"slideshow_autoplay",class:"ml-2 popup-label text-sm"},"Autoplay",-1))])])])])],64)):(0,i.Q3)("",!0)])}t(81454);var K=t(40687),P={name:"SlideshowElement",components:{FileBrowser:K.A},props:{item:{type:Object,required:!0},mode:{type:String,required:!0}},emits:["update-item"],data(){return{localItem:JSON.parse(JSON.stringify(this.item)),editingSlideIndex:null,slideImageBrowserOpenForIndex:null}},watch:{item:{handler(e){JSON.stringify(e)!==JSON.stringify(this.localItem)&&(this.localItem=JSON.parse(JSON.stringify(e)))},deep:!0},localItem:{handler(e){JSON.stringify(e)!==JSON.stringify(this.item)&&this.$emit("update-item",JSON.parse(JSON.stringify(e)))},deep:!0}},methods:{addSlide(){const e={title:"New Slide",subtitle:"",image:"",link:"",button:!1,content:!0},l=Array.isArray(this.localItem.slides)?this.localItem.slides:[],t=l.concat(e);this.localItem={...this.localItem,slides:t},this.editingSlideIndex=this.localItem.slides.length-1},deleteSlide(e){this.localItem.slides&&this.localItem.slides[e]&&(this.localItem.slides.splice(e,1),this.editingSlideIndex===e?this.editingSlideIndex=null:this.editingSlideIndex>e&&this.editingSlideIndex--)},moveSlideUp(e){if(this.localItem.slides&&e>0){const l=this.localItem.slides.splice(e,1)[0];this.localItem.slides.splice(e-1,0,l),this.editingSlideIndex===e?this.editingSlideIndex=e-1:this.editingSlideIndex===e-1&&(this.editingSlideIndex=e)}},moveSlideDown(e){if(this.localItem.slides&&e<this.localItem.slides.length-1){const l=this.localItem.slides.splice(e,1)[0];this.localItem.slides.splice(e+1,0,l),this.editingSlideIndex===e?this.editingSlideIndex=e+1:this.editingSlideIndex===e+1&&(this.editingSlideIndex=e)}},cloneSlide(e){if(this.localItem.slides&&this.localItem.slides[e]){const l=this.localItem.slides[e],t=JSON.parse(JSON.stringify(l));this.localItem.slides.splice(e+1,0,t)}},showSlideActionPanel(e){this.editingSlideIndex=e},saveSlideChanges(){this.editingSlideIndex=null},cancelSlideEdit(){this.editingSlideIndex=null},openSlideImageBrowser(e){this.slideImageBrowserOpenForIndex=e},handleSlideFileBrowserClose(){this.slideImageBrowserOpenForIndex=null},handleSlideImageSelected(e){console.log("[Slideshow] handleSlideImageSelected PAYLOAD:",JSON.stringify(e));let l=null;if(e&&"string"===typeof e.callback){const t=e.callback.split("_"),i=parseInt(t[t.length-1],10);isNaN(i)||(l=i)}if(console.log("[Slideshow] Extracted slideIndexFromCallback:",l),e&&"string"===typeof e.file&&""!==e.file.trim()&&null!==l){const t=l;if(this.localItem&&Array.isArray(this.localItem.slides)&&this.localItem.slides[t]){console.log("[Slideshow] BEFORE update, slide image for index",t,":",this.localItem.slides[t].image);const l=this.localItem.slides.map(((l,i)=>i===t?{...l,image:e.file}:l));this.localItem={...this.localItem,slides:l},console.log("[Slideshow] AFTER update, localItem.slides["+t+"].image:",this.localItem.slides[t].image)}else console.error("[Slideshow] Condition not met for update (using slideIndexFromCallback):",{localItemExists:!!this.localItem,slidesIsArray:Array.isArray(this.localItem&&this.localItem.slides),slideExistsAtIndex:!!(this.localItem&&this.localItem.slides&&this.localItem.slides[t]),slideIndexUsed:t})}else console.warn("[Slideshow] Invalid payload, file, or could not extract slideIndexFromCallback for update:",{payloadReceived:!!e,payloadFile:e?e.file:"payload_undefined",payloadCallback:e?e.callback:"payload_undefined",slideIndexFromCallback:l});this.slideImageBrowserOpenForIndex=null}}},$=t(64621);const q=(0,$.A)(P,[["render",H],["__scopeId","data-v-b3991fee"]]);var G=q}}]);
//# sourceMappingURL=element-slideshow-vue.d5067eed.js.map