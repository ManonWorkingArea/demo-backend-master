"use strict";(self["webpackChunknode_backend"]=self["webpackChunknode_backend"]||[]).push([[8961],{68398:function(e,t,l){l.r(t),l.d(t,{default:function(){return se}});var a=l(20641),o=l(90033),s=l(53751);const r={key:0,class:"p-2 border rounded-md shadow-sm overflow-x-auto"},d={key:0},c={key:0,class:"text-md font-semibold mb-2"},i={class:"min-w-full divide-y divide-gray-200"},n={class:"bg-gray-50"},u={class:"bg-white divide-y divide-gray-200"},m={key:1,class:"text-sm text-gray-500 p-2"},p={key:1,class:"content-editor overflow-auto bg-white rounded-lg h-full"},b={class:"px-6 py-4 space-y-6"},h={class:"bg-white border border-gray-200 rounded-lg shadow-sm p-4 mb-3"},g={class:"bg-white border border-gray-200 rounded-lg shadow-sm p-4"},I={class:"flex items-center space-x-4 mb-3"},f={class:"flex items-center"},y={class:"flex items-center"},k={key:0},x={class:"mb-3"},L={class:"overflow-x-auto"},w={class:"min-w-full divide-y divide-gray-300 border border-gray-300"},v={class:"bg-gray-100"},C={class:"flex items-center"},E=["onUpdate:modelValue"],X=["onClick"],A={key:0,class:"p-2 border-b border-gray-300 text-center text-sm font-semibold"},S={class:"bg-white divide-y divide-gray-200"},D=["onUpdate:modelValue"],F={key:0,class:"p-1 text-center"},T=["onClick"],P={key:0},N=["colspan"],U={key:1},V={key:1},_={class:"flex items-end space-x-2 mb-3"},J={class:"flex-grow"},O=["disabled"],Q={key:0,class:"text-red-500 text-sm mb-2 p-2 border border-red-300 bg-red-50 rounded-md"},H={key:1,class:"mb-2 p-2 border border-yellow-300 bg-yellow-50 rounded-md text-sm"},R={class:"overflow-x-auto bg-gray-700 text-white p-2 rounded-md text-xs"},K={class:"mb-2"},$={class:"mb-3"},M={key:2,class:"overflow-x-auto"},W={class:"min-w-full divide-y divide-gray-300 border border-gray-300"},j={class:"bg-gray-100"},G={class:"flex items-center"},q=["onUpdate:modelValue"],Y=["onClick"],z={key:3,class:"text-sm text-gray-500 p-2 border rounded-md"};function B(e,t,l,B,Z,ee){const te=(0,a.g2)("font-awesome-icon");return(0,a.uX)(),(0,a.CE)("div",null,["preview"===l.mode?((0,a.uX)(),(0,a.CE)("div",r,[Z.localItem.rows&&Z.localItem.rows.length>0?((0,a.uX)(),(0,a.CE)("div",d,[Z.localItem.tableName?((0,a.uX)(),(0,a.CE)("h4",c,(0,o.v_)(Z.localItem.tableName),1)):(0,a.Q3)("",!0),(0,a.Lk)("table",i,[(0,a.Lk)("thead",n,[(0,a.Lk)("tr",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.localItem.columns,((e,t)=>((0,a.uX)(),(0,a.CE)("th",{key:e.id||t,scope:"col",class:"px-4 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},(0,o.v_)(e.label),1)))),128))])]),(0,a.Lk)("tbody",u,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.localItem.rows,((e,t)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id||t},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.localItem.columns,((l,s)=>((0,a.uX)(),(0,a.CE)("td",{key:l.id||s,class:"px-4 py-2 whitespace-nowrap text-sm text-gray-700"},(0,o.v_)(ee.getValue(e,l,t,s)),1)))),128))])))),128))])])])):((0,a.uX)(),(0,a.CE)("div",m," Table is empty or not configured. "))])):(0,a.Q3)("",!0),"edit"===l.mode?((0,a.uX)(),(0,a.CE)("div",p,[t[35]||(t[35]=(0,a.Fv)('<div class="bg-white border-b border-gray-200 px-6 py-4 sticky top-0 z-10" data-v-bd01cf76><div class="flex items-center space-x-3" data-v-bd01cf76><div class="w-8 h-8 bg-green-100 rounded-lg flex items-center justify-center" data-v-bd01cf76><i class="fas fa-table text-green-600 h-4 w-4" data-v-bd01cf76></i></div><div data-v-bd01cf76><h3 class="text-lg font-semibold text-gray-900" data-v-bd01cf76>Table Configuration</h3><p class="text-sm text-gray-500" data-v-bd01cf76>ตั้งค่าการแสดงผลของตาราง</p></div></div></div>',1)),(0,a.Lk)("div",b,[(0,a.Lk)("div",h,[t[20]||(t[20]=(0,a.Lk)("label",{class:"popup-label block mb-1 font-semibold"},"Table Name (Optional):",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=e=>Z.localItem.tableName=e),onInput:t[1]||(t[1]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),class:"popup-input w-full rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"Enter table name"},null,544),[[s.Jo,Z.localItem.tableName]])]),(0,a.Lk)("div",g,[t[34]||(t[34]=(0,a.Lk)("label",{class:"popup-label block mb-1 font-semibold"},"Data Source Type:",-1)),(0,a.Lk)("div",I,[(0,a.Lk)("label",f,[(0,a.bo)((0,a.Lk)("input",{type:"radio",id:"manual",value:"manual","onUpdate:modelValue":t[2]||(t[2]=e=>Z.localItem.dataSourceType=e),onChange:t[3]||(t[3]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),class:"form-radio"},null,544),[[s.XL,Z.localItem.dataSourceType]]),t[21]||(t[21]=(0,a.Lk)("span",{class:"ml-2 popup-label"},"Manual Input",-1))]),(0,a.Lk)("label",y,[(0,a.bo)((0,a.Lk)("input",{type:"radio",id:"api",value:"api","onUpdate:modelValue":t[4]||(t[4]=e=>Z.localItem.dataSourceType=e),onChange:t[5]||(t[5]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),class:"form-radio"},null,544),[[s.XL,Z.localItem.dataSourceType]]),t[22]||(t[22]=(0,a.Lk)("span",{class:"ml-2 popup-label"},"API",-1))])]),"manual"===Z.localItem.dataSourceType?((0,a.uX)(),(0,a.CE)("div",k,[(0,a.Lk)("div",x,[(0,a.Lk)("button",{onClick:t[6]||(t[6]=(...e)=>ee.addColumn&&ee.addColumn(...e)),class:"px-3 py-1.5 bg-green-500 text-white rounded-md hover:bg-green-600 text-sm mr-2"},[(0,a.bF)(te,{icon:["fas","plus"],class:"mr-1"}),t[23]||(t[23]=(0,a.eW)(" Add Column "))]),(0,a.Lk)("button",{onClick:t[7]||(t[7]=(...e)=>ee.addRow&&ee.addRow(...e)),class:"px-3 py-1.5 bg-blue-500 text-white rounded-md hover:bg-blue-600 text-sm mr-2"},[(0,a.bF)(te,{icon:["fas","plus"],class:"mr-1"}),t[24]||(t[24]=(0,a.eW)(" Add Row "))]),Z.localItem.columns&&Z.localItem.columns.length>0&&Z.localItem.rows&&Z.localItem.rows.length>0?((0,a.uX)(),(0,a.CE)("button",{key:0,onClick:t[8]||(t[8]=(...e)=>ee.clearTableData&&ee.clearTableData(...e)),class:"px-3 py-1.5 bg-red-500 text-white rounded-md hover:bg-red-600 text-sm"}," Clear Table Data ")):(0,a.Q3)("",!0)]),(0,a.Lk)("div",L,[(0,a.Lk)("table",w,[(0,a.Lk)("thead",v,[(0,a.Lk)("tr",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.localItem.columns,((e,l)=>((0,a.uX)(),(0,a.CE)("th",{key:e.id||l,class:"p-2 border-b border-r border-gray-300 text-left text-sm font-semibold"},[(0,a.Lk)("div",C,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.label=t,onInput:t[9]||(t[9]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),type:"text",class:"popup-input flex-grow text-sm mr-1 rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"Column Name"},null,40,E),[[s.Jo,e.label]]),(0,a.Lk)("button",{onClick:e=>ee.deleteColumn(l),class:"text-red-500 hover:text-red-700 ml-1"},[(0,a.bF)(te,{icon:["fas","times"]})],8,X)])])))),128)),Z.localItem.columns&&Z.localItem.columns.length>0?((0,a.uX)(),(0,a.CE)("th",A,"Actions")):(0,a.Q3)("",!0)])]),(0,a.Lk)("tbody",S,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.localItem.rows,((e,l)=>((0,a.uX)(),(0,a.CE)("tr",{key:e.id||l},[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.localItem.columns,((l,o)=>((0,a.uX)(),(0,a.CE)("td",{key:l.id||o,class:"p-1 border-r border-gray-200"},[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.data[l.label]=t,onInput:t[10]||(t[10]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),type:"text",class:"popup-input w-full text-sm rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"Enter data"},null,40,D),[[s.Jo,e.data[l.label]]])])))),128)),Z.localItem.columns&&Z.localItem.columns.length>0?((0,a.uX)(),(0,a.CE)("td",F,[(0,a.Lk)("button",{onClick:e=>ee.deleteRow(l),class:"text-red-500 hover:text-red-700"},[(0,a.bF)(te,{icon:["fas","trash"]})],8,T)])):(0,a.Q3)("",!0)])))),128)),!Z.localItem.rows||0===Z.localItem.rows.length&&Z.localItem.columns&&Z.localItem.columns.length>0?((0,a.uX)(),(0,a.CE)("tr",P,[(0,a.Lk)("td",{colspan:Z.localItem.columns.length+1,class:"text-center p-3 text-gray-500"}," No rows yet. Click 'Add Row' to start. ",8,N)])):(0,a.Q3)("",!0),Z.localItem.columns&&0!==Z.localItem.columns.length?(0,a.Q3)("",!0):((0,a.uX)(),(0,a.CE)("tr",U,t[25]||(t[25]=[(0,a.Lk)("td",{class:"text-center p-3 text-gray-500"}," No columns yet. Click 'Add Column' to start. ",-1)])))])])])])):"api"===Z.localItem.dataSourceType?((0,a.uX)(),(0,a.CE)("div",V,[(0,a.Lk)("div",_,[(0,a.Lk)("div",J,[t[26]||(t[26]=(0,a.Lk)("label",{class:"popup-label block mb-1 font-semibold"},"API Endpoint URL:",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[11]||(t[11]=e=>Z.localItem.apiEndpoint=e),onInput:t[12]||(t[12]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),placeholder:"https://api.example.com/data",class:"popup-input w-full rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},null,544),[[s.Jo,Z.localItem.apiEndpoint]])]),(0,a.Lk)("div",null,[t[28]||(t[28]=(0,a.Lk)("label",{class:"popup-label block mb-1 font-semibold"},"Method:",-1)),(0,a.bo)((0,a.Lk)("select",{"onUpdate:modelValue":t[13]||(t[13]=e=>Z.localItem.apiMethod=e),onChange:t[14]||(t[14]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),class:"popup-input rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500"},t[27]||(t[27]=[(0,a.Lk)("option",{value:"GET"},"GET",-1),(0,a.Lk)("option",{value:"POST"},"POST",-1)]),544),[[s.u1,Z.localItem.apiMethod]])]),(0,a.Lk)("button",{onClick:t[15]||(t[15]=(...e)=>ee.fetchDataFromApi&&ee.fetchDataFromApi(...e)),disabled:Z.apiLoading,class:"px-4 py-2 bg-indigo-500 text-white rounded-md hover:bg-indigo-600 text-sm"},[(0,a.bF)(te,{icon:["fas",Z.apiLoading?"spinner":"download"],spin:Z.apiLoading,class:"mr-1"},null,8,["icon","spin"]),(0,a.eW)(" "+(0,o.v_)(Z.apiLoading?"Fetching...":"Fetch Data"),1)],8,O)]),Z.apiError?((0,a.uX)(),(0,a.CE)("div",Q,(0,o.v_)(Z.apiError),1)):(0,a.Q3)("",!0),Z.localItem.apiDataStructureHint&&Z.localItem.apiDataStructureHint.length>0?((0,a.uX)(),(0,a.CE)("div",H,[t[29]||(t[29]=(0,a.Lk)("p",{class:"font-semibold"},"API Data Structure Hint (first item):",-1)),(0,a.Lk)("pre",R,(0,o.v_)(Z.localItem.apiDataStructureHint[0]),1)])):(0,a.Q3)("",!0),(0,a.Lk)("div",K,[t[30]||(t[30]=(0,a.Lk)("label",{class:"popup-label block mb-1 font-semibold"},"Data Path (e.g., data.items or leave empty if response is array):",-1)),(0,a.bo)((0,a.Lk)("input",{type:"text","onUpdate:modelValue":t[16]||(t[16]=e=>Z.localItem.apiDataPath=e),onInput:t[17]||(t[17]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),class:"popup-input w-full rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"data.records"},null,544),[[s.Jo,Z.localItem.apiDataPath]])]),t[33]||(t[33]=(0,a.Lk)("p",{class:"text-xs text-gray-500 mb-3"},"After fetching, manually add columns below based on the API response structure. The table will then populate using these column labels as keys for the data.",-1)),(0,a.Lk)("div",$,[(0,a.Lk)("button",{onClick:t[18]||(t[18]=(...e)=>ee.addColumnForApi&&ee.addColumnForApi(...e)),class:"px-3 py-1.5 bg-green-500 text-white rounded-md hover:bg-green-600 text-sm mr-2"},[(0,a.bF)(te,{icon:["fas","plus"],class:"mr-1"}),t[31]||(t[31]=(0,a.eW)(" Add Column for API Data "))])]),Z.localItem.apiColumns&&Z.localItem.apiColumns.length>0?((0,a.uX)(),(0,a.CE)("div",M,[(0,a.Lk)("table",W,[(0,a.Lk)("thead",j,[(0,a.Lk)("tr",null,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(Z.localItem.apiColumns,((e,l)=>((0,a.uX)(),(0,a.CE)("th",{key:e.id||l,class:"p-2 border-b border-r border-gray-300 text-left text-sm font-semibold"},[(0,a.Lk)("div",G,[(0,a.bo)((0,a.Lk)("input",{"onUpdate:modelValue":t=>e.label=t,onInput:t[19]||(t[19]=(...e)=>ee.updateLocalItem&&ee.updateLocalItem(...e)),type:"text",class:"popup-input flex-grow text-sm mr-1 rounded-md border border-gray-300 p-2 focus:border-blue-500 focus:ring-2 focus:ring-blue-500",placeholder:"Column Key/Label"},null,40,q),[[s.Jo,e.label]]),(0,a.Lk)("button",{onClick:e=>ee.deleteApiColumn(l),class:"text-red-500 hover:text-red-700 ml-1"},[(0,a.bF)(te,{icon:["fas","times"]})],8,Y)])])))),128))])])]),t[32]||(t[32]=(0,a.Lk)("p",{class:"text-xs text-gray-500 mt-1"},"Preview will use these column labels to map data from the API response.",-1))])):((0,a.uX)(),(0,a.CE)("div",z," Add columns to define how API data should be displayed. "))])):(0,a.Q3)("",!0)])])])):(0,a.Q3)("",!0)])}l(44114),l(98992),l(3949);var Z=l(61273),ee=l(94335);function te(){return Date.now().toString(36)+Math.random().toString(36).substring(2)}var le={name:"TableElement",components:{FontAwesomeIcon:Z.gc},props:{item:{type:Object,required:!0},mode:{type:String,required:!0}},emits:["update-item"],data(){return{localItem:{},apiLoading:!1,apiError:null}},computed:{divStyles(){const e=!1;if(e){const e="calc(100vh - 190px)";return{height:e,overflowY:"scroll",scrollbarWidth:"thin",scrollbarColor:"rgba(0, 0, 0, 0.2) transparent",right:"-20px"}}return{minHeight:"600px",maxHeight:"600px",overflowY:"scroll",scrollbarWidth:"thin",scrollbarColor:"rgba(0, 0, 0, 0.2) transparent",right:"-20px"}}},watch:{item:{handler(e){const t={tableName:"",dataSourceType:"manual",columns:[],rows:[],apiEndpoint:"",apiMethod:"GET",apiDataPath:"",apiColumns:[],apiDataStructureHint:null},l={...t,...JSON.parse(JSON.stringify(e))};l.columns=l.columns||[],l.rows=l.rows||[],l.apiColumns=l.apiColumns||[],JSON.stringify(l)!==JSON.stringify(this.localItem)&&(this.localItem=l)},deep:!0,immediate:!0}},methods:{updateLocalItem(){this.$emit("update-item",JSON.parse(JSON.stringify(this.localItem)))},addColumn(){this.localItem.columns||(this.localItem.columns=[]);const e=`col_${te()}`;this.localItem.columns.push({id:e,label:`Column ${this.localItem.columns.length+1}`}),this.localItem.rows&&this.localItem.rows.forEach((e=>{e.data||(e.data={}),e.data[`Column ${this.localItem.columns.length}`]=""})),this.updateLocalItem()},addRow(){this.localItem.rows||(this.localItem.rows=[]);const e={id:`row_${te()}`,data:{}};this.localItem.columns&&this.localItem.columns.forEach((t=>{e.data[t.label]=""})),this.localItem.rows.push(e),this.updateLocalItem()},deleteColumn(e){if(this.localItem.columns&&this.localItem.columns[e]){const t=this.localItem.columns[e].label;this.localItem.columns.splice(e,1),this.localItem.rows&&this.localItem.rows.forEach((e=>{e.data&&Object.prototype.hasOwnProperty.call(e.data,t)&&delete e.data[t]})),this.updateLocalItem()}},deleteRow(e){this.localItem.rows&&(this.localItem.rows.splice(e,1),this.updateLocalItem())},clearTableData(){this.localItem.rows=[],this.updateLocalItem()},addColumnForApi(){this.localItem.apiColumns||(this.localItem.apiColumns=[]),this.localItem.apiColumns.push({id:`api_col_${te()}`,label:""}),this.updateLocalItem()},deleteApiColumn(e){this.localItem.apiColumns&&(this.localItem.apiColumns.splice(e,1),this.updateLocalItem())},async fetchDataFromApi(){if(this.localItem.apiEndpoint){this.apiLoading=!0,this.apiError=null,this.localItem.apiDataStructureHint=null;try{const e=await(0,ee.A)({method:this.localItem.apiMethod||"GET",url:this.localItem.apiEndpoint});let t=e.data;if(this.localItem.apiDataPath){const l=this.localItem.apiDataPath.split(".");let a=e.data;for(const e of l){if(!a||"object"!==typeof a||!(e in a))throw new Error(`Path '${this.localItem.apiDataPath}' not found in API response.`);a=a[e]}t=a}if(!Array.isArray(t))throw new Error("Data at the specified path is not an array.");t.length>0&&(this.localItem.apiDataStructureHint=[JSON.stringify(t[0],null,2)])}catch(e){console.error("API Fetch Error:",e),this.apiError=e.message||"Failed to fetch data from API.",e.response&&(this.apiError+=` (Status: ${e.response.status})`)}finally{this.apiLoading=!1,this.updateLocalItem()}}else this.apiError="API Endpoint URL is required."},getValue(e,t){return"manual"===this.localItem.dataSourceType?e.data&&t.label in e.data?e.data[t.label]:"":"api"===this.localItem.dataSourceType&&e&&t.label in e?e[t.label]:""}}},ae=l(64621);const oe=(0,ae.A)(le,[["render",B],["__scopeId","data-v-bd01cf76"]]);var se=oe}}]);
//# sourceMappingURL=element-table-vue.a35f8ea9.js.map