/**
 * ERP Document Universal Styles
 * 
 * CSS กลางสำหรับเอกสารทุกประเภทในระบบ ERP
 * - ใบขอซื้อ (Purchase Request)
 * - ใบเสนอราคา (Quotation)
 * - ใบแจ้งหนี้ (Invoice)
 * - ใบส่งของ (Delivery Order)
 * - และอื่นๆ
 * 
 * @version 1.0.0
 * @date 2024-11-24
 */

/* ===== HARDCODED A4 PORTRAIT LAYOUT ===== */

/* Document CSS Isolation - Override Everything */
[data-document-isolated="true"] {
  all: revert;
  
  /* Force A4 Portrait: 210mm x 297mm - ULTIMATE OVERRIDE */
  width: 210mm !important;
  height: 297mm !important;
  min-width: 210mm !important;
  min-height: 297mm !important;
  max-width: 210mm !important;
  max-height: 297mm !important;
  
  /* Typography Reset */
  font-family: 'Sarabun', 'TH SarabunPSK', Arial, sans-serif !important;
  font-size: 11pt !important;
  line-height: 1.2 !important;
  color: #000000 !important;
  
  /* Layout - NUCLEAR OVERRIDE */
  background: #ffffff !important;
  margin: 0 auto !important;
  padding: 0 !important;
  position: relative !important;
  box-sizing: border-box !important;
  
  /* Remove all external influences */
  display: block !important;
  overflow: visible !important;
  flex: none !important;
  
  /* Print ready */
  -webkit-print-color-adjust: exact !important;
  print-color-adjust: exact !important;
  
  /* Isolation containment */
  contain: none !important;
  
  /* Debug - Make sure it's visible */
  opacity: 1 !important;
  visibility: visible !important;
  z-index: 1 !important;
}

/* A4 Document Structure - Absolute Positioning */
.a4-document {
  width: 210mm;
  height: 297mm;
  background: #ffffff;
  position: relative;
  
  /* Remove grid - use absolute positioning instead */
  display: block;
  overflow: visible;
  box-sizing: border-box;
}

/* Document Content - Minimal Margins for Terminal Printing */
.document-content {
  /* Content area with safe margins */
  position: absolute;
  top: 5mm;
  left: 5mm;
  right: 5mm;
  bottom: 5mm;

  width: 200mm;
  height: 287mm;

  /* Dynamic grid layout based on page type */
  display: grid;
  /* Grid rows adjust based on content: head, sub-head, table, [optional signatures], footer */
  grid-template-rows: var(--grid-rows, 24mm 26mm 1fr 35mm 20mm);
  /* Remove vertical gap so table can touch the sub-head divider */
  grid-row-gap: 0mm;

  background: #ffffff;
  box-sizing: border-box;
  overflow: hidden;
}

/* SIMPLE HEADER BOX - Terminal Printer Friendly */
.document-head {
  /* Grid row 1 */
  position: relative !important;
  width: 100% !important;
  height: 24mm !important;

  background: #ffffff !important;
  padding: 0mm 0mm 3mm 0mm !important;
  box-sizing: border-box !important;
  overflow: visible !important;
  z-index: 1 !important;
  display: block !important;
  border-bottom: var(--divider, 1pt) solid #dcdcdc !important;
}

/* Header Container - Simple Lines Only */
.header-container {
  width: 100% !important;
  height: 100% !important;
  background: #ffffff !important;
  box-sizing: border-box !important;
  /* No outer border */
}

/* Header Top Row */
.header-top-row {
  width: 100% !important;
  height: 70% !important;
  display: flex !important;
  box-sizing: border-box !important;
  padding-bottom: 2mm !important;
}

.header-logo-section {
  width: 30% !important;
  padding: 0mm !important;
  display: flex !important;
  align-items: center !important;
  justify-content: flex-start !important;
  box-sizing: border-box !important;
}

.header-logo {
  height: 20mm !important;
  width: auto !important;
  max-width: 100% !important;
  object-fit: contain !important;
}

.header-title-section {
  width: 70% !important;
  padding: 2mm !important;
  display: flex !important;
  align-items: center !important;
  justify-content: flex-end !important;
  font-size: 12pt !important;
  font-weight: bold !important;
  color: #000000 !important;
  box-sizing: border-box !important;
}

/* Header Bottom Row */
.header-bottom-row {
  width: 100% !important;
  height: 30% !important;
  display: flex !important;
  box-sizing: border-box !important;
  padding-top: 2mm !important;
  padding-bottom: 2mm !important;
}

.header-code-section {
  width: 50% !important;
  padding: 0 !important;
  padding-right: 4mm !important;
  display: flex !important;
  align-items: center !important;
  justify-content: flex-start !important;
  font-size: 10pt !important;
  color: #000000 !important;
  box-sizing: border-box !important;
  position: relative !important;
}

.header-date-section {
  width: 50% !important;
  padding: 0 !important;
  padding-left: 4mm !important;
  display: flex !important;
  align-items: center !important;
  justify-content: flex-end !important;
  font-size: 10pt !important;
  color: #000000 !important;
  box-sizing: border-box !important;
}

.document-sub-head {
  /* Grid row 2 */
  position: relative !important;
  width: 100% !important;
  height: 26mm !important;

  background: #ffffff !important;
  padding: 5mm 0mm !important;
  box-sizing: border-box !important;
  overflow: hidden !important;
  border-bottom: var(--divider, 1pt) solid #000000 !important;
}

/* Contact Info Grid */
.contact-info-grid {
  width: 100% !important;
  height: 100% !important;
  display: flex !important;
  box-sizing: border-box !important;
}

.company-info-section {
  width: 50% !important;
  padding: 0 !important;
  padding-right: 4mm !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: flex-start !important;
  box-sizing: border-box !important;
  position: relative !important;
  border-right: 0.5pt solid #e5e5e5 !important;
}

.requester-info-section {
  width: 50% !important;
  padding: 0 !important;
  padding-left: 4mm !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: flex-start !important;
  box-sizing: border-box !important;
}

.document-main-content {
  /* Grid row 3 - flexible */
  position: relative !important;
  width: 100% !important;
  height: 100% !important;

  background: #ffffff !important;
  padding: 0mm !important;
  box-sizing: border-box !important;
  overflow: hidden !important;
}

.document-sub-footer {
  /* Grid row 4 */
  position: relative !important;
  width: 100% !important;
  height: 35mm !important;

  background: #ffffff !important;
  padding: 0mm 0mm !important;
  box-sizing: border-box !important;
  overflow: visible !important;
}

.document-footer {
  /* Grid row 5 */
  position: relative !important;
  width: 100% !important;
  height: 20mm !important;

  background: #ffffff !important;
  padding: 2mm 3mm !important;
  box-sizing: border-box !important;
  overflow: hidden !important;
}

/* Hardcoded Typography - No Responsive */
h1, h2, h3, h4, h5, h6 {
  font-family: 'Sarabun', 'TH SarabunPSK', Arial, sans-serif;
  font-weight: bold;
  margin: 0;
  padding: 0;
  line-height: 1.2;
  color: #000000;
}

h1 { 
  font-size: 18pt;
  text-align: center;
  margin-bottom: 2mm;
}

h2 { 
  font-size: 14pt;
  text-align: center;
  margin-bottom: 3mm;
  font-weight: normal;
}

h3 { 
  font-size: 11pt;
  margin-bottom: 2mm;
}

h4 {
  font-size: 9pt;
  margin-bottom: 1mm;
}

/* Table Container - Full Width for Terminal */
.table-container {
  position: relative;
  width: 100%;
  height: 100%;
  background: #ffffff;
  overflow: hidden;
}

/* Table with borders like the design - force compact */
table {
  width: 100%;
  height: auto !important;
  border-collapse: collapse;
  font-size: 8pt;
  table-layout: fixed !important;
  /* Only top/bottom border; remove left/right */
  border-top: var(--divider, 1pt) solid #000000;
  border-bottom: var(--divider, 1pt) solid #000000;
  border-left: 0;
  border-right: 0;
  /* Pull the table up to overlap the divider above */
  margin-top: calc(-1 * var(--divider, 1pt));
}

/* Table Structure - Force ultra compact */
table thead {
  background: #ffffff !important;
  height: auto !important;
}

table tbody {
  background: #ffffff !important;
  height: auto !important;
}

table tfoot {
  background: #f8f8f8 !important;
  height: auto !important;
  min-height: 25mm !important;
  font-weight: bold !important;
}

/* Table Cells - With borders like the design */
table th,
table td {
  border: 0.5pt solid #000000 !important;
  padding: 1px 4px !important;
  vertical-align: middle;
  text-align: left;
  line-height: 1.0;
  font-size: 8pt;
  overflow: hidden;
  white-space: nowrap;
  text-overflow: ellipsis;
}

/* Row heights - driven by variables for clear control */
tbody tr,
table tbody tr { 
  height: calc(var(--row-line-height, 8mm) + (2 * var(--cell-vpad, 1mm))) !important; 
}

tbody td {
  padding: var(--cell-vpad, 1mm) 6px !important;
  line-height: var(--row-line-height, 8mm) !important;
  font-size: 8pt !important;
  vertical-align: middle !important;
}

table tfoot td {
  padding: 1.5mm 2mm !important;
  line-height: 1.2 !important;
}

/* Footer cells need special handling for long text */
table tfoot td[colspan] {
  white-space: normal !important;
  overflow: visible !important;
  text-overflow: visible !important;
  height: auto !important;
  min-height: 8mm !important;
}

table th {
  font-weight: bold !important;
  text-align: center !important;
  color: #000000 !important;
  background: #ffffff !important;
  vertical-align: middle;
}

table td {
  background: #ffffff !important;
}

/* Header bilingual labels */
table th .th-wrap { 
  display: inline-flex; 
  flex-direction: column; 
  align-items: inherit; 
  line-height: 1.1; 
}

table th .th-th { 
  font-size: 8.5pt; 
  color: #000000; 
}

table th .th-en { 
  font-size: 7pt; 
  color: #666666; 
  font-weight: 600; 
  margin-top: 1px; 
}

table th .th-right { 
  align-items: flex-end; 
}

/* Force table borders with high specificity */
.table-container table {
  /* Ensure only top and bottom borders are shown */
  border-top: var(--divider, 1pt) solid #000000 !important;
  border-bottom: var(--divider, 1pt) solid #000000 !important;
  border-left: 0 !important;
  border-right: 0 !important;
}

.table-container table th,
.table-container table td {
  border: 0.5pt solid #000000 !important;
}

/* Remove outermost left and right cell borders to match table sides */
.table-container table th:first-child,
.table-container table td:first-child { 
  border-left: 0 !important; 
}

.table-container table th:last-child,
.table-container table td:last-child { 
  border-right: 0 !important; 
}

/* ITEMS BODY: remove all horizontal borders (keep vertical only) */
.table-container table tbody td {
  border-top: 0 !important;
  border-bottom: 0 !important;
}

/* Footer summary styling */
table tfoot td {
  background: #ffffff !important;
  font-size: 8pt !important;
  padding: 2mm 2mm !important;
  white-space: normal !important;
  overflow: visible !important;
  text-overflow: visible !important;
}

table tfoot tr:last-child td {
  font-weight: bold !important;
  font-size: 9pt !important;
  background: #f8f8f8 !important;
}

/* Notes area styling */
.notes-title { 
  font-weight: 600; 
  margin-bottom: 1mm; 
}

.notes-content { 
  min-height: 12mm; 
  white-space: pre-wrap; 
}

table td {
  color: #000000;
  background: #ffffff;
}

/* Controlled Row Heights */
table thead tr { 
  height: 10mm; 
}

table tbody tr { 
  height: calc(var(--row-line-height, 8mm) + (2 * var(--cell-vpad, 1mm))); 
}

table tfoot tr {
  height: auto;
  min-height: 30px;
}

/* Column Widths - percentage to adapt with safe mm layout */
table th:nth-child(1), table td:nth-child(1) { width: 9%; }
table th:nth-child(2), table td:nth-child(2) { width: 15%; }
table th:nth-child(3), table td:nth-child(3) { width: 33%; }
table th:nth-child(4), table td:nth-child(4) { width: 11%; }
table th:nth-child(5), table td:nth-child(5) { width: 8%; }
table th:nth-child(6), table td:nth-child(6) { width: 12%; }
table th:nth-child(7), table td:nth-child(7) { width: 12%; }

/* Terminal Style - Allow table background colors */
table .bg-gray-50,
table thead { 
  background-color: #ffffff !important; 
}

.bg-gray-100 { 
  background-color: #f5f5f5; 
}

/* A4 Border System - Table borders enabled */
.border { 
  border: 1px solid #000000; 
}

.border-gray-300 { 
  border-color: #000000; 
}

.border-b-2 { 
  border: none; 
}

.border-t { 
  border: none; 
}

/* Status Badge System */
.rounded-full { 
  border-radius: 50px; 
}

.px-2 { 
  padding-left: 0.2cm; 
  padding-right: 0.2cm; 
}

.py-1 { 
  padding-top: 0.1cm; 
  padding-bottom: 0.1cm; 
}

/* Minimal spacing for terminal printing */
.p-3, .p-4 { 
  padding: 1mm; 
}

.pt-4 { 
  padding-top: 1mm; 
}

.pb-4 { 
  padding-bottom: 1mm; 
}

.pb-6 { 
  padding-bottom: 1mm; 
}

.mt-4 { 
  margin-top: 1mm; 
}

.mt-6 { 
  margin-top: 1mm; 
}

.mt-12 { 
  margin-top: 2mm; 
}

/* Clean Borders - Table borders enabled */
table .border, 
table .border-gray-300, 
table .border-gray-200 {
  border: 0.5pt solid #000000 !important;
}

.border-b-2 {
  border: none;
  page-break-after: avoid;
}

.border-t {
  border: none;
}

.rounded {
  border-radius: 0;
}

/* Signature sections - Thai Style with Dots - Expanded */
.signature-row {
  margin-top: 3mm !important;
  border-top: var(--divider, 1pt) solid #000000 !important;
  padding-top: 4mm !important;
  height: 28mm !important;
  width: 100% !important;
  display: flex !important;
}

.signature-section {
  width: 50% !important;
  padding: 3mm !important;
  text-align: center !important;
  background: #ffffff !important;
  box-sizing: border-box !important;
  display: flex !important;
  flex-direction: column !important;
  justify-content: flex-start !important;
}

.signature-space {
  display: flex !important;
  flex-direction: column !important;
  align-items: center !important;
  margin-top: 2mm !important;
}

.signature-dots {
  font-size: 12pt !important;
  line-height: 1.2 !important;
  margin-bottom: 3mm !important;
  letter-spacing: 1.5pt !important;
  width: 80% !important;
  color: #000000 !important;
  font-weight: 700 !important;
}

.signature-name {
  font-size: 9pt !important;
  line-height: 1.2 !important;
  color: #000000 !important;
  margin-top: 1mm !important;
  font-weight: 600 !important;
}

/* Document footer - Ultra Compact */
.document-footer {
  margin-top: 1rem;
  page-break-inside: avoid;
  border-top: var(--divider, 1pt) solid #000000;
  padding-top: 0.2rem;
  font-size: 8px;
  text-align: center;
}

/* Make signature section headings darker */
.document-sub-footer .text-xs {
  color: #000000 !important;
  font-weight: 700 !important;
}

/* Hardcoded Utility Classes - No Variables */
.text-right { 
  text-align: right; 
}

.text-center { 
  text-align: center; 
}

.text-left { 
  text-align: left; 
}

.font-semibold { 
  font-weight: 600; 
}

.font-bold { 
  font-weight: bold; 
}

.font-mono { 
  font-family: 'Courier New', Monaco, monospace; 
}

/* Fixed Font Sizes */
.text-2xl { 
  font-size: 14pt; 
  line-height: 1.1; 
}

.text-xl { 
  font-size: 12pt; 
  line-height: 1.1; 
}

.text-lg { 
  font-size: 11pt; 
  line-height: 1.2; 
}

.text-sm { 
  font-size: 9pt; 
  line-height: 1.2; 
}

.text-xs { 
  font-size: 8pt; 
  line-height: 1.1; 
}

/* Fixed Spacing */
.space-y-1 > * + * { 
  margin-top: 1mm; 
}

.mb-1 { 
  margin-bottom: 1mm; 
}

.mb-2 { 
  margin-bottom: 2mm; 
}

.mt-1 { 
  margin-top: 1mm; 
}

.mt-2 { 
  margin-top: 2mm; 
}

.mt-3 { 
  margin-top: 3mm; 
}

.mt-4 { 
  margin-top: 4mm; 
}

.ml-2 { 
  margin-left: 2mm; 
}

/* Fixed Layout */
.max-w-md { 
  max-width: 80mm; 
}

.w-full { 
  width: 100%; 
}

/* Fixed Colors */
.text-gray-600 { 
  color: #666666; 
}

.text-gray-700 { 
  color: #333333; 
}

.text-gray-900 { 
  color: #000000; 
}

.min-h-20 { 
  min-height: 2rem; 
}

/* ===== SCREEN DISPLAY ===== */
.erp-document {
  /* Always center on screen */
  margin: 10mm auto;
  box-shadow: 0 4pt 16pt rgba(0, 0, 0, 0.1);
  border: 0.5pt solid #cccccc;
  /* Adjustable row sizing */
  --row-line-height: 8mm;   /* increase for taller rows */
  --cell-vpad: 1mm;         /* vertical padding */
  /* Consistent divider thickness across the document */
  --divider: 1pt;
  /* Dynamic grid layout based on page content */
  --grid-rows: 24mm 26mm 1fr 35mm 20mm; /* default: with signatures */
}

/* Conditional grid layout for pages without signatures */
.erp-document[data-no-signatures="true"] {
  --grid-rows: 24mm 26mm 1fr 20mm; /* head, sub-head, table, footer only */
}

.erp-document[data-no-signatures="true"] .document-content {
  grid-template-rows: 24mm 26mm 1fr 20mm;
}

/* ===== PRINT OPTIMIZATION ===== */
@media print {
  @page {
    size: A4 portrait;
    margin: 0mm;
  }
  
  .erp-document {
    width: 210mm !important;
    height: 297mm !important;
    margin: 0 !important;
    box-shadow: none !important;
    border: none !important;
  }
  
  .a4-document {
    width: 210mm !important;
    height: 297mm !important;
    margin: 0 !important;
    box-shadow: none !important;
    border: none !important;
  }

  /* Grid remains stable on print; avoid fixed positioning to prevent overlaps */
  .document-footer,
  .document-sub-footer {
    position: relative !important;
    page-break-inside: avoid !important;
  }
}
